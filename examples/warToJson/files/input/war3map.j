//===========================================================================
// 
// Heroes and Empires v90
// 
//   Warcraft III map script
//   Generated by the Warcraft III World Editor
//   Date: Mon Jul 22 16:23:04 2013
//   Map Author: Lord_Squad & FinalLegacy
// 
//===========================================================================

//***************************************************************************
//*
//*  Global Variables
//*
//***************************************************************************

globals
    // User-defined
    integer                 udg_Empires                = 0
    integer                 udg_Heroes                 = 0
    integer array           udg_HeroLifes
    string array            udg_Playercolor
    player                  udg_player                 = null
    timer                   udg_Builderstarter         = null
    integer array           udg_Rations
    integer array           udg_Empire
    integer array           udg_food
    integer array           udg_happyness
    integer array           udg_CurrentAge
    integer array           udg_StartedEmpire
    integer array           udg_Tax
    integer array           udg_ResearchDone
    integer array           udg_Townhallsettings4
    integer array           udg_ResearchNeed
    integer array           udg_Researching
    integer                 udg_Pay                    = 0
    integer array           udg_Townhallsettings1
    integer array           udg_Townhallsettings2
    integer array           udg_Townhallsettings3
    integer array           udg_ResearchNeedStart
    string array            udg_ProjectName
    unit                    udg_ResearchCentre         = null
    integer array           udg_Researches
    integer                 udg_Chosen                 = 0
    integer array           udg_Attributepoints
    integer array           udg_HeroLevel
    integer                 udg_exp                    = 0
    integer                 udg_MonsterType            = 0
    integer                 udg_Camera                 = 0
    player                  udg_playerremind           = null
    player array            udg_asking
    player                  udg_otherplayer            = null
    button array            udg_HeroAllyButtons
    integer array           udg_Playerbussy
    dialog                  udg_HeroAlly1              = null
    dialog                  udg_HeroAlly2              = null
    dialog                  udg_HeroAlly3              = null
    dialog                  udg_HeroAlly4              = null
    dialog                  udg_HeroAlly5              = null
    dialog                  udg_HeroAlly6              = null
    dialog                  udg_HeroAlly7              = null
    dialog                  udg_HeroAlly8              = null
    dialog                  udg_HeroAlly9              = null
    dialog                  udg_HeroAlly10             = null
    player                  udg_Asked                  = null
    player                  udg_Asker                  = null
    dialog                  udg_Difficulty             = null
    button array            udg_Difficultybuttons
    integer array           udg_VoteCounter
    timer                   udg_SpawnUp                = null
    integer array           udg_Citizens
    location                udg_Tempspot               = null
    rect                    udg_TempRegion3            = null
    location                udg_Tempspot3              = null
    integer                 udg_UpCounter2             = 0
    location                udg_Tempspot4              = null
    group                   udg_TempGroup1             = null
    group                   udg_TempGroup3             = null
    group                   udg_TempGroup4             = null
    location                udg_Tempspot10             = null
    integer array           udg_Ignore1
    integer array           udg_Ignore2
    integer array           udg_Ignore3
    integer array           udg_Ignore4
    integer array           udg_Ignore5
    integer array           udg_Ignore6
    integer array           udg_Ignore7
    integer array           udg_Ignore8
    integer array           udg_Ignore9
    integer array           udg_Ignore10
    location                udg_Tempspot11             = null
    location                udg_Tempspot12             = null
    timer                   udg_GracePeriode           = null
    integer                 udg_Damageunits            = 0
    unit                    udg_DyingUnit              = null
    unit                    udg_KillingUnit            = null
    integer                 udg_CreepCounter           = 0
    integer                 udg_Exprate                = 0
    integer                 udg_daynight               = 0
    integer                 udg_TimerDiff              = 0
    integer                 udg_UpCounter              = 0
    dialog                  udg_Race                   = null
    button array            udg_RaceButtons
    integer                 udg_Starting               = 0
    integer array           udg_HeroRace
    integer                 udg_Players                = 0
    integer array           udg_PowerSupply
    multiboard array        udg_PlayerMultiboard
    integer array           udg_Powerneeded
    player                  udg_player2                = null
    unit array              udg_Herounit
    integer                 udg_SkillLevel             = 0
    timer                   udg_CompUp                 = null
    force                   udg_AttackerGroup          = null
    unit array              udg_ScienceLab
    integer array           udg_FarmsAmount
    integer array           udg_WeaponSword
    integer array           udg_WeaponHands
    integer array           udg_WeaponStaff
    integer array           udg_WeaponAxe
    integer array           udg_dummyspell1
    integer array           udg_dummyspell2
    integer array           udg_WeaponMagic
    integer array           udg_dummyspell3
    integer array           udg_dummyspell4
    effect array            udg_HelmGraphic
    integer array           udg_HelmGraphicSet
    integer                 udg_ObeliskSpawn           = 0
    timer                   udg_Obilisk                = null
    timerdialog             udg_obilisktimerwindow     = null
    unit                    udg_Obelisk                = null
    integer                 udg_Plague                 = 0
    timer                   udg_PlagueTimer            = null
    timerdialog             udg_PlagueTimerWindow      = null
    integer array           udg_ArmorAmount
    integer                 udg_Random                 = 0
    integer                 udg_EquipmentCamp          = 0
    timerdialog             udg_startingwindow         = null
    integer                 udg_KalendenDiff           = 0
    boolean                 udg_ZZBoolean              = false
    player                  udg_ZZPlayer               = null
    dialog                  udg_Class                  = null
    button array            udg_ClassButtons
    integer array           udg_ClassNumber
    integer array           udg_SkillBook
    integer array           udg_income
    integer array           udg_ExtraWood
    integer array           udg_Power
    integer array           udg_PeopleRelaxing
    integer array           udg_PeopleSience
    integer array           udg_PeopleIndustrial
    integer array           udg_PeopleCommercial
    integer array           udg_PeopleWorking
    integer                 udg_Fires                  = 0
    integer array           udg_ZZRebelionLevel
    integer array           udg_GrainFarming
    button array            udg_ProfileButtons
    dialog                  udg_Profile                = null
    integer array           udg_EmpireProfile
    dialog                  udg_Mode                   = null
    button array            udg_ModeButtons
    unit                    udg_ZZUnit                 = null
    unit                    udg_ZZUnit2                = null
    integer array           udg_Weapon
    integer array           udg_ZZCreepLevels1
    integer array           udg_ZZCreepLevels2
    integer array           udg_ZZCreepLevels3
    integer array           udg_ZZCreepLevels4
    integer array           udg_ZZCreepLevels5
    integer array           udg_HeroType
    integer array           udg_Starving
    integer array           udg_TradePoints
    integer array           udg_WeaponBow
    integer                 udg_QuestSpawn             = 0
    integer                 udg_QuestType              = 0
    integer                 udg_QuestTownTypes         = 0
    integer                 udg_QuestNonTownTypes      = 0
    integer                 udg_MonsterDifficulty      = 0
    integer                 udg_MonsterDrop            = 0
    integer                 udg_QuestGiverAmount       = 0
    integer array           udg_Payment
    integer array           udg_EmpireHiredHero
    dialog                  udg_EmpireHireDialog       = null
    button array            udg_EmpireHireDialogButtons
    integer                 udg_HiringEmpire           = 0
    integer array           udg_Events
    integer                 udg_CreepGroupCounter      = 0
    integer array           udg_EmpirePaymentExp
    integer array           udg_EmpirePaymentTradePoints
    integer array           udg_PaymentCounter
    location array          udg_CastleCreepsSpots
    integer                 udg_MisslesFired           = 0
    integer                 udg_ReminderInt            = 0
    boolean                 udg_ZZrebelt               = false
    integer array           udg_WeaponDagger
    integer array           udg_WeaponElemental
    unit array              udg_HuntedUnit
    integer array           udg_ScienceError
    group                   udg_Houses                 = null
    group                   udg_EquipmentCamps         = null
    group                   udg_Spawners               = null
    group                   udg_KalendenArmy           = null
    group                   udg_CompArmy               = null
    group                   udg_KalendenLargeArmy      = null
    group                   udg_QuestArmy              = null
    group                   udg_RebellionArmy          = null
    group array             udg_Group

    // Generated
    rect                    gg_rct_Kalenden_Area       = null
    rect                    gg_rct_Spawn               = null
    rect                    gg_rct_Start_Builder       = null
    rect                    gg_rct_no_enter1           = null
    rect                    gg_rct_no_enter2           = null
    rect                    gg_rct_camp_top            = null
    rect                    gg_rct_camp_bottom         = null
    rect                    gg_rct_camp_bottom1        = null
    rect                    gg_rct_camp_top1           = null
    sound                   gg_snd_ArrangedTeamInvitation = null
    sound                   gg_snd_Fire                = null
    sound                   gg_snd_FoodDown            = null
    sound                   gg_snd_FoodUp              = null
    sound                   gg_snd_GenericWarningResearchComplete1 = null
    sound                   gg_snd_low_power           = null
    sound                   gg_snd_MapPing             = null
    sound                   gg_snd_Message             = null
    sound                   gg_snd_Nuclear_Launch      = null
    sound                   gg_snd_power_online        = null
    sound                   gg_snd_QuestCompleted      = null
    sound                   gg_snd_QuestNew            = null
    sound                   gg_snd_Warning             = null
    sound                   gg_snd_Fight               = null
    sound                   gg_snd_Credits             = null
    string                  gg_snd_Tragic_Confrontation
    string                  gg_snd_Storm_Earth_and_Fire
    string                  gg_snd_Pursuit
    string                  gg_snd_Tragedy
    trigger                 gg_trg_Autoblink           = null
    trigger                 gg_trg_Refresh_Multiboard  = null
    trigger                 gg_trg_Multiboard_Show     = null
    trigger                 gg_trg_Set_Up_Castle_Creeps = null
    trigger                 gg_trg_Set_Up_Rebellions   = null
    trigger                 gg_trg_Set_Up_Creep        = null
    trigger                 gg_trg_Starting_Game       = null
    trigger                 gg_trg_Vote_Over           = null
    trigger                 gg_trg_Button_Clicked      = null
    trigger                 gg_trg_Button_Clicked_Race = null
    trigger                 gg_trg_Button_Clicked_Class = null
    trigger                 gg_trg_Button_Clicked_Profile = null
    trigger                 gg_trg_Button_Clicked_Mode = null
    trigger                 gg_trg_Victory_Kalenden_Death = null
    trigger                 gg_trg_Grace_Periode_End   = null
    trigger                 gg_trg_Multiboard_Hero     = null
    trigger                 gg_trg_Multiboard_Empire   = null
    trigger                 gg_trg_Defeat_check        = null
    trigger                 gg_trg_Unpack              = null
    trigger                 gg_trg_Not_allowed         = null
    trigger                 gg_trg_House_Grow          = null
    trigger                 gg_trg_Hire_or_Fire_Hero   = null
    trigger                 gg_trg_Hire_Hero_Button    = null
    trigger                 gg_trg_Increase_and_Decrease_Payment = null
    trigger                 gg_trg_Player_Leaves       = null
    trigger                 gg_trg_Set_working_people  = null
    trigger                 gg_trg_Tax                 = null
    trigger                 gg_trg_Rations             = null
    trigger                 gg_trg_Destroy_Building    = null
    trigger                 gg_trg_Demolish_Plant      = null
    trigger                 gg_trg_Retire              = null
    trigger                 gg_trg_Open_and_Close_gates = null
    trigger                 gg_trg_Unit_Trained        = null
    trigger                 gg_trg_Building_Finished   = null
    trigger                 gg_trg_Begins_an_Upgrade   = null
    trigger                 gg_trg_Unit_or_Building_Dies = null
    trigger                 gg_trg_New_Building        = null
    trigger                 gg_trg_New_Building_Grace  = null
    trigger                 gg_trg_Nuclear_Missle_Launch = null
    trigger                 gg_trg_Black_Hole          = null
    trigger                 gg_trg_Age_Up              = null
    trigger                 gg_trg_Fire_Dies           = null
    trigger                 gg_trg_Grow_Trees          = null
    trigger                 gg_trg_Destroy_Road        = null
    trigger                 gg_trg_No_Hiring           = null
    trigger                 gg_trg_Science_Lab         = null
    trigger                 gg_trg_Start_Research      = null
    trigger                 gg_trg_Research_Done       = null
    trigger                 gg_trg_Researches_Back     = null
    trigger                 gg_trg_Abort_Research      = null
    trigger                 gg_trg_Go_to_Tech          = null
    trigger                 gg_trg_Hero_Gets_Item      = null
    trigger                 gg_trg_Hero_Loses_Item     = null
    trigger                 gg_trg_Show_Spots          = null
    trigger                 gg_trg_Show_Quest_Monsters = null
    trigger                 gg_trg_Upgrade_Skills      = null
    trigger                 gg_trg_Hero_Level_Up       = null
    trigger                 gg_trg_Set_Up_Camp         = null
    trigger                 gg_trg_Hero_Dies           = null
    trigger                 gg_trg_Exp_and_Gold        = null
    trigger                 gg_trg_Exp_Gold_Rank       = null
    trigger                 gg_trg_Servant_of_Decay    = null
    trigger                 gg_trg_Merc_Speed          = null
    trigger                 gg_trg_Buy_Item            = null
    trigger                 gg_trg_Sell_Item           = null
    trigger                 gg_trg_Hero_Building_Dies  = null
    trigger                 gg_trg_Hideout_Heal        = null
    trigger                 gg_trg_Campfire            = null
    trigger                 gg_trg_Hideout             = null
    trigger                 gg_trg_Forge               = null
    trigger                 gg_trg_Library             = null
    trigger                 gg_trg_Spike_Trap          = null
    trigger                 gg_trg_Storage_Pit         = null
    trigger                 gg_trg_Land_Mine           = null
    trigger                 gg_trg_Temple              = null
    trigger                 gg_trg_Tower               = null
    trigger                 gg_trg_Forge_Armor         = null
    trigger                 gg_trg_Upgrade_Armor       = null
    trigger                 gg_trg_Forge_Weapon        = null
    trigger                 gg_trg_Upgrade_Weapon      = null
    trigger                 gg_trg_Forge_Helm          = null
    trigger                 gg_trg_Upgrade_Helm        = null
    trigger                 gg_trg_Forge_Staff         = null
    trigger                 gg_trg_Upgrade_Staff       = null
    trigger                 gg_trg_Forge_Claymore      = null
    trigger                 gg_trg_Improve_Claymore    = null
    trigger                 gg_trg_Brew_Potions        = null
    trigger                 gg_trg_Sacrafice           = null
    trigger                 gg_trg_Gifts               = null
    trigger                 gg_trg_Upgrade_Tower       = null
    trigger                 gg_trg_Trigger_Random_Events = null
    trigger                 gg_trg_Obilisk_Timer_Up    = null
    trigger                 gg_trg_Obilisk_Destroyed   = null
    trigger                 gg_trg_Plague_or_Baby_Boom_Over = null
    trigger                 gg_trg_Initiate            = null
    trigger                 gg_trg_Getting_Quest       = null
    trigger                 gg_trg_Quest_Table         = null
    trigger                 gg_trg_Monster_Table       = null
    trigger                 gg_trg_Set_Quests          = null
    trigger                 gg_trg_Returning_Quest_Items_To_Towns = null
    trigger                 gg_trg_Quest_Reward_Monster_Slaying = null
    trigger                 gg_trg_Camp_Attack         = null
    trigger                 gg_trg_Supply_Wagon        = null
    trigger                 gg_trg_zooms               = null
    trigger                 gg_trg_rotate              = null
    trigger                 gg_trg_angle               = null
    trigger                 gg_trg_reset               = null
    trigger                 gg_trg_rename              = null
    trigger                 gg_trg_Rename              = null
    trigger                 gg_trg_Hero_Ally_Click     = null
    trigger                 gg_trg_Difficulty          = null
    trigger                 gg_trg_War                 = null
    trigger                 gg_trg_War_All             = null
    trigger                 gg_trg_Truce               = null
    trigger                 gg_trg_Truce_All           = null
    trigger                 gg_trg_Share               = null
    trigger                 gg_trg_Unshare             = null
    trigger                 gg_trg_Ally                = null
    trigger                 gg_trg_Ally_All            = null
    trigger                 gg_trg_ignore              = null
    trigger                 gg_trg_unignore            = null
    trigger                 gg_trg_Give_Tradepoints    = null
    trigger                 gg_trg_Give_Food           = null
    trigger                 gg_trg_Unit_is_hit_by_Tower = null
    trigger                 gg_trg_Tradepoint_Flow     = null
    trigger                 gg_trg_Taunt               = null
    trigger                 gg_trg_Roar                = null
    trigger                 gg_trg_Use_Potions         = null
    trigger                 gg_trg_Call_to_Arms        = null
    trigger                 gg_trg_Merc_Heal           = null
    trigger                 gg_trg_Fireball            = null
    trigger                 gg_trg_Gold_Strike         = null
    trigger                 gg_trg_Energy_Shield       = null
    trigger                 gg_trg_Shield_of_divinity  = null
    trigger                 gg_trg_Nova                = null
    trigger                 gg_trg_Mend                = null
    trigger                 gg_trg_Battle_Rage         = null
    trigger                 gg_trg_Nova_wiz            = null
    trigger                 gg_trg_Dark_Pact           = null
    trigger                 gg_trg_Death_Coil          = null
    trigger                 gg_trg_Finger_of_Pain      = null
    trigger                 gg_trg_Destruction_Bolt_and_Frost_Bolt = null
    trigger                 gg_trg_Finger_of_Death     = null
    trigger                 gg_trg_Ray_of_Light        = null
    trigger                 gg_trg_Soul_Drain          = null
    trigger                 gg_trg_Gold_Factory        = null
    trigger                 gg_trg_Green_Brown_Grey_Dies = null
    trigger                 gg_trg_Spawning            = null
    trigger                 gg_trg_other_victem        = null
    trigger                 gg_trg_Order_Creeps        = null
    trigger                 gg_trg_Attacker_Spawn      = null
    trigger                 gg_trg_Kalendens_Army      = null
    trigger                 gg_trg_Comp_Up             = null
    trigger                 gg_trg_Castle_Creep_Respawn = null
    trigger                 gg_trg_Equipment_Camp_Grow = null
    trigger                 gg_trg_Equipment_Camp_Attack = null
    trigger                 gg_trg_Kick_Blue           = null
    trigger                 gg_trg_Kick_Teal           = null
    trigger                 gg_trg_Kick_Purple         = null
    trigger                 gg_trg_Kick_Yellow         = null
    trigger                 gg_trg_Kick_Orange         = null
    trigger                 gg_trg_Kick_Green          = null
    trigger                 gg_trg_Kick_Pink           = null
    trigger                 gg_trg_Kick_Gray           = null
    trigger                 gg_trg_Kick_LB             = null
    trigger                 gg_trg_Continue_After_Win  = null
    trigger                 gg_trg_Turn_off_song       = null
    trigger                 gg_trg_EXAMPLE             = null
    trigger                 gg_trg_Storm_Earth_and_Fire = null
    trigger                 gg_trg_Tragic_Confrontation = null
    trigger                 gg_trg_Pursuit             = null
    unit                    gg_unit_n00N_0026          = null
    unit                    gg_unit_e00X_0288          = null
    unit                    gg_unit_n00L_0244          = null
    unit                    gg_unit_n00L_0245          = null
endglobals

function InitGlobals takes nothing returns nothing
    local integer i = 0
    set udg_Empires = 0
    set udg_Heroes = 0
    set i = 0
    loop
        exitwhen (i > 10)
        set udg_HeroLifes[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Playercolor[i] = ""
        set i = i + 1
    endloop

    set udg_Builderstarter = CreateTimer()
    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Rations[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Empire[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_food[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_happyness[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_CurrentAge[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_StartedEmpire[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Tax[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_ResearchDone[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Townhallsettings4[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_ResearchNeed[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Researching[i] = 0
        set i = i + 1
    endloop

    set udg_Pay = 0
    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Townhallsettings1[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Townhallsettings2[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Townhallsettings3[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_ResearchNeedStart[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_ProjectName[i] = ""
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Researches[i] = 0
        set i = i + 1
    endloop

    set udg_Chosen = 0
    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Attributepoints[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_HeroLevel[i] = 1
        set i = i + 1
    endloop

    set udg_exp = 0
    set udg_Camera = 0
    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Playerbussy[i] = 0
        set i = i + 1
    endloop

    set udg_HeroAlly1 = DialogCreate()
    set udg_HeroAlly2 = DialogCreate()
    set udg_HeroAlly3 = DialogCreate()
    set udg_HeroAlly4 = DialogCreate()
    set udg_HeroAlly5 = DialogCreate()
    set udg_HeroAlly6 = DialogCreate()
    set udg_HeroAlly7 = DialogCreate()
    set udg_HeroAlly8 = DialogCreate()
    set udg_HeroAlly9 = DialogCreate()
    set udg_HeroAlly10 = DialogCreate()
    set udg_Difficulty = DialogCreate()
    set i = 0
    loop
        exitwhen (i > 10)
        set udg_VoteCounter[i] = 0
        set i = i + 1
    endloop

    set udg_SpawnUp = CreateTimer()
    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Citizens[i] = 0
        set i = i + 1
    endloop

    set udg_UpCounter2 = 0
    set udg_TempGroup1 = CreateGroup()
    set udg_TempGroup3 = CreateGroup()
    set udg_TempGroup4 = CreateGroup()
    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Ignore1[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Ignore2[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Ignore3[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Ignore4[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Ignore5[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Ignore6[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Ignore7[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Ignore8[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Ignore9[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Ignore10[i] = 0
        set i = i + 1
    endloop

    set udg_GracePeriode = CreateTimer()
    set udg_Damageunits = 0
    set udg_CreepCounter = 1
    set udg_Exprate = 0
    set udg_daynight = 0
    set udg_TimerDiff = 0
    set udg_UpCounter = 0
    set udg_Race = DialogCreate()
    set udg_Starting = 0
    set i = 0
    loop
        exitwhen (i > 10)
        set udg_HeroRace[i] = 0
        set i = i + 1
    endloop

    set udg_Players = 0
    set i = 0
    loop
        exitwhen (i > 10)
        set udg_PowerSupply[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Powerneeded[i] = 0
        set i = i + 1
    endloop

    set udg_SkillLevel = 0
    set udg_CompUp = CreateTimer()
    set udg_AttackerGroup = CreateForce()
    set i = 0
    loop
        exitwhen (i > 10)
        set udg_FarmsAmount[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_WeaponSword[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_WeaponHands[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_WeaponStaff[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_WeaponAxe[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_WeaponMagic[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_HelmGraphicSet[i] = 0
        set i = i + 1
    endloop

    set udg_ObeliskSpawn = 0
    set udg_Obilisk = CreateTimer()
    set udg_Plague = 0
    set udg_PlagueTimer = CreateTimer()
    set i = 0
    loop
        exitwhen (i > 10)
        set udg_ArmorAmount[i] = 0
        set i = i + 1
    endloop

    set udg_Random = 0
    set udg_EquipmentCamp = 0
    set udg_KalendenDiff = 0
    set udg_ZZBoolean = false
    set udg_Class = DialogCreate()
    set i = 0
    loop
        exitwhen (i > 10)
        set udg_ClassNumber[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_income[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_ExtraWood[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Power[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_PeopleRelaxing[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_PeopleSience[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_PeopleIndustrial[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_PeopleCommercial[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_PeopleWorking[i] = 0
        set i = i + 1
    endloop

    set udg_Fires = 0
    set i = 0
    loop
        exitwhen (i > 10)
        set udg_GrainFarming[i] = 0
        set i = i + 1
    endloop

    set udg_Profile = DialogCreate()
    set i = 0
    loop
        exitwhen (i > 10)
        set udg_EmpireProfile[i] = 0
        set i = i + 1
    endloop

    set udg_Mode = DialogCreate()
    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Weapon[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_HeroType[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Starving[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_TradePoints[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_WeaponBow[i] = 0
        set i = i + 1
    endloop

    set udg_QuestSpawn = 0
    set udg_QuestType = 0
    set udg_QuestTownTypes = 0
    set udg_QuestNonTownTypes = 0
    set udg_MonsterDifficulty = 0
    set udg_MonsterDrop = 0
    set udg_QuestGiverAmount = 0
    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Payment[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_EmpireHiredHero[i] = 0
        set i = i + 1
    endloop

    set udg_EmpireHireDialog = DialogCreate()
    set udg_HiringEmpire = 0
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_Events[i] = 0
        set i = i + 1
    endloop

    set udg_CreepGroupCounter = 0
    set i = 0
    loop
        exitwhen (i > 10)
        set udg_EmpirePaymentExp[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_EmpirePaymentTradePoints[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_PaymentCounter[i] = 0
        set i = i + 1
    endloop

    set udg_MisslesFired = 0
    set udg_ReminderInt = 0
    set udg_ZZrebelt = false
    set i = 0
    loop
        exitwhen (i > 10)
        set udg_WeaponDagger[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_WeaponElemental[i] = 0
        set i = i + 1
    endloop

    set i = 0
    loop
        exitwhen (i > 10)
        set udg_ScienceError[i] = 0
        set i = i + 1
    endloop

    set udg_Houses = CreateGroup()
    set udg_EquipmentCamps = CreateGroup()
    set udg_Spawners = CreateGroup()
    set udg_KalendenArmy = CreateGroup()
    set udg_CompArmy = CreateGroup()
    set udg_KalendenLargeArmy = CreateGroup()
    set udg_QuestArmy = CreateGroup()
    set udg_RebellionArmy = CreateGroup()
    set i = 0
    loop
        exitwhen (i > 20)
        set udg_Group[i] = CreateGroup()
        set i = i + 1
    endloop

endfunction

//***************************************************************************
//*
//*  Sounds
//*
//***************************************************************************

function InitSounds takes nothing returns nothing
    set gg_snd_ArrangedTeamInvitation = CreateSound( "Sound\\Interface\\ArrangedTeamInvitation.wav", false, false, false, 10, 10, "" )
    call SetSoundParamsFromLabel( gg_snd_ArrangedTeamInvitation, "ArrangedTeamInvitation" )
    call SetSoundDuration( gg_snd_ArrangedTeamInvitation, 2914 )
    set gg_snd_Fire = CreateSound( "war3mapImported\\Fire.mp3", false, false, false, 10, 10, "DefaultEAXON" )
    call SetSoundDuration( gg_snd_Fire, 2741 )
    call SetSoundChannel( gg_snd_Fire, 0 )
    call SetSoundVolume( gg_snd_Fire, 127 )
    call SetSoundPitch( gg_snd_Fire, 1.0 )
    set gg_snd_FoodDown = CreateSound( "war3mapImported\\FoodDown.mp3", false, false, false, 10, 10, "" )
    call SetSoundDuration( gg_snd_FoodDown, 2221 )
    call SetSoundChannel( gg_snd_FoodDown, 0 )
    call SetSoundVolume( gg_snd_FoodDown, 127 )
    call SetSoundPitch( gg_snd_FoodDown, 1.0 )
    set gg_snd_FoodUp = CreateSound( "war3mapImported\\FoodUp.mp3", false, false, false, 10, 10, "" )
    call SetSoundDuration( gg_snd_FoodUp, 2299 )
    call SetSoundChannel( gg_snd_FoodUp, 0 )
    call SetSoundVolume( gg_snd_FoodUp, 127 )
    call SetSoundPitch( gg_snd_FoodUp, 1.0 )
    set gg_snd_GenericWarningResearchComplete1 = CreateSound( "Sound\\Dialogue\\GenericWarnings\\GenericWarningResearchComplete1.mp3", false, false, false, 10, 10, "DefaultEAXON" )
    call SetSoundParamsFromLabel( gg_snd_GenericWarningResearchComplete1, "ResearchCompleteGeneric" )
    call SetSoundDuration( gg_snd_GenericWarningResearchComplete1, 1228 )
    call SetSoundChannel( gg_snd_GenericWarningResearchComplete1, 0 )
    call SetSoundVolume( gg_snd_GenericWarningResearchComplete1, 127 )
    set gg_snd_low_power = CreateSound( "war3mapImported\\low power.wav", false, false, false, 10, 10, "" )
    call SetSoundChannel( gg_snd_low_power, 0 )
    call SetSoundVolume( gg_snd_low_power, 127 )
    call SetSoundPitch( gg_snd_low_power, 1.0 )
    set gg_snd_MapPing = CreateSound( "Sound\\Interface\\MapPing.wav", false, false, false, 10, 10, "" )
    call SetSoundParamsFromLabel( gg_snd_MapPing, "MapPing" )
    call SetSoundDuration( gg_snd_MapPing, 1637 )
    set gg_snd_Message = CreateSound( "Sound\\Interface\\Hint.wav", false, false, false, 10, 10, "DefaultEAXON" )
    call SetSoundParamsFromLabel( gg_snd_Message, "Hint" )
    call SetSoundDuration( gg_snd_Message, 2006 )
    set gg_snd_Nuclear_Launch = CreateSound( "war3mapImported\\Nuclear Launch.mp3", false, false, false, 10, 10, "DefaultEAXON" )
    call SetSoundDuration( gg_snd_Nuclear_Launch, 1801 )
    call SetSoundChannel( gg_snd_Nuclear_Launch, 0 )
    call SetSoundVolume( gg_snd_Nuclear_Launch, 127 )
    call SetSoundPitch( gg_snd_Nuclear_Launch, 1.0 )
    set gg_snd_power_online = CreateSound( "war3mapImported\\power online.wav", false, false, false, 10, 10, "" )
    call SetSoundChannel( gg_snd_power_online, 0 )
    call SetSoundVolume( gg_snd_power_online, 127 )
    call SetSoundPitch( gg_snd_power_online, 1.0 )
    set gg_snd_QuestCompleted = CreateSound( "Sound\\Interface\\QuestCompleted.wav", false, false, false, 10, 10, "" )
    call SetSoundParamsFromLabel( gg_snd_QuestCompleted, "QuestCompleted" )
    call SetSoundDuration( gg_snd_QuestCompleted, 5155 )
    set gg_snd_QuestNew = CreateSound( "Sound\\Interface\\QuestNew.wav", false, false, false, 10, 10, "" )
    call SetSoundParamsFromLabel( gg_snd_QuestNew, "QuestNew" )
    call SetSoundDuration( gg_snd_QuestNew, 3750 )
    set gg_snd_Warning = CreateSound( "Sound\\Interface\\Warning.wav", false, false, false, 10, 10, "" )
    call SetSoundParamsFromLabel( gg_snd_Warning, "Warning" )
    call SetSoundDuration( gg_snd_Warning, 1904 )
    set gg_snd_Fight = CreateSound( "Sound\\Dialogue\\HumanCampaign\\Human01\\H01Arthas18.mp3", false, false, false, 10, 10, "DefaultEAXON" )
    call SetSoundParamsFromLabel( gg_snd_Fight, "H01Arthas18" )
    call SetSoundDuration( gg_snd_Fight, 4127 )
    call SetSoundVolume( gg_snd_Fight, 127 )
    set gg_snd_Credits = CreateSound( "Sound\\Music\\mp3Music\\Credits.mp3", false, false, false, 10, 10, "DefaultEAXON" )
    call SetSoundParamsFromLabel( gg_snd_Credits, "CreditsMusic" )
    call SetSoundDuration( gg_snd_Credits, 83017 )
    call SetSoundVolume( gg_snd_Credits, 125 )
    set gg_snd_Tragic_Confrontation = "Sound\\Music\\mp3Music\\TragicConfrontation.mp3"
    set gg_snd_Storm_Earth_and_Fire = "Sound\\Music\\mp3Music\\PH1.mp3"
    set gg_snd_Pursuit = "Sound\\Music\\mp3Music\\PursuitTheme.mp3"
    set gg_snd_Tragedy = "Sound\\Music\\mp3Music\\TragicConfrontation.mp3"
endfunction

//***************************************************************************
//*
//*  Items
//*
//***************************************************************************

function CreateAllItems takes nothing returns nothing
    local integer itemID

    call CreateItem( 'I014', -786.7, -3986.6 )
    call CreateItem( 'desc', 15982.2, -7508.5 )
endfunction

//***************************************************************************
//*
//*  Unit Creation
//*
//***************************************************************************

//===========================================================================
function CreateUnitsForPlayer10 takes nothing returns nothing
    local player p = Player(10)
    local unit u
    local integer unitID
    local trigger t
    local real life

    set u = CreateUnit( p, 'o015', -461.2, 562.6, 135.000 )
    set u = CreateUnit( p, 'o015', -575.7, 435.9, 135.000 )
    set u = CreateUnit( p, 'o014', -562.5, 166.0, 181.939 )
    set u = CreateUnit( p, 'o014', -291.3, 74.7, 181.632 )
    set u = CreateUnit( p, 'o014', -29.6, 346.2, 1.000 )
    set u = CreateUnit( p, 'o012', 25.8, -176.9, 39.288 )
    set u = CreateUnit( p, 'o012', 202.3, -193.2, 249.914 )
    set u = CreateUnit( p, 'o00Z', -725.6, 1576.1, 1.000 )
    set u = CreateUnit( p, 'o00Z', -309.5, 998.6, 1.000 )
    set u = CreateUnit( p, 'o011', -846.0, 1511.1, 49.910 )
    set u = CreateUnit( p, 'o011', -703.3, 1409.2, 71.000 )
    set u = CreateUnit( p, 'o011', -378.0, 1109.0, 42.013 )
    set u = CreateUnit( p, 'o014', 511.6, 453.1, 79.082 )
    set u = CreateUnit( p, 'o014', 566.8, 264.8, 293.465 )
    set u = CreateUnit( p, 'o014', 1224.2, 394.8, 30.246 )
    set u = CreateUnit( p, 'o014', 1105.5, 145.0, 303.562 )
    set u = CreateUnit( p, 'o016', 826.9, 358.0, 351.134 )
    set u = CreateUnit( p, 'o012', 703.4, 518.5, 257.330 )
    set u = CreateUnit( p, 'o012', 1077.1, 730.3, 175.995 )
    set u = CreateUnit( p, 'o011', -455.1, 1001.8, 353.133 )
    set u = CreateUnit( p, 'o014', -1989.7, -1054.8, 90.515 )
    set u = CreateUnit( p, 'o014', -2263.0, -1387.6, 180.780 )
    set u = CreateUnit( p, 'o014', -1963.7, -1615.0, 277.821 )
    set u = CreateUnit( p, 'o014', -1734.0, -1296.7, 70.424 )
    set u = CreateUnit( p, 'o013', -1913.8, -534.0, 272.917 )
    set u = CreateUnit( p, 'o013', -1768.4, -672.2, 221.914 )
    set u = CreateUnit( p, 'o013', -2016.1, -696.3, 320.641 )
    set u = CreateUnit( p, 'o012', -1508.8, -846.0, 141.408 )
    set u = CreateUnit( p, 'o012', -2190.0, -795.2, 268.308 )
    set u = CreateUnit( p, 'o016', -1520.3, -1736.7, 144.246 )
    set u = CreateUnit( p, 'o012', 814.1, -974.2, 102.056 )
    set u = CreateUnit( p, 'o012', 1113.8, -1070.1, 60.200 )
    set u = CreateUnit( p, 'o012', 1186.8, -1467.1, 273.889 )
    set u = CreateUnit( p, 'o012', 942.2, -1570.5, 260.892 )
    set u = CreateUnit( p, 'o012', 473.4, -1294.1, 123.098 )
    set u = CreateUnit( p, 'o012', 741.4, 183.9, 285.488 )
    set u = CreateUnit( p, 'o014', -584.5, -196.5, 286.929 )
    set u = CreateUnit( p, 'o01C', 944.2, -7682.8, 130.272 )
    set u = CreateUnit( p, 'o01C', 1084.8, -6909.1, 241.369 )
    set u = CreateUnit( p, 'o01C', 384.5, -7488.6, 130.607 )
    set u = CreateUnit( p, 'o01B', -1572.9, -6550.5, 336.090 )
    set u = CreateUnit( p, 'o01B', -1099.2, -7002.6, 30.901 )
    set u = CreateUnit( p, 'o01B', -1326.9, -6801.1, 5.957 )
    set u = CreateUnit( p, 'o018', -120.5, -6382.1, 66.781 )
    set u = CreateUnit( p, 'o017', -76.6, -7079.0, 121.636 )
    set u = CreateUnit( p, 'o018', 359.1, -6597.6, 159.087 )
    set u = CreateUnit( p, 'o017', -340.6, -6890.6, 345.117 )
    set u = CreateUnit( p, 'n01E', -2164.9, -6727.7, 338.507 )
    call SetUnitColor( u, ConvertPlayerColor(12) )
    set u = CreateUnit( p, 'n01E', -1810.6, -7334.8, 39.739 )
    call SetUnitColor( u, ConvertPlayerColor(12) )
    set u = CreateUnit( p, 'n01E', -1161.4, -7653.9, 118.168 )
    call SetUnitColor( u, ConvertPlayerColor(12) )
    set u = CreateUnit( p, 'n01E', -1724.4, -7741.9, 65.612 )
    call SetUnitColor( u, ConvertPlayerColor(12) )
    set u = CreateUnit( p, 'n01E', -2544.2, -7086.8, 4.590 )
    call SetUnitColor( u, ConvertPlayerColor(12) )
    set u = CreateUnit( p, 'n01E', -2152.5, -7175.0, 23.449 )
    call SetUnitColor( u, ConvertPlayerColor(12) )
    set u = CreateUnit( p, 'n01R', -1901.6, -2858.8, 294.908 )
    call SetUnitState( u, UNIT_STATE_MANA, 0 )
    set u = CreateUnit( p, 'n01R', -2221.9, -4315.3, 295.674 )
    call SetUnitState( u, UNIT_STATE_MANA, 0 )
    set u = CreateUnit( p, 'n021', -1306.6, -3118.3, 46.996 )
    call SetUnitState( u, UNIT_STATE_MANA, 0 )
    set u = CreateUnit( p, 'n021', -1089.7, -3397.3, 77.663 )
    call SetUnitState( u, UNIT_STATE_MANA, 0 )
    set u = CreateUnit( p, 'n021', -1297.4, -4025.2, 355.488 )
    call SetUnitState( u, UNIT_STATE_MANA, 0 )
    set u = CreateUnit( p, 'n021', -1869.5, -4547.6, 291.373 )
    call SetUnitState( u, UNIT_STATE_MANA, 0 )
    set u = CreateUnit( p, 'n021', -2232.2, -4769.1, 291.436 )
    call SetUnitState( u, UNIT_STATE_MANA, 0 )
    set u = CreateUnit( p, 'n01O', -1523.3, -3738.3, 333.921 )
    call SetUnitState( u, UNIT_STATE_MANA, 0 )
    set u = CreateUnit( p, 'n00P', -299.0, -4316.5, 97.068 )
    call SetUnitColor( u, ConvertPlayerColor(12) )
    set u = CreateUnit( p, 'n00P', -173.5, -3865.7, 235.597 )
    call SetUnitColor( u, ConvertPlayerColor(12) )
    set u = CreateUnit( p, 'n00P', -496.5, -4075.7, 355.190 )
    call SetUnitColor( u, ConvertPlayerColor(12) )
    set u = CreateUnit( p, 'o013', 225.9, -2995.6, 90.600 )
    set u = CreateUnit( p, 'o01B', -855.9, -5669.6, 352.925 )
    set u = CreateUnit( p, 'o013', 607.8, -3217.8, 106.648 )
    set u = CreateUnit( p, 'o014', -769.8, -2356.5, 48.800 )
    set u = CreateUnit( p, 'o014', -521.7, -2339.6, 128.453 )
    set u = CreateUnit( p, 'o014', -475.7, -2131.5, 203.526 )
    set u = CreateUnit( p, 'o014', -733.3, -1994.4, 296.098 )
    set u = CreateUnit( p, 'o014', -856.2, -2122.3, 340.869 )
    set u = CreateUnit( p, 'o013', 892.6, -2871.2, 188.178 )
    set u = CreateUnit( p, 'o013', 618.4, -2679.1, 145.746 )
    set u = CreateUnit( p, 'o01B', -887.9, -5248.4, 45.144 )
    set u = CreateUnit( p, 'o01A', -1231.3, -5459.7, 284.401 )
    set u = CreateUnit( p, 'o015', 1027.6, -4946.1, 100.016 )
    set u = CreateUnit( p, 'o015', 1003.4, -5528.6, 277.183 )
    set u = CreateUnit( p, 'o015', 1258.5, -5189.9, 1.320 )
    set u = CreateUnit( p, 'o015', 740.3, -5248.5, 180.567 )
    set u = CreateUnit( p, 'o018', 831.6, -5455.9, 202.983 )
    set u = CreateUnit( p, 'o018', 1213.3, -4973.9, 63.957 )
    set u = CreateUnit( p, 'o01G', -979.9, -2722.2, 38.529 )
    set u = CreateUnit( p, 'o011', -1865.6, 1108.7, 353.133 )
    set u = CreateUnit( p, 'o011', -2053.3, 795.2, 353.133 )
    set u = CreateUnit( p, 'o012', -1178.4, 887.0, 257.330 )
    set u = CreateUnit( p, 'o01G', 1131.7, -4322.7, 38.529 )
    set u = CreateUnit( p, 'o012', 1256.7, 763.6, 64.755 )
    set u = CreateUnit( p, 'o012', 1415.6, 433.5, 73.971 )
    set u = CreateUnit( p, 'o014', -491.1, -209.0, 286.929 )
    set u = CreateUnit( p, 'o01C', 1371.5, -6966.7, 210.644 )
    set u = CreateUnit( p, 'o01C', 1299.0, -7291.1, 195.069 )
    set u = CreateUnit( p, 'o017', -737.4, -3698.3, 270.000 )
    set u = CreateUnit( p, 'o017', -540.1, -3698.2, 270.000 )
    set u = CreateUnit( p, 'o017', -602.9, -1507.0, 270.000 )
    set u = CreateUnit( p, 'o017', -405.6, -1506.9, 270.000 )
    set u = CreateUnit( p, 'o017', -504.5, -1510.2, 270.000 )
    set u = CreateUnit( p, 'o017', 490.1, -4454.7, 270.000 )
    set u = CreateUnit( p, 'o017', 292.9, -4454.7, 270.000 )
    set u = CreateUnit( p, 'o014', -257.8, -742.9, 86.520 )
    set u = CreateUnit( p, 'o012', 1592.1, 459.3, 83.699 )
    set u = CreateUnit( p, 'o01G', 1498.2, -4300.7, 38.529 )
    set u = CreateUnit( p, 'n01E', -3999.2, -1585.2, 13.901 )
    call SetUnitColor( u, ConvertPlayerColor(12) )
    set u = CreateUnit( p, 'n01E', -4053.4, -1971.0, 34.909 )
    call SetUnitColor( u, ConvertPlayerColor(12) )
    set u = CreateUnit( p, 'n01E', -3396.2, -1938.2, 60.730 )
    call SetUnitColor( u, ConvertPlayerColor(12) )
    set u = CreateUnit( p, 'o01G', -502.0, -1238.6, 303.430 )
    set u = CreateUnit( p, 'o01G', -257.0, -1243.3, 197.705 )
    set u = CreateUnit( p, 'o01G', -3178.2, -1496.7, 198.573 )
    set u = CreateUnit( p, 'o01G', -3203.5, -1325.5, 227.163 )
    set u = CreateUnit( p, 'o01G', -1682.7, -1659.7, 121.090 )
    set u = CreateUnit( p, 'o01G', 815.9, -1307.5, 72.444 )
    set u = CreateUnit( p, 'o01G', 805.3, -5028.6, 71.294 )
    set u = CreateUnit( p, 'o01G', 23.0, -6149.1, 87.783 )
    set u = CreateUnit( p, 'o01G', -888.7, -6892.9, 22.493 )
    set u = CreateUnit( p, 'o01G', -1085.3, -5533.2, 2.360 )
    set u = CreateUnit( p, 'o01G', -2030.5, -3335.0, 0.000 )
    set u = CreateUnit( p, 'o01G', -1941.1, -3409.5, 0.000 )
    set u = CreateUnit( p, 'o01G', -2031.3, -3491.5, 0.000 )
endfunction

//===========================================================================
function CreateUnitsForPlayer11 takes nothing returns nothing
    local player p = Player(11)
    local unit u
    local integer unitID
    local trigger t
    local real life

    set u = CreateUnit( p, 'ogru', -2252.2, -3151.4, 0.000 )
    set u = CreateUnit( p, 'ogru', -2256.8, -3710.6, 0.000 )
    set gg_unit_n00N_0026 = CreateUnit( p, 'n00N', -6889.3, -6525.5, 0.000 )
    set u = CreateUnit( p, 'n00U', -7162.6, -5247.6, 83.450 )
    call SetUnitColor( u, ConvertPlayerColor(12) )
    set u = CreateUnit( p, 'n01F', -6154.0, -5265.5, 0.000 )
    call SetUnitColor( u, ConvertPlayerColor(0) )
    set u = CreateUnit( p, 'oshm', -6652.6, -6067.9, 270.000 )
    set u = CreateUnit( p, 'oshm', -6642.9, -6965.6, 0.000 )
    set u = CreateUnit( p, 'oshm', -6138.5, -6972.9, 0.000 )
    set u = CreateUnit( p, 'oshm', -6142.4, -6079.0, 270.000 )
    set u = CreateUnit( p, 'oshm', -5559.6, -6093.2, 270.000 )
    set u = CreateUnit( p, 'oshm', -5546.0, -6971.5, 0.000 )
    set u = CreateUnit( p, 'oshm', -5511.6, -5185.9, 0.000 )
    set u = CreateUnit( p, 'oshm', -5501.5, -5576.7, 0.000 )
    set u = CreateUnit( p, 'ogru', -7403.6, -4741.1, 90.000 )
    set u = CreateUnit( p, 'ogru', -6935.5, -4756.2, 90.000 )
    set u = CreateUnit( p, 'ohun', -4608.8, -5192.7, 215.000 )
    set u = CreateUnit( p, 'ohun', -4424.7, -5434.2, 215.000 )
    set u = CreateUnit( p, 'ohun', -3856.9, -7119.2, 135.000 )
    set u = CreateUnit( p, 'ohun', -3641.6, -6909.7, 135.000 )
    set u = CreateUnit( p, 'ohun', -3948.4, -4378.4, 270.000 )
    set u = CreateUnit( p, 'ohun', -4330.8, -4381.6, 270.000 )
    set u = CreateUnit( p, 'ohun', -5999.8, -4141.8, 270.000 )
    set u = CreateUnit( p, 'ohun', -5633.1, -4160.3, 270.000 )
    set u = CreateUnit( p, 'ohun', -6652.3, -2821.1, 90.000 )
    set u = CreateUnit( p, 'ohun', -6923.8, -2838.0, 90.000 )
    set u = CreateUnit( p, 'ohun', -6714.7, -3336.9, 312.525 )
    set u = CreateUnit( p, 'ohun', -6533.5, -3124.1, 325.553 )
    set u = CreateUnit( p, 'ohun', -4766.0, -3276.8, 0.000 )
    set u = CreateUnit( p, 'ohun', -4762.0, -3515.3, 0.000 )
    set u = CreateUnit( p, 'ohun', -3759.8, -2854.8, 283.087 )
    set u = CreateUnit( p, 'ohun', -3556.8, -2854.8, 261.999 )
    set u = CreateUnit( p, 'ohun', -3730.4, -3982.7, 80.561 )
    set u = CreateUnit( p, 'ohun', -3569.2, -3977.3, 96.322 )
    set u = CreateUnit( p, 'ocat', -4194.5, -3991.8, 42.835 )
    set u = CreateUnit( p, 'ocat', -4199.5, -2809.7, 318.300 )
    set u = CreateUnit( p, 'ocat', -5313.9, -2971.2, 321.482 )
    set u = CreateUnit( p, 'ocat', -5179.1, -2839.5, 307.447 )
    set u = CreateUnit( p, 'ocat', -5017.5, -2734.2, 291.074 )
    set u = CreateUnit( p, 'ocat', -5337.6, -3785.5, 36.246 )
    set u = CreateUnit( p, 'ocat', -5188.2, -3907.2, 52.192 )
    set u = CreateUnit( p, 'ocat', -5071.2, -4036.2, 44.347 )
    set u = CreateUnit( p, 'ogru', -4951.9, -3387.5, 0.000 )
    set u = CreateUnit( p, 'ogru', -3649.3, -2980.0, 272.185 )
    set u = CreateUnit( p, 'ogru', -3641.2, -3854.6, 89.004 )
    set u = CreateUnit( p, 'ogru', -6509.7, -3332.6, 310.032 )
    set u = CreateUnit( p, 'ogru', -7385.5, -3078.2, 270.000 )
    set u = CreateUnit( p, 'ogru', -5820.6, -4224.2, 270.000 )
    set u = CreateUnit( p, 'ocat', -5730.8, -2818.3, 90.000 )
    set u = CreateUnit( p, 'ocat', -5980.9, -2833.1, 90.000 )
    set u = CreateUnit( p, 'ocat', -6238.4, -2831.9, 90.000 )
    set u = CreateUnit( p, 'ocat', -6514.5, -2833.1, 90.000 )
    set u = CreateUnit( p, 'ocat', -6797.5, -2830.9, 90.000 )
    set u = CreateUnit( p, 'ocat', -7074.3, -2855.2, 90.000 )
    set u = CreateUnit( p, 'ohun', -5810.1, -3643.4, 359.862 )
    set u = CreateUnit( p, 'ohun', -5807.1, -3162.2, 356.780 )
    set u = CreateUnit( p, 'ohun', -7017.2, -4081.8, 270.000 )
    set u = CreateUnit( p, 'ohun', -6826.4, -4081.8, 270.000 )
    set u = CreateUnit( p, 'ogru', -7283.6, -4310.2, 1.573 )
    set u = CreateUnit( p, 'ogru', -6531.8, -4296.7, 180.529 )
    set u = CreateUnit( p, 'ocat', -4702.2, -4769.8, 180.000 )
    set u = CreateUnit( p, 'ocat', -4695.4, -4416.7, 180.000 )
    set u = CreateUnit( p, 'ocat', -4041.9, -5924.7, 90.000 )
    set u = CreateUnit( p, 'ocat', -3661.7, -5918.7, 90.000 )
    set u = CreateUnit( p, 'ogru', -4591.1, -5408.1, 215.000 )
    set u = CreateUnit( p, 'ogru', -3823.1, -6939.4, 135.000 )
    set u = CreateUnit( p, 'ogru', -3458.2, -4505.1, 180.000 )
    set u = CreateUnit( p, 'ohun', -4408.0, -6541.1, 177.432 )
    set u = CreateUnit( p, 'ogru', -4910.3, -6364.5, 356.521 )
    set u = CreateUnit( p, 'o01F', -427.5, -3372.0, 359.746 )
    set u = CreateUnit( p, 'o01F', -601.8, -2883.0, 93.324 )
    set u = CreateUnit( p, 'o01F', -450.1, -2881.5, 87.600 )
    set u = CreateUnit( p, 'o01F', -290.7, -2890.9, 92.909 )
    set u = CreateUnit( p, 'o01F', 106.9, -1499.0, 359.447 )
    set u = CreateUnit( p, 'o01F', -67.0, -1076.9, 45.799 )
    set u = CreateUnit( p, 'o01F', -547.1, -867.4, 94.971 )
    set u = CreateUnit( p, 'o01F', -2113.7, -3063.0, 0.000 )
    set u = CreateUnit( p, 'ocat', -376.0, -1206.1, 90.000 )
    set u = CreateUnit( p, 'o01F', 332.5, -3906.0, 130.988 )
    set u = CreateUnit( p, 'o01F', 571.2, -3640.4, 126.046 )
    set u = CreateUnit( p, 'o01F', 797.1, -4278.9, 0.949 )
    set u = CreateUnit( p, 'o01C', 692.6, -7211.0, 202.255 )
    set u = CreateUnit( p, 'o01C', 139.5, -6848.3, 114.407 )
    set u = CreateUnit( p, 'o01F', -2115.2, -3229.9, 0.000 )
    set u = CreateUnit( p, 'o01F', -2008.9, -3162.6, 0.000 )
    set u = CreateUnit( p, 'o01F', -2125.0, -3604.2, 0.000 )
    set u = CreateUnit( p, 'o01F', -2126.5, -3771.1, 0.000 )
    set u = CreateUnit( p, 'o01F', -2020.2, -3703.8, 0.000 )
    set u = CreateUnit( p, 'o01F', -2363.4, -2996.8, 0.000 )
    set u = CreateUnit( p, 'o01F', -2371.4, -3846.1, 0.000 )
    set u = CreateUnit( p, 'o01F', -2355.7, -3286.2, 0.000 )
    set u = CreateUnit( p, 'o01F', -2362.7, -3553.9, 0.000 )
    set u = CreateUnit( p, 'ogru', -4912.9, -6657.9, 356.521 )
    set u = CreateUnit( p, 'ogru', -4912.1, -6508.0, 356.521 )
    set u = CreateUnit( p, 'ogru', -7292.7, -4671.8, 90.000 )
    set u = CreateUnit( p, 'ogru', -7179.5, -4602.8, 90.000 )
    set u = CreateUnit( p, 'ogru', -7057.7, -4680.8, 90.000 )
    set u = CreateUnit( p, 'ohun', -2904.7, -4434.2, 0.000 )
    set u = CreateUnit( p, 'ohun', -2908.8, -4772.8, 0.000 )
    set u = CreateUnit( p, 'ohun', -2890.4, -4614.8, 0.000 )
    set u = CreateUnit( p, 'ocat', -3087.1, -4489.3, 0.000 )
    set u = CreateUnit( p, 'ocat', -3086.5, -4717.8, 0.000 )
    set u = CreateUnit( p, 'ohun', -5091.6, -4381.4, 270.000 )
    set u = CreateUnit( p, 'ogru', -3472.2, -4666.2, 180.000 )
    set u = CreateUnit( p, 'ogru', -3843.3, -5726.5, 90.000 )
    set u = CreateUnit( p, 'ohun', -6371.1, -2823.7, 90.000 )
    set u = CreateUnit( p, 'ohun', -6114.0, -2814.0, 90.000 )
    set u = CreateUnit( p, 'ohun', -5854.8, -2815.5, 90.000 )
    set u = CreateUnit( p, 'ogru', -7281.5, -3082.8, 270.000 )
    set u = CreateUnit( p, 'ogru', -7193.2, -3082.4, 270.000 )
    set u = CreateUnit( p, 'ohun', -7216.0, -2833.2, 90.000 )
    set u = CreateUnit( p, 'ogru', -5489.9, -3270.3, 0.000 )
    set u = CreateUnit( p, 'ogru', -5490.4, -3523.3, 0.000 )
    set u = CreateUnit( p, 'ogru', -4435.7, -3309.4, 0.000 )
    set u = CreateUnit( p, 'ogru', -4359.5, -3398.7, 0.000 )
    set u = CreateUnit( p, 'ogru', -4438.5, -3473.0, 0.000 )
    set u = CreateUnit( p, 'ogru', -3640.4, -3386.5, 0.000 )
endfunction

//===========================================================================
function CreateNeutralHostile takes nothing returns nothing
    local player p = Player(PLAYER_NEUTRAL_AGGRESSIVE)
    local unit u
    local integer unitID
    local trigger t
    local real life

    set u = CreateUnit( p, 'n01F', -6695.7, -6258.0, 0.000 )
    call SetUnitColor( u, ConvertPlayerColor(0) )
    set u = CreateUnit( p, 'n01F', -6665.1, -6802.4, 0.000 )
    call SetUnitColor( u, ConvertPlayerColor(0) )
endfunction

//===========================================================================
function CreateNeutralPassiveBuildings takes nothing returns nothing
    local player p = Player(PLAYER_NEUTRAL_PASSIVE)
    local unit u
    local integer unitID
    local trigger t
    local real life

    set u = CreateUnit( p, 'n000', -4736.0, 12608.0, 270.000 )
    set u = CreateUnit( p, 'n000', 8320.0, -2240.0, 270.000 )
endfunction

//===========================================================================
function CreateNeutralPassive takes nothing returns nothing
    local player p = Player(PLAYER_NEUTRAL_PASSIVE)
    local unit u
    local integer unitID
    local trigger t
    local real life

    set u = CreateUnit( p, 'e01A', -2637.3, 2105.4, 4.000 )
    set u = CreateUnit( p, 'e015', 15275.4, -6977.5, 1.000 )
    set u = CreateUnit( p, 'e015', 6784.4, -7054.2, 1.000 )
    set u = CreateUnit( p, 'e015', 15863.9, 9599.1, 1.000 )
    set u = CreateUnit( p, 'e015', -3194.6, 11526.4, 1.000 )
    set u = CreateUnit( p, 'e015', -7240.7, 377.2, 1.000 )
    set u = CreateUnit( p, 'e01A', 11647.0, 11639.8, 4.000 )
    set u = CreateUnit( p, 'e01A', 8159.0, -4834.5, 1.000 )
    set u = CreateUnit( p, 'e01A', 11529.0, 3985.5, 1.000 )
    set u = CreateUnit( p, 'e01A', 7516.6, 4102.5, 1.000 )
    set u = CreateUnit( p, 'e01A', 14145.4, 10571.2, 4.000 )
    set u = CreateUnit( p, 'e01A', 7062.9, 15218.1, 4.000 )
    set u = CreateUnit( p, 'e01A', 7147.4, 10030.4, 1.000 )
    set u = CreateUnit( p, 'e01A', -1610.7, 12490.0, 1.000 )
    set u = CreateUnit( p, 'e01A', -4742.1, 6922.4, 1.000 )
    set u = CreateUnit( p, 'e01A', 2223.0, 14518.8, 1.000 )
    set u = CreateUnit( p, 'e01A', -4976.1, 227.2, 1.000 )
    set u = CreateUnit( p, 'e01A', 14829.7, 15193.1, 6.000 )
    set u = CreateUnit( p, 'e01A', -6693.0, 9648.3, 1.000 )
    set u = CreateUnit( p, 'e01A', -7026.7, 7540.1, 1.000 )
    set u = CreateUnit( p, 'e01A', -6318.5, 12200.9, 1.000 )
    set u = CreateUnit( p, 'e01A', -2197.3, 15237.0, 1.000 )
    set u = CreateUnit( p, 'e01A', -6587.4, 14217.7, 1.000 )
    set u = CreateUnit( p, 'e01A', -2921.0, 10925.4, 1.000 )
    set u = CreateUnit( p, 'e01A', 799.8, 13101.1, 1.000 )
    set u = CreateUnit( p, 'e01A', 112.5, 7689.6, 1.000 )
    set u = CreateUnit( p, 'e01A', 2676.8, 6500.4, 1.000 )
    set u = CreateUnit( p, 'e01A', 4864.1, 5897.5, 1.000 )
    set u = CreateUnit( p, 'e01A', 4670.9, 15193.8, 1.000 )
    set u = CreateUnit( p, 'e01A', 4626.8, 10993.1, 1.000 )
    set u = CreateUnit( p, 'e01A', 5883.0, 12471.4, 1.000 )
    set u = CreateUnit( p, 'e01A', 11139.6, 14619.6, 4.000 )
    set u = CreateUnit( p, 'e01A', 10024.0, 10847.7, 4.000 )
    set u = CreateUnit( p, 'e01A', 9003.4, 8029.5, 1.000 )
    set u = CreateUnit( p, 'e015', 15864.4, 5372.9, 1.000 )
    set u = CreateUnit( p, 'e01A', 15001.2, 1815.6, 1.000 )
    set u = CreateUnit( p, 'e01A', 12433.6, 5692.7, 1.000 )
    set u = CreateUnit( p, 'e01A', 9297.1, 3200.5, 1.000 )
    set u = CreateUnit( p, 'e01A', 7024.6, 6420.8, 1.000 )
    set u = CreateUnit( p, 'e01A', 9824.8, 6341.7, 1.000 )
    set u = CreateUnit( p, 'e01A', 11766.4, 1450.3, 1.000 )
    set u = CreateUnit( p, 'e01A', 7732.2, 2070.6, 1.000 )
    set u = CreateUnit( p, 'e01A', 13167.6, -3451.0, 1.000 )
    set u = CreateUnit( p, 'e01A', 11312.3, -4294.5, 1.000 )
    set u = CreateUnit( p, 'e01A', 10608.8, -6254.3, 1.000 )
    set u = CreateUnit( p, 'e01A', 4539.5, -2849.8, 1.000 )
    set u = CreateUnit( p, 'e01A', 4590.5, 3142.0, 1.000 )
    set u = CreateUnit( p, 'e01A', 2944.4, -273.5, 1.000 )
    set u = CreateUnit( p, 'e01A', 634.7, 4394.0, 1.000 )
    set u = CreateUnit( p, 'e01A', -1459.3, 4815.1, 1.000 )
    set u = CreateUnit( p, 'e01A', -5997.2, 4400.9, 1.000 )
    set u = CreateUnit( p, 'e01A', -6768.7, 2296.2, 1.000 )
    set u = CreateUnit( p, 'e01A', 12572.8, 8087.3, 1.000 )
    set u = CreateUnit( p, 'n002', 7508.2, -2577.7, 90.000 )
    set u = CreateUnit( p, 'n001', 7174.8, -1924.4, 270.000 )
    set u = CreateUnit( p, 'e01A', 15377.1, 8059.0, 1.000 )
    set u = CreateUnit( p, 'n003', 8405.9, -1938.6, 230.000 )
    set u = CreateUnit( p, 'n001', -4476.1, 12451.0, 90.000 )
    set u = CreateUnit( p, 'n002', -4486.9, 12916.6, 0.000 )
    set u = CreateUnit( p, 'n003', -3737.1, 12843.9, 145.000 )
    set u = CreateUnit( p, 'n00A', -4073.5, 12585.1, 90.000 )
    set u = CreateUnit( p, 'n00A', 7211.0, -2498.4, 45.000 )
    set gg_unit_n00L_0244 = CreateUnit( p, 'n00L', -4052.4, 12975.1, 45.000 )
    set gg_unit_n00L_0245 = CreateUnit( p, 'n00L', 7540.9, -1841.9, 270.000 )
    set u = CreateUnit( p, 'e01A', 3896.9, -6930.3, 1.000 )
    set u = CreateUnit( p, 'n00W', -4049.5, 13570.8, 325.000 )
    set u = CreateUnit( p, 'e01A', 15218.4, -5891.3, 1.000 )
    set u = CreateUnit( p, 'n00W', -3762.7, 13852.6, 325.000 )
    set u = CreateUnit( p, 'n00W', -3368.3, 13357.1, 145.000 )
    set u = CreateUnit( p, 'n00W', -3563.1, 13044.5, 145.000 )
    set u = CreateUnit( p, 'n00W', 8065.9, -1794.0, 270.000 )
    set u = CreateUnit( p, 'n00W', 8038.5, -2461.8, 90.000 )
    set u = CreateUnit( p, 'n00W', 6458.7, -1995.0, 45.000 )
    set u = CreateUnit( p, 'e01A', 13586.2, 13225.4, 4.000 )
    set u = CreateUnit( p, 'e01A', 10258.7, 12412.9, 4.000 )
    set u = CreateUnit( p, 'e01A', -4379.5, 9877.9, 1.000 )
    set u = CreateUnit( p, 'e01A', -2239.6, 7465.1, 1.000 )
    set u = CreateUnit( p, 'e01A', 1799.7, 9288.5, 1.000 )
    set u = CreateUnit( p, 'e01A', 8031.1, 12881.2, 4.000 )
    set u = CreateUnit( p, 'e01A', -4664.5, 15084.6, 1.000 )
    set u = CreateUnit( p, 'e01A', 15015.5, -89.0, 1.000 )
    set u = CreateUnit( p, 'e01A', 14646.9, 4075.8, 1.000 )
    set u = CreateUnit( p, 'e01A', 9154.4, -3188.1, 1.000 )
    set u = CreateUnit( p, 'e01A', 5252.5, -911.1, 1.000 )
    set u = CreateUnit( p, 'e01A', 5877.7, -4042.3, 1.000 )
    set u = CreateUnit( p, 'e01A', 3560.0, -4588.1, 1.000 )
    set u = CreateUnit( p, 'e01A', 10401.7, -685.4, 1.000 )
    set u = CreateUnit( p, 'e01A', 4570.5, 7779.4, 1.000 )
    set u = CreateUnit( p, 'e01A', -3255.6, 4924.5, 4.000 )
    set gg_unit_e00X_0288 = CreateUnit( p, 'e00X', 13421.7, -7904.2, 1.000 )
    set u = CreateUnit( p, 'e01A', 3100.7, 13012.9, 1.000 )
    set u = CreateUnit( p, 'n00W', 6919.0, -1714.4, 270.000 )
    set u = CreateUnit( p, 'e01A', 3586.5, 1458.6, 1.000 )
    set u = CreateUnit( p, 'e01A', 14031.1, -1726.3, 1.000 )
endfunction

//===========================================================================
function CreatePlayerBuildings takes nothing returns nothing
endfunction

//===========================================================================
function CreatePlayerUnits takes nothing returns nothing
    call CreateUnitsForPlayer10(  )
    call CreateUnitsForPlayer11(  )
endfunction

//===========================================================================
function CreateAllUnits takes nothing returns nothing
    call CreateNeutralPassiveBuildings(  )
    call CreatePlayerBuildings(  )
    call CreateNeutralHostile(  )
    call CreateNeutralPassive(  )
    call CreatePlayerUnits(  )
endfunction

//***************************************************************************
//*
//*  Regions
//*
//***************************************************************************

function CreateRegions takes nothing returns nothing
    local weathereffect we

    set gg_rct_Kalenden_Area = Rect( -8192.0, -8192.0, 1952.0, -1088.0 )
    set gg_rct_Spawn = Rect( 800.0, -7520.0, 1440.0, -6720.0 )
    set gg_rct_Start_Builder = Rect( 4512.0, 5888.0, 4928.0, 6368.0 )
    set gg_rct_no_enter1 = Rect( -1248.0, -1088.0, 1728.0, 2464.0 )
    set gg_rct_no_enter2 = Rect( -2464.0, -1120.0, -1216.0, 1408.0 )
    set gg_rct_camp_top = Rect( -3776.0, 13408.0, -3456.0, 13728.0 )
    set gg_rct_camp_bottom = Rect( 6752.0, -2176.0, 7072.0, -1856.0 )
    set gg_rct_camp_bottom1 = Rect( 8128.0, -2240.0, 8256.0, -2112.0 )
    set gg_rct_camp_top1 = Rect( -4672.0, 12480.0, -4544.0, 12608.0 )
endfunction

//***************************************************************************
//*
//*  Custom Script Code
//*
//***************************************************************************
function UpdateHarvesting takes unit u returns nothing
local player p = GetOwningPlayer(u)
loop
exitwhen GetUnitCurrentOrder(u) == String2OrderIdBJ("null")
exitwhen IsUnitDeadBJ(u)
call PolledWait(10.00)
endloop
call UnitRemoveAbilityBJ( 'A01E', u )
call UnitRemoveAbilityBJ( 'A006', u )
call UnitRemoveAbilityBJ( 'A052', u )
call UnitRemoveAbilityBJ( 'A057', u )
call UnitRemoveAbilityBJ( 'A05M', u )
call UnitRemoveAbilityBJ( 'A05Q', u )
call UnitRemoveAbilityBJ( 'A05X', u )
call UnitRemoveAbilityBJ( 'A05L', u )
call UnitRemoveAbilityBJ( 'A060', u )
if GetPlayerTechCountSimple('R003', p) == 1 then
call UnitAddAbilityBJ( 'A006', u )
endif
if GetPlayerTechCountSimple('R003', p) == 2 then
call UnitAddAbilityBJ( 'A052', u )
endif
if GetPlayerTechCountSimple('R003', p) == 3 then
call UnitAddAbilityBJ( 'A057', u )
endif
if GetPlayerTechCountSimple('R003', p) == 4 then
call UnitAddAbilityBJ( 'A05M', u )
endif
if GetPlayerTechCountSimple('R003', p) == 5 then
call UnitAddAbilityBJ( 'A05Q', u )
endif
if GetPlayerTechCountSimple('R003', p) == 6 then
call UnitAddAbilityBJ( 'A05X', u )
endif
if GetPlayerTechCountSimple('R003', p) == 7 then
call UnitAddAbilityBJ( 'A05L', u )
endif
if GetPlayerTechCountSimple('R003', p) == 8 then
call UnitAddAbilityBJ( 'A060', u )
endif
if GetPlayerTechCountSimple('R003', p) == 9 then
call UnitAddAbilityBJ( 'A06Q', u )
endif
set p = null
endfunction

///////////////////////////////////////////
///////////////////////////////////////////
///////////////////////////////////////////

function UnitGuardUnitAI_function takes nothing returns nothing
 local location l 
 local location l2
 local real angle
 local real dist
 local unit summon = bj_lastHauntedGoldMine
 local unit master = bj_lastLoadedUnit
 local effect array e

loop
  exitwhen IsUnitDeadBJ(summon) or summon == null or GetUnitUserData(summon) == 10
  set l = GetUnitLoc(master)
  set l2 = GetUnitLoc(summon)
if (DistanceBetweenPoints(l, l2) > 1500.00 ) then
  call SetUnitPositionLoc( summon, l )
  set e[1] = AddSpecialEffectLoc("Abilities\\Spells\\NightElf\\Blink\\BlinkCaster.mdl", l)
  set e[2] = AddSpecialEffectLoc("Abilities\\Spells\\NightElf\\Blink\\BlinkTarget.mdl", l2)
  call PolledWait( 0.25 )
  call DestroyEffect( e[1] )
  call DestroyEffect( e[2] )
else
  set angle = GetUnitFacing(master)
  set dist = 600.0
  call MoveLocation(l2, GetLocationX(l) + dist * Cos(angle * bj_DEGTORAD), GetLocationY(l) + dist * Sin(angle * bj_DEGTORAD))
  call IssuePointOrderLoc(summon, "attack", l2)
endif
  call RemoveLocation(l)
  call RemoveLocation(l2)
  call PolledWait( 1.00)
endloop

call DestroyEffect( e[1] )
call DestroyEffect( e[2] )
set e[1] = null
set e[2] = null
set summon = null
set master = null
set l = null
set l2 = null
endfunction

function UnitGuardUnitAI takes unit summon, unit master returns nothing
local trigger t = CreateTrigger()
call TriggerAddAction( t, function UnitGuardUnitAI_function )
set bj_lastHauntedGoldMine = summon
set bj_lastLoadedUnit = master
call TriggerExecute( t )
call DestroyTrigger( t )
set t = null
endfunction
///////////////////////////////////////////
///////////////////////////////////////////
///////////////////////////////////////////

function floatingtext_child takes nothing returns nothing
    local integer alpha=255
    local integer red=S2I(SubString(bj_cineFadeContinueTex,1,4))
    local integer green=S2I(SubString(bj_cineFadeContinueTex,4,7))
    local integer blue=S2I(SubString(bj_cineFadeContinueTex,7,10))
    local texttag t= bj_lastCreatedTextTag
 loop
  call PolledWait( 0.25 )
 set alpha=alpha - 64
  exitwhen alpha <= 0
  call SetTextTagColor(t,red,green,blue,alpha)
 endloop
 call DestroyTextTag(t)
set t = null
endfunction

function SetFloatingText takes player whichplayer, string FloatText, real x, real y, integer ZOffset, integer red, integer green, integer blue returns nothing
    local texttag t=CreateTextTag()
    local trigger child=CreateTrigger()
    call SetTextTagText(t,FloatText,0.025)
    call SetTextTagPos(t,x,y, ZOffset)
    call SetTextTagColor(t,red,green,blue,255)
    call SetTextTagVisibility(t,(GetLocalPlayer() == whichplayer))
    call SetTextTagVelocity( t, 0, 0.04 )
    call TriggerAddAction( child, function floatingtext_child )
    set bj_lastCreatedTextTag=t
    set bj_cineFadeContinueTex=I2S(1000000000 + red * 1000000 + green * 1000 + blue)
    call TriggerExecute( child )
    call DestroyTrigger( child )
    set t = null
    set child = null
endfunction

///////////////////////////////////////////
///////////////////////////////////////////
///////////////////////////////////////////

function MultiboardAddBar takes multiboard M, integer BarRow returns nothing
local multiboarditem Temp
local integer Index = 0
local integer Cols = MultiboardGetColumnCount(M)
loop
exitwhen Index >= Cols
set Temp = MultiboardGetItem(M,BarRow - 1,Index)
call MultiboardSetItemStyle(Temp,false,true)
if Index == 0 then
call MultiboardSetItemWidth(Temp,0.0065)
call MultiboardSetItemIcon(Temp,"Objects\\Board\\BarLeftBase.blp")
elseif Index == Cols - 1 then
call MultiboardSetItemWidth(Temp,0.0065)
call MultiboardSetItemIcon(Temp,"Objects\\Board\\BarRightBase.blp")
else
call MultiboardSetItemWidth(Temp,0.0065)
call MultiboardSetItemIcon(Temp,"Objects\\Board\\BarMiddleBase.blp")
endif
call MultiboardReleaseItem(Temp)
set Index = Index + 1
endloop
set Temp = null
endfunction

function MultiboardUpdate takes multiboard M, integer Row, real Percentage returns nothing
local multiboarditem Temp
local integer Index = 0
local integer Cols = MultiboardGetColumnCount(M)
local integer Strength = R2I((Percentage * Cols) / 100)
loop
exitwhen Index >= Cols
set Temp = MultiboardGetItem(M,Row - 1,Index)
if Index == 0 then
if Strength <= 0 then
call MultiboardSetItemIcon(Temp,"Objects\\Board\\BarLeftBase.blp")
else
call MultiboardSetItemIcon(Temp,"Objects\\Board\\BarLeftGreen.blp")
endif
elseif Index == Cols - 1 then
if Strength >= Cols then
call MultiboardSetItemIcon(Temp,"Objects\\Board\\BarRightGreen.blp")
else
call MultiboardSetItemIcon(Temp,"Objects\\Board\\BarRightBase.blp")
endif
elseif Strength > Index then
call MultiboardSetItemIcon(Temp,"Objects\\Board\\BarMiddleGreen.blp")
else
call MultiboardSetItemIcon(Temp,"Objects\\Board\\BarMiddleBase.blp")
endif
call MultiboardReleaseItem(Temp)
set Index = Index + 1
endloop
set Temp = null
endfunction

///////////////////////////////////////////
///////////////////////////////////////////
///////////////////////////////////////////

function PlaySoundForPlayer takes player whichPlayer, sound whichSound returns nothing 
 if ( whichPlayer == GetLocalPlayer() ) then
 call PlaySoundBJ( whichSound )
 endif
endfunction

//////////////////////////////////////////
///////////////////////////////////////////
///////////////////////////////////////////

function RebelLevel takes integer a returns nothing
local integer level = udg_CreepCounter + ((a * udg_CreepCounter) / 6)
local integer i = 0

if level > 30 then
set level = 30 
endif

loop
set i = udg_ZZRebelionLevel[level]
exitwhen i != 0
set level = level + 1
endloop
set bj_groupCountUnits = udg_ZZRebelionLevel[level]

endfunction

function Level takes integer a, integer r returns nothing
local integer level = udg_CreepCounter + ((a * udg_CreepCounter) / 6)
local integer i = 0

if level > 30 then
set level = 30 
endif

if r == 1 then
loop
set i = udg_ZZCreepLevels1[level]
exitwhen i != 0
set level = level + 1
endloop
set bj_groupCountUnits = udg_ZZCreepLevels1[level]
endif

if r == 2 then
loop
set i = udg_ZZCreepLevels2[level]
exitwhen i != 0
set level = level + 1
endloop
set bj_groupCountUnits = udg_ZZCreepLevels2[level]
endif

if r == 3 then
loop
set i = udg_ZZCreepLevels3[level]
exitwhen i != 0
set level = level + 1
endloop
set bj_groupCountUnits = udg_ZZCreepLevels3[level]
endif

if r == 4 then
loop
set i = udg_ZZCreepLevels4[level]
exitwhen i != 0
set level = level + 1
endloop
set bj_groupCountUnits = udg_ZZCreepLevels4[level]
endif

if r == 5 then
loop
set i = udg_ZZCreepLevels5[level]
exitwhen i != 0
set level = level + 1
endloop
set bj_groupCountUnits = udg_ZZCreepLevels5[level]
endif

endfunction

/////////////////////////////
/////////////////////////////
/////////////////////////////

function QuestReward takes nothing returns nothing
local unit u = GetEnumUnit()
local player p = GetOwningPlayer(u)
local integer i = (((GetHeroLevel(u) * GetHeroLevel(u) * 3) / 2) + 100 + (GetHeroLevel(u) * 15))
call AddHeroXPSwapped( i, u, true )
call DisplayTimedTextToForce( GetForceOfPlayer(p), 10.00, ( "|cff00FF00You have gained " + ( I2S(i) + " experience! For completing this quest." ) ) )
call PlaySoundForPlayer( p, gg_snd_QuestCompleted ) 
set u = null
set p = null      
endfunction

function QuestReward2 takes nothing returns nothing
local unit u = GetEnumUnit()
local player p = GetOwningPlayer(u)
local integer i = ((GetHeroLevel(u) * GetHeroLevel(u) * 3) + 250 + (GetHeroLevel(u) * 30))
call AddHeroXPSwapped( i, u, true )
call DisplayTimedTextToForce( GetForceOfPlayer(p), 10.00, ( "|cff00FF00You have gained " + ( I2S(i) + " experience! For completing this quest." ) ) )
call PlaySoundForPlayer( p, gg_snd_QuestCompleted ) 
set u = null
set p = null      
endfunction
//***************************************************************************
//*
//*  Triggers
//*
//***************************************************************************

//===========================================================================
// Trigger: Autoblink
//===========================================================================
function AutoBlinkCheck takes nothing returns boolean
local unit u = GetOrderedUnit()
local player p = GetOwningPlayer(u)
local unit u2 = GetFilterUnit()
local player p2 = GetOwningPlayer(u2)
if IsUnitType(u2, UNIT_TYPE_GROUND) == true or IsUnitType(u2, UNIT_TYPE_STRUCTURE) and IsUnitAliveBJ(u2) == true and p2 != Player(PLAYER_NEUTRAL_PASSIVE) and IsUnitAlly(u2, p) == true then
set p = null
set u = null
set p2 = null
set u2 = null
return true
endif
set p = null
set u = null
set p2 = null
set u2 = null
return false
endfunction

function Trig_Teleport_Move_Conditions takes nothing returns boolean
    local integer  orderId = GetIssuedOrderId()
    local string   orderString
    local unit     u = GetOrderedUnit()
    local location s = GetUnitLoc(u)
    local location t = GetOrderPointLoc()
    local real     d = DistanceBetweenPoints(s, t)
    local rect     r = GetEntireMapRect()
    local location l = GetRectCenter(r)
    local group g = GetUnitsInRangeOfLocMatching(300.00, t, Condition(function AutoBlinkCheck))

    call RemoveLocation(s)
    set s = null
    call RemoveRect(r)
    set r = null

    if GetLocationX(t) == GetLocationX(l) and GetLocationY(t) == GetLocationY(l) then
    call RemoveLocation(l)
    set l = null
    set u = null
    call RemoveLocation(t)
    set t = null
    set orderString = null
    return false
    endif

    call RemoveLocation(l)
    set l = null

    if d < 2000 then
    set u = null
    call RemoveLocation(t)
    set t = null
    set orderString = null
    return false
    endif


    if ((orderId == 851990) or ((orderId > 852007) and (orderId < 852014))) then
    set u = null
    set orderString = null
    call RemoveLocation(t)
    set t = null
    set orderString = null
    return false
    endif
  
    set orderString = UnitId2String(orderId)
    if (orderString != null) then
    set u = null
    set orderString = null
    call RemoveLocation(t)
    set t = null
    set orderString = null
    return false
    endif

    if ( GetUnitTypeId(u) == 'h01S' ) then
    set u = null
    set orderString = null
    call RemoveLocation(t)
    set t = null
    set orderString = null
    return true
    else
    if ( IsLocationVisibleToPlayer(t, GetOwningPlayer(u)) == false) then
    call RemoveLocation(t)
    set t = null
    set u = null
    set orderString = null
    return false
    endif
    endif 

    call RemoveLocation(t)
    set t = null

    if CountUnitsInGroup(g) == 0 then
    set u = null
    set orderString = null
    call DestroyGroup(g)
    set g = null
    return false
    endif

    call DestroyGroup(g)
    set g = null

    if ( GetPlayerController(GetOwningPlayer(u)) == MAP_CONTROL_COMPUTER ) then
    set u = null
    set orderString = null
    return false
    endif

    if ( IsUnitType(u, UNIT_TYPE_HERO) == false ) then
    set u = null
    set orderString = null
    return false
    endif
    set u = null
    set orderString = null
    return true
endfunction

function Trig_Teleport_Move_Actions takes nothing returns nothing
    local unit     u = GetOrderedUnit()
    local location s = GetUnitLoc(u)
    local location t = GetOrderPointLoc()
    local real     a = AngleBetweenPoints(s, t)
    local real     d = DistanceBetweenPoints(s, t) - 0
    local location p = PolarProjectionBJ(s, d, a)
    local integer  b = GetIssuedOrderId()
    local effect array e
    set e[1] = AddSpecialEffectLoc("Abilities\\Spells\\NightElf\\Blink\\BlinkCaster.mdl", s)
    set e[2] = AddSpecialEffectLoc("Abilities\\Spells\\NightElf\\Blink\\BlinkTarget.mdl", p)
    call PolledWait( 0.25 )
    call SetUnitPositionLoc( u, p )
    call DestroyEffect( e[1] )
    call DestroyEffect( e[2] )
    call IssuePointOrderByIdLoc(u, b, t)
    call RemoveLocation(s)
    call RemoveLocation(t)
    call RemoveLocation(p)
    set s = null
    set t = null
    set p = null
    set e[1] = null
    set e[2] = null
    set u = null
endfunction


//===========================================================================
function InitTrig_Autoblink takes nothing returns nothing
    local integer i = 0
    local trigger Teleport_Point = CreateTrigger(  )
    loop
        exitwhen i > 10
        if ( GetPlayerSlotState(Player(i)) == PLAYER_SLOT_STATE_PLAYING ) then
            call TriggerRegisterPlayerUnitEventSimple( Teleport_Point, Player(i), EVENT_PLAYER_UNIT_ISSUED_POINT_ORDER )
            endif
        set i = i + 1
    endloop
    call TriggerAddCondition( Teleport_Point, Condition( function Trig_Teleport_Move_Conditions ) )
    call TriggerAddAction( Teleport_Point, function Trig_Teleport_Move_Actions )
endfunction

//===========================================================================
// Trigger: Refresh Multiboard
//===========================================================================
function Armycheck takes nothing returns boolean
if IsUnitType(GetFilterUnit(), UNIT_TYPE_GROUND) == true and GetUnitTypeId(GetFilterUnit()) != 'h023' and GetUnitTypeId(GetFilterUnit()) != 'n01G' then
return true
endif
return false
endfunction

function StarveUnit takes unit u, player p returns nothing
local player p2 = GetOwningPlayer(u)
if p2 == p then
call KillUnit(u)
endif
set p2 = null
endfunction

function RebelUnit takes unit u, player p returns nothing
local player p2 = GetOwningPlayer(u)
if p2 == p then
set bj_livingPlayerUnitsTypeId = 1
call SetUnitOwner( u, Player(10), true )
call GroupAddUnitSimple( u, udg_RebellionArmy )
endif
set p2 = null
endfunction

function PowerUnit takes nothing returns nothing
local unit u = GetEnumUnit()
local player p = Player(bj_groupCountUnits-1)
local player p2 = GetOwningPlayer(u)
if p2 == p then
if bj_itemRandomConsidered == 0 then
call PauseUnitBJ( false, u )
else 
call PauseUnitBJ( true, u )
endif
endif
set u = null
set p = null 
set p2 = null
endfunction

function Bounties takes nothing returns nothing
local integer food = 0
local unit u = GetEnumUnit()
local location l = GetUnitLoc(u)
local player p = Player(bj_groupCountUnits - 1)

call SetFloatingText(p,"+" + I2S((udg_income[GetConvertedPlayerId(p)] * (100 - udg_Payment[GetConvertedPlayerId(p)])) / 100),GetLocationX(l),GetLocationY(l),50,255,220,0)
call SetFloatingText(p,"+" + I2S(udg_ExtraWood[GetConvertedPlayerId(p)]),GetLocationX(l),GetLocationY(l),0,0,200,80)
if udg_FarmsAmount[GetConvertedPlayerId(p)] > 0 then
set food = ( ( 1000 * udg_FarmsAmount[GetConvertedPlayerId(p)] ) + ( udg_FarmsAmount[GetConvertedPlayerId(p)] * ( udg_GrainFarming[GetConvertedPlayerId(p)] * 500 ) ) )
if udg_EmpireProfile[GetConvertedPlayerId(p)] == 5 then
set food = (food + (( ( 1000 * udg_FarmsAmount[GetConvertedPlayerId(p)] ) + ( udg_FarmsAmount[GetConvertedPlayerId(p)] * ( udg_GrainFarming[GetConvertedPlayerId(p)] * 500 ) ) ) / 5))
endif    
call SetFloatingText(p,"+" + I2S(food),GetLocationX(l),GetLocationY(l),100,80,40,0)
endif
call RemoveLocation(l)
set l = null
set p = null
set u = null
endfunction

function Townhallcheck takes nothing returns boolean
local unit u = GetFilterUnit()
if IsUnitType(u, UNIT_TYPE_TOWNHALL) == true then
set u = null
return true
endif
set u = null
return false
endfunction

function PowerCheck takes nothing returns boolean
local unit u = GetFilterUnit()
if GetUnitStateSwap(UNIT_STATE_MAX_MANA, u) > 0.00 and GetUnitTypeId(u) != 'h022' and GetUnitTypeId(u) != 'h02A' and GetUnitTypeId(u) != 'h02B' and GetUnitTypeId(u) != 'h021' and GetUnitTypeId(u) != 'h02D' and GetUnitTypeId(u) != 'h002' and GetUnitTypeId(u) != 'h02C' and IsUnitType(u, UNIT_TYPE_STRUCTURE) == true then
set u = null
return true
endif
set u = null
return false
endfunction

function MultiboardUpdate2 takes integer Pnumb returns nothing
local integer FoodNeeded
local unit u = null
local integer i = 0
local integer i2 = 0
local real r = 0
local group g = GetUnitsOfPlayerMatching(Player(Pnumb-1), Condition(function Townhallcheck))
local group g3 = GetUnitsOfPlayerMatching(Player(Pnumb-1), Condition(function Armycheck))
local integer i3 = 1 + CountUnitsInGroup(g3) / 10
local group g4 = GetUnitsOfPlayerMatching(Player(Pnumb-1), Condition(function PowerCheck))
local integer i4 = 0
local unit u2 = null
local player p

    set bj_livingPlayerUnitsTypeId = 0
    set bj_itemRandomConsidered = 0
    set bj_groupCountUnits = Pnumb
    set p = Player(Pnumb - 1)

    // Food Cost
    set udg_Starving[Pnumb] = 0
    set i2 = udg_food[Pnumb]
    set udg_food[Pnumb] = ( udg_food[Pnumb] + ( ( 1000 * udg_FarmsAmount[Pnumb] ) + ( udg_FarmsAmount[Pnumb] * ( udg_GrainFarming[Pnumb] * 500 ) ) ) )
    if udg_EmpireProfile[Pnumb] == 5 then
    set udg_food[Pnumb] = (udg_food[Pnumb] + (( ( 1000 * udg_FarmsAmount[Pnumb] ) + ( udg_FarmsAmount[Pnumb] * ( udg_GrainFarming[Pnumb] * 500 ) ) ) / 5))
    endif    
    set FoodNeeded =  udg_Citizens[Pnumb] * udg_Rations[Pnumb] * udg_Rations[Pnumb] / 100
    if udg_food[Pnumb] >= FoodNeeded then
    set udg_food[Pnumb] = udg_food[Pnumb] - FoodNeeded
    else
       set i4 = 1
       loop
       set u2 = FirstOfGroup(g3)
       exitwhen i4 > i3 or u2 == null
       call StarveUnit(u2,p)
       call GroupRemoveUnitSimple( u2, g3 )
       set i4 = i4 + 1
       endloop
    set udg_happyness[Pnumb] = udg_happyness[Pnumb] - 50
    set udg_food[Pnumb] = 0
    set udg_Starving[Pnumb] = 1
    if udg_Citizens[Pnumb] > 0 then
    call PlaySoundForPlayer( p, gg_snd_Warning )
    call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000WARNING: Your people are starving!" )
    endif
    endif    
    if i2 > (udg_food[Pnumb] + (udg_food[Pnumb] / 10)) then 
    call PlaySoundForPlayer( p, gg_snd_FoodDown )
    call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000WARNING: Food dropping fast!" )  
    endif
    if i2 < (udg_food[Pnumb] - (udg_food[Pnumb] / 5)) then 
    call PlaySoundForPlayer( p, gg_snd_FoodUp )
    endif

    //Food Cap
    if udg_food[Pnumb] > 1000000000 then
    set udg_food[Pnumb] = 1000000000
    endif

    // bad happyness
    if udg_happyness[Pnumb] < 200 then
       set i4 = 1
       loop
       set u2 = FirstOfGroup(g3)
       exitwhen i4 > i3 or u2 == null
       call RebelUnit(u2,p)
       call GroupRemoveUnitSimple( u2, g3 )
       set i4 = i4 + 1
       endloop
    endif
    if bj_livingPlayerUnitsTypeId == 1 then
    call PlaySoundForPlayer( p, gg_snd_Warning )
    call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000WARNING: Some of your units are rebelling!" ) 
    endif

    // Power
    if udg_Powerneeded[Pnumb] > 0 and udg_PowerSupply[Pnumb] > 0 then
    set r = ((udg_Powerneeded[Pnumb] * 100) / udg_PowerSupply[Pnumb] )
    call MultiboardUpdate( udg_PlayerMultiboard[Pnumb], 13, r )
    endif

    if udg_Powerneeded[Pnumb] == 0 and udg_PowerSupply[Pnumb] > 0 then
    call MultiboardUpdate( udg_PlayerMultiboard[Pnumb], 13, 0 )
    endif

    if udg_Powerneeded[Pnumb] > 0 and udg_PowerSupply[Pnumb] == 0 then
    call MultiboardUpdate( udg_PlayerMultiboard[Pnumb], 13, 100 )    
    endif

    if udg_Powerneeded[Pnumb] > udg_PowerSupply[Pnumb] and udg_Power[Pnumb] == 1 then
    set bj_itemRandomConsidered = 1
    call ForGroupBJ( g4, function PowerUnit )
    endif
    
    if udg_Powerneeded[Pnumb] > udg_PowerSupply[Pnumb] and udg_Power[Pnumb] == 0 then
    set udg_Power[Pnumb] = 1
    call PlaySoundForPlayer(p, gg_snd_low_power )
    call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000WARNING: Power offline!" )
    set bj_itemRandomConsidered = 1
    call ForGroupBJ( g4, function PowerUnit )
    endif

    if udg_Powerneeded[Pnumb] <= udg_PowerSupply[Pnumb] and udg_Power[Pnumb] == 1 then
    set udg_Power[Pnumb] = 0
    call PlaySoundForPlayer(p, gg_snd_power_online )
    call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000Power online!" )
    call ForGroupBJ( g4, function PowerUnit )
    endif
   
    // Happyness
    set udg_happyness[Pnumb] = ((udg_happyness[Pnumb] - 20 ) + ( udg_Rations[Pnumb] * 6 ) - (udg_Tax[Pnumb] * 10)) 
    
    // Working People
    set udg_PeopleRelaxing[Pnumb] = ( ( udg_Citizens[Pnumb] * udg_Townhallsettings4[Pnumb] ) / 100 )
    set udg_PeopleSience[Pnumb] = ( ( udg_Citizens[Pnumb] * udg_Townhallsettings3[Pnumb] ) / 100 )
    set udg_PeopleIndustrial[Pnumb] = ( ( udg_Citizens[Pnumb] * udg_Townhallsettings1[Pnumb] ) / 100 )
    set udg_PeopleCommercial[Pnumb] = ( ( udg_Citizens[Pnumb] * udg_Townhallsettings2[Pnumb] ) / 100 )
    set udg_PeopleWorking[Pnumb] = ( udg_PeopleCommercial[Pnumb] + ( udg_PeopleIndustrial[Pnumb] + ( udg_PeopleRelaxing[Pnumb] + udg_PeopleSience[Pnumb] ) ) )
    if udg_Citizens[Pnumb] != udg_PeopleWorking[Pnumb] then
    set udg_PeopleRelaxing[Pnumb] = ( udg_PeopleRelaxing[Pnumb] + ( udg_Citizens[Pnumb] - udg_PeopleWorking[Pnumb] ) )
    endif

    // Industry
    set udg_ExtraWood[Pnumb] = ( udg_PeopleIndustrial[Pnumb] / 5 )
  
    // Happiness
    call MultiboardSetItemColorBJ( udg_PlayerMultiboard[Pnumb], 0, 1, I2R(100 - (udg_happyness[Pnumb] / 10)) , I2R(udg_happyness[Pnumb] / 10), 0.00, 0 )
    if  udg_happyness[Pnumb] <= 0 then
    set udg_happyness[Pnumb] = 0
    call MultiboardSetItemValueBJ( udg_PlayerMultiboard[Pnumb], 2, 1, "Hate" )
    endif
    if udg_happyness[Pnumb] <= 100 and udg_happyness[Pnumb] > 0 then
    call MultiboardSetItemValueBJ( udg_PlayerMultiboard[Pnumb], 2, 1, "Hate" )
    endif
    if udg_happyness[Pnumb] <= 200 and udg_happyness[Pnumb] > 100 then
    call MultiboardSetItemValueBJ( udg_PlayerMultiboard[Pnumb], 2, 1, "Angry" )
    endif
    if udg_happyness[Pnumb] <= 300 and udg_happyness[Pnumb] > 200 then
    call MultiboardSetItemValueBJ( udg_PlayerMultiboard[Pnumb], 2, 1, "Unhappy" )
    endif
    if udg_happyness[Pnumb] <= 400 and udg_happyness[Pnumb] > 300 then
    call MultiboardSetItemValueBJ( udg_PlayerMultiboard[Pnumb], 2, 1, "Bad" )
    endif
    if udg_happyness[Pnumb] <= 500 and udg_happyness[Pnumb] > 400 then
    call MultiboardSetItemValueBJ( udg_PlayerMultiboard[Pnumb], 2, 1, "Normal" )
    endif
    if udg_happyness[Pnumb] <= 600 and udg_happyness[Pnumb] > 500 then
    call MultiboardSetItemValueBJ( udg_PlayerMultiboard[Pnumb], 2, 1, "Good" )
    endif
    if udg_happyness[Pnumb] <= 700 and udg_happyness[Pnumb] > 600 then
    call MultiboardSetItemValueBJ( udg_PlayerMultiboard[Pnumb], 2, 1, "Cheerful" )
    endif
    if udg_happyness[Pnumb] <= 800 and udg_happyness[Pnumb] > 700 then
    call MultiboardSetItemValueBJ( udg_PlayerMultiboard[Pnumb], 2, 1, "Happy" )
    endif
    if udg_happyness[Pnumb] <= 900 and udg_happyness[Pnumb] > 800 then
    call MultiboardSetItemValueBJ( udg_PlayerMultiboard[Pnumb], 2, 1, "Proud" )
    endif
    if udg_happyness[Pnumb] <= 1000 and udg_happyness[Pnumb] > 900 then
    call MultiboardSetItemValueBJ( udg_PlayerMultiboard[Pnumb], 2, 1, "Love" )
    endif
    if udg_happyness[Pnumb] > 1000 then
    set udg_happyness[Pnumb] = 1000
    call MultiboardSetItemValueBJ( udg_PlayerMultiboard[Pnumb], 2, 1, "Love" )
    endif
    set udg_income[Pnumb] = (5 + ((udg_Citizens[Pnumb] * udg_Tax[Pnumb] * (udg_happyness[Pnumb] / 100)) / 5000) + ((udg_PeopleCommercial[Pnumb] * (udg_happyness[Pnumb] / 100) * 6) / 3000) + ((udg_PeopleCommercial[Pnumb] * (udg_happyness[Pnumb]/ 100) * udg_Tax[Pnumb]) / 3000))
    call MultiboardSetItemValueBJ( udg_PlayerMultiboard[Pnumb], 2, 9, udg_ProjectName[Pnumb] )
    call MultiboardSetItemValueBJ( udg_PlayerMultiboard[Pnumb], 2, 3, I2S(udg_food[Pnumb]) )
    call MultiboardSetItemValueBJ( udg_PlayerMultiboard[Pnumb], 2, 4, I2S(udg_Citizens[Pnumb]) )
   
    // Income
    set udg_ExtraWood[Pnumb] = ( udg_ExtraWood[Pnumb] + 10 )
    if udg_EmpireProfile[Pnumb] == 5 then
    set udg_income[Pnumb] = (udg_income[Pnumb] + (udg_income[Pnumb] / 5))    
    set udg_ExtraWood[Pnumb] = (udg_ExtraWood[Pnumb] + (udg_ExtraWood[Pnumb] / 5))  
    endif
    call AdjustPlayerStateBJ( ((udg_income[Pnumb] * (100 - udg_Payment[Pnumb])) / 100), p, PLAYER_STATE_RESOURCE_GOLD )
    call AdjustPlayerStateBJ( udg_ExtraWood[Pnumb], p, PLAYER_STATE_RESOURCE_LUMBER )   
    set udg_ZZPlayer = p    

    //Hired Hero
    if udg_EmpireHiredHero[Pnumb] != 0 then
    set udg_PaymentCounter[Pnumb] = udg_PaymentCounter[Pnumb] + 1
    set i = (udg_income[Pnumb] * udg_Payment[Pnumb] / 75) + (udg_Payment[Pnumb] * 3)
    set udg_EmpirePaymentExp[Pnumb] = udg_EmpirePaymentExp[Pnumb] + i
    set udg_EmpirePaymentTradePoints[Pnumb] = udg_EmpirePaymentTradePoints[Pnumb] + (udg_Payment[Pnumb] / 25)    
    endif

    if udg_PaymentCounter[Pnumb] == 10 then
    call AddHeroXPSwapped(udg_EmpirePaymentExp[Pnumb], udg_Herounit[GetConvertedPlayerId(ConvertedPlayer(udg_EmpireHiredHero[Pnumb]))], true )
    set udg_TradePoints[GetConvertedPlayerId(ConvertedPlayer(udg_EmpireHiredHero[Pnumb]))] = udg_TradePoints[GetConvertedPlayerId(ConvertedPlayer(udg_EmpireHiredHero[Pnumb]))] + udg_EmpirePaymentTradePoints[Pnumb]
    call DisplayTimedTextToForce( GetForceOfPlayer(ConvertedPlayer(udg_EmpireHiredHero[Pnumb])), 2.00, udg_Playercolor[Pnumb] + GetPlayerName(Player(Pnumb - 1)) + "|c00ff0000 has given you " + I2S(udg_EmpirePaymentExp[Pnumb]) + " exp and " + I2S(udg_EmpirePaymentTradePoints[Pnumb]) + " tradepoints!")
    call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(ConvertedPlayer(udg_EmpireHiredHero[Pnumb]))], 2, 11, I2S(udg_TradePoints[GetConvertedPlayerId(ConvertedPlayer(udg_EmpireHiredHero[Pnumb]))]) )
    set udg_PaymentCounter[Pnumb] = 0
    set udg_EmpirePaymentExp[Pnumb] = 0
    set udg_EmpirePaymentTradePoints[Pnumb] = 0
    endif

    //Wasted Research
    if udg_PeopleSience[Pnumb] > 0 and udg_ResearchNeed[Pnumb] == 0 then

    if udg_ScienceError[Pnumb] > 2 then
    set udg_ScienceError[Pnumb] = 0
    call PlaySoundForPlayer( p, gg_snd_Warning )
    call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000You have no Science Project but you do have people working in Science!" ) 
    else
    set udg_ScienceError[Pnumb] = udg_ScienceError[Pnumb] + 1
    endif

    else
    set udg_ScienceError[Pnumb] = 0
    endif

    //Show Income
    call ForGroupBJ( g, function Bounties )

call DestroyGroup(g)
call DestroyGroup(g3)
call DestroyGroup(g4)
set g = null
set g3 = null
set g4 = null
set u = null
set u2 = null
endfunction

function Trig_Refresh_Multiboard_Actions takes nothing returns nothing
local integer i = 1
    loop
    exitwhen i > 10
    if GetPlayerSlotState(Player(i - 1)) == PLAYER_SLOT_STATE_PLAYING and udg_Empire[i] == 1 and udg_StartedEmpire[i] == 1 then
    call MultiboardUpdate2(i)
    endif
    set i = i + 1
    endloop
endfunction

//===========================================================================
function InitTrig_Refresh_Multiboard takes nothing returns nothing
    set gg_trg_Refresh_Multiboard = CreateTrigger(  )
    call DisableTrigger( gg_trg_Refresh_Multiboard )
    call TriggerRegisterTimerEventPeriodic( gg_trg_Refresh_Multiboard, 5.00 )
    call TriggerAddAction( gg_trg_Refresh_Multiboard, function Trig_Refresh_Multiboard_Actions )
endfunction

//===========================================================================
// Trigger: Multiboard Show
//===========================================================================
function MultiboardShow takes nothing returns nothing
local player p = GetEnumPlayer() 
if p == GetLocalPlayer() then
call MultiboardDisplayBJ( true, udg_PlayerMultiboard[GetConvertedPlayerId(p)] )
endif
set p = null
endfunction

function Trig_MultiboardShow_Actions takes nothing returns nothing
call ForForce( udg_AttackerGroup, function MultiboardShow )
endfunction

//===========================================================================
function InitTrig_Multiboard_Show takes nothing returns nothing
    set gg_trg_Multiboard_Show = CreateTrigger(  )
    call DisableTrigger( gg_trg_Multiboard_Show )
    call TriggerRegisterTimerEventPeriodic( gg_trg_Multiboard_Show, 5.11 )
    call TriggerAddAction( gg_trg_Multiboard_Show, function Trig_MultiboardShow_Actions )
endfunction

//===========================================================================
// Trigger: Set Up Castle Creeps
//===========================================================================
function Trig_Set_Up_Castle_Creeps_Actions takes nothing returns nothing
local group g = GetUnitsOfPlayerAll(Player(10))
local group g2 = GetUnitsOfPlayerAll(Player(11))
local integer i = 101
local unit u = null
loop
exitwhen CountUnitsInGroup(g) == 0
set u = FirstOfGroup(g)
set udg_CastleCreepsSpots[i] = GetUnitLoc(u)
call SetUnitUserData( u, i )
call GroupRemoveUnitSimple( u, g )
set i = i + 1
endloop
loop
exitwhen CountUnitsInGroup(g2) == 0
set u = FirstOfGroup(g2)
set udg_CastleCreepsSpots[i] = GetUnitLoc(u)
call SetUnitUserData( u, i )
call GroupRemoveUnitSimple( u, g2 )
set i = i + 1
endloop
call DestroyGroup(g)
call DestroyGroup(g2)
set g = null
set g2 = null
set u = null
call DestroyTrigger(GetTriggeringTrigger())
endfunction

//===========================================================================
function InitTrig_Set_Up_Castle_Creeps takes nothing returns nothing
    set gg_trg_Set_Up_Castle_Creeps = CreateTrigger(  )
    call TriggerRegisterTimerEventSingle( gg_trg_Set_Up_Castle_Creeps, 4.00 )
    call TriggerAddAction( gg_trg_Set_Up_Castle_Creeps, function Trig_Set_Up_Castle_Creeps_Actions )
endfunction

//===========================================================================
// Trigger: Set Up Rebellions
//===========================================================================
function Trig_Set_Up_Rebellions_Actions takes nothing returns nothing
    call DestroyTrigger(GetTriggeringTrigger())
    set udg_ZZRebelionLevel[1] = 'o00T'
    set udg_ZZRebelionLevel[2] = 'o00U'
    set udg_ZZRebelionLevel[3] = 'o00V'
    set udg_ZZRebelionLevel[4] = 'o00W'
    set udg_ZZRebelionLevel[5] = 'o00X'
    set udg_ZZRebelionLevel[6] = 'o00Y'
    set udg_ZZRebelionLevel[7] = 'o00Z'
    set udg_ZZRebelionLevel[8] = 'o010'
    set udg_ZZRebelionLevel[9] = 'o011'
    set udg_ZZRebelionLevel[10] = 'o012'
    set udg_ZZRebelionLevel[11] = 'o013'
    set udg_ZZRebelionLevel[13] = 'o014'
    set udg_ZZRebelionLevel[14] = 'o015'
    set udg_ZZRebelionLevel[16] = 'o016'
    set udg_ZZRebelionLevel[18] = 'o017'
    set udg_ZZRebelionLevel[20] = 'o018'
    set udg_ZZRebelionLevel[23] = 'o019'
    set udg_ZZRebelionLevel[25] = 'o01A'
    set udg_ZZRebelionLevel[27] = 'o01B'
    set udg_ZZRebelionLevel[30] = 'o01C'
endfunction

//===========================================================================
function InitTrig_Set_Up_Rebellions takes nothing returns nothing
    set gg_trg_Set_Up_Rebellions = CreateTrigger(  )
    call TriggerRegisterTimerEventSingle( gg_trg_Set_Up_Rebellions, 1.10 )
    call TriggerAddAction( gg_trg_Set_Up_Rebellions, function Trig_Set_Up_Rebellions_Actions )
endfunction

//===========================================================================
// Trigger: Set Up Creep
//===========================================================================
function Trig_Set_Up_Creep_Actions takes nothing returns nothing
    call DestroyTrigger(GetTriggeringTrigger())
    // level 1
    set udg_ZZCreepLevels1[1] = 'n00I'
    set udg_ZZCreepLevels2[1] = 'n00I'
    set udg_ZZCreepLevels3[1] = 'n00I'
    set udg_ZZCreepLevels4[1] = 'n00I'
    set udg_ZZCreepLevels5[1] = 'n00I'
    // level 2
    set udg_ZZCreepLevels1[2] = 'n00C'
    set udg_ZZCreepLevels2[2] = 'n00C'
    set udg_ZZCreepLevels3[2] = 'n01D'
    set udg_ZZCreepLevels4[2] = 'n00C'
    set udg_ZZCreepLevels5[2] = 'n01D'
    // level 3
    set udg_ZZCreepLevels1[3] = 'n00D'
    set udg_ZZCreepLevels2[3] = 'n00D'
    set udg_ZZCreepLevels3[3] = 'n00D'
    set udg_ZZCreepLevels4[3] = 'n00D'
    set udg_ZZCreepLevels5[3] = 'n00D'
    // level 4
    set udg_ZZCreepLevels2[4] = 'n007'
    set udg_ZZCreepLevels2[4] = 'n007'
    set udg_ZZCreepLevels3[4] = 'n010'
    set udg_ZZCreepLevels4[4] = 'n01K'
    set udg_ZZCreepLevels5[4] = 'n01K'
    // level 6
    set udg_ZZCreepLevels1[6] = 'n00J'
    set udg_ZZCreepLevels2[6] = 'n008'
    set udg_ZZCreepLevels3[6] = 'n01L'
    set udg_ZZCreepLevels4[6] = 'n00J'
    set udg_ZZCreepLevels5[6] = 'n008'
    // level 8
    set udg_ZZCreepLevels1[8] = 'n00M'
    set udg_ZZCreepLevels2[8] = 'n00R'
    set udg_ZZCreepLevels3[8] = 'n00S'
    set udg_ZZCreepLevels4[8] = 'n01Y'
    set udg_ZZCreepLevels5[8] = 'n01M'
    // level 10
    set udg_ZZCreepLevels1[10] = 'n00O'
    set udg_ZZCreepLevels2[10] = 'n00T'
    set udg_ZZCreepLevels3[10] = 'n01Z'
    set udg_ZZCreepLevels4[10] = 'n00E'
    set udg_ZZCreepLevels5[10] = 'n01N'
    // level 13
    set udg_ZZCreepLevels1[13] = 'n01T'
    set udg_ZZCreepLevels2[13] = 'n00P'
    set udg_ZZCreepLevels3[13] = 'n01O'
    set udg_ZZCreepLevels4[13] = 'n01T'
    set udg_ZZCreepLevels5[13] = 'n00P'
    // level 16
    set udg_ZZCreepLevels1[16] = 'n00V'
    set udg_ZZCreepLevels2[16] = 'n00F'
    set udg_ZZCreepLevels3[16] = 'n021'
    set udg_ZZCreepLevels4[16] = 'n00V'
    set udg_ZZCreepLevels5[16] = 'n00F'
    // level 20
    set udg_ZZCreepLevels1[20] = 'n01U'
    set udg_ZZCreepLevels2[20] = 'n01H'
    set udg_ZZCreepLevels3[20] = 'n01E'
    set udg_ZZCreepLevels4[20] = 'n01P'
    set udg_ZZCreepLevels5[20] = 'n01R'
    // level 25
    set udg_ZZCreepLevels1[25] = 'n01I'
    set udg_ZZCreepLevels2[25] = 'n01S'
    set udg_ZZCreepLevels3[25] = 'n01I'
    set udg_ZZCreepLevels4[25] = 'n01S'
    set udg_ZZCreepLevels5[25] = 'n01I'
    // level 30
    set udg_ZZCreepLevels1[30] = 'n01V'
    set udg_ZZCreepLevels2[30] = 'n01V'
    set udg_ZZCreepLevels3[30] = 'n01X'
    set udg_ZZCreepLevels4[30] = 'n01X'
    set udg_ZZCreepLevels5[30] = 'n01V'
endfunction

//===========================================================================
function InitTrig_Set_Up_Creep takes nothing returns nothing
    set gg_trg_Set_Up_Creep = CreateTrigger(  )
    call TriggerRegisterTimerEventSingle( gg_trg_Set_Up_Creep, 1.20 )
    call TriggerAddAction( gg_trg_Set_Up_Creep, function Trig_Set_Up_Creep_Actions )
endfunction

//===========================================================================
// Trigger: Starting Game
//===========================================================================
function Trig_Starting_Game_Func003Func001C takes nothing returns boolean
    if ( not ( GetPlayerSlotState(ConvertedPlayer(udg_Starting)) == PLAYER_SLOT_STATE_PLAYING ) ) then
        return false
    endif
    return true
endfunction

function Trig_Starting_Game_Func037002 takes nothing returns nothing
    call SetUnitUserData( GetEnumUnit(), 1 )
endfunction

function Trig_Starting_Game_Actions takes nothing returns nothing
    set udg_Spawners = GetUnitsOfPlayerAndTypeId(Player(PLAYER_NEUTRAL_PASSIVE), 'e01A')
    call EnableTrigger( gg_trg_Player_Leaves )
    set udg_Starting = 1
    loop
        exitwhen udg_Starting > 10
        if ( Trig_Starting_Game_Func003Func001C() ) then
            call ForceAddPlayerSimple( ConvertedPlayer(udg_Starting), udg_AttackerGroup )
        else
            call DoNothing(  )
        endif
        set udg_Starting = udg_Starting + 1
    endloop
    call SetForceAllianceStateBJ( udg_AttackerGroup, GetForceOfPlayer(Player(bj_PLAYER_NEUTRAL_VICTIM)), bj_ALLIANCE_ALLIED )
    call SetForceAllianceStateBJ( udg_AttackerGroup, GetForceOfPlayer(Player(PLAYER_NEUTRAL_PASSIVE)), bj_ALLIANCE_ALLIED )
    call SetForceAllianceStateBJ( GetForceOfPlayer(Player(bj_PLAYER_NEUTRAL_VICTIM)), udg_AttackerGroup, bj_ALLIANCE_ALLIED )
    call SetForceAllianceStateBJ( GetForceOfPlayer(Player(PLAYER_NEUTRAL_PASSIVE)), udg_AttackerGroup, bj_ALLIANCE_ALLIED )
    call RemoveUnit( gg_unit_e00X_0288 )
    call SetPlayerAllianceStateBJ( Player(PLAYER_NEUTRAL_PASSIVE), Player(bj_PLAYER_NEUTRAL_VICTIM), bj_ALLIANCE_ALLIED )
    call SetPlayerAllianceStateBJ( Player(bj_PLAYER_NEUTRAL_VICTIM), Player(PLAYER_NEUTRAL_PASSIVE), bj_ALLIANCE_ALLIED )
    call SetPlayerFlagBJ( PLAYER_STATE_GIVES_BOUNTY, false, Player(PLAYER_NEUTRAL_AGGRESSIVE) )
    call SetPlayerAllianceStateBJ( Player(11), Player(PLAYER_NEUTRAL_AGGRESSIVE), bj_ALLIANCE_ALLIED )
    call SetPlayerAllianceStateBJ( Player(11), Player(PLAYER_NEUTRAL_PASSIVE), bj_ALLIANCE_UNALLIED )
    call SetPlayerAllianceStateBJ( Player(10), Player(PLAYER_NEUTRAL_AGGRESSIVE), bj_ALLIANCE_ALLIED )
    call SetPlayerAllianceStateBJ( Player(10), Player(PLAYER_NEUTRAL_PASSIVE), bj_ALLIANCE_UNALLIED )
    call SetPlayerAllianceStateBJ( Player(PLAYER_NEUTRAL_AGGRESSIVE), Player(11), bj_ALLIANCE_ALLIED )
    call SetPlayerAllianceStateBJ( Player(PLAYER_NEUTRAL_AGGRESSIVE), Player(10), bj_ALLIANCE_ALLIED )
    call SetPlayerAllianceStateBJ( Player(PLAYER_NEUTRAL_AGGRESSIVE), Player(PLAYER_NEUTRAL_PASSIVE), bj_ALLIANCE_UNALLIED )
    call SetPlayerAllianceStateBJ( Player(PLAYER_NEUTRAL_PASSIVE), Player(PLAYER_NEUTRAL_AGGRESSIVE), bj_ALLIANCE_UNALLIED )
    call SetPlayerAllianceStateBJ( Player(PLAYER_NEUTRAL_PASSIVE), Player(11), bj_ALLIANCE_UNALLIED )
    call SetPlayerAllianceStateBJ( Player(PLAYER_NEUTRAL_PASSIVE), Player(10), bj_ALLIANCE_UNALLIED )
    set udg_Playercolor[1] = "|cffff0000"
    set udg_Playercolor[2] = "|cff0041ff"
    set udg_Playercolor[3] = "|cff1be6b8"
    set udg_Playercolor[4] = "|cff530080"
    set udg_Playercolor[5] = "|cffffff00"
    set udg_Playercolor[6] = "|cfffe890d"
    set udg_Playercolor[7] = "|cff1fbf00"
    set udg_Playercolor[8] = "|cffe55aaf"
    set udg_Playercolor[9] = "|cffa0a0a0"
    set udg_Playercolor[10] = "|cff7dbef1"
    call EnableMinimapFilterButtons( true, false )
    call SetCreepCampFilterState( false )
    call DisplayTimedTextToForce( udg_AttackerGroup, 7.00, "TRIGSTR_3921" )
    call PlaySoundBJ( gg_snd_Message )
    call ForGroupBJ( GetUnitsOfTypeIdAll('n00W'), function Trig_Starting_Game_Func037002 )
    call CreateQuestBJ( bj_QUESTTYPE_REQ_DISCOVERED, "TRIGSTR_3969", "TRIGSTR_216", "ReplaceableTextures\\CommandButtons\\BTNSelectHeroOn.blp" )
    call CreateQuestBJ( bj_QUESTTYPE_REQ_DISCOVERED, "TRIGSTR_4243", "TRIGSTR_1637", "ReplaceableTextures\\CommandButtons\\BTNSelectHeroOn.blp" )
    call CreateQuestBJ( bj_QUESTTYPE_REQ_DISCOVERED, "TRIGSTR_4246", "TRIGSTR_4247", "ReplaceableTextures\\CommandButtons\\BTNSelectHeroOn.blp" )
    call CreateQuestBJ( bj_QUESTTYPE_REQ_DISCOVERED, "TRIGSTR_4261", "TRIGSTR_4267", "ReplaceableTextures\\CommandButtons\\BTNSelectHeroOn.blp" )
    call CreateQuestBJ( bj_QUESTTYPE_REQ_DISCOVERED, "TRIGSTR_4268", "TRIGSTR_1651", "ReplaceableTextures\\CommandButtons\\BTNSelectHeroOn.blp" )
    call CreateQuestBJ( bj_QUESTTYPE_OPT_DISCOVERED, "TRIGSTR_402", "TRIGSTR_4271", "ReplaceableTextures\\CommandButtons\\BTNSelectHeroOn.blp" )
    set udg_daynight = 4000
    call SetTimeOfDay( 3.00 )
    call DialogSetMessageBJ( udg_Mode, "TRIGSTR_4272" )
    call DialogAddButtonBJ( udg_Mode, "TRIGSTR_4273" )
    set udg_ModeButtons[0] = GetLastCreatedButtonBJ()
    call DialogAddButtonBJ( udg_Mode, "TRIGSTR_4274" )
    set udg_ModeButtons[1] = GetLastCreatedButtonBJ()
    call DialogAddButtonBJ( udg_Mode, "TRIGSTR_4280" )
    set udg_ModeButtons[2] = GetLastCreatedButtonBJ()
    call DialogAddButtonBJ( udg_Mode, "TRIGSTR_4282" )
    set udg_ModeButtons[3] = GetLastCreatedButtonBJ()
    call DialogSetMessageBJ( udg_Profile, "TRIGSTR_4283" )
    call DialogAddButtonBJ( udg_Profile, "TRIGSTR_4273" )
    set udg_ProfileButtons[0] = GetLastCreatedButtonBJ()
    call DialogAddButtonBJ( udg_Profile, "TRIGSTR_4286" )
    set udg_ProfileButtons[1] = GetLastCreatedButtonBJ()
    call DialogAddButtonBJ( udg_Profile, "TRIGSTR_4287" )
    set udg_ProfileButtons[2] = GetLastCreatedButtonBJ()
    call DialogAddButtonBJ( udg_Profile, "TRIGSTR_4288" )
    set udg_ProfileButtons[3] = GetLastCreatedButtonBJ()
    call DialogAddButtonBJ( udg_Profile, "TRIGSTR_4289" )
    set udg_ProfileButtons[4] = GetLastCreatedButtonBJ()
    call DialogSetMessageBJ( udg_Class, "TRIGSTR_4291" )
    call DialogAddButtonBJ( udg_Class, "TRIGSTR_4273" )
    set udg_ClassButtons[0] = GetLastCreatedButtonBJ()
    call DialogAddButtonBJ( udg_Class, "TRIGSTR_524" )
    set udg_ClassButtons[1] = GetLastCreatedButtonBJ()
    call DialogAddButtonBJ( udg_Class, "TRIGSTR_753" )
    set udg_ClassButtons[2] = GetLastCreatedButtonBJ()
    call DialogAddButtonBJ( udg_Class, "TRIGSTR_1340" )
    set udg_ClassButtons[3] = GetLastCreatedButtonBJ()
    call DialogAddButtonBJ( udg_Class, "TRIGSTR_525" )
    set udg_ClassButtons[4] = GetLastCreatedButtonBJ()
    call DialogAddButtonBJ( udg_Class, "TRIGSTR_619" )
    set udg_ClassButtons[5] = GetLastCreatedButtonBJ()
    call DialogAddButtonBJ( udg_Class, "TRIGSTR_1343" )
    set udg_ClassButtons[6] = GetLastCreatedButtonBJ()
    call DialogAddButtonBJ( udg_Class, "TRIGSTR_3024" )
    set udg_ClassButtons[7] = GetLastCreatedButtonBJ()
    call DialogSetMessageBJ( udg_Race, "TRIGSTR_4324" )
    call DialogAddButtonBJ( udg_Race, "TRIGSTR_4325" )
    set udg_RaceButtons[1] = GetLastCreatedButtonBJ()
    call DialogAddButtonBJ( udg_Race, "TRIGSTR_730" )
    set udg_RaceButtons[2] = GetLastCreatedButtonBJ()
    call DialogAddButtonBJ( udg_Race, "TRIGSTR_4273" )
    set udg_RaceButtons[3] = GetLastCreatedButtonBJ()
    call DialogSetMessageBJ( udg_Difficulty, "TRIGSTR_4331" )
    call DialogAddButtonBJ( udg_Difficulty, "TRIGSTR_4332" )
    call DialogAddButtonBJ( udg_Difficulty, "TRIGSTR_4333" )
    set udg_Difficultybuttons[0] = GetLastCreatedButtonBJ()
    call DialogAddButtonBJ( udg_Difficulty, "TRIGSTR_4338" )
    set udg_Difficultybuttons[3] = GetLastCreatedButtonBJ()
    call DialogAddButtonBJ( udg_Difficulty, "TRIGSTR_4346" )
    set udg_Difficultybuttons[4] = GetLastCreatedButtonBJ()
    call DialogAddButtonBJ( udg_Difficulty, "TRIGSTR_4368" )
    set udg_Difficultybuttons[5] = GetLastCreatedButtonBJ()
    call DialogAddButtonBJ( udg_Difficulty, "TRIGSTR_4370" )
    set udg_Difficultybuttons[6] = GetLastCreatedButtonBJ()
    call DialogAddButtonBJ( udg_Difficulty, "TRIGSTR_4372" )
    set udg_Difficultybuttons[7] = GetLastCreatedButtonBJ()
    call DialogAddButtonBJ( udg_Difficulty, "TRIGSTR_4374" )
    set udg_Difficultybuttons[8] = GetLastCreatedButtonBJ()
    call PolledWait( 10.00 )
    call StartTimerBJ( udg_Builderstarter, false, 30.00 )
    call CreateTimerDialogBJ( GetLastCreatedTimerBJ(), "TRIGSTR_4375" )
    call TimerDialogDisplayBJ( true, GetLastCreatedTimerDialogBJ() )
    set udg_Starting = 1
    loop
        exitwhen udg_Starting > 10
        call DialogDisplayBJ( true, udg_Difficulty, ConvertedPlayer(udg_Starting) )
        set udg_Starting = udg_Starting + 1
    endloop
    call DestroyTrigger(GetTriggeringTrigger())
endfunction

//===========================================================================
function InitTrig_Starting_Game takes nothing returns nothing
    set gg_trg_Starting_Game = CreateTrigger(  )
    call TriggerRegisterTimerEventSingle( gg_trg_Starting_Game, 0.00 )
    call TriggerAddAction( gg_trg_Starting_Game, function Trig_Starting_Game_Actions )
endfunction

//===========================================================================
// Trigger: Vote Over
//===========================================================================
function Trig_Vote_Over_Func019Func007Func001Func002Func002Func002Func002Func001C takes nothing returns boolean
    if ( not ( udg_VoteCounter[3] == 6 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Vote_Over_Func019Func007Func001Func002Func002Func002Func002C takes nothing returns boolean
    if ( not ( udg_VoteCounter[3] == 5 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Vote_Over_Func019Func007Func001Func002Func002Func002C takes nothing returns boolean
    if ( not ( udg_VoteCounter[3] == 4 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Vote_Over_Func019Func007Func001Func002Func002C takes nothing returns boolean
    if ( not ( udg_VoteCounter[3] == 3 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Vote_Over_Func019Func007Func001Func002C takes nothing returns boolean
    if ( not ( udg_VoteCounter[3] == 2 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Vote_Over_Func019Func007Func001C takes nothing returns boolean
    if ( not ( udg_VoteCounter[3] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Vote_Over_Func019Func007C takes nothing returns boolean
    if ( not ( udg_VoteCounter[3] == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Vote_Over_Func019C takes nothing returns boolean
    if ( not ( udg_VoteCounter[2] > 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Vote_Over_Func020Func001Func003001 takes nothing returns boolean
    return ( udg_Random == 1 )
endfunction

function Trig_Vote_Over_Func020Func001C takes nothing returns boolean
    if ( not ( udg_Empire[udg_Starting] == 0 ) ) then
        return false
    endif
    if ( not ( udg_HeroRace[udg_Starting] == 0 ) ) then
        return false
    endif
    if ( not ( GetPlayerSlotState(ConvertedPlayer(udg_Starting)) == PLAYER_SLOT_STATE_PLAYING ) ) then
        return false
    endif
    return true
endfunction

function Trig_Vote_Over_Func020Func002C takes nothing returns boolean
    if ( not ( udg_Empire[udg_Starting] == 1 ) ) then
        return false
    endif
    if ( not ( udg_EmpireProfile[udg_Starting] == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Vote_Over_Func020Func003C takes nothing returns boolean
    if ( not ( udg_HeroRace[udg_Starting] == 1 ) ) then
        return false
    endif
    if ( not ( udg_ClassNumber[udg_Starting] == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Vote_Over_Func020Func004C takes nothing returns boolean
    if ( not ( udg_HeroRace[udg_Starting] == 1 ) ) then
        return false
    endif
    if ( not ( udg_HeroType[udg_Starting] == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Vote_Over_Func022Func001Func001Func001001 takes nothing returns boolean
    return ( udg_ClassNumber[udg_Starting] == 1 )
endfunction

function Trig_Vote_Over_Func022Func001Func001Func002001 takes nothing returns boolean
    return ( udg_ClassNumber[udg_Starting] == 2 )
endfunction

function Trig_Vote_Over_Func022Func001Func001Func003001 takes nothing returns boolean
    return ( udg_ClassNumber[udg_Starting] == 3 )
endfunction

function Trig_Vote_Over_Func022Func001Func001Func004001 takes nothing returns boolean
    return ( udg_ClassNumber[udg_Starting] == 4 )
endfunction

function Trig_Vote_Over_Func022Func001Func001Func005001 takes nothing returns boolean
    return ( udg_ClassNumber[udg_Starting] == 5 )
endfunction

function Trig_Vote_Over_Func022Func001Func001Func006001 takes nothing returns boolean
    return ( udg_ClassNumber[udg_Starting] == 6 )
endfunction

function Trig_Vote_Over_Func022Func001Func001Func007001 takes nothing returns boolean
    return ( udg_ClassNumber[udg_Starting] == 7 )
endfunction

function Trig_Vote_Over_Func022Func001Func001Func009001 takes nothing returns boolean
    return ( udg_ClassNumber[udg_Starting] == 1 )
endfunction

function Trig_Vote_Over_Func022Func001Func001Func010001 takes nothing returns boolean
    return ( udg_ClassNumber[udg_Starting] == 2 )
endfunction

function Trig_Vote_Over_Func022Func001Func001Func011001 takes nothing returns boolean
    return ( udg_ClassNumber[udg_Starting] == 3 )
endfunction

function Trig_Vote_Over_Func022Func001Func001Func012001 takes nothing returns boolean
    return ( udg_ClassNumber[udg_Starting] == 4 )
endfunction

function Trig_Vote_Over_Func022Func001Func001Func013001 takes nothing returns boolean
    return ( udg_ClassNumber[udg_Starting] == 5 )
endfunction

function Trig_Vote_Over_Func022Func001Func001Func014001 takes nothing returns boolean
    return ( udg_ClassNumber[udg_Starting] == 6 )
endfunction

function Trig_Vote_Over_Func022Func001Func001Func015001 takes nothing returns boolean
    return ( udg_ClassNumber[udg_Starting] == 7 )
endfunction

function Trig_Vote_Over_Func022Func001Func001Func022Func001C takes nothing returns boolean
    if ( not ( udg_HeroType[udg_Starting] == 3 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Vote_Over_Func022Func001Func001Func022C takes nothing returns boolean
    if ( not ( udg_HeroType[udg_Starting] == 2 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Vote_Over_Func022Func001Func001C takes nothing returns boolean
    if ( not ( udg_HeroRace[udg_Starting] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Vote_Over_Func022Func001Func007001 takes nothing returns boolean
    return ( udg_EmpireProfile[udg_Starting] == 1 )
endfunction

function Trig_Vote_Over_Func022Func001Func008001 takes nothing returns boolean
    return ( udg_EmpireProfile[udg_Starting] == 2 )
endfunction

function Trig_Vote_Over_Func022Func001Func009001 takes nothing returns boolean
    return ( udg_EmpireProfile[udg_Starting] == 3 )
endfunction

function Trig_Vote_Over_Func022Func001Func010001 takes nothing returns boolean
    return ( udg_EmpireProfile[udg_Starting] == 4 )
endfunction

function Trig_Vote_Over_Func022Func001C takes nothing returns boolean
    if ( not ( udg_Empire[udg_Starting] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Vote_Over_Func033Func001C takes nothing returns boolean
    if ( not ( udg_HeroRace[udg_Starting] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Vote_Over_Func039Func001C takes nothing returns boolean
    if ( not ( udg_HeroRace[udg_Starting] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Vote_Over_Actions takes nothing returns nothing
    call DestroyTrigger(gg_trg_Button_Clicked)
    call DestroyTrigger(gg_trg_Button_Clicked_Race)
    call DestroyTrigger(gg_trg_Button_Clicked_Class)
    call DestroyTrigger(gg_trg_Button_Clicked_Profile)
    call DestroyTrigger(gg_trg_Button_Clicked_Mode)
    call EnableTrigger( gg_trg_Difficulty )
    set udg_Starting = 1
    loop
        exitwhen udg_Starting > 10
        call DialogDisplayBJ( false, udg_Difficulty, ConvertedPlayer(udg_Starting) )
        call DialogDisplayBJ( false, udg_Race, ConvertedPlayer(udg_Starting) )
        call DialogDisplayBJ( false, udg_Class, ConvertedPlayer(udg_Starting) )
        call DialogDisplayBJ( false, udg_Profile, ConvertedPlayer(udg_Starting) )
        call DialogDisplayBJ( false, udg_Mode, ConvertedPlayer(udg_Starting) )
        set udg_Starting = udg_Starting + 1
    endloop
    call DestroyTimerDialogBJ( GetLastCreatedTimerDialogBJ() )
    call EnableTrigger( gg_trg_ignore )
    call EnableTrigger( gg_trg_unignore )
    call EnableTrigger( gg_trg_Ally )
    call EnableTrigger( gg_trg_Ally_All )
    call EnableTrigger( gg_trg_War )
    call EnableTrigger( gg_trg_War_All )
    call EnableTrigger( gg_trg_Truce )
    call EnableTrigger( gg_trg_Truce_All )
    call EnableTrigger( gg_trg_Share )
    if ( Trig_Vote_Over_Func019C() ) then
        set udg_VoteCounter[3] = ( udg_VoteCounter[1] / udg_VoteCounter[2] )
        if ( Trig_Vote_Over_Func019Func007C() ) then
            call DisplayTimedTextToForce( udg_AttackerGroup, 10.00, "TRIGSTR_4376" )
            set udg_KalendenDiff = 0
            set udg_TimerDiff = 0
            set udg_Exprate = 125
        else
            if ( Trig_Vote_Over_Func019Func007Func001C() ) then
                set udg_Exprate = 75
                call DisplayTimedTextToForce( udg_AttackerGroup, 10.00, "TRIGSTR_4385" )
                set udg_KalendenDiff = 10
                set udg_TimerDiff = 3
            else
                if ( Trig_Vote_Over_Func019Func007Func001Func002C() ) then
                    set udg_Exprate = 70
                    call DisplayTimedTextToForce( udg_AttackerGroup, 10.00, "TRIGSTR_4384" )
                    set udg_KalendenDiff = 10
                    set udg_TimerDiff = 6
                    call SetPlayerTechResearchedSwap( 'R00I', 1, Player(PLAYER_NEUTRAL_AGGRESSIVE) )
                    call SetPlayerTechResearchedSwap( 'R00I', 1, Player(10) )
                    call SetPlayerTechResearchedSwap( 'R00I', 1, Player(11) )
                else
                    if ( Trig_Vote_Over_Func019Func007Func001Func002Func002C() ) then
                        set udg_Exprate = 65
                        call DisplayTimedTextToForce( udg_AttackerGroup, 10.00, "TRIGSTR_4383" )
                        set udg_KalendenDiff = 20
                        set udg_TimerDiff = 10
                        call SetPlayerTechResearchedSwap( 'R00I', 2, Player(PLAYER_NEUTRAL_AGGRESSIVE) )
                        call SetPlayerTechResearchedSwap( 'R00I', 2, Player(10) )
                        call SetPlayerTechResearchedSwap( 'R00I', 2, Player(11) )
                    else
                        if ( Trig_Vote_Over_Func019Func007Func001Func002Func002Func002C() ) then
                            set udg_Exprate = 60
                            call DisplayTimedTextToForce( udg_AttackerGroup, 10.00, "TRIGSTR_4382" )
                            set udg_KalendenDiff = 20
                            set udg_TimerDiff = 16
                            call SetPlayerTechResearchedSwap( 'R00I', 3, Player(PLAYER_NEUTRAL_AGGRESSIVE) )
                            call SetPlayerTechResearchedSwap( 'R00I', 3, Player(10) )
                            call SetPlayerTechResearchedSwap( 'R00I', 3, Player(11) )
                        else
                            if ( Trig_Vote_Over_Func019Func007Func001Func002Func002Func002Func002C() ) then
                                call DisplayTimedTextToForce( udg_AttackerGroup, 10.00, "TRIGSTR_4381" )
                                set udg_Exprate = 55
                                set udg_KalendenDiff = 30
                                set udg_TimerDiff = 25
                                call SetPlayerTechResearchedSwap( 'R00I', 5, Player(PLAYER_NEUTRAL_AGGRESSIVE) )
                                call SetPlayerTechResearchedSwap( 'R00I', 5, Player(10) )
                                call SetPlayerTechResearchedSwap( 'R00I', 5, Player(11) )
                            else
                                if ( Trig_Vote_Over_Func019Func007Func001Func002Func002Func002Func002Func001C() ) then
                                    call DisplayTimedTextToForce( udg_AttackerGroup, 10.00, "TRIGSTR_4380" )
                                    set udg_Exprate = 50
                                    set udg_KalendenDiff = 30
                                    set udg_TimerDiff = 35
                                    call SetPlayerTechResearchedSwap( 'R00I', 7, Player(PLAYER_NEUTRAL_AGGRESSIVE) )
                                    call SetPlayerTechResearchedSwap( 'R00I', 7, Player(10) )
                                    call SetPlayerTechResearchedSwap( 'R00I', 7, Player(11) )
                                else
                                    set udg_Exprate = 45
                                    call DisplayTimedTextToForce( udg_AttackerGroup, 10.00, "TRIGSTR_4379" )
                                    set udg_KalendenDiff = 40
                                    set udg_TimerDiff = 50
                                    call SetPlayerTechResearchedSwap( 'R00I', 10, Player(PLAYER_NEUTRAL_AGGRESSIVE) )
                                    call SetPlayerTechResearchedSwap( 'R00I', 10, Player(10) )
                                    call SetPlayerTechResearchedSwap( 'R00I', 10, Player(11) )
                                endif
                            endif
                        endif
                    endif
                endif
            endif
        endif
    else
        call DisplayTimedTextToForce( udg_AttackerGroup, 10.00, "TRIGSTR_4376" )
        set udg_KalendenDiff = 0
        set udg_TimerDiff = 0
        set udg_Exprate = 100
    endif
    set udg_Starting = 1
    loop
        exitwhen udg_Starting > 10
        if ( Trig_Vote_Over_Func020Func001C() ) then
            set udg_Random = GetRandomInt(1, 2)
            if ( Trig_Vote_Over_Func020Func001Func003001() ) then
                set udg_Empire[udg_Starting] = 1
            else
                set udg_HeroRace[udg_Starting] = 1
            endif
        else
            call DoNothing(  )
        endif
        if ( Trig_Vote_Over_Func020Func002C() ) then
            set udg_EmpireProfile[udg_Starting] = GetRandomInt(1, 5)
        else
        endif
        if ( Trig_Vote_Over_Func020Func003C() ) then
            set udg_ClassNumber[udg_Starting] = GetRandomInt(1, 7)
        else
        endif
        if ( Trig_Vote_Over_Func020Func004C() ) then
            set udg_HeroType[udg_Starting] = GetRandomInt(1, 3)
        else
        endif
        set udg_Starting = udg_Starting + 1
    endloop
    call PlaySoundBJ( gg_snd_Message )
    set udg_Starting = 1
    loop
        exitwhen udg_Starting > 10
        if ( Trig_Vote_Over_Func022Func001C() ) then
            set udg_Empires = ( udg_Empires + 1 )
            set udg_Tempspot = GetRectCenter(gg_rct_Start_Builder)
            call CreateNUnitsAtLoc( 1, 'h01S', ConvertedPlayer(udg_Starting), udg_Tempspot, bj_UNIT_FACING )
            call PanCameraToTimedLocForPlayer( ConvertedPlayer(udg_Starting), udg_Tempspot, 0 )
            call DisplayTimedTextToForce( GetForceOfPlayer(ConvertedPlayer(udg_Starting)), 10.00, "TRIGSTR_4387" )
            if ( Trig_Vote_Over_Func022Func001Func007001() ) then
                call SetPlayerTechResearchedSwap( 'R00O', 1, ConvertedPlayer(udg_Starting) )
            else
                call DoNothing(  )
            endif
            if ( Trig_Vote_Over_Func022Func001Func008001() ) then
                call SetPlayerTechResearchedSwap( 'R00A', 1, ConvertedPlayer(udg_Starting) )
            else
                call DoNothing(  )
            endif
            if ( Trig_Vote_Over_Func022Func001Func009001() ) then
                call SetPlayerTechResearchedSwap( 'R00P', 1, ConvertedPlayer(udg_Starting) )
            else
                call DoNothing(  )
            endif
            if ( Trig_Vote_Over_Func022Func001Func010001() ) then
                call SetPlayerTechResearchedSwap( 'R00Q', 1, ConvertedPlayer(udg_Starting) )
            else
                call DoNothing(  )
            endif
            call CreateFogModifierRectBJ( true, ConvertedPlayer(udg_Starting), FOG_OF_WAR_VISIBLE, GetPlayableMapRect() )
            call DestroyFogModifier( GetLastCreatedFogModifier() )
            call RemoveLocation( udg_Tempspot )
            set udg_player = ConvertedPlayer(udg_Starting)
            call TriggerExecute( gg_trg_Multiboard_Empire )
        else
            if ( Trig_Vote_Over_Func022Func001Func001C() ) then
                if ( Trig_Vote_Over_Func022Func001Func001Func001001() ) then
                    set udg_SkillBook[udg_Starting] = 'A00U'
                else
                    call DoNothing(  )
                endif
                if ( Trig_Vote_Over_Func022Func001Func001Func002001() ) then
                    set udg_SkillBook[udg_Starting] = 'A02O'
                else
                    call DoNothing(  )
                endif
                if ( Trig_Vote_Over_Func022Func001Func001Func003001() ) then
                    set udg_SkillBook[udg_Starting] = 'A02P'
                else
                    call DoNothing(  )
                endif
                if ( Trig_Vote_Over_Func022Func001Func001Func004001() ) then
                    set udg_SkillBook[udg_Starting] = 'A02T'
                else
                    call DoNothing(  )
                endif
                if ( Trig_Vote_Over_Func022Func001Func001Func005001() ) then
                    set udg_SkillBook[udg_Starting] = 'A02U'
                else
                    call DoNothing(  )
                endif
                if ( Trig_Vote_Over_Func022Func001Func001Func006001() ) then
                    set udg_SkillBook[udg_Starting] = 'A02S'
                else
                    call DoNothing(  )
                endif
                if ( Trig_Vote_Over_Func022Func001Func001Func007001() ) then
                    set udg_SkillBook[udg_Starting] = 'A0AY'
                else
                    call DoNothing(  )
                endif
                set udg_Tempspot = GetUnitLoc(GroupPickRandomUnit(GetUnitsOfPlayerAndTypeId(Player(PLAYER_NEUTRAL_PASSIVE), 'e015')))
                if ( Trig_Vote_Over_Func022Func001Func001Func009001() ) then
                    call CreateNUnitsAtLoc( 1, 'H000', ConvertedPlayer(udg_Starting), udg_Tempspot, bj_UNIT_FACING )
                else
                    call DoNothing(  )
                endif
                if ( Trig_Vote_Over_Func022Func001Func001Func010001() ) then
                    call CreateNUnitsAtLoc( 1, 'H00T', ConvertedPlayer(udg_Starting), udg_Tempspot, bj_UNIT_FACING )
                else
                    call DoNothing(  )
                endif
                if ( Trig_Vote_Over_Func022Func001Func001Func011001() ) then
                    call CreateNUnitsAtLoc( 1, 'H02G', ConvertedPlayer(udg_Starting), udg_Tempspot, bj_UNIT_FACING )
                else
                    call DoNothing(  )
                endif
                if ( Trig_Vote_Over_Func022Func001Func001Func012001() ) then
                    call CreateNUnitsAtLoc( 1, 'H02U', ConvertedPlayer(udg_Starting), udg_Tempspot, bj_UNIT_FACING )
                else
                    call DoNothing(  )
                endif
                if ( Trig_Vote_Over_Func022Func001Func001Func013001() ) then
                    call CreateNUnitsAtLoc( 1, 'H02I', ConvertedPlayer(udg_Starting), udg_Tempspot, bj_UNIT_FACING )
                else
                    call DoNothing(  )
                endif
                if ( Trig_Vote_Over_Func022Func001Func001Func014001() ) then
                    call CreateNUnitsAtLoc( 1, 'H02H', ConvertedPlayer(udg_Starting), udg_Tempspot, bj_UNIT_FACING )
                else
                    call DoNothing(  )
                endif
                if ( Trig_Vote_Over_Func022Func001Func001Func015001() ) then
                    call CreateNUnitsAtLoc( 1, 'H01Q', ConvertedPlayer(udg_Starting), udg_Tempspot, bj_UNIT_FACING )
                else
                    call DoNothing(  )
                endif
                set udg_Heroes = ( udg_Heroes + 1 )
                set udg_HeroLevel[udg_Starting] = 1
                set udg_HeroLifes[udg_Starting] = 10
                call SetPlayerHandicapXPBJ( ConvertedPlayer(udg_Starting), 0.00 )
                if ( Trig_Vote_Over_Func022Func001Func001Func022C() ) then
                    call UnitAddItemByIdSwapped( 'I003', GetLastCreatedUnit() )
                else
                    if ( Trig_Vote_Over_Func022Func001Func001Func022Func001C() ) then
                        call SetUnitUseFoodBJ( false, GetLastCreatedUnit() )
                        call UnitAddItemByIdSwapped( 'I03F', GetLastCreatedUnit() )
                    else
                    endif
                endif
                call UnitAddAbilityBJ( udg_SkillBook[udg_Starting], GetLastCreatedUnit() )
                call SetUnitInvulnerable( GetLastCreatedUnit(), true )
                set udg_Herounit[udg_Starting] = GetLastCreatedUnit()
                call PanCameraToTimedLocForPlayer( ConvertedPlayer(udg_Starting), udg_Tempspot, 0 )
                call RemoveLocation( udg_Tempspot )
                set udg_player = ConvertedPlayer(udg_Starting)
                call TriggerExecute( gg_trg_Multiboard_Hero )
            else
                set udg_HeroLifes[udg_Starting] = -1
            endif
        endif
        set udg_Starting = udg_Starting + 1
    endloop
    call TriggerExecute( gg_trg_Multiboard_Show )
    call PlaySoundBJ( gg_snd_Message )
    call EnableTrigger( gg_trg_Refresh_Multiboard )
    call EnableTrigger( gg_trg_Multiboard_Show )
    call StartTimerBJ( udg_GracePeriode, false, 600.00 )
    call CreateTimerDialogBJ( GetLastCreatedTimerBJ(), "TRIGSTR_4388" )
    call TimerDialogDisplayBJ( true, GetLastCreatedTimerDialogBJ() )
    set udg_startingwindow = GetLastCreatedTimerDialogBJ()
    call PolledWait( 30.00 )
    call TriggerExecute( gg_trg_Multiboard_Show )
    set udg_Starting = 1
    loop
        exitwhen udg_Starting > 10
        if ( Trig_Vote_Over_Func033Func001C() ) then
            call SetUnitInvulnerable( udg_Herounit[GetConvertedPlayerId(ConvertedPlayer(udg_Starting))], false )
        else
            call DoNothing(  )
        endif
        set udg_Starting = udg_Starting + 1
    endloop
    call PolledWait( 15.00 )
    call TriggerExecute( gg_trg_Multiboard_Show )
    call DisplayTimedTextToForce( udg_AttackerGroup, 30.00, "TRIGSTR_4389" )
    call PlaySoundBJ( gg_snd_Message )
    call PolledWait( 25.00 )
    set udg_Starting = 1
    loop
        exitwhen udg_Starting > 10
        if ( Trig_Vote_Over_Func039Func001C() ) then
        else
            call CreateFogModifierRectBJ( true, ConvertedPlayer(udg_Starting), FOG_OF_WAR_FOGGED, GetPlayableMapRect() )
            call DestroyFogModifier( GetLastCreatedFogModifier() )
        endif
        set udg_Starting = udg_Starting + 1
    endloop
    set udg_Players = ( udg_Empires + udg_Heroes )
    call StartTimerBJ( udg_CompUp, true, ( 500.00 - I2R(( udg_TimerDiff * 3 )) ) )
    call TriggerExecute( gg_trg_Multiboard_Show )
    call DestroyTrigger(gg_trg_Multiboard_Hero)
    call DestroyTrigger(gg_trg_Multiboard_Empire)
    call DestroyTrigger(GetTriggeringTrigger())
endfunction

//===========================================================================
function InitTrig_Vote_Over takes nothing returns nothing
    set gg_trg_Vote_Over = CreateTrigger(  )
    call TriggerRegisterTimerExpireEventBJ( gg_trg_Vote_Over, udg_Builderstarter )
    call TriggerAddAction( gg_trg_Vote_Over, function Trig_Vote_Over_Actions )
endfunction

//===========================================================================
// Trigger: Button Clicked
//===========================================================================
function Trig_Button_Clicked_Func001Func002Func001Func001Func001Func001Func001Func001Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_Difficultybuttons[0] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Func001Func002Func001Func001Func001Func001Func001Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_Difficultybuttons[8] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Func001Func002Func001Func001Func001Func001Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_Difficultybuttons[7] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Func001Func002Func001Func001Func001Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_Difficultybuttons[6] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Func001Func002Func001Func001Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_Difficultybuttons[5] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Func001Func002Func001Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_Difficultybuttons[4] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Func001Func002Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_Difficultybuttons[3] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Func001Func002C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_Difficultybuttons[2] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_Difficultybuttons[1] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Actions takes nothing returns nothing
    if ( Trig_Button_Clicked_Func001C() ) then
        set udg_VoteCounter[1] = ( udg_VoteCounter[1] + 0 )
        set udg_VoteCounter[2] = ( udg_VoteCounter[2] + 1 )
        call DialogDisplayBJ( true, udg_Race, GetTriggerPlayer() )
    else
        if ( Trig_Button_Clicked_Func001Func002C() ) then
            set udg_VoteCounter[1] = ( udg_VoteCounter[1] + 1 )
            set udg_VoteCounter[2] = ( udg_VoteCounter[2] + 1 )
            call DialogDisplayBJ( true, udg_Race, GetTriggerPlayer() )
        else
            if ( Trig_Button_Clicked_Func001Func002Func001C() ) then
                set udg_VoteCounter[1] = ( udg_VoteCounter[1] + 2 )
                set udg_VoteCounter[2] = ( udg_VoteCounter[2] + 1 )
                call DialogDisplayBJ( true, udg_Race, GetTriggerPlayer() )
            else
                if ( Trig_Button_Clicked_Func001Func002Func001Func001C() ) then
                    set udg_VoteCounter[1] = ( udg_VoteCounter[1] + 3 )
                    set udg_VoteCounter[2] = ( udg_VoteCounter[2] + 1 )
                    call DialogDisplayBJ( true, udg_Race, GetTriggerPlayer() )
                else
                    if ( Trig_Button_Clicked_Func001Func002Func001Func001Func001C() ) then
                        set udg_VoteCounter[1] = ( udg_VoteCounter[1] + 4 )
                        set udg_VoteCounter[2] = ( udg_VoteCounter[2] + 1 )
                        call DialogDisplayBJ( true, udg_Race, GetTriggerPlayer() )
                    else
                        if ( Trig_Button_Clicked_Func001Func002Func001Func001Func001Func001C() ) then
                            set udg_VoteCounter[1] = ( udg_VoteCounter[1] + 5 )
                            set udg_VoteCounter[2] = ( udg_VoteCounter[2] + 1 )
                            call DialogDisplayBJ( true, udg_Race, GetTriggerPlayer() )
                        else
                            if ( Trig_Button_Clicked_Func001Func002Func001Func001Func001Func001Func001C() ) then
                                set udg_VoteCounter[1] = ( udg_VoteCounter[1] + 6 )
                                set udg_VoteCounter[2] = ( udg_VoteCounter[2] + 1 )
                                call DialogDisplayBJ( true, udg_Race, GetTriggerPlayer() )
                            else
                                if ( Trig_Button_Clicked_Func001Func002Func001Func001Func001Func001Func001Func001C() ) then
                                    set udg_VoteCounter[1] = ( udg_VoteCounter[1] + 7 )
                                    set udg_VoteCounter[2] = ( udg_VoteCounter[2] + 1 )
                                    call DialogDisplayBJ( true, udg_Race, GetTriggerPlayer() )
                                else
                                    if ( Trig_Button_Clicked_Func001Func002Func001Func001Func001Func001Func001Func001Func001C() ) then
                                        call DialogDisplayBJ( true, udg_Race, GetTriggerPlayer() )
                                    else
                                        call DialogDisplayBJ( true, udg_Difficulty, GetTriggerPlayer() )
                                    endif
                                endif
                            endif
                        endif
                    endif
                endif
            endif
        endif
    endif
endfunction

//===========================================================================
function InitTrig_Button_Clicked takes nothing returns nothing
    set gg_trg_Button_Clicked = CreateTrigger(  )
    call TriggerRegisterDialogEventBJ( gg_trg_Button_Clicked, udg_Difficulty )
    call TriggerAddAction( gg_trg_Button_Clicked, function Trig_Button_Clicked_Actions )
endfunction

//===========================================================================
// Trigger: Button Clicked Race
//===========================================================================
function Trig_Button_Clicked_Race_Func001Func001Func002001 takes nothing returns boolean
    return ( udg_Random == 1 )
endfunction

function Trig_Button_Clicked_Race_Func001Func001Func003C takes nothing returns boolean
    if ( not ( udg_HeroRace[GetConvertedPlayerId(GetTriggerPlayer())] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Race_Func001Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_RaceButtons[2] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Race_Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_RaceButtons[1] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Race_Actions takes nothing returns nothing
    if ( Trig_Button_Clicked_Race_Func001C() ) then
        set udg_Empire[GetConvertedPlayerId(GetTriggerPlayer())] = 1
        call DialogDisplayBJ( true, udg_Profile, GetTriggerPlayer() )
    else
        if ( Trig_Button_Clicked_Race_Func001Func001C() ) then
            set udg_HeroRace[GetConvertedPlayerId(GetTriggerPlayer())] = 1
            call DialogDisplayBJ( true, udg_Class, GetTriggerPlayer() )
        else
            set udg_Random = GetRandomInt(1, 2)
            if ( Trig_Button_Clicked_Race_Func001Func001Func002001() ) then
                set udg_Empire[GetConvertedPlayerId(GetTriggerPlayer())] = 1
            else
                set udg_HeroRace[GetConvertedPlayerId(GetTriggerPlayer())] = 1
            endif
            if ( Trig_Button_Clicked_Race_Func001Func001Func003C() ) then
                call DialogDisplayBJ( true, udg_Class, GetTriggerPlayer() )
            else
                call DialogDisplayBJ( true, udg_Profile, GetTriggerPlayer() )
            endif
        endif
    endif
endfunction

//===========================================================================
function InitTrig_Button_Clicked_Race takes nothing returns nothing
    set gg_trg_Button_Clicked_Race = CreateTrigger(  )
    call TriggerRegisterDialogEventBJ( gg_trg_Button_Clicked_Race, udg_Race )
    call TriggerAddAction( gg_trg_Button_Clicked_Race, function Trig_Button_Clicked_Race_Actions )
endfunction

//===========================================================================
// Trigger: Button Clicked Class
//===========================================================================
function Trig_Button_Clicked_Class_Func001Func001Func001Func001Func001Func001Func001Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_ClassButtons[7] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Class_Func001Func001Func001Func001Func001Func001Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_ClassButtons[6] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Class_Func001Func001Func001Func001Func001Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_ClassButtons[5] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Class_Func001Func001Func001Func001Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_ClassButtons[4] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Class_Func001Func001Func001Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_ClassButtons[3] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Class_Func001Func001Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_ClassButtons[2] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Class_Func001Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_ClassButtons[1] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Class_Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_ClassButtons[0] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Class_Actions takes nothing returns nothing
    if ( Trig_Button_Clicked_Class_Func001C() ) then
        set udg_ClassNumber[GetConvertedPlayerId(GetTriggerPlayer())] = GetRandomInt(1, 7)
    else
        if ( Trig_Button_Clicked_Class_Func001Func001C() ) then
            set udg_ClassNumber[GetConvertedPlayerId(GetTriggerPlayer())] = 1
        else
            if ( Trig_Button_Clicked_Class_Func001Func001Func001C() ) then
                set udg_ClassNumber[GetConvertedPlayerId(GetTriggerPlayer())] = 2
            else
                if ( Trig_Button_Clicked_Class_Func001Func001Func001Func001C() ) then
                    set udg_ClassNumber[GetConvertedPlayerId(GetTriggerPlayer())] = 3
                else
                    if ( Trig_Button_Clicked_Class_Func001Func001Func001Func001Func001C() ) then
                        set udg_ClassNumber[GetConvertedPlayerId(GetTriggerPlayer())] = 4
                    else
                        if ( Trig_Button_Clicked_Class_Func001Func001Func001Func001Func001Func001C() ) then
                            set udg_ClassNumber[GetConvertedPlayerId(GetTriggerPlayer())] = 5
                        else
                            if ( Trig_Button_Clicked_Class_Func001Func001Func001Func001Func001Func001Func001C() ) then
                                set udg_ClassNumber[GetConvertedPlayerId(GetTriggerPlayer())] = 6
                            else
                                if ( Trig_Button_Clicked_Class_Func001Func001Func001Func001Func001Func001Func001Func001C() ) then
                                    set udg_ClassNumber[GetConvertedPlayerId(GetTriggerPlayer())] = 7
                                else
                                endif
                            endif
                        endif
                    endif
                endif
            endif
        endif
    endif
    call DialogDisplayBJ( true, udg_Mode, GetTriggerPlayer() )
endfunction

//===========================================================================
function InitTrig_Button_Clicked_Class takes nothing returns nothing
    set gg_trg_Button_Clicked_Class = CreateTrigger(  )
    call TriggerRegisterDialogEventBJ( gg_trg_Button_Clicked_Class, udg_Class )
    call TriggerAddAction( gg_trg_Button_Clicked_Class, function Trig_Button_Clicked_Class_Actions )
endfunction

//===========================================================================
// Trigger: Button Clicked Profile
//===========================================================================
function Trig_Button_Clicked_Profile_Func001Func001Func001Func001Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_ProfileButtons[4] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Profile_Func001Func001Func001Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_ProfileButtons[3] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Profile_Func001Func001Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_ProfileButtons[2] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Profile_Func001Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_ProfileButtons[1] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Profile_Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_ProfileButtons[0] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Profile_Actions takes nothing returns nothing
    if ( Trig_Button_Clicked_Profile_Func001C() ) then
        set udg_EmpireProfile[GetConvertedPlayerId(GetTriggerPlayer())] = GetRandomInt(1, 5)
    else
        if ( Trig_Button_Clicked_Profile_Func001Func001C() ) then
            set udg_EmpireProfile[GetConvertedPlayerId(GetTriggerPlayer())] = 1
        else
            if ( Trig_Button_Clicked_Profile_Func001Func001Func001C() ) then
                set udg_EmpireProfile[GetConvertedPlayerId(GetTriggerPlayer())] = 2
            else
                if ( Trig_Button_Clicked_Profile_Func001Func001Func001Func001C() ) then
                    set udg_EmpireProfile[GetConvertedPlayerId(GetTriggerPlayer())] = 3
                else
                    if ( Trig_Button_Clicked_Profile_Func001Func001Func001Func001Func001C() ) then
                        set udg_EmpireProfile[GetConvertedPlayerId(GetTriggerPlayer())] = 4
                    else
                    endif
                endif
            endif
        endif
    endif
endfunction

//===========================================================================
function InitTrig_Button_Clicked_Profile takes nothing returns nothing
    set gg_trg_Button_Clicked_Profile = CreateTrigger(  )
    call TriggerRegisterDialogEventBJ( gg_trg_Button_Clicked_Profile, udg_Profile )
    call TriggerAddAction( gg_trg_Button_Clicked_Profile, function Trig_Button_Clicked_Profile_Actions )
endfunction

//===========================================================================
// Trigger: Button Clicked Mode
//===========================================================================
function Trig_Button_Clicked_Mode_Func001Func001Func002Func002C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_ModeButtons[3] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Mode_Func001Func001Func002C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_ModeButtons[2] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Mode_Func001Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_ModeButtons[1] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Mode_Func001C takes nothing returns boolean
    if ( not ( GetClickedButtonBJ() == udg_ModeButtons[0] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Button_Clicked_Mode_Actions takes nothing returns nothing
    if ( Trig_Button_Clicked_Mode_Func001C() ) then
        set udg_Random = GetRandomInt(1, 3)
        set udg_HeroType[GetConvertedPlayerId(GetTriggerPlayer())] = udg_Random
    else
        if ( Trig_Button_Clicked_Mode_Func001Func001C() ) then
            set udg_HeroType[GetConvertedPlayerId(GetTriggerPlayer())] = 1
        else
            if ( Trig_Button_Clicked_Mode_Func001Func001Func002C() ) then
                set udg_HeroType[GetConvertedPlayerId(GetTriggerPlayer())] = 2
            else
                if ( Trig_Button_Clicked_Mode_Func001Func001Func002Func002C() ) then
                    set udg_HeroType[GetConvertedPlayerId(GetTriggerPlayer())] = 3
                else
                endif
            endif
        endif
    endif
endfunction

//===========================================================================
function InitTrig_Button_Clicked_Mode takes nothing returns nothing
    set gg_trg_Button_Clicked_Mode = CreateTrigger(  )
    call TriggerRegisterDialogEventBJ( gg_trg_Button_Clicked_Mode, udg_Mode )
    call TriggerAddAction( gg_trg_Button_Clicked_Mode, function Trig_Button_Clicked_Mode_Actions )
endfunction

//===========================================================================
// Trigger: Victory Kalenden Death
//===========================================================================
function Trig_Victory_Kalenden_Death_Actions takes nothing returns nothing
    call CustomVictoryBJ( Player(0), true, true )
    call CustomVictoryBJ( Player(1), true, true )
    call CustomVictoryBJ( Player(2), true, true )
    call CustomVictoryBJ( Player(3), true, true )
    call CustomVictoryBJ( Player(4), true, true )
    call CustomVictoryBJ( Player(5), true, true )
    call CustomVictoryBJ( Player(6), true, true )
    call CustomVictoryBJ( Player(7), true, true )
    call CustomVictoryBJ( Player(8), true, true )
    call CustomVictoryBJ( Player(9), true, true )
    call PlaySoundBJ( gg_snd_Credits )
endfunction

//===========================================================================
function InitTrig_Victory_Kalenden_Death takes nothing returns nothing
    set gg_trg_Victory_Kalenden_Death = CreateTrigger(  )
    call TriggerRegisterUnitEvent( gg_trg_Victory_Kalenden_Death, gg_unit_n00N_0026, EVENT_UNIT_DEATH )
    call TriggerAddAction( gg_trg_Victory_Kalenden_Death, function Trig_Victory_Kalenden_Death_Actions )
endfunction

//===========================================================================
// Trigger: Grace Periode End
//===========================================================================
function Trig_Grace_Periode_End_Func013Func001Func004A takes nothing returns nothing
local unit u = GetEnumUnit()
if GetUnitTypeId(u) != 'h02W' then
call SetUnitInvulnerable( u, false )
endif
set u = null
endfunction

function Trig_Grace_Periode_End_Actions takes nothing returns nothing
local integer i = 0
local group g
    call StartTimerBJ( udg_SpawnUp, false, ( 120.00 - ( I2R(CountPlayersInForceBJ(udg_AttackerGroup)) * 10.00 ) ) )
    call DestroyTrigger(gg_trg_Multiboard_Hero)
    call DestroyTrigger(gg_trg_Multiboard_Empire)
    set udg_Damageunits = 1
    call PlaySoundBJ( gg_snd_Warning )
    call DisplayTimedTextToForce( GetPlayersAll(), 10.00, "|cffFF0000Grace period ended!" )
    call DestroyTimerDialogBJ( udg_startingwindow )
    set i = 1
    loop
        exitwhen i > 10
        if udg_Empire[i] == 1 then
        set g = GetUnitsOfPlayerAll(ConvertedPlayer(i))
        call ForGroupBJ( g, function Trig_Grace_Periode_End_Func013Func001Func004A )
        call DestroyGroup( g )
        endif
        set i = i + 1
    endloop
    set g = null
    call DestroyTrigger(GetTriggeringTrigger())
endfunction

//===========================================================================
function InitTrig_Grace_Periode_End takes nothing returns nothing
    set gg_trg_Grace_Periode_End = CreateTrigger(  )
    call TriggerRegisterTimerExpireEventBJ( gg_trg_Grace_Periode_End, udg_GracePeriode )
    call TriggerAddAction( gg_trg_Grace_Periode_End, function Trig_Grace_Periode_End_Actions )
endfunction

//===========================================================================
// Trigger: Multiboard Hero
//===========================================================================
function Trig_Multiboard_Hero_Actions takes nothing returns nothing
    call CreateMultiboardBJ( 3, 11, ( GetPlayerName(udg_player) + "'s Hero" ) )
    call MultiboardMinimizeBJ( false, GetLastCreatedMultiboard() )
    call MultiboardDisplayBJ( false, GetLastCreatedMultiboard() )
    set udg_PlayerMultiboard[GetConvertedPlayerId(udg_player)] = GetLastCreatedMultiboard()
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 1, 0, 12.00 )
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 2, 0, 3.00 )
    call MultiboardSetItemStyleBJ( GetLastCreatedMultiboard(), 0, 0, true, false )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 1, 1, "TRIGSTR_4390" )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 1, "TRIGSTR_4391" )
    call MultiboardSetItemColorBJ( GetLastCreatedMultiboard(), 0, 1, 100.00, 0.00, 100.00, 0 )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 1, 2, "TRIGSTR_4392" )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 2, "TRIGSTR_4393" )
    call MultiboardSetItemColorBJ( GetLastCreatedMultiboard(), 0, 2, 80.00, 80.00, 0.00, 0 )
    set udg_Attributepoints[GetConvertedPlayerId(udg_player)] = 1
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 1, 3, "TRIGSTR_4394" )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 3, "TRIGSTR_4395" )
    call MultiboardSetItemColorBJ( GetLastCreatedMultiboard(), 0, 3, 100.00, 0.00, 0.00, 0 )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 1, 4, "TRIGSTR_4396" )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 4, "TRIGSTR_4395" )
    call MultiboardSetItemColorBJ( GetLastCreatedMultiboard(), 0, 4, 100.00, 0.00, 0.00, 0 )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 1, 5, "TRIGSTR_4398" )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 5, "TRIGSTR_4395" )
    call MultiboardSetItemColorBJ( GetLastCreatedMultiboard(), 0, 5, 100.00, 0.00, 0.00, 0 )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 1, 6, "TRIGSTR_4400" )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 6, "TRIGSTR_4395" )
    call MultiboardSetItemColorBJ( GetLastCreatedMultiboard(), 0, 6, 100.00, 0.00, 0.00, 0 )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 1, 7, "TRIGSTR_4402" )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 7, "TRIGSTR_4395" )
    call MultiboardSetItemColorBJ( GetLastCreatedMultiboard(), 0, 7, 100.00, 0.00, 0.00, 0 )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 1, 8, "TRIGSTR_4404" )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 8, "TRIGSTR_4395" )
    call MultiboardSetItemColorBJ( GetLastCreatedMultiboard(), 0, 8, 100.00, 0.00, 0.00, 0 )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 1, 9, "TRIGSTR_4406" )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 9, "TRIGSTR_4395" )
    call MultiboardSetItemColorBJ( GetLastCreatedMultiboard(), 0, 9, 100.00, 0.00, 0.00, 0 )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 1, 10, "TRIGSTR_4408" )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 10, "TRIGSTR_4395" )
    call MultiboardSetItemColorBJ( GetLastCreatedMultiboard(), 0, 10, 100.00, 0.00, 0.00, 0 )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 1, 11, "TRIGSTR_4410" )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 11, "TRIGSTR_4395" )
    call MultiboardSetItemColorBJ( GetLastCreatedMultiboard(), 0, 11, 0.00, 100.00, 0.00, 0 )
endfunction

//===========================================================================
function InitTrig_Multiboard_Hero takes nothing returns nothing
    set gg_trg_Multiboard_Hero = CreateTrigger(  )
    call TriggerAddAction( gg_trg_Multiboard_Hero, function Trig_Multiboard_Hero_Actions )
endfunction

//===========================================================================
// Trigger: Multiboard Empire
//===========================================================================
function Trig_Multiboard_Empire_Func102001 takes nothing returns boolean
    return ( udg_EmpireProfile[GetConvertedPlayerId(udg_player)] == 1 )
endfunction

function Trig_Multiboard_Empire_Func103001 takes nothing returns boolean
    return ( udg_EmpireProfile[GetConvertedPlayerId(udg_player)] == 2 )
endfunction

function Trig_Multiboard_Empire_Func104001 takes nothing returns boolean
    return ( udg_EmpireProfile[GetConvertedPlayerId(udg_player)] == 3 )
endfunction

function Trig_Multiboard_Empire_Func105001 takes nothing returns boolean
    return ( udg_EmpireProfile[GetConvertedPlayerId(udg_player)] == 4 )
endfunction

function Trig_Multiboard_Empire_Func106001 takes nothing returns boolean
    return ( udg_EmpireProfile[GetConvertedPlayerId(udg_player)] == 5 )
endfunction

function Trig_Multiboard_Empire_Actions takes nothing returns nothing
    call SetPlayerTechMaxAllowedSwap( 'R017', 0, udg_player )
    call SetPlayerTechMaxAllowedSwap( 'R018', 0, udg_player )
    call SetPlayerTechMaxAllowedSwap( 'R019', 0, udg_player )
    call SetPlayerTechMaxAllowedSwap( 'R01A', 0, udg_player )
    call SetPlayerTechMaxAllowedSwap( 'R01B', 0, udg_player )
    call SetPlayerTechMaxAllowedSwap( 'R01C', 0, udg_player )
    call SetPlayerTechMaxAllowedSwap( 'R01D', 0, udg_player )
    call SetPlayerTechMaxAllowedSwap( 'R01E', 0, udg_player )
    call SetPlayerTechMaxAllowedSwap( 'R01F', 0, udg_player )
    call SetPlayerTechMaxAllowedSwap( 'R01G', 0, udg_player )
    call SetPlayerTechMaxAllowedSwap( 'R01H', 0, udg_player )
    call SetPlayerTechMaxAllowedSwap( 'R01I', 0, udg_player )
    call SetPlayerTechMaxAllowedSwap( 'R01J', 0, udg_player )
    call SetPlayerTechMaxAllowedSwap( 'R01K', 0, udg_player )
    call SetPlayerTechMaxAllowedSwap( 'R01L', 0, udg_player )
    call SetPlayerTechMaxAllowedSwap( 'R01M', 0, udg_player )
    call SetPlayerTechMaxAllowedSwap( 'R01N', 0, udg_player )
    call SetPlayerTechMaxAllowedSwap( 'R01O', 0, udg_player )
    set udg_Townhallsettings1[GetConvertedPlayerId(udg_player)] = 0
    set udg_Townhallsettings2[GetConvertedPlayerId(udg_player)] = 0
    set udg_Townhallsettings3[GetConvertedPlayerId(udg_player)] = 0
    set udg_Townhallsettings4[GetConvertedPlayerId(udg_player)] = 100
    call SetPlayerTechMaxAllowedSwap( 'h01E', 1, udg_player )
    set udg_Tax[GetConvertedPlayerId(udg_player)] = 1
    call AdjustPlayerStateBJ( 700, udg_player, PLAYER_STATE_RESOURCE_GOLD )
    call AdjustPlayerStateBJ( 6000, udg_player, PLAYER_STATE_RESOURCE_LUMBER )
    set udg_Empire[GetConvertedPlayerId(udg_player)] = 1
    set udg_Rations[GetConvertedPlayerId(udg_player)] = 6
    set udg_food[GetConvertedPlayerId(udg_player)] = 20000
    set udg_happyness[GetConvertedPlayerId(udg_player)] = 450
    set udg_CurrentAge[GetConvertedPlayerId(udg_player)] = 1
    // Happiness
    call CreateMultiboardBJ( 20, 17, ( GetPlayerName(udg_player) + "'s Empire" ) )
    call MultiboardMinimizeBJ( false, GetLastCreatedMultiboard() )
    call MultiboardDisplayBJ( false, GetLastCreatedMultiboard() )
    set udg_PlayerMultiboard[GetConvertedPlayerId(udg_player)] = GetLastCreatedMultiboard()
    call MultiboardSetItemStyleBJ( GetLastCreatedMultiboard(), 0, 0, true, false )
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 0, 0, 0.00 )
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 1, 1, 7.00 )
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 2, 1, 6.00 )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 1, 1, "TRIGSTR_4412" )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 1, "TRIGSTR_4413" )
    call MultiboardSetItemColorBJ( GetLastCreatedMultiboard(), 0, 1, 50.00, 50.00, 0.00, 0 )
    // Ages
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 1, 2, 7.00 )
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 2, 2, 6.00 )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 1, 2, "TRIGSTR_4414" )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 2, "TRIGSTR_4415" )
    call MultiboardSetItemColorBJ( GetLastCreatedMultiboard(), 0, 2, 75.00, 75.00, 75.00, 0 )
    // Food
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 1, 3, 7.00 )
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 2, 3, 6.00 )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 1, 3, "TRIGSTR_4416" )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 3, I2S(udg_food[GetConvertedPlayerId(udg_player)]) )
    call MultiboardSetItemColorBJ( GetLastCreatedMultiboard(), 0, 3, 0.00, 75.00, 75.00, 0 )
    // Citizens
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 1, 4, 7.00 )
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 2, 4, 6.00 )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 1, 4, "TRIGSTR_4417" )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 4, "TRIGSTR_4395" )
    call MultiboardSetItemColorBJ( GetLastCreatedMultiboard(), 0, 4, 0.00, 75.00, 75.00, 0 )
    // Tax
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 1, 5, 7.00 )
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 2, 5, 6.00 )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 1, 5, "TRIGSTR_4419" )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 5, I2S(udg_Tax[GetConvertedPlayerId(udg_player)]) )
    call MultiboardSetItemColorBJ( GetLastCreatedMultiboard(), 0, 5, 90.00, 90.00, 0.00, 0 )
    // Rations
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 1, 6, 7.00 )
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 2, 6, 6.00 )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 1, 6, "TRIGSTR_4420" )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 6, I2S(udg_Rations[GetConvertedPlayerId(udg_player)]) )
    call MultiboardSetItemColorBJ( GetLastCreatedMultiboard(), 0, 6, 75.00, 50.00, 50.00, 0 )
    // Nothing
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 1, 7, 7.00 )
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 2, 7, 6.00 )
    // Research
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 1, 8, 13.00 )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 1, 8, "TRIGSTR_4421" )
    call MultiboardSetItemColorBJ( GetLastCreatedMultiboard(), 0, 8, 80.00, 80.00, 10.00, 0 )
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 1, 9, 7.00 )
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 2, 9, 6.00 )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 1, 9, "TRIGSTR_4422" )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 9, "TRIGSTR_4334" )
    call MultiboardSetItemColorBJ( GetLastCreatedMultiboard(), 0, 9, 50.00, 50.00, 50.00, 0 )
    call MultiboardAddBar( GetLastCreatedMultiboard(), 10 )
    // Nothing
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 1, 11, 7.00 )
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 2, 11, 6.00 )
    // Power
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 1, 12, 13.00 )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 1, 12, "TRIGSTR_4424" )
    call MultiboardSetItemColorBJ( GetLastCreatedMultiboard(), 0, 12, 80.00, 80.00, 10.00, 0 )
    call MultiboardAddBar( GetLastCreatedMultiboard(), 13 )
    // Nothing
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 1, 14, 7.00 )
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 2, 14, 6.00 )
    // Profile
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 1, 15, 7.00 )
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 2, 15, 6.00 )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 1, 15, "TRIGSTR_4283" )
    if ( Trig_Multiboard_Empire_Func102001() ) then
        call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 15, "TRIGSTR_4286" )
    else
        call DoNothing(  )
    endif
    if ( Trig_Multiboard_Empire_Func103001() ) then
        call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 15, "TRIGSTR_4287" )
    else
        call DoNothing(  )
    endif
    if ( Trig_Multiboard_Empire_Func104001() ) then
        call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 15, "TRIGSTR_4288" )
    else
        call DoNothing(  )
    endif
    if ( Trig_Multiboard_Empire_Func105001() ) then
        call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 15, "TRIGSTR_4289" )
    else
        call DoNothing(  )
    endif
    if ( Trig_Multiboard_Empire_Func106001() ) then
        call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 15, "TRIGSTR_4290" )
    else
        call DoNothing(  )
    endif
    call MultiboardSetItemColorBJ( GetLastCreatedMultiboard(), 0, 15, 0.00, 0.00, 100.00, 0 )
    // Hero Payment
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 1, 16, 7.00 )
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 2, 16, 6.00 )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 1, 16, "TRIGSTR_4496" )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 16, "TRIGSTR_4497" )
    call MultiboardSetItemColorBJ( GetLastCreatedMultiboard(), 0, 16, 100.00, 0.00, 0.00, 0 )
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 1, 17, 7.00 )
    call MultiboardSetItemWidthBJ( GetLastCreatedMultiboard(), 2, 17, 6.00 )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 1, 17, "TRIGSTR_4498" )
    call MultiboardSetItemValueBJ( GetLastCreatedMultiboard(), 2, 17, "TRIGSTR_4334" )
    call MultiboardSetItemColorBJ( GetLastCreatedMultiboard(), 0, 17, 100.00, 0.00, 0.00, 0 )
endfunction

//===========================================================================
function InitTrig_Multiboard_Empire takes nothing returns nothing
    set gg_trg_Multiboard_Empire = CreateTrigger(  )
    call TriggerAddAction( gg_trg_Multiboard_Empire, function Trig_Multiboard_Empire_Actions )
endfunction

//===========================================================================
// Trigger: Defeat check
//===========================================================================
function Trig_Defeat_check_Func001C takes nothing returns boolean
    if ( not ( CountPlayersInForceBJ(udg_AttackerGroup) == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Defeat_check_Actions takes nothing returns nothing
    if ( Trig_Defeat_check_Func001C() ) then
        call DisplayTimedTextToForce( GetPlayersAll(), 10.00, "TRIGSTR_4500" )
        call PolledWait( 60.00 )
        call CustomDefeatBJ( Player(0), "TRIGSTR_4502" )
        call CustomDefeatBJ( Player(1), "TRIGSTR_4502" )
        call CustomDefeatBJ( Player(2), "TRIGSTR_4502" )
        call CustomDefeatBJ( Player(3), "TRIGSTR_4502" )
        call CustomDefeatBJ( Player(4), "TRIGSTR_4502" )
        call CustomDefeatBJ( Player(5), "TRIGSTR_4502" )
        call CustomDefeatBJ( Player(6), "TRIGSTR_4502" )
        call CustomDefeatBJ( Player(7), "TRIGSTR_4502" )
        call CustomDefeatBJ( Player(8), "TRIGSTR_4502" )
        call CustomDefeatBJ( Player(9), "TRIGSTR_4502" )
        call CustomVictoryBJ( Player(10), false, false )
        call CustomVictoryBJ( Player(11), false, false )
    else
    endif
endfunction

//===========================================================================
function InitTrig_Defeat_check takes nothing returns nothing
    set gg_trg_Defeat_check = CreateTrigger(  )
    call TriggerAddAction( gg_trg_Defeat_check, function Trig_Defeat_check_Actions )
endfunction

//===========================================================================
// Trigger: Unpack
//===========================================================================
function Trig_Unpack_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A00A' then
return true
endif
return false
endfunction

function Trig_Unpack_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local unit u2 = null
local location l = GetUnitLoc(u)
local player p = GetOwningPlayer(u)
local integer i = 0

call CreateNUnitsAtLoc( 1, 'h023', p, l, bj_UNIT_FACING )
set u2 = GetLastCreatedUnit()
call SetUnitInvulnerable( u2, true )
call CreateNUnitsAtLoc( 1, 'h023', p, l, bj_UNIT_FACING )
set u2 = GetLastCreatedUnit()
call SetUnitInvulnerable( u2, true )
call CreateNUnitsAtLoc( 1, 'h023', p, l, bj_UNIT_FACING )
set u2 = GetLastCreatedUnit()
call SetUnitInvulnerable( u2, true )
call CreateNUnitsAtLoc( 1, 'h023', p, l, bj_UNIT_FACING )
set u2 = GetLastCreatedUnit()
call SetUnitInvulnerable( u2, true )
call CreateNUnitsAtLoc( 1, 'h023', p, l, bj_UNIT_FACING )
set u2 = GetLastCreatedUnit()
call SetUnitInvulnerable( u2, true )

call CreateNUnitsAtLoc( 5, 'h008', p, l, bj_UNIT_FACING )
call CreateNUnitsAtLoc( 5, 'h00H', p, l, bj_UNIT_FACING )

call PanCameraToTimedLocForPlayer( p, l, 0 )
call KillUnit( u )

call RemoveLocation( l )
set l = null
set p = null
set u = null
set u2 = null
endfunction

//===========================================================================
function InitTrig_Unpack takes nothing returns nothing
    set gg_trg_Unpack = CreateTrigger(  )
    call TriggerRegisterAnyUnitEventBJ( gg_trg_Unpack, EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Unpack, Condition( function Trig_Unpack_Conditions ) )
    call TriggerAddAction( gg_trg_Unpack, function Trig_Unpack_Actions )
endfunction

//===========================================================================
// Trigger: Not allowed
//===========================================================================
function Trig_Not_allowed_Conditions takes nothing returns boolean
if GetUnitTypeId(GetEnteringUnit()) == 'h01S' then
return true
endif
return false
endfunction

function Trig_Not_allowed_Actions takes nothing returns nothing
local location l = GetRectCenter(gg_rct_Start_Builder)
local unit u = GetEnteringUnit()
local player p = GetOwningPlayer(u)
call SetUnitPositionLoc( u, l )
call PanCameraToTimedLocForPlayer( p, l, 0 )
call PlaySoundForPlayer( p, gg_snd_Warning )
call DisplayTimedTextToForce( GetForceOfPlayer(p), 10.00, "|c00ff0000You are not allowed to come there!" )
call RemoveLocation(l)
set l = null
set u = null
set p = null
endfunction

//===========================================================================
function InitTrig_Not_allowed takes nothing returns nothing
    set gg_trg_Not_allowed = CreateTrigger(  )
    call TriggerRegisterEnterRectSimple( gg_trg_Not_allowed, gg_rct_Kalenden_Area )
    call TriggerRegisterEnterRectSimple( gg_trg_Not_allowed, gg_rct_no_enter1 )
    call TriggerRegisterEnterRectSimple( gg_trg_Not_allowed, gg_rct_no_enter2 )
    call TriggerAddCondition( gg_trg_Not_allowed, Condition( function Trig_Not_allowed_Conditions ) )
    call TriggerAddAction( gg_trg_Not_allowed, function Trig_Not_allowed_Actions )
endfunction

//===========================================================================
// Trigger: House Grow
//===========================================================================
function Fireman takes nothing returns nothing
local unit u = GetEnumUnit()
local location l = GetUnitLoc(u)
local player p = GetOwningPlayer(u)
local unit u2 = null
call CreateNUnitsAtLoc( 1, 'n01G', p, l, bj_UNIT_FACING )
set u2 = GetLastCreatedUnit()
call SetUnitUserData( u2, udg_Fires )
call UnitApplyTimedLifeBJ( 30.00, 'BTLF', u2 )
call PlaySoundForPlayer( p, gg_snd_Fire )
call RemoveLocation( l )
set l = null
set u = null
set u2 = null
set p = null
endfunction

function Upgrading takes unit u returns nothing
local unit u2 = null
local integer i = 0
local player p = GetOwningPlayer(u)
local integer Pnumb = GetConvertedPlayerId(p)
set p = null
if udg_CurrentAge[Pnumb] >= 18 and GetUnitTypeId(u) == 'h02C' then
call GroupRemoveUnitSimple( u, udg_Houses )
set i = R2I(GetUnitLifePercent(u))
call ReplaceUnitBJ( u, 'h02D', bj_UNIT_STATE_METHOD_ABSOLUTE )
set u2 = GetLastReplacedUnitBJ()
call SetUnitLifePercentBJ( u2, I2R(i) )
call GroupAddUnitSimple( u2, udg_Houses )
set u2 = null
return
endif
if udg_CurrentAge[Pnumb] >= 13 and GetUnitTypeId(u) == 'h022' then
call GroupRemoveUnitSimple( u, udg_Houses )
set i = R2I(GetUnitLifePercent(u))
call ReplaceUnitBJ( u, 'h02C', bj_UNIT_STATE_METHOD_ABSOLUTE )
set u2 = GetLastReplacedUnitBJ()
call SetUnitLifePercentBJ( u2, I2R(i) )
call GroupAddUnitSimple( u2, udg_Houses )
set u2 = null
return
endif
if udg_CurrentAge[Pnumb] >= 9 and GetUnitTypeId(u) == 'h021' then
call GroupRemoveUnitSimple( u, udg_Houses )
set i = R2I(GetUnitLifePercent(u))
call ReplaceUnitBJ( u, 'h022', bj_UNIT_STATE_METHOD_ABSOLUTE )
set u2 = GetLastReplacedUnitBJ()
call SetUnitLifePercentBJ( u2, I2R(i) )
call GroupAddUnitSimple( u2, udg_Houses )
set u2 = null
return
endif
if udg_CurrentAge[Pnumb] >= 6 and GetUnitTypeId(u) == 'h02A' then
call GroupRemoveUnitSimple( u, udg_Houses )
set i = R2I(GetUnitLifePercent(u))
call ReplaceUnitBJ( u, 'h021', bj_UNIT_STATE_METHOD_ABSOLUTE )
set u2 = GetLastReplacedUnitBJ()
call SetUnitLifePercentBJ( u2, I2R(i) )
call GroupAddUnitSimple( u2, udg_Houses )
set u2 = null
return
endif
if udg_CurrentAge[Pnumb] >= 4 and GetUnitTypeId(u) == 'h002' then
call GroupRemoveUnitSimple( u, udg_Houses )
set i = R2I(GetUnitLifePercent(u))
call ReplaceUnitBJ( u, 'h02A', bj_UNIT_STATE_METHOD_ABSOLUTE )
set u2 = GetLastReplacedUnitBJ()
call SetUnitLifePercentBJ( u2, I2R(i) )
call GroupAddUnitSimple( u2, udg_Houses )
set u2 = null
return
endif
if udg_CurrentAge[Pnumb] >= 2 and GetUnitTypeId(u) == 'h02B' then
call GroupRemoveUnitSimple( u, udg_Houses )
set i = R2I(GetUnitLifePercent(u))
call ReplaceUnitBJ( u, 'h002', bj_UNIT_STATE_METHOD_ABSOLUTE )
set u2 = GetLastReplacedUnitBJ()
call SetUnitLifePercentBJ( u2, I2R(i) )
call GroupAddUnitSimple( u2, udg_Houses )
set u2 = null
return
endif
set u2 = null
endfunction

function Downgrading takes unit u returns nothing
local unit u2 = null
local integer i = 0
if GetUnitTypeId(u) == 'h002' then
call GroupRemoveUnitSimple( u, udg_Houses )
set i = R2I(GetUnitLifePercent(u))
call ReplaceUnitBJ( u, 'h02B', bj_UNIT_STATE_METHOD_ABSOLUTE )
set u2 = GetLastReplacedUnitBJ()
call SetUnitLifePercentBJ( u2, I2R(i) )
call GroupAddUnitSimple( u2, udg_Houses )
set u2 = null
return
endif
if GetUnitTypeId(u) == 'h02A' then
call GroupRemoveUnitSimple( u, udg_Houses )
set i = R2I(GetUnitLifePercent(u))
call ReplaceUnitBJ( u, 'h002', bj_UNIT_STATE_METHOD_ABSOLUTE )
set u2 = GetLastReplacedUnitBJ()
call SetUnitLifePercentBJ( u2, I2R(i) )
call GroupAddUnitSimple( u2, udg_Houses )
set u2 = null
return
endif
if GetUnitTypeId(u) == 'h021' then
call GroupRemoveUnitSimple( u, udg_Houses )
set i = R2I(GetUnitLifePercent(u))
call ReplaceUnitBJ( u, 'h02A', bj_UNIT_STATE_METHOD_ABSOLUTE )
set u2 = GetLastReplacedUnitBJ()
call SetUnitLifePercentBJ( u2, I2R(i) )
call GroupAddUnitSimple( u2, udg_Houses )
set u2 = null
return
endif
if GetUnitTypeId(u) == 'h022' then
call GroupRemoveUnitSimple( u, udg_Houses )
set i = R2I(GetUnitLifePercent(u))
call ReplaceUnitBJ( u, 'h021', bj_UNIT_STATE_METHOD_ABSOLUTE )
set u2 = GetLastReplacedUnitBJ()
call SetUnitLifePercentBJ( u2, I2R(i) )
call GroupAddUnitSimple( u2, udg_Houses )
set u2 = null
return
endif
if GetUnitTypeId(u) == 'h02C' then
call GroupRemoveUnitSimple( u, udg_Houses )
set i = R2I(GetUnitLifePercent(u))
call ReplaceUnitBJ( u, 'h022', bj_UNIT_STATE_METHOD_ABSOLUTE )
set u2 = GetLastReplacedUnitBJ()
call SetUnitLifePercentBJ( u2, I2R(i) )
call GroupAddUnitSimple( u2, udg_Houses )
set u2 = null
return
endif
if GetUnitTypeId(u) == 'h02D' then
call GroupRemoveUnitSimple( u, udg_Houses )
set i = R2I(GetUnitLifePercent(u))
call ReplaceUnitBJ( u, 'h02C', bj_UNIT_STATE_METHOD_ABSOLUTE )
set u2 = GetLastReplacedUnitBJ()
call SetUnitLifePercentBJ( u2, I2R(i) )
call GroupAddUnitSimple( u2, udg_Houses )
set u2 = null
return
endif
set u2 = null
endfunction

function House takes nothing returns nothing
local unit u = GetEnumUnit()
local player p = GetOwningPlayer(u)
set udg_Citizens[GetConvertedPlayerId(p)] = udg_Citizens[GetConvertedPlayerId(p)] + R2I(GetUnitStateSwap(UNIT_STATE_MANA, u))
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 4, I2S(udg_Citizens[GetConvertedPlayerId(p)]) )

if udg_Damageunits == 0 then
call SetUnitInvulnerable( u, true ) 
endif
        
//upgrade houses
if GetUnitStateSwap(UNIT_STATE_MANA, u) == GetUnitStateSwap(UNIT_STATE_MAX_MANA, u) then
call Upgrading(u)
endif

//downgrade houses
if GetUnitManaPercent(u) < 40.00 then
call Downgrading(u)
endif

if udg_food[GetConvertedPlayerId(p)] == 0 then
call SetUnitManaPercentBJ( u, ( GetUnitManaPercent(u) - 10.00 ) ) 
endif

call SetUnitManaBJ( u, ( GetUnitStateSwap(UNIT_STATE_MANA, u) + (((I2R(udg_happyness[GetConvertedPlayerId(p)]) / 250.00) + (I2R(udg_Townhallsettings4[GetConvertedPlayerId(p)]) / 7.50) - 15.00) * 4.00)))
if udg_Starving[GetConvertedPlayerId(p)] == 1 then
call SetUnitManaBJ( u, ( GetUnitStateSwap(UNIT_STATE_MANA, u) - 2.0))
call SetUnitManaPercentBJ( u, ( GetUnitManaPercent(u) - 10.00 ) )
endif

if udg_Plague == 1 then 
call SetUnitManaPercentBJ( u, GetUnitManaPercent(u) - 2.0)
endif

if udg_Plague == 2 then 
call SetUnitManaPercentBJ( u, GetUnitManaPercent(u) + 3.0)
endif

set p = null
set u = null
endfunction

function IsUnitHouse takes nothing returns boolean
local unit u = GetFilterUnit()
if GetUnitTypeId(u) == 'h022' or GetUnitTypeId(u) == 'h02A' or GetUnitTypeId(u) == 'h02B' or GetUnitTypeId(u) == 'h021' or GetUnitTypeId(u) == 'h02D' or GetUnitTypeId(u) == 'h002' or GetUnitTypeId(u) == 'h02C' then
set u = null
return true
endif
set u = null
return false
endfunction

function Trig_House_Grow_Actions takes nothing returns nothing
local integer i = 1
local integer i2 = GetRandomInt(1,40)
local player p = null
local location l = null
local unit u = null
local unit u2 = null
local group g
local group g2

loop
exitwhen i > 10
set p = ConvertedPlayer(i)
if GetPlayerSlotState(p) == PLAYER_SLOT_STATE_PLAYING and udg_Empire[i] == 1 and udg_StartedEmpire[i] == 1 then
set udg_Citizens[GetConvertedPlayerId(p)] = 0
endif
set i = i + 1
endloop

call ForGroupBJ( udg_Houses, function House )

set i = 1
loop
exitwhen i > 10
set p = ConvertedPlayer(i)
if i == i2 and udg_Damageunits == 1 and GetPlayerSlotState(p) == PLAYER_SLOT_STATE_PLAYING and udg_Empire[i] == 1 and udg_StartedEmpire[i] == 1 then
set g2 = GetUnitsOfPlayerMatching(p, Condition(function IsUnitHouse))
set u = GroupPickRandomUnit(g2)
set l = GetUnitLoc(u)
set udg_Fires = udg_Fires + 1
call PlaySoundForPlayer( p, gg_snd_Warning )
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000WARNING:|r |cffffcc00One of your houses has caught fire!" )
call CreateNUnitsAtLoc( 1, 'e00U', Player(PLAYER_NEUTRAL_AGGRESSIVE), l, bj_UNIT_FACING )
set u2 = GetLastCreatedUnit()
call SetUnitUserData( u2, udg_Fires )
call UnitApplyTimedLifeBJ( 30.00, 'BTLF', u2 )
call SetUnitLifePercentBJ( u2, 8.00 )
set g = GetUnitsOfPlayerAndTypeId(p, 'h01J')
call ForGroupBJ(g, function Fireman )
call DestroyGroup(g)
call DestroyGroup(g2)
call RemoveLocation(l)
endif
set i = i + 1
endloop

set g = null
set g2 = null
set l = null
set p = null
set u = null
set u2 = null
endfunction

//===========================================================================
function InitTrig_House_Grow takes nothing returns nothing
    set gg_trg_House_Grow = CreateTrigger(  )
    call TriggerRegisterTimerEventPeriodic( gg_trg_House_Grow, 7.50 )
    call TriggerAddAction( gg_trg_House_Grow, function Trig_House_Grow_Actions )
endfunction

//===========================================================================
// Trigger: Hire or Fire Hero
//===========================================================================
function Trig_Hire_or_Fire_Hero_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A003' and udg_HiringEmpire == 0 then
return true
endif
return false
endfunction

function Trig_Hire_or_Fire_Hero_Dialog takes nothing returns nothing
local player p = GetEnumPlayer()
local unit u = GetTriggerUnit()
local player p2 = GetOwningPlayer(u)
if IsPlayerAlly(p, p2) == true and udg_HeroRace[GetConvertedPlayerId(p)] == 1 then
call DialogAddButtonBJ( udg_EmpireHireDialog, GetPlayerName(p) )
set udg_EmpireHireDialogButtons[GetConvertedPlayerId(p)] = GetLastCreatedButtonBJ()
endif
set p = null
set u = null
set p2 = null
endfunction

function Trig_Hire_or_Fire_Hero_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
    if udg_EmpireHiredHero[GetConvertedPlayerId(p)] == 0 then
        set udg_HiringEmpire = GetConvertedPlayerId(p)
        call DialogClearBJ( udg_EmpireHireDialog )
        call DialogSetMessageBJ( udg_EmpireHireDialog, "Hire Hero:" )
        call ForForce( udg_AttackerGroup, function Trig_Hire_or_Fire_Hero_Dialog )
        call DialogAddButtonBJ( udg_EmpireHireDialog, "Cancel" )
        call DialogDisplayBJ( true, udg_EmpireHireDialog, p )
    else
        call DisplayTimedTextToForce( GetForceOfPlayer(ConvertedPlayer(udg_EmpireHiredHero[GetConvertedPlayerId(p)])), 10.00, ( udg_Playercolor[GetConvertedPlayerId(p)] + ( GetPlayerName(ConvertedPlayer(GetConvertedPlayerId(p))) + " |c00ff0000has fired you!" ) ) )
        call PlaySoundForPlayer( Player(udg_EmpireHiredHero[GetConvertedPlayerId(p)] - 1), gg_snd_Warning )
        call PlaySoundForPlayer( p, gg_snd_Warning )
        call DisplayTimedTextToForce( GetForceOfPlayer(p), 10.00, ( "|c00ff0000You have fired " + ( GetPlayerName(ConvertedPlayer(udg_EmpireHiredHero[GetConvertedPlayerId(p)])) + "!" ) ) )
        set udg_EmpireHiredHero[GetConvertedPlayerId(p)] = 0
        set udg_Payment[GetConvertedPlayerId(p)] = 0
        call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 16, "0%" )
        call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 17, "None" )
    endif
    call PolledWait( 10.00 )
    if udg_HiringEmpire == GetConvertedPlayerId(p) then
    call DialogDisplayBJ( false, udg_EmpireHireDialog, p )
    set udg_HiringEmpire = 0
    endif
set u = null
set p = null
endfunction

//===========================================================================
function InitTrig_Hire_or_Fire_Hero takes nothing returns nothing
    set gg_trg_Hire_or_Fire_Hero = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hire_or_Fire_Hero, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hire_or_Fire_Hero, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hire_or_Fire_Hero, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hire_or_Fire_Hero, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hire_or_Fire_Hero, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hire_or_Fire_Hero, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hire_or_Fire_Hero, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hire_or_Fire_Hero, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hire_or_Fire_Hero, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hire_or_Fire_Hero, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Hire_or_Fire_Hero, Condition( function Trig_Hire_or_Fire_Hero_Conditions ) )
    call TriggerAddAction( gg_trg_Hire_or_Fire_Hero, function Trig_Hire_or_Fire_Hero_Actions )
endfunction

//===========================================================================
// Trigger: Hire Hero Button
//===========================================================================
function Trig_Hire_Hero_Button_Actions takes nothing returns nothing
local player p = null
local integer i = 1
    
loop
exitwhen i > 10
if GetClickedButtonBJ() == udg_EmpireHireDialogButtons[i] then
set udg_EmpireHiredHero[udg_HiringEmpire] = i
set udg_Payment[udg_HiringEmpire] = 5
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[udg_HiringEmpire], 2, 16, "5%" )
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[udg_HiringEmpire], 2, 17, GetPlayerName(ConvertedPlayer(i)) )
call DisplayTimedTextToForce( GetForceOfPlayer(ConvertedPlayer(i)), 10.00, ( udg_Playercolor[udg_HiringEmpire] + GetPlayerName(ConvertedPlayer(udg_HiringEmpire)) + "|c00ff0000 has hired you!" ) )
call PlaySoundForPlayer( Player(i - 1), gg_snd_Warning )
endif
set i = i + 1
endloop

set udg_HiringEmpire = 0

set p = null
endfunction

//===========================================================================
function InitTrig_Hire_Hero_Button takes nothing returns nothing
    set gg_trg_Hire_Hero_Button = CreateTrigger(  )
    call TriggerRegisterDialogEventBJ( gg_trg_Hire_Hero_Button, udg_EmpireHireDialog )
    call TriggerAddAction( gg_trg_Hire_Hero_Button, function Trig_Hire_Hero_Button_Actions )
endfunction

//===========================================================================
// Trigger: Increase and Decrease Payment
//===========================================================================
function Trig_Increase_and_Decrease_Payment_Func014C takes nothing returns boolean
    if ( ( GetSpellAbilityId() == 'A03Z' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A040' ) ) then
        return true
    endif
    return false
endfunction

function Trig_Increase_and_Decrease_Payment_Conditions takes nothing returns boolean
    if ( not Trig_Increase_and_Decrease_Payment_Func014C() ) then
        return false
    endif
    if ( not ( udg_EmpireHiredHero[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] > 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Increase_and_Decrease_Payment_Func011C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A03Z' ) ) then
        return false
    endif
    if ( not ( udg_Payment[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] < 100 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Increase_and_Decrease_Payment_Func012C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A040' ) ) then
        return false
    endif
    if ( not ( udg_Payment[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] > 5 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Increase_and_Decrease_Payment_Actions takes nothing returns nothing
    if ( Trig_Increase_and_Decrease_Payment_Func011C() ) then
        set udg_Payment[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( udg_Payment[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] + 5 )
    else
    endif
    if ( Trig_Increase_and_Decrease_Payment_Func012C() ) then
        set udg_Payment[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( udg_Payment[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] - 5 )
    else
    endif
    call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))], 2, 16, ( I2S(udg_Payment[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))]) + "%" ) )
endfunction

//===========================================================================
function InitTrig_Increase_and_Decrease_Payment takes nothing returns nothing
    set gg_trg_Increase_and_Decrease_Payment = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Increase_and_Decrease_Payment, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Increase_and_Decrease_Payment, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Increase_and_Decrease_Payment, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Increase_and_Decrease_Payment, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Increase_and_Decrease_Payment, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Increase_and_Decrease_Payment, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Increase_and_Decrease_Payment, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Increase_and_Decrease_Payment, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Increase_and_Decrease_Payment, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Increase_and_Decrease_Payment, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Increase_and_Decrease_Payment, Condition( function Trig_Increase_and_Decrease_Payment_Conditions ) )
    call TriggerAddAction( gg_trg_Increase_and_Decrease_Payment, function Trig_Increase_and_Decrease_Payment_Actions )
endfunction

//===========================================================================
// Trigger: Player Leaves
//===========================================================================
function Trig_Player_Leaves_Func004002002 takes nothing returns boolean
    return ( IsUnitAliveBJ(GetFilterUnit()) == true )
endfunction

function Trig_Player_Leaves_Func009002 takes nothing returns nothing
local unit u = GetEnumUnit()
call RemoveUnit( u )
set u = null
endfunction

function Trig_Player_Leaves_Actions takes nothing returns nothing
local player p = GetTriggerPlayer()
local group g = GetUnitsOfPlayerMatching(p, Condition(function Trig_Player_Leaves_Func004002002))
call ForceRemovePlayerSimple( p, udg_AttackerGroup )
call PlaySoundBJ( gg_snd_Warning )
call DisplayTimedTextToForce( GetPlayersAll(), 10.00, ( ( "|cffffcc00Player " + udg_Playercolor[GetConvertedPlayerId(GetTriggerPlayer())] ) + ( GetPlayerName(GetTriggerPlayer()) + " |cffffcc00has left the game!" ) ) )
if CountUnitsInGroup(g) > 0 and udg_Empire[GetConvertedPlayerId(p)] == 1 then
set udg_Empires = ( udg_Empires - 1 )
set udg_Empire[GetConvertedPlayerId(p)] = 0
call TriggerExecute( gg_trg_Defeat_check )
else
if CountUnitsInGroup(g) > 0 and udg_HeroRace[GetConvertedPlayerId(p)] == 1 then
set udg_Heroes = ( udg_Heroes - 1 )
set udg_HeroRace[GetConvertedPlayerId(p)] = 0
call TriggerExecute( gg_trg_Defeat_check )
endif
endif
call ForGroupBJ( g, function Trig_Player_Leaves_Func009002 )
call DestroyGroup( g )
set g = null
set p = null
endfunction

//===========================================================================
function InitTrig_Player_Leaves takes nothing returns nothing
    set gg_trg_Player_Leaves = CreateTrigger(  )
    call DisableTrigger( gg_trg_Player_Leaves )
    call TriggerRegisterPlayerEventLeave( gg_trg_Player_Leaves, Player(0) )
    call TriggerRegisterPlayerEventLeave( gg_trg_Player_Leaves, Player(1) )
    call TriggerRegisterPlayerEventLeave( gg_trg_Player_Leaves, Player(2) )
    call TriggerRegisterPlayerEventLeave( gg_trg_Player_Leaves, Player(3) )
    call TriggerRegisterPlayerEventLeave( gg_trg_Player_Leaves, Player(4) )
    call TriggerRegisterPlayerEventLeave( gg_trg_Player_Leaves, Player(5) )
    call TriggerRegisterPlayerEventLeave( gg_trg_Player_Leaves, Player(6) )
    call TriggerRegisterPlayerEventLeave( gg_trg_Player_Leaves, Player(7) )
    call TriggerRegisterPlayerEventLeave( gg_trg_Player_Leaves, Player(8) )
    call TriggerRegisterPlayerEventLeave( gg_trg_Player_Leaves, Player(9) )
    call TriggerAddAction( gg_trg_Player_Leaves, function Trig_Player_Leaves_Actions )
endfunction

//===========================================================================
// Trigger: Set working people
//===========================================================================
function Trig_Set_working_people_Conditions takes nothing returns boolean
local item i = GetManipulatedItem()
if GetItemTypeId(i) == 'I03S' or GetItemTypeId(i) == 'I03R' or GetItemTypeId(i) == 'I02P' or GetItemTypeId(i) == 'I03U' then
set i = null
return true
endif
set i = null
return false
endfunction

function Trig_Set_working_people_Func001002002 takes nothing returns boolean
local unit u = GetFilterUnit()
if IsUnitType(u, UNIT_TYPE_TOWNHALL) == true then
set u = null
return true
endif
set u = null
return false
endfunction

function Trig_Set_working_people_Func002A takes nothing returns nothing
local unit u = GetEnumUnit()
local unit u2 = GetTriggerUnit()
local player p = GetOwningPlayer(u2)
local integer i = GetConvertedPlayerId(p)
local item it = UnitItemInSlotBJ(u, 1)
call SetItemCharges( it, udg_Townhallsettings1[i] )
set it = UnitItemInSlotBJ(u, 2)
call SetItemCharges( it, udg_Townhallsettings4[i] )
set it = UnitItemInSlotBJ(u, 3)
call SetItemCharges( it, udg_Townhallsettings2[i] )
set it = UnitItemInSlotBJ(u, 5)
call SetItemCharges( it, udg_Townhallsettings3[i] )
set u = null
set u2 = null
set p = null
set it = null
endfunction

function Trig_Set_working_people_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local item it = GetManipulatedItem()
local item it2 = GetItemOfTypeFromUnitBJ(u, 'I03T')
local integer i = GetItemCharges(it2)
local player p = GetOwningPlayer(u)
local integer i2 = GetConvertedPlayerId(p)
local group g = GetUnitsOfPlayerMatching(p, Condition(function Trig_Set_working_people_Func001002002))

if i > 0 and GetItemTypeId(it) == 'I03R' then
set udg_Townhallsettings1[i2] = ( udg_Townhallsettings1[i2] + 5 )
set udg_Townhallsettings4[i2] = ( udg_Townhallsettings4[i2] - 5 )
endif
if i > 0 and GetItemTypeId(it) == 'I03S' then
set udg_Townhallsettings2[i2] = ( udg_Townhallsettings2[i2] + 5 )
set udg_Townhallsettings4[i2] = ( udg_Townhallsettings4[i2] - 5 )
endif
if i > 0 and GetItemTypeId(it) == 'I02P' then
set udg_Townhallsettings3[i2] = ( udg_Townhallsettings3[i2] + 5 )
set udg_Townhallsettings4[i2] = ( udg_Townhallsettings4[i2] - 5 )
endif
if GetItemTypeId(it) == 'I03U' then
set udg_Townhallsettings1[i2] = 0
set udg_Townhallsettings2[i2] = 0
set udg_Townhallsettings3[i2] = 0
set udg_Townhallsettings4[i2] = 100
endif
call ForGroupBJ( g, function Trig_Set_working_people_Func002A )
call DestroyGroup( g )
set g = null
set u = null
set it = null
set it2 = null
set p = null
endfunction

//===========================================================================
function InitTrig_Set_working_people takes nothing returns nothing
    set gg_trg_Set_working_people = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Set_working_people, Player(0), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Set_working_people, Player(1), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Set_working_people, Player(2), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Set_working_people, Player(3), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Set_working_people, Player(4), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Set_working_people, Player(5), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Set_working_people, Player(6), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Set_working_people, Player(7), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Set_working_people, Player(8), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Set_working_people, Player(9), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerAddCondition( gg_trg_Set_working_people, Condition( function Trig_Set_working_people_Conditions ) )
    call TriggerAddAction( gg_trg_Set_working_people, function Trig_Set_working_people_Actions )
endfunction

//===========================================================================
// Trigger: Tax
//===========================================================================
function Trig_Tax_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A008' or GetSpellAbilityId() == 'A007' then
return true
endif
return false
endfunction

function Trig_Tax_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
local integer i = GetConvertedPlayerId(p)
if GetSpellAbilityId() == 'A008' and udg_Tax[i] > 0 then
set udg_Tax[i] = ( udg_Tax[i] - 1 )
endif
if GetSpellAbilityId() == 'A007' then
set udg_Tax[i] = ( udg_Tax[i] + 1 )
endif
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[i], 2, 5, I2S(udg_Tax[i]) )
set u = null
set p = null
endfunction

//===========================================================================
function InitTrig_Tax takes nothing returns nothing
    set gg_trg_Tax = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Tax, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Tax, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Tax, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Tax, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Tax, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Tax, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Tax, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Tax, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Tax, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Tax, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Tax, Condition( function Trig_Tax_Conditions ) )
    call TriggerAddAction( gg_trg_Tax, function Trig_Tax_Actions )
endfunction

//===========================================================================
// Trigger: Rations
//===========================================================================
function Trig_Rations_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A055' or GetSpellAbilityId() == 'A058' then
return true
endif
return false
endfunction

function Trig_Rations_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
local integer i = GetConvertedPlayerId(p)
if GetSpellAbilityId() == 'A058' and udg_Rations[i] > 0 then
set udg_Rations[i] = ( udg_Rations[i] - 1 )
endif
if GetSpellAbilityId() == 'A055' then
set udg_Rations[i] = ( udg_Rations[i] + 1 )
endif
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[i], 2, 6, I2S(udg_Rations[i]) )
set u = null
set p = null
endfunction

//===========================================================================
function InitTrig_Rations takes nothing returns nothing
    set gg_trg_Rations = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Rations, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Rations, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Rations, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Rations, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Rations, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Rations, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Rations, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Rations, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Rations, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Rations, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Rations, Condition( function Trig_Rations_Conditions ) )
    call TriggerAddAction( gg_trg_Rations, function Trig_Rations_Actions )
endfunction

//===========================================================================
// Trigger: Destroy Building
//===========================================================================
function Trig_Destroy_Building_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A05J' then
return true
endif
return false
endfunction

function Trig_Destroy_Building_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
call KillUnit( u )
set u = null
endfunction

//===========================================================================
function InitTrig_Destroy_Building takes nothing returns nothing
    set gg_trg_Destroy_Building = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Destroy_Building, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Destroy_Building, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Destroy_Building, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Destroy_Building, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Destroy_Building, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Destroy_Building, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Destroy_Building, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Destroy_Building, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Destroy_Building, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Destroy_Building, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Destroy_Building, Condition( function Trig_Destroy_Building_Conditions ) )
    call TriggerAddAction( gg_trg_Destroy_Building, function Trig_Destroy_Building_Actions )
endfunction

//===========================================================================
// Trigger: Demolish Plant
//===========================================================================
function Trig_Demolish_Plant_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A09R' then
return true
endif
return false
endfunction

function Trig_Demolish_Plant_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
if GetUnitTypeId(u) == 'h02F' then
set udg_PowerSupply[GetConvertedPlayerId(p)] = ( udg_PowerSupply[GetConvertedPlayerId(p)] - 50 )
endif
if GetUnitTypeId(u) == 'h02M' then
set udg_PowerSupply[GetConvertedPlayerId(p)] = ( udg_PowerSupply[GetConvertedPlayerId(p)] - 25 )
endif
call RemoveUnit( u )
set u = null
set p = null
endfunction

//===========================================================================
function InitTrig_Demolish_Plant takes nothing returns nothing
    set gg_trg_Demolish_Plant = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Demolish_Plant, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Demolish_Plant, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Demolish_Plant, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Demolish_Plant, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Demolish_Plant, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Demolish_Plant, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Demolish_Plant, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Demolish_Plant, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Demolish_Plant, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Demolish_Plant, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Demolish_Plant, Condition( function Trig_Demolish_Plant_Conditions ) )
    call TriggerAddAction( gg_trg_Demolish_Plant, function Trig_Demolish_Plant_Actions )
endfunction

//===========================================================================
// Trigger: Retire
//===========================================================================
function Trig_Retire_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A07D' then
return true
endif
return false
endfunction

function Trig_Retire_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
if udg_StartedEmpire[GetConvertedPlayerId(p)] == 1 or udg_HeroRace[GetConvertedPlayerId(p)] == 1 then
call RemoveUnit( u )
endif
set p = null
set u = null
endfunction

//===========================================================================
function InitTrig_Retire takes nothing returns nothing
    set gg_trg_Retire = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Retire, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Retire, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Retire, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Retire, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Retire, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Retire, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Retire, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Retire, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Retire, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Retire, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Retire, Condition( function Trig_Retire_Conditions ) )
    call TriggerAddAction( gg_trg_Retire, function Trig_Retire_Actions )
endfunction

//===========================================================================
// Trigger: Open and Close gates
//===========================================================================
function Trig_Open_and_Close_gates_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A00B' or GetSpellAbilityId() == 'A00C' then
return true
endif
return false
endfunction

function Trig_Open_and_Close_gates_Func003002002002 takes nothing returns boolean
local unit u = GetFilterUnit()
if IsUnitAliveBJ(u) == true and IsUnitType(u, UNIT_TYPE_STRUCTURE) == false then
set u = null
return true
endif
set u = null
return false
endfunction

function Trig_Open_and_Close_gates_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local location l = GetUnitLoc(u)
local player p = GetOwningPlayer(u)
local group g = GetUnitsInRangeOfLocMatching(150, l, Condition(function Trig_Open_and_Close_gates_Func003002002002) )
local integer i = CountUnitsInGroup(g)
local rect r = RectFromCenterSizeBJ(l, 300.00, 300.00)
local item it = RandomItemInRectSimpleBJ(r)

//open gate
if GetSpellAbilityId() == 'A00B' then
if GetUnitTypeId(u) == 'h00C' then
call ReplaceUnitBJ( u, 'h00B', bj_UNIT_STATE_METHOD_RELATIVE )
endif
if GetUnitTypeId(u) == 'h00O' then
call ReplaceUnitBJ( u, 'h00N', bj_UNIT_STATE_METHOD_RELATIVE )
endif
if GetUnitTypeId(u) == 'h015' then
call ReplaceUnitBJ( u, 'h014', bj_UNIT_STATE_METHOD_RELATIVE )
endif
if GetUnitTypeId(u) == 'h01B' then
call ReplaceUnitBJ( u, 'h01A', bj_UNIT_STATE_METHOD_RELATIVE )
endif
if GetUnitTypeId(u) == 'h01H' then
call ReplaceUnitBJ( u, 'h01G', bj_UNIT_STATE_METHOD_RELATIVE )
endif
endif

//close gate
if GetSpellAbilityId() == 'A00C' then
if it == null then
if i == 0 then
if GetUnitTypeId(u) == 'h00B' then
call ReplaceUnitBJ( u, 'h00C', bj_UNIT_STATE_METHOD_RELATIVE )
endif
if GetUnitTypeId(u) == 'h00N' then
call ReplaceUnitBJ( u, 'h00O', bj_UNIT_STATE_METHOD_RELATIVE )
endif
if GetUnitTypeId(u) == 'h014' then
call ReplaceUnitBJ( u, 'h015', bj_UNIT_STATE_METHOD_RELATIVE )
endif
if GetUnitTypeId(u) == 'h01A' then
call ReplaceUnitBJ( u, 'h01B', bj_UNIT_STATE_METHOD_RELATIVE )
endif
if GetUnitTypeId(u) == 'h01G' then
call ReplaceUnitBJ( u, 'h01H', bj_UNIT_STATE_METHOD_RELATIVE )
endif
else
call SetFloatingText(p,"Units too close",GetLocationX(l),GetLocationY(l),-100,255,0,0)
endif
else
call SetFloatingText(p,"Item too close",GetLocationX(l),GetLocationY(l),-100,255,0,0)
endif
endif

call RemoveRect(r)
set r = null
set it = null
set u = null
call RemoveLocation(l)
set l = null
set p = null
call DestroyGroup(g)
set g = null
endfunction

//===========================================================================
function InitTrig_Open_and_Close_gates takes nothing returns nothing
    set gg_trg_Open_and_Close_gates = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Open_and_Close_gates, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Open_and_Close_gates, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Open_and_Close_gates, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Open_and_Close_gates, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Open_and_Close_gates, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Open_and_Close_gates, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Open_and_Close_gates, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Open_and_Close_gates, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Open_and_Close_gates, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Open_and_Close_gates, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Open_and_Close_gates, Condition( function Trig_Open_and_Close_gates_Conditions ) )
    call TriggerAddAction( gg_trg_Open_and_Close_gates, function Trig_Open_and_Close_gates_Actions )
endfunction

//===========================================================================
// Trigger: Unit Trained
//===========================================================================
function Trig_Unit_Trained_Func001Func001001 takes nothing returns boolean
    return ( udg_Damageunits == 0 )
endfunction

function Trig_Unit_Trained_Func001Func002Func004001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R003', GetOwningPlayer(GetTrainedUnit())) == 1 )
endfunction

function Trig_Unit_Trained_Func001Func002Func005001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R003', GetOwningPlayer(GetTrainedUnit())) == 2 )
endfunction

function Trig_Unit_Trained_Func001Func002Func006001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R003', GetOwningPlayer(GetTrainedUnit())) == 3 )
endfunction

function Trig_Unit_Trained_Func001Func002Func007001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R003', GetOwningPlayer(GetTrainedUnit())) == 4 )
endfunction

function Trig_Unit_Trained_Func001Func002Func008001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R003', GetOwningPlayer(GetTrainedUnit())) == 5 )
endfunction

function Trig_Unit_Trained_Func001Func002Func009001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R003', GetOwningPlayer(GetTrainedUnit())) == 6 )
endfunction

function Trig_Unit_Trained_Func001Func002Func010001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R003', GetOwningPlayer(GetTrainedUnit())) == 7 )
endfunction

function Trig_Unit_Trained_Func001Func002Func011001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R003', GetOwningPlayer(GetTrainedUnit())) == 8 )
endfunction

function Trig_Unit_Trained_Func001Func002Func012001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R003', GetOwningPlayer(GetTrainedUnit())) == 9 )
endfunction

function Trig_Unit_Trained_Func001Func002C takes nothing returns boolean
    if ( not ( GetPlayerTechCountSimple('R003', GetOwningPlayer(GetTrainedUnit())) > 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Unit_Trained_Func001C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTrainedUnit()) == 'h023' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Unit_Trained_Actions takes nothing returns nothing
    if ( Trig_Unit_Trained_Func001C() ) then
        if ( Trig_Unit_Trained_Func001Func001001() ) then
            call SetUnitInvulnerable( GetTrainedUnit(), true )
        else
            call DoNothing(  )
        endif
        if ( Trig_Unit_Trained_Func001Func002C() ) then
            call UnitRemoveAbilityBJ( 'A01E', GetTrainedUnit() )
            if ( Trig_Unit_Trained_Func001Func002Func004001() ) then
                call UnitAddAbilityBJ( 'A006', GetTrainedUnit() )
            else
                call DoNothing(  )
            endif
            if ( Trig_Unit_Trained_Func001Func002Func005001() ) then
                call UnitAddAbilityBJ( 'A052', GetTrainedUnit() )
            else
                call DoNothing(  )
            endif
            if ( Trig_Unit_Trained_Func001Func002Func006001() ) then
                call UnitAddAbilityBJ( 'A057', GetTrainedUnit() )
            else
                call DoNothing(  )
            endif
            if ( Trig_Unit_Trained_Func001Func002Func007001() ) then
                call UnitAddAbilityBJ( 'A05M', GetTrainedUnit() )
            else
                call DoNothing(  )
            endif
            if ( Trig_Unit_Trained_Func001Func002Func008001() ) then
                call UnitAddAbilityBJ( 'A05Q', GetTrainedUnit() )
            else
                call DoNothing(  )
            endif
            if ( Trig_Unit_Trained_Func001Func002Func009001() ) then
                call UnitAddAbilityBJ( 'A05X', GetTrainedUnit() )
            else
                call DoNothing(  )
            endif
            if ( Trig_Unit_Trained_Func001Func002Func010001() ) then
                call UnitAddAbilityBJ( 'A05L', GetTrainedUnit() )
            else
                call DoNothing(  )
            endif
            if ( Trig_Unit_Trained_Func001Func002Func011001() ) then
                call UnitAddAbilityBJ( 'A060', GetTrainedUnit() )
            else
                call DoNothing(  )
            endif
            if ( Trig_Unit_Trained_Func001Func002Func012001() ) then
                call UnitAddAbilityBJ( 'A06Q', GetTrainedUnit() )
            else
                call DoNothing(  )
            endif
        else
            call DoNothing(  )
        endif
    else
    endif
endfunction

//===========================================================================
function InitTrig_Unit_Trained takes nothing returns nothing
    set gg_trg_Unit_Trained = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_Trained, Player(0), EVENT_PLAYER_UNIT_TRAIN_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_Trained, Player(1), EVENT_PLAYER_UNIT_TRAIN_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_Trained, Player(2), EVENT_PLAYER_UNIT_TRAIN_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_Trained, Player(3), EVENT_PLAYER_UNIT_TRAIN_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_Trained, Player(4), EVENT_PLAYER_UNIT_TRAIN_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_Trained, Player(5), EVENT_PLAYER_UNIT_TRAIN_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_Trained, Player(6), EVENT_PLAYER_UNIT_TRAIN_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_Trained, Player(7), EVENT_PLAYER_UNIT_TRAIN_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_Trained, Player(8), EVENT_PLAYER_UNIT_TRAIN_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_Trained, Player(9), EVENT_PLAYER_UNIT_TRAIN_FINISH )
    call TriggerAddAction( gg_trg_Unit_Trained, function Trig_Unit_Trained_Actions )
endfunction

//===========================================================================
// Trigger: Building Finished
//===========================================================================
function Trig_Building_Finished_Func003C takes nothing returns boolean
    if ( ( GetUnitTypeId(GetConstructedStructure()) == 'o000' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetConstructedStructure()) == 'h024' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetConstructedStructure()) == 'h01N' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetConstructedStructure()) == 'h00E' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetConstructedStructure()) == 'h02J' ) ) then
        return true
    endif
    return false
endfunction

function Trig_Building_Finished_Conditions takes nothing returns boolean
    if ( not Trig_Building_Finished_Func003C() ) then
        return false
    endif
    return true
endfunction

function Trig_Building_Finished_Func001Func004001 takes nothing returns boolean
    return ( udg_Damageunits == 0 )
endfunction

function Trig_Building_Finished_Func001C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetConstructedStructure()) == 'h02J' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Building_Finished_Func002C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetConstructedStructure()) == 'h024' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Building_Finished_Func004Func013C takes nothing returns boolean
    if ( not ( udg_StartedEmpire[GetConvertedPlayerId(GetOwningPlayer(GetConstructedStructure()))] == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Building_Finished_Func004C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetConstructedStructure()) == 'o000' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Building_Finished_Func005C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetConstructedStructure()) == 'h01N' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Building_Finished_Actions takes nothing returns nothing
    if ( Trig_Building_Finished_Func001C() ) then
        call CreateNUnitsAtLoc( 1, 'h02W', GetOwningPlayer(GetConstructedStructure()), GetUnitLoc(GetConstructedStructure()), 90.00 )
        call ReplaceUnitBJ( GetConstructedStructure(), 'h02B', bj_UNIT_STATE_METHOD_ABSOLUTE )
        call GroupAddUnitSimple( GetLastReplacedUnitBJ(), udg_Houses )
        if ( Trig_Building_Finished_Func001Func004001() ) then
            call SetUnitInvulnerable( GetLastReplacedUnitBJ(), true )
        else
            call DoNothing(  )
        endif
    else
        call DoNothing(  )
    endif
    if ( Trig_Building_Finished_Func002C() ) then
        set udg_Tempspot10 = GetUnitLoc(GetConstructedStructure())
        call RemoveUnit( GetConstructedStructure() )
        call CreateDestructableLoc( 'B002', udg_Tempspot10, 90.00, 0.20, 1 )
        call RemoveLocation(udg_Tempspot10)
    else
        call DoNothing(  )
    endif
    if ( Trig_Building_Finished_Func004C() ) then
        call UnitAddAbilityBJ( 'AInv', GetConstructedStructure() )
        call UnitAddItemByIdSwapped( 'I03R', GetConstructedStructure() )
        call SetItemCharges( GetLastCreatedItem(), udg_Townhallsettings1[GetConvertedPlayerId(GetOwningPlayer(GetConstructedStructure()))] )
        call UnitAddItemByIdSwapped( 'I03T', GetConstructedStructure() )
        call SetItemCharges( GetLastCreatedItem(), udg_Townhallsettings4[GetConvertedPlayerId(GetOwningPlayer(GetConstructedStructure()))] )
        call UnitAddItemByIdSwapped( 'I03S', GetConstructedStructure() )
        call SetItemCharges( GetLastCreatedItem(), udg_Townhallsettings2[GetConvertedPlayerId(GetOwningPlayer(GetConstructedStructure()))] )
        call UnitAddItemByIdSwapped( 'I039', GetConstructedStructure() )
        call UnitAddItemByIdSwapped( 'I02P', GetConstructedStructure() )
        call SetItemCharges( GetLastCreatedItem(), udg_Townhallsettings3[GetConvertedPlayerId(GetOwningPlayer(GetConstructedStructure()))] )
        call UnitAddItemByIdSwapped( 'I03U', GetConstructedStructure() )
        if ( Trig_Building_Finished_Func004Func013C() ) then
            set udg_StartedEmpire[GetConvertedPlayerId(GetOwningPlayer(GetConstructedStructure()))] = 1
        else
            call DoNothing(  )
        endif
        call SetUnitUserData( GetConstructedStructure(), 1 )
    else
        call DoNothing(  )
    endif
    if ( Trig_Building_Finished_Func005C() ) then
        set udg_FarmsAmount[GetConvertedPlayerId(GetOwningPlayer(GetConstructedStructure()))] = ( udg_FarmsAmount[GetConvertedPlayerId(GetOwningPlayer(GetConstructedStructure()))] + 1 )
        call SetUnitUserData( GetConstructedStructure(), 1 )
    else
        call DoNothing(  )
    endif
endfunction

//===========================================================================
function InitTrig_Building_Finished takes nothing returns nothing
    set gg_trg_Building_Finished = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Building_Finished, Player(0), EVENT_PLAYER_UNIT_CONSTRUCT_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Building_Finished, Player(1), EVENT_PLAYER_UNIT_CONSTRUCT_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Building_Finished, Player(2), EVENT_PLAYER_UNIT_CONSTRUCT_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Building_Finished, Player(3), EVENT_PLAYER_UNIT_CONSTRUCT_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Building_Finished, Player(4), EVENT_PLAYER_UNIT_CONSTRUCT_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Building_Finished, Player(5), EVENT_PLAYER_UNIT_CONSTRUCT_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Building_Finished, Player(6), EVENT_PLAYER_UNIT_CONSTRUCT_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Building_Finished, Player(7), EVENT_PLAYER_UNIT_CONSTRUCT_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Building_Finished, Player(8), EVENT_PLAYER_UNIT_CONSTRUCT_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Building_Finished, Player(9), EVENT_PLAYER_UNIT_CONSTRUCT_FINISH )
    call TriggerAddCondition( gg_trg_Building_Finished, Condition( function Trig_Building_Finished_Conditions ) )
    call TriggerAddAction( gg_trg_Building_Finished, function Trig_Building_Finished_Actions )
endfunction

//===========================================================================
// Trigger: Begins an Upgrade
//===========================================================================
function Trig_Begins_an_Upgrade_Conditions takes nothing returns boolean
    if ( not ( IsUnitType(GetTriggerUnit(), UNIT_TYPE_STRUCTURE) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_Begins_an_Upgrade_Func001C takes nothing returns boolean
    if ( not ( GetUnitStateSwap(UNIT_STATE_MAX_MANA, GetTriggerUnit()) > 0.00 ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetTriggerUnit()) != 'h022' ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetTriggerUnit()) != 'h02A' ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetTriggerUnit()) != 'h02B' ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetTriggerUnit()) != 'h021' ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetTriggerUnit()) != 'h02D' ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetTriggerUnit()) != 'h002' ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetTriggerUnit()) != 'h02C' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Begins_an_Upgrade_Func003Func005001 takes nothing returns boolean
    return ( udg_Damageunits == 0 )
endfunction

function Trig_Begins_an_Upgrade_Func003C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetLastReplacedUnitBJ()) != 'o00J' ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetLastReplacedUnitBJ()) != 'o005' ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetLastReplacedUnitBJ()) != 'h00M' ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetLastReplacedUnitBJ()) != 'h00O' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Begins_an_Upgrade_Func004Func003001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R003', udg_player) < GetPlayerTechMaxAllowedSwap('R003', udg_player) )
endfunction

function Trig_Begins_an_Upgrade_Func004Func004001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R005', udg_player) < GetPlayerTechMaxAllowedSwap('R005', udg_player) )
endfunction

function Trig_Begins_an_Upgrade_Func004Func005001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R009', udg_player) < GetPlayerTechMaxAllowedSwap('R009', udg_player) )
endfunction

function Trig_Begins_an_Upgrade_Func004Func006001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R00H', udg_player) < GetPlayerTechMaxAllowedSwap('R00H', udg_player) )
endfunction

function Trig_Begins_an_Upgrade_Func004Func018Func001Func001Func002C takes nothing returns boolean
    if ( not ( udg_UpCounter2 == 1 ) ) then
        return false
    endif
    if ( not ( udg_Researches[udg_UpCounter2] < 100 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Begins_an_Upgrade_Func004Func018Func001Func001Func003C takes nothing returns boolean
    if ( not ( udg_UpCounter2 == 2 ) ) then
        return false
    endif
    if ( not ( udg_Researches[udg_UpCounter2] < 100 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Begins_an_Upgrade_Func004Func018Func001Func001Func004C takes nothing returns boolean
    if ( not ( udg_UpCounter2 == 3 ) ) then
        return false
    endif
    if ( not ( udg_Researches[udg_UpCounter2] < 100 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Begins_an_Upgrade_Func004Func018Func001Func001Func005C takes nothing returns boolean
    if ( not ( udg_UpCounter2 == 4 ) ) then
        return false
    endif
    if ( not ( udg_Researches[udg_UpCounter2] < 100 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Begins_an_Upgrade_Func004Func018Func001Func001Func006C takes nothing returns boolean
    if ( not ( udg_UpCounter2 == 5 ) ) then
        return false
    endif
    if ( not ( udg_Researches[udg_UpCounter2] < 100 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Begins_an_Upgrade_Func004Func018Func001Func001Func007C takes nothing returns boolean
    if ( not ( udg_UpCounter2 == 6 ) ) then
        return false
    endif
    if ( not ( udg_Researches[udg_UpCounter2] < 100 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Begins_an_Upgrade_Func004Func018Func001Func001Func008C takes nothing returns boolean
    if ( not ( udg_Chosen == 4 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Begins_an_Upgrade_Func004Func018Func001Func001C takes nothing returns boolean
    if ( not ( udg_Researches[udg_UpCounter2] <= udg_Researches[1] ) ) then
        return false
    endif
    if ( not ( udg_Researches[udg_UpCounter2] <= udg_Researches[2] ) ) then
        return false
    endif
    if ( not ( udg_Researches[udg_UpCounter2] <= udg_Researches[3] ) ) then
        return false
    endif
    if ( not ( udg_Researches[udg_UpCounter2] <= udg_Researches[4] ) ) then
        return false
    endif
    if ( not ( udg_Researches[udg_UpCounter2] <= udg_Researches[5] ) ) then
        return false
    endif
    if ( not ( udg_Researches[udg_UpCounter2] <= udg_Researches[6] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Begins_an_Upgrade_Func004C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetLastReplacedUnitBJ()) == 'h01E' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Begins_an_Upgrade_Func005C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetLastReplacedUnitBJ()) == 'o00G' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Begins_an_Upgrade_Func006C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetLastReplacedUnitBJ()) == 'o003' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Begins_an_Upgrade_Func007C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetLastReplacedUnitBJ()) == 'h00V' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Begins_an_Upgrade_Func008C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetLastReplacedUnitBJ()) == 'h020' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Begins_an_Upgrade_Func009C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetLastReplacedUnitBJ()) == 'h02M' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Begins_an_Upgrade_Func010C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetLastReplacedUnitBJ()) == 'h02N' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Begins_an_Upgrade_Func011C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetLastReplacedUnitBJ()) == 'h02F' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Begins_an_Upgrade_Func012C takes nothing returns boolean
    if ( not ( GetUnitStateSwap(UNIT_STATE_MAX_MANA, GetLastReplacedUnitBJ()) > 0.00 ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetLastReplacedUnitBJ()) != 'h022' ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetLastReplacedUnitBJ()) != 'h02A' ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetLastReplacedUnitBJ()) != 'h02B' ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetLastReplacedUnitBJ()) != 'h021' ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetLastReplacedUnitBJ()) != 'h02D' ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetLastReplacedUnitBJ()) != 'h002' ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetLastReplacedUnitBJ()) != 'h02C' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Begins_an_Upgrade_Actions takes nothing returns nothing
    if ( Trig_Begins_an_Upgrade_Func001C() ) then
        set udg_Powerneeded[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( udg_Powerneeded[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] - GetUnitUserData(GetTriggerUnit()) )
    else
        call DoNothing(  )
    endif
    call ReplaceUnitBJ( GetTriggerUnit(), GetUnitTypeId(GetTriggerUnit()), bj_UNIT_STATE_METHOD_RELATIVE )
    if ( Trig_Begins_an_Upgrade_Func003C() ) then
        if ( Trig_Begins_an_Upgrade_Func003Func005001() ) then
            call SetUnitInvulnerable( GetLastReplacedUnitBJ(), true )
        else
            call DoNothing(  )
        endif
    else
    endif
    if ( Trig_Begins_an_Upgrade_Func004C() ) then
        set udg_ScienceLab[GetConvertedPlayerId(GetOwningPlayer(GetLastReplacedUnitBJ()))] = GetLastReplacedUnitBJ()
        set udg_player = GetOwningPlayer(GetLastReplacedUnitBJ())
        if ( Trig_Begins_an_Upgrade_Func004Func003001() ) then
            call UnitAddAbilityBJ( 'A054', GetLastReplacedUnitBJ() )
        else
            call DoNothing(  )
        endif
        if ( Trig_Begins_an_Upgrade_Func004Func004001() ) then
            call UnitAddAbilityBJ( 'A05D', GetLastReplacedUnitBJ() )
        else
            call DoNothing(  )
        endif
        if ( Trig_Begins_an_Upgrade_Func004Func005001() ) then
            call UnitAddAbilityBJ( 'A00M', GetLastReplacedUnitBJ() )
        else
            call DoNothing(  )
        endif
        if ( Trig_Begins_an_Upgrade_Func004Func006001() ) then
            call UnitAddAbilityBJ( 'A000', GetLastReplacedUnitBJ() )
        else
            call DoNothing(  )
        endif
        call UnitAddAbilityBJ( 'A05C', udg_ScienceLab[GetConvertedPlayerId(udg_player)] )
        set udg_Researches[1] = ( ( GetPlayerTechCountSimple('R001', udg_player) * 100 ) / GetPlayerTechMaxAllowedSwap('R001', udg_player) )
        set udg_Researches[2] = ( ( GetPlayerTechCountSimple('R002', udg_player) * 100 ) / GetPlayerTechMaxAllowedSwap('R002', udg_player) )
        set udg_Researches[3] = ( ( GetPlayerTechCountSimple('R008', udg_player) * 100 ) / GetPlayerTechMaxAllowedSwap('R008', udg_player) )
        set udg_Researches[4] = ( ( GetPlayerTechCountSimple('R00C', udg_player) * 100 ) / GetPlayerTechMaxAllowedSwap('R00C', udg_player) )
        set udg_Researches[5] = ( ( GetPlayerTechCountSimple('R00D', udg_player) * 100 ) / GetPlayerTechMaxAllowedSwap('R00D', udg_player) )
        set udg_Researches[6] = ( ( GetPlayerTechCountSimple('R00F', udg_player) * 100 ) / GetPlayerTechMaxAllowedSwap('R00F', udg_player) )
        set udg_Chosen = 0
        set udg_ProjectName[GetConvertedPlayerId(udg_player)] = "None"
        call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(udg_player)], 2, 9, udg_ProjectName[GetConvertedPlayerId(udg_player)] )
        call MultiboardUpdate( udg_PlayerMultiboard[GetConvertedPlayerId(udg_player)], 10, 0.00 )
        set udg_UpCounter = 1
        loop
            exitwhen udg_UpCounter > 4
            set udg_UpCounter2 = 1
            loop
                exitwhen udg_UpCounter2 > 7
                if ( Trig_Begins_an_Upgrade_Func004Func018Func001Func001C() ) then
                    if ( Trig_Begins_an_Upgrade_Func004Func018Func001Func001Func002C() ) then
                        set udg_Researches[1] = 100
                        call UnitAddAbilityBJ( 'A05A', GetLastReplacedUnitBJ() )
                        set udg_Chosen = ( udg_Chosen + 1 )
                    else
                        call DoNothing(  )
                    endif
                    if ( Trig_Begins_an_Upgrade_Func004Func018Func001Func001Func003C() ) then
                        set udg_Researches[2] = 100
                        call UnitAddAbilityBJ( 'A05B', GetLastReplacedUnitBJ() )
                        set udg_Chosen = ( udg_Chosen + 1 )
                    else
                        call DoNothing(  )
                    endif
                    if ( Trig_Begins_an_Upgrade_Func004Func018Func001Func001Func004C() ) then
                        set udg_Researches[3] = 100
                        call UnitAddAbilityBJ( 'A059', GetLastReplacedUnitBJ() )
                        set udg_Chosen = ( udg_Chosen + 1 )
                    else
                        call DoNothing(  )
                    endif
                    if ( Trig_Begins_an_Upgrade_Func004Func018Func001Func001Func005C() ) then
                        set udg_Researches[4] = 100
                        call UnitAddAbilityBJ( 'A05N', GetLastReplacedUnitBJ() )
                        set udg_Chosen = ( udg_Chosen + 1 )
                    else
                        call DoNothing(  )
                    endif
                    if ( Trig_Begins_an_Upgrade_Func004Func018Func001Func001Func006C() ) then
                        set udg_Researches[5] = 100
                        call UnitAddAbilityBJ( 'A05F', GetLastReplacedUnitBJ() )
                        set udg_Chosen = ( udg_Chosen + 1 )
                    else
                        call DoNothing(  )
                    endif
                    if ( Trig_Begins_an_Upgrade_Func004Func018Func001Func001Func007C() ) then
                        set udg_Researches[8] = 100
                        call UnitAddAbilityBJ( 'A01F', GetLastReplacedUnitBJ() )
                        set udg_Chosen = ( udg_Chosen + 1 )
                    else
                        call DoNothing(  )
                    endif
                    if ( Trig_Begins_an_Upgrade_Func004Func018Func001Func001Func008C() ) then
                        return
                    else
                        call DoNothing(  )
                    endif
                else
                    call DoNothing(  )
                endif
                set udg_UpCounter2 = udg_UpCounter2 + 1
            endloop
            set udg_UpCounter = udg_UpCounter + 1
        endloop
    else
        call DoNothing(  )
    endif
    if ( Trig_Begins_an_Upgrade_Func005C() ) then
        call SetUnitUserData( GetLastReplacedUnitBJ(), 1 )
        call UnitAddItemByIdSwapped( 'I03R', GetLastReplacedUnitBJ() )
        call SetItemCharges( GetLastCreatedItem(), udg_Townhallsettings1[GetConvertedPlayerId(GetOwningPlayer(GetLastReplacedUnitBJ()))] )
        call UnitAddItemByIdSwapped( 'I03T', GetLastReplacedUnitBJ() )
        call SetItemCharges( GetLastCreatedItem(), udg_Townhallsettings4[GetConvertedPlayerId(GetOwningPlayer(GetLastReplacedUnitBJ()))] )
        call UnitAddItemByIdSwapped( 'I03S', GetLastReplacedUnitBJ() )
        call SetItemCharges( GetLastCreatedItem(), udg_Townhallsettings2[GetConvertedPlayerId(GetOwningPlayer(GetLastReplacedUnitBJ()))] )
        call UnitAddItemByIdSwapped( 'I039', GetLastReplacedUnitBJ() )
        call UnitAddItemByIdSwapped( 'I02P', GetLastReplacedUnitBJ() )
        call SetItemCharges( GetLastCreatedItem(), udg_Townhallsettings3[GetConvertedPlayerId(GetOwningPlayer(GetLastReplacedUnitBJ()))] )
        call UnitAddItemByIdSwapped( 'I03U', GetLastReplacedUnitBJ() )
    else
        call DoNothing(  )
    endif
    if ( Trig_Begins_an_Upgrade_Func006C() ) then
        call SetUnitUserData( GetLastReplacedUnitBJ(), 1 )
        call UnitAddItemByIdSwapped( 'I03R', GetLastReplacedUnitBJ() )
        call SetItemCharges( GetLastCreatedItem(), udg_Townhallsettings1[GetConvertedPlayerId(GetOwningPlayer(GetLastReplacedUnitBJ()))] )
        call UnitAddItemByIdSwapped( 'I03T', GetLastReplacedUnitBJ() )
        call SetItemCharges( GetLastCreatedItem(), udg_Townhallsettings4[GetConvertedPlayerId(GetOwningPlayer(GetLastReplacedUnitBJ()))] )
        call UnitAddItemByIdSwapped( 'I03S', GetLastReplacedUnitBJ() )
        call SetItemCharges( GetLastCreatedItem(), udg_Townhallsettings2[GetConvertedPlayerId(GetOwningPlayer(GetLastReplacedUnitBJ()))] )
        call UnitAddItemByIdSwapped( 'I039', GetLastReplacedUnitBJ() )
        call UnitAddItemByIdSwapped( 'I02P', GetLastReplacedUnitBJ() )
        call SetItemCharges( GetLastCreatedItem(), udg_Townhallsettings3[GetConvertedPlayerId(GetOwningPlayer(GetLastReplacedUnitBJ()))] )
        call UnitAddItemByIdSwapped( 'I03U', GetLastReplacedUnitBJ() )
    else
        call DoNothing(  )
    endif
    if ( Trig_Begins_an_Upgrade_Func007C() ) then
        set udg_PowerSupply[GetConvertedPlayerId(GetOwningPlayer(GetLastReplacedUnitBJ()))] = ( udg_PowerSupply[GetConvertedPlayerId(GetOwningPlayer(GetLastReplacedUnitBJ()))] + 2 )
    else
    endif
    if ( Trig_Begins_an_Upgrade_Func008C() ) then
        set udg_PowerSupply[GetConvertedPlayerId(GetOwningPlayer(GetLastReplacedUnitBJ()))] = ( udg_PowerSupply[GetConvertedPlayerId(GetOwningPlayer(GetLastReplacedUnitBJ()))] + 10 )
    else
    endif
    if ( Trig_Begins_an_Upgrade_Func009C() ) then
        set udg_PowerSupply[GetConvertedPlayerId(GetOwningPlayer(GetLastReplacedUnitBJ()))] = ( udg_PowerSupply[GetConvertedPlayerId(GetOwningPlayer(GetLastReplacedUnitBJ()))] + 25 )
    else
    endif
    if ( Trig_Begins_an_Upgrade_Func010C() ) then
        set udg_PowerSupply[GetConvertedPlayerId(GetOwningPlayer(GetLastReplacedUnitBJ()))] = ( udg_PowerSupply[GetConvertedPlayerId(GetOwningPlayer(GetLastReplacedUnitBJ()))] + 15 )
    else
    endif
    if ( Trig_Begins_an_Upgrade_Func011C() ) then
        set udg_PowerSupply[GetConvertedPlayerId(GetOwningPlayer(GetLastReplacedUnitBJ()))] = ( udg_PowerSupply[GetConvertedPlayerId(GetOwningPlayer(GetLastReplacedUnitBJ()))] + 50 )
    else
    endif
    if ( Trig_Begins_an_Upgrade_Func012C() ) then
        set udg_Powerneeded[GetConvertedPlayerId(GetOwningPlayer(GetLastReplacedUnitBJ()))] = ( udg_Powerneeded[GetConvertedPlayerId(GetOwningPlayer(GetLastReplacedUnitBJ()))] + R2I(GetUnitStateSwap(UNIT_STATE_MAX_MANA, GetLastReplacedUnitBJ())) )
        call SetUnitUserData( GetLastReplacedUnitBJ(), R2I(GetUnitStateSwap(UNIT_STATE_MAX_MANA, GetLastReplacedUnitBJ())) )
    else
        call DoNothing(  )
    endif
endfunction

//===========================================================================
function InitTrig_Begins_an_Upgrade takes nothing returns nothing
    set gg_trg_Begins_an_Upgrade = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Begins_an_Upgrade, Player(0), EVENT_PLAYER_UNIT_UPGRADE_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Begins_an_Upgrade, Player(1), EVENT_PLAYER_UNIT_UPGRADE_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Begins_an_Upgrade, Player(2), EVENT_PLAYER_UNIT_UPGRADE_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Begins_an_Upgrade, Player(3), EVENT_PLAYER_UNIT_UPGRADE_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Begins_an_Upgrade, Player(4), EVENT_PLAYER_UNIT_UPGRADE_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Begins_an_Upgrade, Player(5), EVENT_PLAYER_UNIT_UPGRADE_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Begins_an_Upgrade, Player(6), EVENT_PLAYER_UNIT_UPGRADE_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Begins_an_Upgrade, Player(7), EVENT_PLAYER_UNIT_UPGRADE_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Begins_an_Upgrade, Player(8), EVENT_PLAYER_UNIT_UPGRADE_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Begins_an_Upgrade, Player(9), EVENT_PLAYER_UNIT_UPGRADE_START )
    call TriggerAddCondition( gg_trg_Begins_an_Upgrade, Condition( function Trig_Begins_an_Upgrade_Conditions ) )
    call TriggerAddAction( gg_trg_Begins_an_Upgrade, function Trig_Begins_an_Upgrade_Actions )
endfunction

//===========================================================================
// Trigger: Unit or Building Dies
//===========================================================================
function Trig_Unit_or_Building_Dies_Conditions takes nothing returns boolean
    if ( not ( udg_Empire[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Unit_or_Building_Dies_Func001C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetDyingUnit()) == 'h01N' ) ) then
        return false
    endif
    if ( not ( GetUnitUserData(GetDyingUnit()) == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Unit_or_Building_Dies_Func002C takes nothing returns boolean
    if ( not ( GetUnitStateSwap(UNIT_STATE_MAX_MANA, GetDyingUnit()) > 0.00 ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetDyingUnit()) != 'h022' ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetDyingUnit()) != 'h02A' ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetDyingUnit()) != 'h02B' ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetDyingUnit()) != 'h021' ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetDyingUnit()) != 'h02D' ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetDyingUnit()) != 'h002' ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetDyingUnit()) != 'h02C' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Unit_or_Building_Dies_Func003C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetDyingUnit()) == 'n01W' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Unit_or_Building_Dies_Func004C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetDyingUnit()) == 'n01C' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Unit_or_Building_Dies_Func005C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetDyingUnit()) == 'e01B' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Unit_or_Building_Dies_Func006C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetDyingUnit()) == 'h01E' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Unit_or_Building_Dies_Func007C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetDyingUnit()) == 'h00V' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Unit_or_Building_Dies_Func008C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetDyingUnit()) == 'h020' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Unit_or_Building_Dies_Func009C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetDyingUnit()) == 'h02N' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Unit_or_Building_Dies_Func010C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetDyingUnit()) == 'h02M' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Unit_or_Building_Dies_Func011C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetDyingUnit()) == 'h02F' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Unit_or_Building_Dies_Func013Func003C takes nothing returns boolean
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h02C' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h002' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h02D' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h021' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h02B' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h02A' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h022' ) ) then
        return true
    endif
    return false
endfunction

function Trig_Unit_or_Building_Dies_Func013Func007002002 takes nothing returns boolean
    return ( GetUnitTypeId(GetFilterUnit()) == 'e00U' )
endfunction

function Trig_Unit_or_Building_Dies_Func013Func012002002 takes nothing returns boolean
    return ( GetUnitTypeId(GetFilterUnit()) == 'h02W' )
endfunction

function Trig_Unit_or_Building_Dies_Func013Func017C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetDyingUnit()) == 'h022' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Unit_or_Building_Dies_Func013C takes nothing returns boolean
    if ( not Trig_Unit_or_Building_Dies_Func013Func003C() ) then
        return false
    endif
    return true
endfunction

function Trig_Unit_or_Building_Dies_Func014Func002002002001 takes nothing returns boolean
    return ( IsUnitAliveBJ(GetFilterUnit()) == true )
endfunction

function Trig_Unit_or_Building_Dies_Func014Func002002002002 takes nothing returns boolean
    return ( IsUnitType(GetFilterUnit(), UNIT_TYPE_TOWNHALL) == true )
endfunction

function Trig_Unit_or_Building_Dies_Func014Func002002002 takes nothing returns boolean
    return GetBooleanAnd( Trig_Unit_or_Building_Dies_Func014Func002002002001(), Trig_Unit_or_Building_Dies_Func014Func002002002002() )
endfunction

function Trig_Unit_or_Building_Dies_Func014Func003Func004002 takes nothing returns nothing
    call KillUnit( GetEnumUnit() )
endfunction

function Trig_Unit_or_Building_Dies_Func014Func003C takes nothing returns boolean
    if ( not ( udg_StartedEmpire[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] == 1 ) ) then
        return false
    endif
    if ( not ( udg_Empire[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] == 1 ) ) then
        return false
    endif
    if ( not ( CountUnitsInGroup(udg_TempGroup1) == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Unit_or_Building_Dies_Func014Func005C takes nothing returns boolean
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'o00G' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'o003' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'o000' ) ) then
        return true
    endif
    return false
endfunction

function Trig_Unit_or_Building_Dies_Func014C takes nothing returns boolean
    if ( not Trig_Unit_or_Building_Dies_Func014Func005C() ) then
        return false
    endif
    return true
endfunction

function Trig_Unit_or_Building_Dies_Func015Func007C takes nothing returns boolean
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h026' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h017' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h028' ) ) then
        return true
    endif
    return false
endfunction

function Trig_Unit_or_Building_Dies_Func015C takes nothing returns boolean
    if ( not Trig_Unit_or_Building_Dies_Func015Func007C() ) then
        return false
    endif
    return true
endfunction

function Trig_Unit_or_Building_Dies_Func016Func007C takes nothing returns boolean
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h01H' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h01G' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h01F' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h015' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h014' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h013' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h01B' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h01A' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h019' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h00O' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h00N' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h00M' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h00C' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h009' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetDyingUnit()) == 'h01U' ) ) then
        return true
    endif
    return false
endfunction

function Trig_Unit_or_Building_Dies_Func016C takes nothing returns boolean
    if ( not Trig_Unit_or_Building_Dies_Func016Func007C() ) then
        return false
    endif
    return true
endfunction

function Trig_Unit_or_Building_Dies_Func017C takes nothing returns boolean
    if ( not ( IsUnitType(GetDyingUnit(), UNIT_TYPE_STRUCTURE) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_Unit_or_Building_Dies_Actions takes nothing returns nothing
    if ( Trig_Unit_or_Building_Dies_Func001C() ) then
        set udg_FarmsAmount[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] = ( udg_FarmsAmount[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] - 1 )
    else
        call DoNothing(  )
    endif
    if ( Trig_Unit_or_Building_Dies_Func002C() ) then
        set udg_Powerneeded[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] = ( udg_Powerneeded[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] - GetUnitUserData(GetDyingUnit()) )
    else
        call DoNothing(  )
    endif
    if ( Trig_Unit_or_Building_Dies_Func003C() ) then
        set udg_Tempspot3 = GetUnitLoc(GetDyingUnit())
        call AddSpecialEffectLocBJ( udg_Tempspot3, "war3mapImported\\nuke.mdx" )
        call DestroyEffectBJ( GetLastCreatedEffectBJ() )
        call RemoveLocation( udg_Tempspot3 )
    else
        call DoNothing(  )
    endif
    if ( Trig_Unit_or_Building_Dies_Func004C() ) then
        set udg_Tempspot4 = GetUnitLoc(GetDyingUnit())
        call AddSpecialEffectLocBJ( udg_Tempspot4, "Objects\\Spawnmodels\\Human\\FragmentationShards\\FragBoomSpawn.mdl" )
        call DestroyEffectBJ( GetLastCreatedEffectBJ() )
        call RemoveLocation( udg_Tempspot4 )
    else
        call DoNothing(  )
    endif
    if ( Trig_Unit_or_Building_Dies_Func005C() ) then
        set udg_Tempspot4 = GetUnitLoc(GetDyingUnit())
        call AddSpecialEffectLocBJ( udg_Tempspot4, "war3mapImported\\NuclearStrike.MDX" )
        call DestroyEffectBJ( GetLastCreatedEffectBJ() )
        call RemoveLocation( udg_Tempspot4 )
    else
        call DoNothing(  )
    endif
    if ( Trig_Unit_or_Building_Dies_Func006C() ) then
        set udg_ScienceLab[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] = null
        set udg_player = GetOwningPlayer(GetDyingUnit())
        set udg_Researching[GetConvertedPlayerId(udg_player)] = 0
        set udg_ResearchNeed[GetConvertedPlayerId(udg_player)] = 0
        set udg_ResearchNeedStart[GetConvertedPlayerId(udg_player)] = 0
        set udg_ResearchDone[GetConvertedPlayerId(udg_player)] = 0
        set udg_ProjectName[GetConvertedPlayerId(udg_player)] = "None"
        call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(udg_player)], 2, 9, udg_ProjectName[GetConvertedPlayerId(udg_player)] )
        call MultiboardUpdate( udg_PlayerMultiboard[GetConvertedPlayerId(udg_player)], 10, 0.00 )
    else
        call DoNothing(  )
    endif
    if ( Trig_Unit_or_Building_Dies_Func007C() ) then
        set udg_PowerSupply[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] = ( udg_PowerSupply[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] - 2 )
    else
        call DoNothing(  )
    endif
    if ( Trig_Unit_or_Building_Dies_Func008C() ) then
        set udg_PowerSupply[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] = ( udg_PowerSupply[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] - 10 )
    else
        call DoNothing(  )
    endif
    if ( Trig_Unit_or_Building_Dies_Func009C() ) then
        set udg_PowerSupply[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] = ( udg_PowerSupply[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] - 15 )
    else
        call DoNothing(  )
    endif
    if ( Trig_Unit_or_Building_Dies_Func010C() ) then
        set udg_PowerSupply[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] = ( udg_PowerSupply[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] - 25 )
        set udg_Tempspot3 = GetUnitLoc(GetDyingUnit())
        call AddSpecialEffectLocBJ( udg_Tempspot3, "war3mapImported\\nuke.mdx" )
        call DestroyEffectBJ( GetLastCreatedEffectBJ() )
        call RemoveLocation( udg_Tempspot3 )
    else
        call DoNothing(  )
    endif
    if ( Trig_Unit_or_Building_Dies_Func011C() ) then
        set udg_PowerSupply[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] = ( udg_PowerSupply[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] - 50 )
        set udg_Tempspot3 = GetUnitLoc(GetDyingUnit())
        call AddSpecialEffectLocBJ( udg_Tempspot3, "war3mapImported\\nuke.mdx" )
        call DestroyEffectBJ( GetLastCreatedEffectBJ() )
        call RemoveLocation( udg_Tempspot3 )
    else
        call DoNothing(  )
    endif
    if ( Trig_Unit_or_Building_Dies_Func013C() ) then
        call GroupRemoveUnitSimple( GetDyingUnit(), udg_Houses )
        set udg_happyness[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] = ( udg_happyness[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] - 10 )
        set udg_Tempspot12 = GetUnitLoc(GetDyingUnit())
        set udg_TempRegion3 = RectFromCenterSizeBJ(udg_Tempspot12, 120.00, 120.00)
        set udg_TempGroup1 = GetUnitsInRectMatching(udg_TempRegion3, Condition(function Trig_Unit_or_Building_Dies_Func013Func007002002))
        call KillUnit( GroupPickRandomUnit(udg_TempGroup1) )
        call RemoveRect( udg_TempRegion3 )
        call DestroyGroup( udg_TempGroup1 )
        set udg_TempRegion3 = RectFromCenterSizeBJ(udg_Tempspot12, 120.00, 120.00)
        set udg_TempGroup1 = GetUnitsInRectMatching(udg_TempRegion3, Condition(function Trig_Unit_or_Building_Dies_Func013Func012002002))
        call KillUnit( GroupPickRandomUnit(udg_TempGroup1) )
        call RemoveRect( udg_TempRegion3 )
        call DestroyGroup( udg_TempGroup1 )
        call RemoveLocation( udg_Tempspot12 )
        if ( Trig_Unit_or_Building_Dies_Func013Func017C() ) then
            set udg_Tempspot11 = GetUnitLoc(GetDyingUnit())
            call CreateNUnitsAtLoc( 1, 'e016', Player(PLAYER_NEUTRAL_PASSIVE), udg_Tempspot11, bj_UNIT_FACING )
            call RemoveLocation( udg_Tempspot11 )
            call RemoveUnit( GetDyingUnit() )
            call KillUnit( GetLastCreatedUnit() )
        else
            call DoNothing(  )
        endif
    else
        set udg_happyness[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] = ( udg_happyness[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] - 5 )
    endif
    if ( Trig_Unit_or_Building_Dies_Func014C() ) then
        set udg_TempGroup1 = GetUnitsOfPlayerMatching(GetOwningPlayer(GetDyingUnit()), Condition(function Trig_Unit_or_Building_Dies_Func014Func002002002))
        if ( Trig_Unit_or_Building_Dies_Func014Func003C() ) then
            call ForceRemovePlayerSimple( GetOwningPlayer(GetDyingUnit()), udg_AttackerGroup )
            set udg_TempGroup1 = GetUnitsOfPlayerAll(GetOwningPlayer(GetDyingUnit()))
            call ForGroupBJ( udg_TempGroup1, function Trig_Unit_or_Building_Dies_Func014Func003Func004002 )
            call DestroyGroup( udg_TempGroup1 )
            call DisplayTimedTextToForce( GetPlayersAll(), 10.00, ( ( udg_Playercolor[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] + GetPlayerName(GetOwningPlayer(GetDyingUnit())) ) + "'s |cffffcc00Empire has fallen!" ) )
            set udg_Empire[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] = 0
            set udg_Empires = ( udg_Empires - 1 )
            call TriggerExecute( gg_trg_Defeat_check )
        else
            call DoNothing(  )
        endif
        call DestroyGroup( udg_TempGroup1 )
    else
        call DoNothing(  )
    endif
    if ( Trig_Unit_or_Building_Dies_Func015C() ) then
        set udg_Tempspot11 = GetUnitLoc(GetDyingUnit())
        call CreateNUnitsAtLoc( 1, 'e017', Player(PLAYER_NEUTRAL_PASSIVE), udg_Tempspot11, bj_UNIT_FACING )
        call RemoveLocation( udg_Tempspot11 )
        call RemoveUnit( GetDyingUnit() )
        call KillUnit( GetLastCreatedUnit() )
        return
    else
    endif
    if ( Trig_Unit_or_Building_Dies_Func016C() ) then
        set udg_Tempspot11 = GetUnitLoc(GetDyingUnit())
        call CreateNUnitsAtLoc( 1, 'e016', Player(PLAYER_NEUTRAL_PASSIVE), udg_Tempspot11, bj_UNIT_FACING )
        call RemoveLocation( udg_Tempspot11 )
        call RemoveUnit( GetDyingUnit() )
        call KillUnit( GetLastCreatedUnit() )
        return
    else
    endif
    if ( Trig_Unit_or_Building_Dies_Func017C() ) then
        call PolledWait( 1.00 )
        call RemoveUnit( GetDyingUnit() )
    else
        call PolledWait( 5.00 )
        call RemoveUnit( GetDyingUnit() )
    endif
endfunction

//===========================================================================
function InitTrig_Unit_or_Building_Dies takes nothing returns nothing
    set gg_trg_Unit_or_Building_Dies = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_or_Building_Dies, Player(0), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_or_Building_Dies, Player(1), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_or_Building_Dies, Player(2), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_or_Building_Dies, Player(3), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_or_Building_Dies, Player(4), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_or_Building_Dies, Player(5), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_or_Building_Dies, Player(6), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_or_Building_Dies, Player(7), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_or_Building_Dies, Player(8), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_or_Building_Dies, Player(9), EVENT_PLAYER_UNIT_DEATH )
    call TriggerAddCondition( gg_trg_Unit_or_Building_Dies, Condition( function Trig_Unit_or_Building_Dies_Conditions ) )
    call TriggerAddAction( gg_trg_Unit_or_Building_Dies, function Trig_Unit_or_Building_Dies_Actions )
endfunction

//===========================================================================
// Trigger: New Building
//===========================================================================
function Trig_New_Building_Conditions takes nothing returns boolean
local unit u = GetConstructingStructure()
if GetUnitTypeId(u) == 'h026' or GetUnitTypeId(u) == 'h02J' or GetUnitTypeId(u) == 'h024' then
set u = null
return true
endif
set u = null
return false
endfunction

function TownHallCheck takes nothing returns boolean
local unit u = GetFilterUnit()
if IsUnitType(u, UNIT_TYPE_TOWNHALL) == true and GetUnitUserData(u) == 1 then
set u = null
return true
endif
set u = null
return false
endfunction

function DestructableCheck takes nothing returns boolean
local destructable d = GetFilterDestructable()
if GetDestructableTypeId(d) == 'B002' then
set d = null
return true
endif
set d = null
return false
endfunction

function Trig_New_Building_Actions takes nothing returns nothing
local unit u = GetConstructingStructure()
local player p = GetOwningPlayer(u)
local location l = GetUnitLoc(u)
local group g = GetUnitsInRangeOfLocMatching(200.00, l, Condition(function TownHallCheck))
local integer townhalls = CountUnitsInGroup(g)
local rect r = null
local destructable d = null

if GetUnitTypeId(u) == 'h024' then
set r = RectFromCenterSizeBJ(l, 200.00, 200.00)
set d = RandomDestructableInRectBJ(r, Condition(function DestructableCheck))
if d == null and townhalls == 0 then
call AdjustPlayerStateBJ( 1, p, PLAYER_STATE_RESOURCE_GOLD )
call AdjustPlayerStateBJ( 5, p, PLAYER_STATE_RESOURCE_LUMBER )
call RemoveUnit( u )
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffffcc00Roads can only be build next to another road or next to a townhall!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif
endif

if GetUnitTypeId(u) == 'h02J' or GetUnitTypeId(u) == 'h026' then
set r = RectFromCenterSizeBJ(l, 300.00, 300.00)
set d = RandomDestructableInRectBJ(r, Condition(function DestructableCheck))
if GetUnitTypeId(u) == 'h02J' and d == null then
call AdjustPlayerStateBJ( 300, p, PLAYER_STATE_RESOURCE_LUMBER )
call RemoveUnit( u )
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffffcc00Houses must be build next to a road." )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif
if GetUnitTypeId(u) == 'h026' and d == null then
call AdjustPlayerStateBJ( 200, p, PLAYER_STATE_RESOURCE_LUMBER )
call RemoveUnit( u )
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffffcc00Foundations must be build next to a road." )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif
endif

set u = null
set p = null
call RemoveLocation(l)
set l = null
call DestroyGroup(g)
set g = null
call RemoveRect(r)
set r = null
set d = null
endfunction

//===========================================================================
function InitTrig_New_Building takes nothing returns nothing
    set gg_trg_New_Building = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_New_Building, Player(0), EVENT_PLAYER_UNIT_CONSTRUCT_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_New_Building, Player(1), EVENT_PLAYER_UNIT_CONSTRUCT_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_New_Building, Player(2), EVENT_PLAYER_UNIT_CONSTRUCT_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_New_Building, Player(3), EVENT_PLAYER_UNIT_CONSTRUCT_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_New_Building, Player(4), EVENT_PLAYER_UNIT_CONSTRUCT_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_New_Building, Player(5), EVENT_PLAYER_UNIT_CONSTRUCT_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_New_Building, Player(6), EVENT_PLAYER_UNIT_CONSTRUCT_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_New_Building, Player(7), EVENT_PLAYER_UNIT_CONSTRUCT_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_New_Building, Player(8), EVENT_PLAYER_UNIT_CONSTRUCT_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_New_Building, Player(9), EVENT_PLAYER_UNIT_CONSTRUCT_START )
    call TriggerAddCondition( gg_trg_New_Building, Condition( function Trig_New_Building_Conditions ) )
    call TriggerAddAction( gg_trg_New_Building, function Trig_New_Building_Actions )
endfunction

//===========================================================================
// Trigger: New Building Grace
//===========================================================================
function Trig_New_Building_Grace_Actions takes nothing returns nothing
local unit u = GetConstructingStructure()
local player p = GetOwningPlayer(u)
if udg_Empire[GetConvertedPlayerId(p)] == 1 then
if GetUnitTypeId(u) != 'o001' and GetUnitTypeId(u) != 'h009' and GetUnitTypeId(u) != 'h00C' then
if udg_Damageunits == 0 then
call SetUnitInvulnerable( u, true )
else
call DestroyTrigger(GetTriggeringTrigger())
endif
endif
endif
set p = null
set u = null
endfunction

//===========================================================================
function InitTrig_New_Building_Grace takes nothing returns nothing
    set gg_trg_New_Building_Grace = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_New_Building_Grace, Player(0), EVENT_PLAYER_UNIT_CONSTRUCT_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_New_Building_Grace, Player(1), EVENT_PLAYER_UNIT_CONSTRUCT_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_New_Building_Grace, Player(2), EVENT_PLAYER_UNIT_CONSTRUCT_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_New_Building_Grace, Player(3), EVENT_PLAYER_UNIT_CONSTRUCT_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_New_Building_Grace, Player(4), EVENT_PLAYER_UNIT_CONSTRUCT_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_New_Building_Grace, Player(5), EVENT_PLAYER_UNIT_CONSTRUCT_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_New_Building_Grace, Player(6), EVENT_PLAYER_UNIT_CONSTRUCT_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_New_Building_Grace, Player(7), EVENT_PLAYER_UNIT_CONSTRUCT_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_New_Building_Grace, Player(8), EVENT_PLAYER_UNIT_CONSTRUCT_START )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_New_Building_Grace, Player(9), EVENT_PLAYER_UNIT_CONSTRUCT_START )
    call TriggerAddAction( gg_trg_New_Building_Grace, function Trig_New_Building_Grace_Actions )
endfunction

//===========================================================================
// Trigger: Nuclear Missle Launch
//===========================================================================
function Missle_Launch takes nothing returns nothing
local unit u = udg_ZZUnit
local location l = null
local location l1 = null
local location l2 = GetUnitLoc(udg_ZZUnit2)
loop
set l = GetUnitLoc(u)
exitwhen DistanceBetweenPoints(l, l2) <= 300
exitwhen IsUnitDeadBJ(u)
set l1 = PolarProjectionBJ(l, 300, AngleBetweenPoints(l, l2) )
call SetUnitPositionLocFacingBJ( u, l1, AngleBetweenPoints(l, l2) )
if GetUnitFlyHeight(u) > 400 then
call SetUnitFlyHeightBJ( u, GetUnitFlyHeight(u) - 10, 0.00 )
endif
call PolledWait(0.25)
call RemoveLocation(l)
call RemoveLocation(l1)
endloop
call KillUnit( u )
call RemoveLocation( l )
call RemoveLocation( l2 )
set u = null
set l = null
set l1 = null
set l2 = null
endfunction

function Trig_Nuclear_Missle_Launch_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A005' then
return true
endif
return false
endfunction

function Trig_Nuclear_Missle_Launch_Actions takes nothing returns nothing
local trigger t = CreateTrigger()
local unit u = GetSpellAbilityUnit()
local unit u2 = null
local location l = GetSpellTargetLoc()
local location l2 = GetUnitLoc(u)
local player p = GetOwningPlayer(u)
if udg_MisslesFired == 0 then
call StopSoundBJ( gg_snd_Nuclear_Launch, false )
call PlaySoundBJ( gg_snd_Nuclear_Launch )
else
call PlaySoundBJ( gg_snd_Nuclear_Launch )
endif
set udg_MisslesFired = 1
set u = null
call TriggerAddAction( t, function Missle_Launch )
call PolledWait(0.50)
call CreateNUnitsAtLoc( 1, 'e01B', p, l2, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call SetUnitFlyHeightBJ( u, 600.00, 0.00 )
call CreateNUnitsAtLoc( 1, 'e01B', p, l, bj_UNIT_FACING )
set u2 = GetLastCreatedUnit()
set udg_ZZUnit = u
set udg_ZZUnit2 = u2
call TriggerExecute(t)
call PolledWait(0.25)
set udg_MisslesFired = 0
call RemoveUnit(u2)
set u = null
set u2 = null
call RemoveLocation(l)
set l = null
call RemoveLocation(l2)
set l2 = null
set p = null
call DestroyTrigger(t)
set t = null
endfunction

//===========================================================================
function InitTrig_Nuclear_Missle_Launch takes nothing returns nothing
    set gg_trg_Nuclear_Missle_Launch = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nuclear_Missle_Launch, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nuclear_Missle_Launch, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nuclear_Missle_Launch, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nuclear_Missle_Launch, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nuclear_Missle_Launch, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nuclear_Missle_Launch, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nuclear_Missle_Launch, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nuclear_Missle_Launch, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nuclear_Missle_Launch, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nuclear_Missle_Launch, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Nuclear_Missle_Launch, Condition( function Trig_Nuclear_Missle_Launch_Conditions ) )
    call TriggerAddAction( gg_trg_Nuclear_Missle_Launch, function Trig_Nuclear_Missle_Launch_Actions )
endfunction

//===========================================================================
// Trigger: Black Hole
//===========================================================================
function Trig_Black_Hole_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A08G' then
return true
endif
return false
endfunction

function Trig_Black_Hole_Actions takes nothing returns nothing
local unit u = GetSpellAbilityUnit()
local unit u2 = null
local player p = GetOwningPlayer(u)
local location l = GetSpellTargetLoc()
if udg_MisslesFired == 0 then
call StopSoundBJ( gg_snd_Nuclear_Launch, false )
call PlaySoundBJ( gg_snd_Nuclear_Launch )
else
call PlaySoundBJ( gg_snd_Nuclear_Launch )
endif
call CreateNUnitsAtLoc( 1, 'e02G', p, l, bj_UNIT_FACING )
set u2 = GetLastCreatedUnit()
call UnitApplyTimedLifeBJ( 10.00, 'BTLF', u2 )
call PolledWait(0.25)
set udg_MisslesFired = 0
call RemoveLocation( l )
set u = null
set u2= null
set p = null
set l = null
endfunction

//===========================================================================
function InitTrig_Black_Hole takes nothing returns nothing
    set gg_trg_Black_Hole = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Black_Hole, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Black_Hole, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Black_Hole, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Black_Hole, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Black_Hole, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Black_Hole, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Black_Hole, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Black_Hole, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Black_Hole, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Black_Hole, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Black_Hole, Condition( function Trig_Black_Hole_Conditions ) )
    call TriggerAddAction( gg_trg_Black_Hole, function Trig_Black_Hole_Actions )
endfunction

//===========================================================================
// Trigger: Age Up
//===========================================================================
function Trig_Age_Up_Conditions takes nothing returns boolean
local integer i = GetResearched()
if i == 'R016' or i == 'R017' or i == 'R018' or i == 'R019' or i == 'R01A' or i == 'R01B' or i == 'R01C' or i == 'R01D' or i == 'R01E' or i == 'R01F' or i == 'R01G' or i == 'R01H' or i == 'R01I' or i == 'R01J' or i == 'R01K' or i == 'R01L' or i == 'R01M' or i == 'R01N' or i == 'R01O' then
return true
endif
return false
endfunction

function Trig_Age_Up_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
call PlaySoundForPlayer( p, gg_snd_ArrangedTeamInvitation )
set udg_CurrentAge[GetConvertedPlayerId(p)] = ( udg_CurrentAge[GetConvertedPlayerId(p)] + 1 )
if udg_CurrentAge[GetConvertedPlayerId(p)] == 2 then
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 2, "Neolithic" )
call SetPlayerTechMaxAllowedSwap( 'R017', 1, p )
endif
if udg_CurrentAge[GetConvertedPlayerId(p)] == 3 then
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 2, "Stone" )
call SetPlayerTechMaxAllowedSwap( 'R018', 1, p )
endif
if udg_CurrentAge[GetConvertedPlayerId(p)] == 4 then
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 2, "Copper" )
call SetPlayerTechMaxAllowedSwap( 'R019', 1, p )
endif
if udg_CurrentAge[GetConvertedPlayerId(p)] == 5 then
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 2, "Bronze" )
call SetPlayerTechMaxAllowedSwap( 'R01A', 1, p )
endif
if udg_CurrentAge[GetConvertedPlayerId(p)] == 6 then
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 2, "Iron" )
call SetPlayerTechMaxAllowedSwap( 'R01B', 1, p )
endif
if udg_CurrentAge[GetConvertedPlayerId(p)] == 7 then
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 2, "Dark" )
call SetPlayerTechMaxAllowedSwap( 'R01C', 1, p )
endif
if udg_CurrentAge[GetConvertedPlayerId(p)] == 8 then
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 2, "Middle" )
call SetPlayerTechMaxAllowedSwap( 'R01D', 1, p )
endif
if udg_CurrentAge[GetConvertedPlayerId(p)] == 9 then
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 2, "Renaissance" )
call SetPlayerTechMaxAllowedSwap( 'R01E', 1, p )
endif
if udg_CurrentAge[GetConvertedPlayerId(p)] == 10 then
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 2, "Absolutism" )
call SetPlayerTechMaxAllowedSwap( 'R01F', 1, p )
endif
if udg_CurrentAge[GetConvertedPlayerId(p)] == 11 then
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 2, "Enlightment" )
call SetPlayerTechMaxAllowedSwap( 'R01G', 1, p )
endif
if udg_CurrentAge[GetConvertedPlayerId(p)] == 12 then
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 2, "Imperial" )
call SetPlayerTechMaxAllowedSwap( 'R01H', 1, p )
endif
if udg_CurrentAge[GetConvertedPlayerId(p)] == 13 then
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 2, "Industrial" )
call SetPlayerTechMaxAllowedSwap( 'R01I', 1, p )
endif
if udg_CurrentAge[GetConvertedPlayerId(p)] == 14 then
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 2, "World War 1" )
call SetPlayerTechMaxAllowedSwap( 'R01J', 1, p )
endif
if udg_CurrentAge[GetConvertedPlayerId(p)] == 15 then
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 2, "World War 2" )
call SetPlayerTechMaxAllowedSwap( 'R01K', 1, p )
endif
if udg_CurrentAge[GetConvertedPlayerId(p)] == 16 then
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 2, "Atomic" )
call SetPlayerTechMaxAllowedSwap( 'R01L', 1, p )
endif
if udg_CurrentAge[GetConvertedPlayerId(p)] == 17 then
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 2, "Cold War" )
call SetPlayerTechMaxAllowedSwap( 'R01M', 1, p )
endif
if udg_CurrentAge[GetConvertedPlayerId(p)] == 18 then
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 2, "Digital" )
call SetPlayerTechMaxAllowedSwap( 'R01N', 1, p )
endif
if udg_CurrentAge[GetConvertedPlayerId(p)] == 19 then
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 2, "Space" )
call SetPlayerTechMaxAllowedSwap( 'R01O', 1, p )
endif
if udg_CurrentAge[GetConvertedPlayerId(p)] == 20 then
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 2, "Future" )
endif
set u = null
set p = null
endfunction

//===========================================================================
function InitTrig_Age_Up takes nothing returns nothing
    set gg_trg_Age_Up = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Age_Up, Player(0), EVENT_PLAYER_UNIT_RESEARCH_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Age_Up, Player(1), EVENT_PLAYER_UNIT_RESEARCH_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Age_Up, Player(2), EVENT_PLAYER_UNIT_RESEARCH_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Age_Up, Player(3), EVENT_PLAYER_UNIT_RESEARCH_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Age_Up, Player(4), EVENT_PLAYER_UNIT_RESEARCH_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Age_Up, Player(5), EVENT_PLAYER_UNIT_RESEARCH_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Age_Up, Player(6), EVENT_PLAYER_UNIT_RESEARCH_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Age_Up, Player(7), EVENT_PLAYER_UNIT_RESEARCH_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Age_Up, Player(8), EVENT_PLAYER_UNIT_RESEARCH_FINISH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Age_Up, Player(9), EVENT_PLAYER_UNIT_RESEARCH_FINISH )
    call TriggerAddCondition( gg_trg_Age_Up, Condition( function Trig_Age_Up_Conditions ) )
    call TriggerAddAction( gg_trg_Age_Up, function Trig_Age_Up_Actions )
endfunction

//===========================================================================
// Trigger: Fire Dies
//===========================================================================
function Trig_Fire_Dies_Conditions takes nothing returns boolean
local unit u = GetDyingUnit()
if GetUnitTypeId(u) == 'e00U' then
set u = null
return true
endif
set u = null
return false
endfunction

function FireManKillCheck takes nothing returns boolean
local unit u = GetFilterUnit()
local unit u2 = GetDyingUnit()
if GetUnitTypeId(u) == 'n01G' and GetUnitUserData(u) == GetUnitUserData(u2) then
set u = null
set u2 = null
return true
endif
set u = null
set u2 = null
return false
endfunction

function KillFireManNow takes nothing returns nothing
local unit u = GetEnumUnit()
call RemoveUnit( u )
set u = null
endfunction

function Trig_Fire_Dies_Actions takes nothing returns nothing
local unit u = GetDyingUnit()
local unit u2 = GetKillingUnitBJ()
local player p = GetOwningPlayer(u2)
local group g = GetUnitsOfPlayerMatching(p, Condition(function FireManKillCheck))
call ForGroupBJ( g, function KillFireManNow )
call RemoveUnit( u )
call DestroyGroup( g )
set u = null
set u2 = null
set p = null
set g = null
endfunction

//===========================================================================
function InitTrig_Fire_Dies takes nothing returns nothing
    set gg_trg_Fire_Dies = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Fire_Dies, Player(PLAYER_NEUTRAL_AGGRESSIVE), EVENT_PLAYER_UNIT_DEATH )
    call TriggerAddCondition( gg_trg_Fire_Dies, Condition( function Trig_Fire_Dies_Conditions ) )
    call TriggerAddAction( gg_trg_Fire_Dies, function Trig_Fire_Dies_Actions )
endfunction

//===========================================================================
// Trigger: Grow Trees
//===========================================================================
function Trig_Grow_Trees_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A02R' then
return true
endif
return false
endfunction

function GrowTreeNow takes nothing returns nothing
local destructable d = GetEnumDestructable()
call DestructableRestoreLife( d, GetDestructableMaxLife(d), true )
set d = null
endfunction

function Trig_Grow_Trees_Actions takes nothing returns nothing
local location l = GetSpellTargetLoc()
local group g = GetUnitsInRangeOfLocAll(150.00, l)
if CountUnitsInGroup(g) == 0 then
call EnumDestructablesInCircleBJ( 150.00, l, function GrowTreeNow )
endif
call DestroyGroup(g)
call RemoveLocation(l)
set g = null
set l = null
endfunction

//===========================================================================
function InitTrig_Grow_Trees takes nothing returns nothing
    set gg_trg_Grow_Trees = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Grow_Trees, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Grow_Trees, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Grow_Trees, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Grow_Trees, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Grow_Trees, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Grow_Trees, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Grow_Trees, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Grow_Trees, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Grow_Trees, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Grow_Trees, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Grow_Trees, Condition( function Trig_Grow_Trees_Conditions ) )
    call TriggerAddAction( gg_trg_Grow_Trees, function Trig_Grow_Trees_Actions )
endfunction

//===========================================================================
// Trigger: Destroy Road
//===========================================================================
function Trig_Destroy_Road_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A002' then
return true
endif
return false
endfunction

function Trig_Destroy_Road_Func002003 takes nothing returns nothing
local destructable d = GetEnumDestructable()
call RemoveDestructable( d )
set d = null
endfunction

function Trig_Destroy_Road_Actions takes nothing returns nothing
local location l = GetSpellTargetLoc()
call EnumDestructablesInCircleBJ( 50.00, l, function Trig_Destroy_Road_Func002003 )
call RemoveLocation( l )
set l = null
endfunction

//===========================================================================
function InitTrig_Destroy_Road takes nothing returns nothing
    set gg_trg_Destroy_Road = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Destroy_Road, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Destroy_Road, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Destroy_Road, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Destroy_Road, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Destroy_Road, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Destroy_Road, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Destroy_Road, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Destroy_Road, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Destroy_Road, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Destroy_Road, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Destroy_Road, Condition( function Trig_Destroy_Road_Conditions ) )
    call TriggerAddAction( gg_trg_Destroy_Road, function Trig_Destroy_Road_Actions )
endfunction

//===========================================================================
// Trigger: No Hiring
//===========================================================================
function Trig_No_Hiring_Conditions takes nothing returns boolean
local unit u = GetSoldUnit()
local player p = GetOwningPlayer(u)
if udg_Empire[GetConvertedPlayerId(p)] == 1 then
set u = null
set p = null
return true
endif
set u = null
set p = null
return false
endfunction

function Trig_No_Hiring_Actions takes nothing returns nothing
local unit u = GetSoldUnit()
call RemoveUnit( u )
set u = null
endfunction

//===========================================================================
function InitTrig_No_Hiring takes nothing returns nothing
    set gg_trg_No_Hiring = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_No_Hiring, Player(PLAYER_NEUTRAL_PASSIVE), EVENT_PLAYER_UNIT_SELL )
    call TriggerAddCondition( gg_trg_No_Hiring, Condition( function Trig_No_Hiring_Conditions ) )
    call TriggerAddAction( gg_trg_No_Hiring, function Trig_No_Hiring_Actions )
endfunction

//===========================================================================
// Trigger: Science Lab
//===========================================================================
function ScienceLab takes nothing returns nothing
local unit u = GetEnumUnit()
local location l = GetUnitLoc(u)
local player p = GetOwningPlayer(u)
local integer i = 0
local integer i2 = GetConvertedPlayerId(p)

if udg_ResearchNeedStart[i2] == 0 then
set udg_ProjectName[i2] = "None"
set udg_ResearchDone[i2] = 0
else
if udg_ResearchNeedStart[i2] > 0 and GetPlayerState(p, PLAYER_STATE_RESOURCE_GOLD) > ( udg_PeopleSience[i2] / 25 ) then
set i = ( udg_PeopleSience[i2] / -25 )
call SetFloatingText(p,I2S(i),GetLocationX(l),GetLocationY(l),0,255,220,0)
call AdjustPlayerStateBJ( i, p, PLAYER_STATE_RESOURCE_GOLD )
set udg_ResearchNeed[i2] = ( udg_ResearchNeed[i2] - ( udg_PeopleSience[i2] / 20 ) )
else
call SetFloatingText(p,"0",GetLocationX(l),GetLocationY(l),0,255,220,0)
endif
if udg_ResearchNeed[i2] <= 0 then
set udg_ResearchNeed[i2] = 0
set udg_ResearchNeedStart[i2] = 0
set udg_ResearchDone[i2] = 0
set udg_player = p
call TriggerExecute( gg_trg_Research_Done )
else
set i = ( ( udg_ResearchNeed[i2] * 100 ) / udg_ResearchNeedStart[i2] )
set udg_ResearchDone[i2] = ( 100 - i )
call MultiboardUpdate( udg_PlayerMultiboard[i2], 10, I2R(udg_ResearchDone[i2]) )
endif
endif

set u = null
call RemoveLocation(l)
set l = null
set p = null
endfunction

function Trig_Science_Lab_Actions takes nothing returns nothing
local group g = GetUnitsOfTypeIdAll('h01E')
call ForGroup( g, function ScienceLab )
call DestroyGroup(g)
set g = null
endfunction

//===========================================================================
function InitTrig_Science_Lab takes nothing returns nothing
    set gg_trg_Science_Lab = CreateTrigger(  )
    call TriggerRegisterTimerEventPeriodic( gg_trg_Science_Lab, 2.00 )
    call TriggerAddAction( gg_trg_Science_Lab, function Trig_Science_Lab_Actions )
endfunction

//===========================================================================
// Trigger: Start Research
//===========================================================================
function Trig_Start_Research_Func050C takes nothing returns boolean
    if ( ( GetSpellAbilityId() == 'A05B' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A059' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A05C' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A05D' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A05A' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A054' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A05F' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A05N' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A01F' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A00M' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A000' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A07J' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A07K' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A07H' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A07I' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A08A' ) ) then
        return true
    endif
    return false
endfunction

function Trig_Start_Research_Conditions takes nothing returns boolean
    if ( not Trig_Start_Research_Func050C() ) then
        return false
    endif
    return true
endfunction

function Trig_Start_Research_Func012C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A05A' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Start_Research_Func013C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A05B' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Start_Research_Func014C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A059' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Start_Research_Func015C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A05F' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Start_Research_Func016C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A05N' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Start_Research_Func017C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A01F' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Start_Research_Func019C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A05C' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Start_Research_Func020C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A05D' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Start_Research_Func021C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A054' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Start_Research_Func022C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A00M' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Start_Research_Func023C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A000' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Start_Research_Func025C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A07J' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Start_Research_Func026C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A08A' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Start_Research_Func027C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A07K' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Start_Research_Func028C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A07I' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Start_Research_Func029C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A07H' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Start_Research_Actions takes nothing returns nothing
    // Unit Upgrades
    if ( Trig_Start_Research_Func012C() ) then
        set udg_ResearchNeedStart[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( 300 + ( GetPlayerTechCountSimple('R001', GetOwningPlayer(GetTriggerUnit())) * 600 ) )
        set udg_ProjectName[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = "Weapons"
    else
        call DoNothing(  )
    endif
    if ( Trig_Start_Research_Func013C() ) then
        set udg_ResearchNeedStart[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( 300 + ( GetPlayerTechCountSimple('R002', GetOwningPlayer(GetTriggerUnit())) * 600 ) )
        set udg_ProjectName[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = "Armor"
    else
        call DoNothing(  )
    endif
    if ( Trig_Start_Research_Func014C() ) then
        set udg_ResearchNeedStart[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( 300 + ( GetPlayerTechCountSimple('R008', GetOwningPlayer(GetTriggerUnit())) * 600 ) )
        set udg_ProjectName[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = "Defense"
    else
        call DoNothing(  )
    endif
    if ( Trig_Start_Research_Func015C() ) then
        set udg_ResearchNeedStart[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( 500 + ( GetPlayerTechCountSimple('R00D', GetOwningPlayer(GetTriggerUnit())) * 1000 ) )
        set udg_ProjectName[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = "Health Enchantment"
    else
        call DoNothing(  )
    endif
    if ( Trig_Start_Research_Func016C() ) then
        set udg_ResearchNeedStart[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( 250 + ( GetPlayerTechCountSimple('R00C', GetOwningPlayer(GetTriggerUnit())) * 500 ) )
        set udg_ProjectName[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = "Regeneration"
    else
        call DoNothing(  )
    endif
    if ( Trig_Start_Research_Func017C() ) then
        set udg_ResearchNeedStart[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( 750 + ( GetPlayerTechCountSimple('R00F', GetOwningPlayer(GetTriggerUnit())) * 1500 ) )
        set udg_ProjectName[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = "Precision"
    else
        call DoNothing(  )
    endif
    // Houses/Wood Cutting/Grain Farming
    if ( Trig_Start_Research_Func019C() ) then
        set udg_ResearchNeedStart[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( 250 + ( udg_GrainFarming[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] * 500 ) )
        set udg_ProjectName[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = "Grain Farming"
    else
        call DoNothing(  )
    endif
    if ( Trig_Start_Research_Func020C() ) then
        set udg_ResearchNeedStart[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( 500 + ( GetPlayerTechCountSimple('R005', GetOwningPlayer(GetTriggerUnit())) * 1000 ) )
        set udg_ProjectName[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = "Houses"
    else
        call DoNothing(  )
    endif
    if ( Trig_Start_Research_Func021C() ) then
        set udg_ResearchNeedStart[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( 500 + ( GetPlayerTechCountSimple('R003', GetOwningPlayer(GetTriggerUnit())) * 1000 ) )
        set udg_ProjectName[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = "Wood Cutting"
    else
        call DoNothing(  )
    endif
    if ( Trig_Start_Research_Func022C() ) then
        set udg_ResearchNeedStart[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( 200 + ( GetPlayerTechCountSimple('R009', GetOwningPlayer(GetTriggerUnit())) * 400 ) )
        set udg_ProjectName[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = "Building"
    else
        call DoNothing(  )
    endif
    if ( Trig_Start_Research_Func023C() ) then
        set udg_ResearchNeedStart[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( 300 + ( GetPlayerTechCountSimple('R00H', GetOwningPlayer(GetTriggerUnit())) * 750 ) )
        set udg_ProjectName[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = "Movement"
    else
        call DoNothing(  )
    endif
    // Techs
    if ( Trig_Start_Research_Func025C() ) then
        set udg_ResearchNeedStart[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( 1000 + ( GetPlayerTechCountSimple('R006', GetOwningPlayer(GetTriggerUnit())) * 2000 ) )
        set udg_ProjectName[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = "Airplanes"
    else
        call DoNothing(  )
    endif
    if ( Trig_Start_Research_Func026C() ) then
        set udg_ResearchNeedStart[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( 1000 + ( GetPlayerTechCountSimple('R00E', GetOwningPlayer(GetTriggerUnit())) * 2000 ) )
        set udg_ProjectName[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = "Towers"
    else
        call DoNothing(  )
    endif
    if ( Trig_Start_Research_Func027C() ) then
        set udg_ResearchNeedStart[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( 1000 + ( GetPlayerTechCountSimple('R00G', GetOwningPlayer(GetTriggerUnit())) * 2000 ) )
        set udg_ProjectName[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = "Destruction"
    else
        call DoNothing(  )
    endif
    if ( Trig_Start_Research_Func028C() ) then
        set udg_ResearchNeedStart[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( 1000 + ( GetPlayerTechCountSimple('R004', GetOwningPlayer(GetTriggerUnit())) * 2000 ) )
        set udg_ProjectName[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = "Tanks"
    else
        call DoNothing(  )
    endif
    if ( Trig_Start_Research_Func029C() ) then
        set udg_ResearchNeedStart[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( 1000 + ( GetPlayerTechCountSimple('R000', GetOwningPlayer(GetTriggerUnit())) * 2000 ) )
        set udg_ProjectName[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = "Infantry"
    else
        call DoNothing(  )
    endif
    set udg_ResearchNeed[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = udg_ResearchNeedStart[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))]
    call UnitRemoveAbilityBJ( 'A05B', GetTriggerUnit() )
    call UnitRemoveAbilityBJ( 'A059', GetTriggerUnit() )
    call UnitRemoveAbilityBJ( 'A05C', GetTriggerUnit() )
    call UnitRemoveAbilityBJ( 'A05D', GetTriggerUnit() )
    call UnitRemoveAbilityBJ( 'A05A', GetTriggerUnit() )
    call UnitRemoveAbilityBJ( 'A054', GetTriggerUnit() )
    call UnitRemoveAbilityBJ( 'A05F', GetTriggerUnit() )
    call UnitRemoveAbilityBJ( 'A05N', GetTriggerUnit() )
    call UnitRemoveAbilityBJ( 'A01F', GetTriggerUnit() )
    call UnitRemoveAbilityBJ( 'A00M', GetTriggerUnit() )
    call UnitRemoveAbilityBJ( 'A000', GetTriggerUnit() )
    call UnitRemoveAbilityBJ( 'A00O', GetTriggerUnit() )
    call UnitRemoveAbilityBJ( 'A07J', GetTriggerUnit() )
    call UnitRemoveAbilityBJ( 'A07K', GetTriggerUnit() )
    call UnitRemoveAbilityBJ( 'A07H', GetTriggerUnit() )
    call UnitRemoveAbilityBJ( 'A07I', GetTriggerUnit() )
    call UnitRemoveAbilityBJ( 'A08A', GetTriggerUnit() )
    call UnitRemoveAbilityBJ( 'A05O', GetTriggerUnit() )
    set udg_Researching[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = 1
endfunction

//===========================================================================
function InitTrig_Start_Research takes nothing returns nothing
    set gg_trg_Start_Research = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Start_Research, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Start_Research, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Start_Research, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Start_Research, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Start_Research, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Start_Research, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Start_Research, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Start_Research, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Start_Research, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Start_Research, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Start_Research, Condition( function Trig_Start_Research_Conditions ) )
    call TriggerAddAction( gg_trg_Start_Research, function Trig_Start_Research_Actions )
endfunction

//===========================================================================
// Trigger: Research Done
//===========================================================================
function Trig_Research_Done_Func005001 takes nothing returns boolean
    return ( udg_ProjectName[GetConvertedPlayerId(udg_player)] == "Armor" )
endfunction

function Trig_Research_Done_Func006001 takes nothing returns boolean
    return ( udg_ProjectName[GetConvertedPlayerId(udg_player)] == "Defense" )
endfunction

function Trig_Research_Done_Func007001 takes nothing returns boolean
    return ( udg_ProjectName[GetConvertedPlayerId(udg_player)] == "Grain Farming" )
endfunction

function Trig_Research_Done_Func008001 takes nothing returns boolean
    return ( udg_ProjectName[GetConvertedPlayerId(udg_player)] == "Houses" )
endfunction

function Trig_Research_Done_Func009001 takes nothing returns boolean
    return ( udg_ProjectName[GetConvertedPlayerId(udg_player)] == "Weapons" )
endfunction

function Trig_Research_Done_Func010001 takes nothing returns boolean
    return ( udg_ProjectName[GetConvertedPlayerId(udg_player)] == "Wood Cutting" )
endfunction

function Trig_Research_Done_Func011001 takes nothing returns boolean
    return ( udg_ProjectName[GetConvertedPlayerId(udg_player)] == "Health Enchantment" )
endfunction

function Trig_Research_Done_Func012001 takes nothing returns boolean
    return ( udg_ProjectName[GetConvertedPlayerId(udg_player)] == "Regeneration" )
endfunction

function Trig_Research_Done_Func013001 takes nothing returns boolean
    return ( udg_ProjectName[GetConvertedPlayerId(udg_player)] == "Precision" )
endfunction

function Trig_Research_Done_Func014001 takes nothing returns boolean
    return ( udg_ProjectName[GetConvertedPlayerId(udg_player)] == "Building" )
endfunction

function Trig_Research_Done_Func015001 takes nothing returns boolean
    return ( udg_ProjectName[GetConvertedPlayerId(udg_player)] == "Tanks" )
endfunction

function Trig_Research_Done_Func016001 takes nothing returns boolean
    return ( udg_ProjectName[GetConvertedPlayerId(udg_player)] == "Infantry" )
endfunction

function Trig_Research_Done_Func017001 takes nothing returns boolean
    return ( udg_ProjectName[GetConvertedPlayerId(udg_player)] == "Airplanes" )
endfunction

function Trig_Research_Done_Func018001 takes nothing returns boolean
    return ( udg_ProjectName[GetConvertedPlayerId(udg_player)] == "Destruction" )
endfunction

function Trig_Research_Done_Func019001 takes nothing returns boolean
    return ( udg_ProjectName[GetConvertedPlayerId(udg_player)] == "Towers" )
endfunction

function Trig_Research_Done_Func020001 takes nothing returns boolean
    return ( udg_ProjectName[GetConvertedPlayerId(udg_player)] == "Movement" )
endfunction

function Trig_Research_Done_Func021Func001002002001 takes nothing returns boolean
    return ( GetUnitTypeId(GetFilterUnit()) == 'h023' )
endfunction

function Trig_Research_Done_Func021Func001002002002 takes nothing returns boolean
    return ( GetUnitCurrentOrder(GetFilterUnit()) == String2OrderIdBJ("harvest") )
endfunction

function Trig_Research_Done_Func021Func001002002 takes nothing returns boolean
    return GetBooleanAnd( Trig_Research_Done_Func021Func001002002001(), Trig_Research_Done_Func021Func001002002002() )
endfunction

function Trig_Research_Done_Func021Func002Func010001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R003', udg_player) == 1 )
endfunction

function Trig_Research_Done_Func021Func002Func011001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R003', udg_player) == 2 )
endfunction

function Trig_Research_Done_Func021Func002Func012001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R003', udg_player) == 3 )
endfunction

function Trig_Research_Done_Func021Func002Func013001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R003', udg_player) == 4 )
endfunction

function Trig_Research_Done_Func021Func002Func014001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R003', udg_player) == 5 )
endfunction

function Trig_Research_Done_Func021Func002Func015001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R003', udg_player) == 6 )
endfunction

function Trig_Research_Done_Func021Func002Func016001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R003', udg_player) == 7 )
endfunction

function Trig_Research_Done_Func021Func002Func017001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R003', udg_player) == 8 )
endfunction

function Trig_Research_Done_Func021Func002Func018001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R003', udg_player) == 9 )
endfunction

function Trig_Research_Done_Func021Func002A takes nothing returns nothing
    call UnitRemoveAbilityBJ( 'A01E', GetEnumUnit() )
    call UnitRemoveAbilityBJ( 'A006', GetEnumUnit() )
    call UnitRemoveAbilityBJ( 'A052', GetEnumUnit() )
    call UnitRemoveAbilityBJ( 'A057', GetEnumUnit() )
    call UnitRemoveAbilityBJ( 'A05M', GetEnumUnit() )
    call UnitRemoveAbilityBJ( 'A05Q', GetEnumUnit() )
    call UnitRemoveAbilityBJ( 'A05X', GetEnumUnit() )
    call UnitRemoveAbilityBJ( 'A05L', GetEnumUnit() )
    call UnitRemoveAbilityBJ( 'A060', GetEnumUnit() )
    if ( Trig_Research_Done_Func021Func002Func010001() ) then
        call UnitAddAbilityBJ( 'A006', GetEnumUnit() )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func021Func002Func011001() ) then
        call UnitAddAbilityBJ( 'A052', GetEnumUnit() )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func021Func002Func012001() ) then
        call UnitAddAbilityBJ( 'A057', GetEnumUnit() )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func021Func002Func013001() ) then
        call UnitAddAbilityBJ( 'A05M', GetEnumUnit() )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func021Func002Func014001() ) then
        call UnitAddAbilityBJ( 'A05Q', GetEnumUnit() )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func021Func002Func015001() ) then
        call UnitAddAbilityBJ( 'A05X', GetEnumUnit() )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func021Func002Func016001() ) then
        call UnitAddAbilityBJ( 'A05L', GetEnumUnit() )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func021Func002Func017001() ) then
        call UnitAddAbilityBJ( 'A060', GetEnumUnit() )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func021Func002Func018001() ) then
        call UnitAddAbilityBJ( 'A06Q', GetEnumUnit() )
    else
        call DoNothing(  )
    endif
    set udg_Tempspot10 = GetUnitLoc(GetEnumUnit())
    set udg_TempRegion3 = RectFromCenterSizeBJ(udg_Tempspot10, 500.00, 500.00)
    call IssueTargetDestructableOrder( GetEnumUnit(), "harvest", RandomDestructableInRectSimpleBJ(udg_TempRegion3) )
    call RemoveLocation( udg_Tempspot10 )
    call RemoveRect( udg_TempRegion3 )
endfunction

function Trig_Research_Done_Func021Func004002002001 takes nothing returns boolean
    return ( GetUnitTypeId(GetFilterUnit()) == 'h023' )
endfunction

function Trig_Research_Done_Func021Func004002002002 takes nothing returns boolean
    return ( GetUnitCurrentOrder(GetFilterUnit()) != String2OrderIdBJ("harvest") )
endfunction

function Trig_Research_Done_Func021Func004002002 takes nothing returns boolean
    return GetBooleanAnd( Trig_Research_Done_Func021Func004002002001(), Trig_Research_Done_Func021Func004002002002() )
endfunction

function Trig_Research_Done_Func021Func005A takes nothing returns nothing
    call UpdateHarvesting(GetEnumUnit())
endfunction

function Trig_Research_Done_Func021C takes nothing returns boolean
    if ( not ( udg_ProjectName[GetConvertedPlayerId(udg_player)] == "Wood Cutting" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Research_Done_Func022Func001001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R000', udg_player) == 2 )
endfunction

function Trig_Research_Done_Func022Func002001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R000', udg_player) == 5 )
endfunction

function Trig_Research_Done_Func022Func003001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R000', udg_player) == 10 )
endfunction

function Trig_Research_Done_Func022C takes nothing returns boolean
    if ( not ( udg_ProjectName[GetConvertedPlayerId(udg_player)] == "Infantry" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Research_Done_Func023Func001001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R004', udg_player) == 2 )
endfunction

function Trig_Research_Done_Func023Func002001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R004', udg_player) == 5 )
endfunction

function Trig_Research_Done_Func023Func003001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R004', udg_player) == 10 )
endfunction

function Trig_Research_Done_Func023C takes nothing returns boolean
    if ( not ( udg_ProjectName[GetConvertedPlayerId(udg_player)] == "Tanks" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Research_Done_Func024Func001001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R006', udg_player) == 2 )
endfunction

function Trig_Research_Done_Func024Func002001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R006', udg_player) == 5 )
endfunction

function Trig_Research_Done_Func024Func003001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R006', udg_player) == 10 )
endfunction

function Trig_Research_Done_Func024C takes nothing returns boolean
    if ( not ( udg_ProjectName[GetConvertedPlayerId(udg_player)] == "Airplanes" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Research_Done_Func025Func001001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R00G', udg_player) == 2 )
endfunction

function Trig_Research_Done_Func025Func002001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R00G', udg_player) == 5 )
endfunction

function Trig_Research_Done_Func025Func003001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R00G', udg_player) == 10 )
endfunction

function Trig_Research_Done_Func025C takes nothing returns boolean
    if ( not ( udg_ProjectName[GetConvertedPlayerId(udg_player)] == "Destruction" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Research_Done_Func026Func001001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R00E', udg_player) == 2 )
endfunction

function Trig_Research_Done_Func026Func002001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R00E', udg_player) == 5 )
endfunction

function Trig_Research_Done_Func026Func003001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R00E', udg_player) == 10 )
endfunction

function Trig_Research_Done_Func026C takes nothing returns boolean
    if ( not ( udg_ProjectName[GetConvertedPlayerId(udg_player)] == "Towers" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Research_Done_Actions takes nothing returns nothing
        call PlaySoundForPlayer( udg_player, gg_snd_GenericWarningResearchComplete1 )
    set udg_Researching[GetConvertedPlayerId(udg_player)] = 0
        call DisplayTimedTextToForce( GetForceOfPlayer(udg_player), 2.00, ( "                              |cffffcc00" + ( udg_ProjectName[GetConvertedPlayerId(udg_player)] + "  research complete!|r" ) ) )
    set udg_ResearchCentre = GroupPickRandomUnit(GetUnitsOfPlayerAndTypeId(udg_player, 'h01E'))
    if ( Trig_Research_Done_Func005001() ) then
        call SetPlayerTechResearchedSwap( 'R002', ( GetPlayerTechCountSimple('R002', udg_player) + 1 ), udg_player )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func006001() ) then
        call SetPlayerTechResearchedSwap( 'R008', ( GetPlayerTechCountSimple('R008', udg_player) + 1 ), udg_player )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func007001() ) then
        set udg_GrainFarming[GetConvertedPlayerId(udg_player)] = ( udg_GrainFarming[GetConvertedPlayerId(udg_player)] + 1 )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func008001() ) then
        call SetPlayerTechResearchedSwap( 'R005', ( GetPlayerTechCountSimple('R005', udg_player) + 1 ), udg_player )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func009001() ) then
        call SetPlayerTechResearchedSwap( 'R001', ( GetPlayerTechCountSimple('R001', udg_player) + 1 ), udg_player )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func010001() ) then
        call SetPlayerTechResearchedSwap( 'R003', ( GetPlayerTechCountSimple('R003', udg_player) + 1 ), udg_player )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func011001() ) then
        call SetPlayerTechResearchedSwap( 'R00D', ( GetPlayerTechCountSimple('R00D', udg_player) + 1 ), udg_player )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func012001() ) then
        call SetPlayerTechResearchedSwap( 'R00C', ( GetPlayerTechCountSimple('R00C', udg_player) + 1 ), udg_player )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func013001() ) then
        call SetPlayerTechResearchedSwap( 'R00F', ( GetPlayerTechCountSimple('R00F', udg_player) + 1 ), udg_player )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func014001() ) then
        call SetPlayerTechResearchedSwap( 'R009', ( GetPlayerTechCountSimple('R009', udg_player) + 1 ), udg_player )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func015001() ) then
        call SetPlayerTechResearchedSwap( 'R004', ( GetPlayerTechCountSimple('R004', udg_player) + 1 ), udg_player )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func016001() ) then
        call SetPlayerTechResearchedSwap( 'R000', ( GetPlayerTechCountSimple('R000', udg_player) + 1 ), udg_player )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func017001() ) then
        call SetPlayerTechResearchedSwap( 'R006', ( GetPlayerTechCountSimple('R006', udg_player) + 1 ), udg_player )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func018001() ) then
        call SetPlayerTechResearchedSwap( 'R00G', ( GetPlayerTechCountSimple('R00G', udg_player) + 1 ), udg_player )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func019001() ) then
        call SetPlayerTechResearchedSwap( 'R00E', ( GetPlayerTechCountSimple('R00E', udg_player) + 1 ), udg_player )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func020001() ) then
        call SetPlayerTechResearchedSwap( 'R00H', ( GetPlayerTechCountSimple('R00H', udg_player) + 1 ), udg_player )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func021C() ) then
        set udg_TempGroup3 = GetUnitsOfPlayerMatching(udg_player, Condition(function Trig_Research_Done_Func021Func001002002))
        call ForGroupBJ( udg_TempGroup3, function Trig_Research_Done_Func021Func002A )
        call DestroyGroup( udg_TempGroup3 )
        set udg_TempGroup4 = GetUnitsOfPlayerMatching(udg_player, Condition(function Trig_Research_Done_Func021Func004002002))
        call ForGroupBJ( udg_TempGroup4, function Trig_Research_Done_Func021Func005A )
        call DestroyGroup( udg_TempGroup4 )
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func022C() ) then
        if ( Trig_Research_Done_Func022Func001001() ) then
            call SetPlayerTechResearchedSwap( 'R010', 1, udg_player )
        else
            call DoNothing(  )
        endif
        if ( Trig_Research_Done_Func022Func002001() ) then
            call SetPlayerTechResearchedSwap( 'R011', 1, udg_player )
        else
            call DoNothing(  )
        endif
        if ( Trig_Research_Done_Func022Func003001() ) then
            call SetPlayerTechResearchedSwap( 'R012', 1, udg_player )
        else
            call DoNothing(  )
        endif
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func023C() ) then
        if ( Trig_Research_Done_Func023Func001001() ) then
            call SetPlayerTechResearchedSwap( 'R00U', 1, udg_player )
        else
            call DoNothing(  )
        endif
        if ( Trig_Research_Done_Func023Func002001() ) then
            call SetPlayerTechResearchedSwap( 'R00V', 1, udg_player )
        else
            call DoNothing(  )
        endif
        if ( Trig_Research_Done_Func023Func003001() ) then
            call SetPlayerTechResearchedSwap( 'R00W', 1, udg_player )
        else
            call DoNothing(  )
        endif
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func024C() ) then
        if ( Trig_Research_Done_Func024Func001001() ) then
            call SetPlayerTechResearchedSwap( 'R00R', 1, udg_player )
        else
            call DoNothing(  )
        endif
        if ( Trig_Research_Done_Func024Func002001() ) then
            call SetPlayerTechResearchedSwap( 'R00S', 1, udg_player )
        else
            call DoNothing(  )
        endif
        if ( Trig_Research_Done_Func024Func003001() ) then
            call SetPlayerTechResearchedSwap( 'R00T', 1, udg_player )
        else
            call DoNothing(  )
        endif
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func025C() ) then
        if ( Trig_Research_Done_Func025Func001001() ) then
            call SetPlayerTechResearchedSwap( 'R00X', 1, udg_player )
        else
            call DoNothing(  )
        endif
        if ( Trig_Research_Done_Func025Func002001() ) then
            call SetPlayerTechResearchedSwap( 'R00Y', 1, udg_player )
        else
            call DoNothing(  )
        endif
        if ( Trig_Research_Done_Func025Func003001() ) then
            call SetPlayerTechResearchedSwap( 'R00Z', 1, udg_player )
        else
            call DoNothing(  )
        endif
    else
        call DoNothing(  )
    endif
    if ( Trig_Research_Done_Func026C() ) then
        if ( Trig_Research_Done_Func026Func001001() ) then
            call SetPlayerTechResearchedSwap( 'R013', 1, udg_player )
        else
            call DoNothing(  )
        endif
        if ( Trig_Research_Done_Func026Func002001() ) then
            call SetPlayerTechResearchedSwap( 'R014', 1, udg_player )
        else
            call DoNothing(  )
        endif
        if ( Trig_Research_Done_Func026Func003001() ) then
            call SetPlayerTechResearchedSwap( 'R015', 1, udg_player )
        else
            call DoNothing(  )
        endif
    else
        call DoNothing(  )
    endif
    call TriggerExecute( gg_trg_Researches_Back )
endfunction

//===========================================================================
function InitTrig_Research_Done takes nothing returns nothing
    set gg_trg_Research_Done = CreateTrigger(  )
    call TriggerAddAction( gg_trg_Research_Done, function Trig_Research_Done_Actions )
endfunction

//===========================================================================
// Trigger: Researches Back
//===========================================================================
function Trig_Researches_Back_Func005001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R003', udg_player) < GetPlayerTechMaxAllowedSwap('R003', udg_player) )
endfunction

function Trig_Researches_Back_Func006001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R005', udg_player) < GetPlayerTechMaxAllowedSwap('R005', udg_player) )
endfunction

function Trig_Researches_Back_Func007001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R009', udg_player) < GetPlayerTechMaxAllowedSwap('R009', udg_player) )
endfunction

function Trig_Researches_Back_Func008001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R00H', udg_player) < GetPlayerTechMaxAllowedSwap('R00H', udg_player) )
endfunction

function Trig_Researches_Back_Func017Func001Func001Func002C takes nothing returns boolean
    if ( not ( udg_UpCounter2 == 1 ) ) then
        return false
    endif
    if ( not ( udg_Researches[udg_UpCounter2] < 100 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Researches_Back_Func017Func001Func001Func003C takes nothing returns boolean
    if ( not ( udg_UpCounter2 == 2 ) ) then
        return false
    endif
    if ( not ( udg_Researches[udg_UpCounter2] < 100 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Researches_Back_Func017Func001Func001Func004C takes nothing returns boolean
    if ( not ( udg_UpCounter2 == 3 ) ) then
        return false
    endif
    if ( not ( udg_Researches[udg_UpCounter2] < 100 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Researches_Back_Func017Func001Func001Func005C takes nothing returns boolean
    if ( not ( udg_UpCounter2 == 4 ) ) then
        return false
    endif
    if ( not ( udg_Researches[udg_UpCounter2] < 100 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Researches_Back_Func017Func001Func001Func006C takes nothing returns boolean
    if ( not ( udg_UpCounter2 == 5 ) ) then
        return false
    endif
    if ( not ( udg_Researches[udg_UpCounter2] < 100 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Researches_Back_Func017Func001Func001Func007C takes nothing returns boolean
    if ( not ( udg_UpCounter2 == 6 ) ) then
        return false
    endif
    if ( not ( udg_Researches[udg_UpCounter2] < 100 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Researches_Back_Func017Func001Func001Func008001 takes nothing returns boolean
    return ( udg_Chosen == 4 )
endfunction

function Trig_Researches_Back_Func017Func001Func001C takes nothing returns boolean
    if ( not ( udg_Researches[udg_UpCounter2] <= udg_Researches[1] ) ) then
        return false
    endif
    if ( not ( udg_Researches[udg_UpCounter2] <= udg_Researches[2] ) ) then
        return false
    endif
    if ( not ( udg_Researches[udg_UpCounter2] <= udg_Researches[3] ) ) then
        return false
    endif
    if ( not ( udg_Researches[udg_UpCounter2] <= udg_Researches[4] ) ) then
        return false
    endif
    if ( not ( udg_Researches[udg_UpCounter2] <= udg_Researches[5] ) ) then
        return false
    endif
    if ( not ( udg_Researches[udg_UpCounter2] <= udg_Researches[6] ) ) then
        return false
    endif
    return true
endfunction

function Trig_Researches_Back_Actions takes nothing returns nothing
    set udg_ProjectName[GetConvertedPlayerId(udg_player)] = "None"
    call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(udg_player)], 2, 9, udg_ProjectName[GetConvertedPlayerId(udg_player)] )
    call MultiboardUpdate( udg_PlayerMultiboard[GetConvertedPlayerId(udg_player)], 10, 0.00 )
    call UnitAddAbilityBJ( 'A05O', udg_ScienceLab[GetConvertedPlayerId(udg_player)] )
    if ( Trig_Researches_Back_Func005001() ) then
        call UnitAddAbilityBJ( 'A054', udg_ScienceLab[GetConvertedPlayerId(udg_player)] )
    else
        call DoNothing(  )
    endif
    if ( Trig_Researches_Back_Func006001() ) then
        call UnitAddAbilityBJ( 'A05D', udg_ScienceLab[GetConvertedPlayerId(udg_player)] )
    else
        call DoNothing(  )
    endif
    if ( Trig_Researches_Back_Func007001() ) then
        call UnitAddAbilityBJ( 'A00M', udg_ScienceLab[GetConvertedPlayerId(udg_player)] )
    else
        call DoNothing(  )
    endif
    if ( Trig_Researches_Back_Func008001() ) then
        call UnitAddAbilityBJ( 'A000', udg_ScienceLab[GetConvertedPlayerId(udg_player)] )
    else
        call DoNothing(  )
    endif
    call UnitAddAbilityBJ( 'A05C', udg_ScienceLab[GetConvertedPlayerId(udg_player)] )
    set udg_Researches[1] = ( ( GetPlayerTechCountSimple('R001', udg_player) * 100 ) / GetPlayerTechMaxAllowedSwap('R001', udg_player) )
    set udg_Researches[2] = ( ( GetPlayerTechCountSimple('R002', udg_player) * 100 ) / GetPlayerTechMaxAllowedSwap('R002', udg_player) )
    set udg_Researches[3] = ( ( GetPlayerTechCountSimple('R008', udg_player) * 100 ) / GetPlayerTechMaxAllowedSwap('R008', udg_player) )
    set udg_Researches[4] = ( ( GetPlayerTechCountSimple('R00C', udg_player) * 100 ) / GetPlayerTechMaxAllowedSwap('R00C', udg_player) )
    set udg_Researches[5] = ( ( GetPlayerTechCountSimple('R00D', udg_player) * 100 ) / GetPlayerTechMaxAllowedSwap('R00D', udg_player) )
    set udg_Researches[6] = ( ( GetPlayerTechCountSimple('R00F', udg_player) * 100 ) / GetPlayerTechMaxAllowedSwap('R00F', udg_player) )
    set udg_Chosen = 0
    set udg_UpCounter = 1
    loop
        exitwhen udg_UpCounter > 4
        set udg_UpCounter2 = 1
        loop
            exitwhen udg_UpCounter2 > 7
            if ( Trig_Researches_Back_Func017Func001Func001C() ) then
                if ( Trig_Researches_Back_Func017Func001Func001Func002C() ) then
                    set udg_Researches[1] = 100
                    call UnitAddAbilityBJ( 'A05A', udg_ScienceLab[GetConvertedPlayerId(udg_player)] )
                    set udg_Chosen = ( udg_Chosen + 1 )
                else
                    call DoNothing(  )
                endif
                if ( Trig_Researches_Back_Func017Func001Func001Func003C() ) then
                    set udg_Researches[2] = 100
                    call UnitAddAbilityBJ( 'A05B', udg_ScienceLab[GetConvertedPlayerId(udg_player)] )
                    set udg_Chosen = ( udg_Chosen + 1 )
                else
                    call DoNothing(  )
                endif
                if ( Trig_Researches_Back_Func017Func001Func001Func004C() ) then
                    set udg_Researches[3] = 100
                    call UnitAddAbilityBJ( 'A059', udg_ScienceLab[GetConvertedPlayerId(udg_player)] )
                    set udg_Chosen = ( udg_Chosen + 1 )
                else
                    call DoNothing(  )
                endif
                if ( Trig_Researches_Back_Func017Func001Func001Func005C() ) then
                    set udg_Researches[4] = 100
                    call UnitAddAbilityBJ( 'A05N', udg_ScienceLab[GetConvertedPlayerId(udg_player)] )
                    set udg_Chosen = ( udg_Chosen + 1 )
                else
                    call DoNothing(  )
                endif
                if ( Trig_Researches_Back_Func017Func001Func001Func006C() ) then
                    set udg_Researches[5] = 100
                    call UnitAddAbilityBJ( 'A05F', udg_ScienceLab[GetConvertedPlayerId(udg_player)] )
                    set udg_Chosen = ( udg_Chosen + 1 )
                else
                    call DoNothing(  )
                endif
                if ( Trig_Researches_Back_Func017Func001Func001Func007C() ) then
                    set udg_Researches[8] = 100
                    call UnitAddAbilityBJ( 'A01F', udg_ScienceLab[GetConvertedPlayerId(udg_player)] )
                    set udg_Chosen = ( udg_Chosen + 1 )
                else
                    call DoNothing(  )
                endif
                if ( Trig_Researches_Back_Func017Func001Func001Func008001() ) then
                    return
                else
                    call DoNothing(  )
                endif
            else
                call DoNothing(  )
            endif
            set udg_UpCounter2 = udg_UpCounter2 + 1
        endloop
        set udg_UpCounter = udg_UpCounter + 1
    endloop
endfunction

//===========================================================================
function InitTrig_Researches_Back takes nothing returns nothing
    set gg_trg_Researches_Back = CreateTrigger(  )
    call TriggerAddAction( gg_trg_Researches_Back, function Trig_Researches_Back_Actions )
endfunction

//===========================================================================
// Trigger: Abort Research
//===========================================================================
function Trig_Abort_Research_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A03G' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Abort_Research_Actions takes nothing returns nothing
    set udg_player = GetOwningPlayer(GetTriggerUnit())
    set udg_Researching[GetConvertedPlayerId(udg_player)] = 0
    set udg_ResearchNeed[GetConvertedPlayerId(udg_player)] = 0
    set udg_ResearchNeedStart[GetConvertedPlayerId(udg_player)] = 0
    set udg_ResearchDone[GetConvertedPlayerId(udg_player)] = 0
    call UnitRemoveAbilityBJ( 'A00O', GetTriggerUnit() )
    call UnitRemoveAbilityBJ( 'A07J', GetTriggerUnit() )
    call UnitRemoveAbilityBJ( 'A07H', GetTriggerUnit() )
    call UnitRemoveAbilityBJ( 'A07I', GetTriggerUnit() )
    call UnitRemoveAbilityBJ( 'A07K', GetTriggerUnit() )
    call UnitRemoveAbilityBJ( 'A08A', GetTriggerUnit() )
    call TriggerExecute( gg_trg_Researches_Back )
endfunction

//===========================================================================
function InitTrig_Abort_Research takes nothing returns nothing
    set gg_trg_Abort_Research = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Abort_Research, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Abort_Research, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Abort_Research, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Abort_Research, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Abort_Research, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Abort_Research, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Abort_Research, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Abort_Research, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Abort_Research, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Abort_Research, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Abort_Research, Condition( function Trig_Abort_Research_Conditions ) )
    call TriggerAddAction( gg_trg_Abort_Research, function Trig_Abort_Research_Actions )
endfunction

//===========================================================================
// Trigger: Go to Tech
//===========================================================================
function Trig_Go_to_Tech_Func012C takes nothing returns boolean
    if ( ( GetSpellAbilityId() == 'A00O' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A05O' ) ) then
        return true
    endif
    return false
endfunction

function Trig_Go_to_Tech_Conditions takes nothing returns boolean
    if ( not Trig_Go_to_Tech_Func012C() ) then
        return false
    endif
    return true
endfunction

function Trig_Go_to_Tech_Func011Func014001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R000', GetOwningPlayer(GetTriggerUnit())) < 10 )
endfunction

function Trig_Go_to_Tech_Func011Func015001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R004', GetOwningPlayer(GetTriggerUnit())) < 10 )
endfunction

function Trig_Go_to_Tech_Func011Func016001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R006', GetOwningPlayer(GetTriggerUnit())) < 10 )
endfunction

function Trig_Go_to_Tech_Func011Func017001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R00E', GetOwningPlayer(GetTriggerUnit())) < 10 )
endfunction

function Trig_Go_to_Tech_Func011Func018001 takes nothing returns boolean
    return ( GetPlayerTechCountSimple('R00G', GetOwningPlayer(GetTriggerUnit())) < 10 )
endfunction

function Trig_Go_to_Tech_Func011C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A00O' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Go_to_Tech_Actions takes nothing returns nothing
    if ( Trig_Go_to_Tech_Func011C() ) then
        call UnitRemoveAbilityBJ( 'A00O', GetTriggerUnit() )
        call UnitRemoveAbilityBJ( 'A07J', GetTriggerUnit() )
        call UnitRemoveAbilityBJ( 'A07H', GetTriggerUnit() )
        call UnitRemoveAbilityBJ( 'A07I', GetTriggerUnit() )
        call UnitRemoveAbilityBJ( 'A07K', GetTriggerUnit() )
        call UnitRemoveAbilityBJ( 'A08A', GetTriggerUnit() )
        set udg_player = GetOwningPlayer(GetTriggerUnit())
        call TriggerExecute( gg_trg_Researches_Back )
    else
        call UnitRemoveAbilityBJ( 'A05B', GetTriggerUnit() )
        call UnitRemoveAbilityBJ( 'A059', GetTriggerUnit() )
        call UnitRemoveAbilityBJ( 'A05C', GetTriggerUnit() )
        call UnitRemoveAbilityBJ( 'A05D', GetTriggerUnit() )
        call UnitRemoveAbilityBJ( 'A05A', GetTriggerUnit() )
        call UnitRemoveAbilityBJ( 'A054', GetTriggerUnit() )
        call UnitRemoveAbilityBJ( 'A05F', GetTriggerUnit() )
        call UnitRemoveAbilityBJ( 'A05N', GetTriggerUnit() )
        call UnitRemoveAbilityBJ( 'A01F', GetTriggerUnit() )
        call UnitRemoveAbilityBJ( 'A00M', GetTriggerUnit() )
        call UnitRemoveAbilityBJ( 'A000', GetTriggerUnit() )
        call UnitRemoveAbilityBJ( 'A05O', GetTriggerUnit() )
        call UnitAddAbilityBJ( 'A00O', GetTriggerUnit() )
        if ( Trig_Go_to_Tech_Func011Func014001() ) then
            call UnitAddAbilityBJ( 'A07H', GetTriggerUnit() )
        else
            call DoNothing(  )
        endif
        if ( Trig_Go_to_Tech_Func011Func015001() ) then
            call UnitAddAbilityBJ( 'A07I', GetTriggerUnit() )
        else
            call DoNothing(  )
        endif
        if ( Trig_Go_to_Tech_Func011Func016001() ) then
            call UnitAddAbilityBJ( 'A07J', GetTriggerUnit() )
        else
            call DoNothing(  )
        endif
        if ( Trig_Go_to_Tech_Func011Func017001() ) then
            call UnitAddAbilityBJ( 'A08A', GetTriggerUnit() )
        else
            call DoNothing(  )
        endif
        if ( Trig_Go_to_Tech_Func011Func018001() ) then
            call UnitAddAbilityBJ( 'A07K', GetTriggerUnit() )
        else
            call DoNothing(  )
        endif
    endif
endfunction

//===========================================================================
function InitTrig_Go_to_Tech takes nothing returns nothing
    set gg_trg_Go_to_Tech = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Go_to_Tech, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Go_to_Tech, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Go_to_Tech, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Go_to_Tech, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Go_to_Tech, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Go_to_Tech, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Go_to_Tech, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Go_to_Tech, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Go_to_Tech, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Go_to_Tech, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Go_to_Tech, Condition( function Trig_Go_to_Tech_Conditions ) )
    call TriggerAddAction( gg_trg_Go_to_Tech, function Trig_Go_to_Tech_Actions )
endfunction

//===========================================================================
// Trigger: Hero Gets Item
//===========================================================================
function Trig_Hero_Gets_Item_Conditions takes nothing returns boolean
    if ( not ( IsUnitType(GetManipulatingUnit(), UNIT_TYPE_HERO) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_Hero_Gets_Item_Func002Func002C takes nothing returns boolean
    if ( not ( udg_ArmorAmount[GetConvertedPlayerId(GetOwningPlayer(GetManipulatingUnit()))] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Hero_Gets_Item_Func002C takes nothing returns boolean
    if ( not ( GetItemType(GetManipulatedItem()) == ITEM_TYPE_CHARGED ) ) then
        return false
    endif
    return true
endfunction

function Trig_Hero_Gets_Item_Func003Func003C takes nothing returns boolean
    if ( not ( udg_HelmGraphicSet[GetConvertedPlayerId(GetOwningPlayer(GetManipulatingUnit()))] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Hero_Gets_Item_Func003C takes nothing returns boolean
    if ( not ( GetItemType(GetManipulatedItem()) == ITEM_TYPE_POWERUP ) ) then
        return false
    endif
    return true
endfunction

function Trig_Hero_Gets_Item_Func004Func002C takes nothing returns boolean
    if ( not ( udg_Weapon[GetConvertedPlayerId(GetOwningPlayer(GetManipulatingUnit()))] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Hero_Gets_Item_Func004C takes nothing returns boolean
    if ( not ( GetItemType(GetManipulatedItem()) == ITEM_TYPE_PERMANENT ) ) then
        return false
    endif
    return true
endfunction

function Trig_Hero_Gets_Item_Actions takes nothing returns nothing
    if ( Trig_Hero_Gets_Item_Func002C() ) then
        set udg_ArmorAmount[GetConvertedPlayerId(GetOwningPlayer(GetManipulatingUnit()))] = ( udg_ArmorAmount[GetConvertedPlayerId(GetOwningPlayer(GetManipulatingUnit()))] + 1 )
        if ( Trig_Hero_Gets_Item_Func002Func002C() ) then
        else
            call UnitRemoveItemSwapped( GetManipulatedItem(), GetManipulatingUnit() )
            call DisplayTimedTextToForce( GetForceOfPlayer(GetOwningPlayer(GetManipulatingUnit())), 5.00, "TRIGSTR_4522" )
            call PlaySoundForPlayer( GetOwningPlayer(GetManipulatingUnit()), gg_snd_Warning )
        endif
    else
    endif
    if ( Trig_Hero_Gets_Item_Func003C() ) then
        set udg_HelmGraphicSet[GetConvertedPlayerId(GetOwningPlayer(GetManipulatingUnit()))] = ( udg_HelmGraphicSet[GetConvertedPlayerId(GetOwningPlayer(GetManipulatingUnit()))] + 1 )
        if ( Trig_Hero_Gets_Item_Func003Func003C() ) then
            call AddSpecialEffectTargetUnitBJ( "head", GetManipulatingUnit(), "war3mapImported\\greathelm.mdx" )
            set udg_HelmGraphic[GetConvertedPlayerId(GetOwningPlayer(GetManipulatingUnit()))] = GetLastCreatedEffectBJ()
        else
            call UnitRemoveItemSwapped( GetManipulatedItem(), GetManipulatingUnit() )
            call DisplayTimedTextToForce( GetForceOfPlayer(GetOwningPlayer(GetManipulatingUnit())), 5.00, "TRIGSTR_4523" )
            call PlaySoundForPlayer( GetOwningPlayer(GetManipulatingUnit()), gg_snd_Warning )
        endif
    else
    endif
    if ( Trig_Hero_Gets_Item_Func004C() ) then
        set udg_Weapon[GetConvertedPlayerId(GetOwningPlayer(GetManipulatingUnit()))] = ( udg_Weapon[GetConvertedPlayerId(GetOwningPlayer(GetManipulatingUnit()))] + 1 )
        if ( Trig_Hero_Gets_Item_Func004Func002C() ) then
        else
            call UnitRemoveItemSwapped( GetManipulatedItem(), GetManipulatingUnit() )
            call DisplayTimedTextToForce( GetForceOfPlayer(GetOwningPlayer(GetManipulatingUnit())), 5.00, "TRIGSTR_4525" )
            call PlaySoundForPlayer( GetOwningPlayer(GetManipulatingUnit()), gg_snd_Warning )
        endif
    else
    endif
endfunction

//===========================================================================
function InitTrig_Hero_Gets_Item takes nothing returns nothing
    set gg_trg_Hero_Gets_Item = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Gets_Item, Player(0), EVENT_PLAYER_UNIT_PICKUP_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Gets_Item, Player(1), EVENT_PLAYER_UNIT_PICKUP_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Gets_Item, Player(2), EVENT_PLAYER_UNIT_PICKUP_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Gets_Item, Player(3), EVENT_PLAYER_UNIT_PICKUP_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Gets_Item, Player(4), EVENT_PLAYER_UNIT_PICKUP_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Gets_Item, Player(5), EVENT_PLAYER_UNIT_PICKUP_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Gets_Item, Player(6), EVENT_PLAYER_UNIT_PICKUP_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Gets_Item, Player(7), EVENT_PLAYER_UNIT_PICKUP_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Gets_Item, Player(8), EVENT_PLAYER_UNIT_PICKUP_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Gets_Item, Player(9), EVENT_PLAYER_UNIT_PICKUP_ITEM )
    call TriggerAddCondition( gg_trg_Hero_Gets_Item, Condition( function Trig_Hero_Gets_Item_Conditions ) )
    call TriggerAddAction( gg_trg_Hero_Gets_Item, function Trig_Hero_Gets_Item_Actions )
endfunction

//===========================================================================
// Trigger: Hero Loses Item
//===========================================================================
function Trig_Hero_Loses_Item_Conditions takes nothing returns boolean
    if ( not ( IsUnitType(GetManipulatingUnit(), UNIT_TYPE_HERO) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_Hero_Loses_Item_Func012C takes nothing returns boolean
    if ( not ( GetItemType(GetManipulatedItem()) == ITEM_TYPE_CHARGED ) ) then
        return false
    endif
    return true
endfunction

function Trig_Hero_Loses_Item_Func013Func002C takes nothing returns boolean
    if ( not ( udg_HelmGraphicSet[GetConvertedPlayerId(GetOwningPlayer(GetManipulatingUnit()))] == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Hero_Loses_Item_Func013C takes nothing returns boolean
    if ( not ( GetItemType(GetManipulatedItem()) == ITEM_TYPE_POWERUP ) ) then
        return false
    endif
    return true
endfunction

function Trig_Hero_Loses_Item_Func014C takes nothing returns boolean
    if ( not ( GetItemType(GetManipulatedItem()) == ITEM_TYPE_PERMANENT ) ) then
        return false
    endif
    return true
endfunction

function Trig_Hero_Loses_Item_Actions takes nothing returns nothing
    if ( Trig_Hero_Loses_Item_Func012C() ) then
        set udg_ArmorAmount[GetConvertedPlayerId(GetOwningPlayer(GetManipulatingUnit()))] = ( udg_ArmorAmount[GetConvertedPlayerId(GetOwningPlayer(GetManipulatingUnit()))] - 1 )
    else
    endif
    if ( Trig_Hero_Loses_Item_Func013C() ) then
        set udg_HelmGraphicSet[GetConvertedPlayerId(GetOwningPlayer(GetManipulatingUnit()))] = ( udg_HelmGraphicSet[GetConvertedPlayerId(GetOwningPlayer(GetManipulatingUnit()))] - 1 )
        if ( Trig_Hero_Loses_Item_Func013Func002C() ) then
            call DestroyEffectBJ( udg_HelmGraphic[GetConvertedPlayerId(GetOwningPlayer(GetManipulatingUnit()))] )
        else
        endif
    else
    endif
    if ( Trig_Hero_Loses_Item_Func014C() ) then
        set udg_Weapon[GetConvertedPlayerId(GetOwningPlayer(GetManipulatingUnit()))] = ( udg_Weapon[GetConvertedPlayerId(GetOwningPlayer(GetManipulatingUnit()))] - 1 )
    else
    endif
endfunction

//===========================================================================
function InitTrig_Hero_Loses_Item takes nothing returns nothing
    set gg_trg_Hero_Loses_Item = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Loses_Item, Player(0), EVENT_PLAYER_UNIT_DROP_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Loses_Item, Player(1), EVENT_PLAYER_UNIT_DROP_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Loses_Item, Player(2), EVENT_PLAYER_UNIT_DROP_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Loses_Item, Player(3), EVENT_PLAYER_UNIT_DROP_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Loses_Item, Player(4), EVENT_PLAYER_UNIT_DROP_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Loses_Item, Player(5), EVENT_PLAYER_UNIT_DROP_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Loses_Item, Player(6), EVENT_PLAYER_UNIT_DROP_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Loses_Item, Player(7), EVENT_PLAYER_UNIT_DROP_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Loses_Item, Player(8), EVENT_PLAYER_UNIT_DROP_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Loses_Item, Player(9), EVENT_PLAYER_UNIT_DROP_ITEM )
    call TriggerAddCondition( gg_trg_Hero_Loses_Item, Condition( function Trig_Hero_Loses_Item_Conditions ) )
    call TriggerAddAction( gg_trg_Hero_Loses_Item, function Trig_Hero_Loses_Item_Actions )
endfunction

//===========================================================================
// Trigger: Show Spots
//===========================================================================
function Trig_Show_Spots_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A00X' or GetSpellAbilityId() == 'A04M' then
return true
endif
return false
endfunction

function Trig_Show_Spots_Func003A takes nothing returns nothing
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u) 
local unit u2 = GetEnumUnit()
local location l = GetUnitLoc(u2)
call PingMinimapLocForForceEx( GetForceOfPlayer(p), l, 15.00, bj_MINIMAPPINGSTYLE_SIMPLE, 50.00, 50.00, 50.00 )
call RemoveLocation(l)
set l = null
set u = null
set u2 = null
set p = null
endfunction

function Trig_Show_Spots_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
local group g = GetUnitsOfPlayerAndTypeId(Player(10), 'n012')
local location l = null
call PlaySoundForPlayer( p, gg_snd_MapPing )
call ForGroupBJ( g, function Trig_Show_Spots_Func003A )
if udg_Obelisk != null then
set l = GetUnitLoc(udg_Obelisk)
call PingMinimapLocForForceEx( GetForceOfPlayer(p), l, 15.00, bj_MINIMAPPINGSTYLE_SIMPLE, 100.00, 0.00, 0.00 )
call RemoveLocation( l )
endif
set l = GetUnitLoc(gg_unit_n00L_0244)
call PingMinimapLocForForceEx( GetForceOfPlayer(p), l, 15.00, bj_MINIMAPPINGSTYLE_SIMPLE, 0.00, 100.00, 0.00 )
call RemoveLocation(l)
set l = GetUnitLoc(gg_unit_n00L_0245)
call PingMinimapLocForForceEx( GetForceOfPlayer(p), l, 15.00, bj_MINIMAPPINGSTYLE_SIMPLE, 0.00, 100.00, 0.00 )
call RemoveLocation(l)
call DestroyGroup(g)
set g = null
set p = null
set u = null
set l = null
endfunction

//===========================================================================
function InitTrig_Show_Spots takes nothing returns nothing
    set gg_trg_Show_Spots = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Show_Spots, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Show_Spots, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Show_Spots, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Show_Spots, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Show_Spots, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Show_Spots, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Show_Spots, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Show_Spots, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Show_Spots, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Show_Spots, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Show_Spots, Condition( function Trig_Show_Spots_Conditions ) )
    call TriggerAddAction( gg_trg_Show_Spots, function Trig_Show_Spots_Actions )
endfunction

//===========================================================================
// Trigger: Show Quest Monsters
//===========================================================================
function Trig_Show_Quest_Monsters_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A03Y' then
return true
endif
return false
endfunction

function Trig_Show_Quest_Monsters_Func003A takes nothing returns nothing
local location l = GetUnitLoc(GetEnumUnit())
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
call PingMinimapLocForForceEx( GetForceOfPlayer(p), l, 15.00, bj_MINIMAPPINGSTYLE_SIMPLE, 100.00, 100.00, 0.00 )
call RemoveLocation(l)
set l = null
set u = null
set p = null
endfunction

function IsQuestMonster takes nothing returns boolean
local unit u = GetFilterUnit()
if GetUnitTypeId(u) != 'e00U' and GetUnitUserData(u) > 0 then 
set u = null
return true
endif
set u = null
return false
endfunction

function Trig_Show_Quest_Monsters_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
local group g = GetUnitsOfPlayerMatching(Player(PLAYER_NEUTRAL_AGGRESSIVE), Condition(function IsQuestMonster))
call PlaySoundForPlayer( p, gg_snd_MapPing )
call ForGroupBJ( g, function Trig_Show_Quest_Monsters_Func003A )
call DestroyGroup(g)
set u = null
set p = null
set g = null
endfunction

//===========================================================================
function InitTrig_Show_Quest_Monsters takes nothing returns nothing
    set gg_trg_Show_Quest_Monsters = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Show_Quest_Monsters, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Show_Quest_Monsters, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Show_Quest_Monsters, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Show_Quest_Monsters, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Show_Quest_Monsters, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Show_Quest_Monsters, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Show_Quest_Monsters, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Show_Quest_Monsters, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Show_Quest_Monsters, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Show_Quest_Monsters, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Show_Quest_Monsters, Condition( function Trig_Show_Quest_Monsters_Conditions ) )
    call TriggerAddAction( gg_trg_Show_Quest_Monsters, function Trig_Show_Quest_Monsters_Actions )
endfunction

//===========================================================================
// Trigger: Upgrade Skills
//===========================================================================
function Trig_Upgrade_Skills_Func023C takes nothing returns boolean
    if ( ( GetSpellAbilityId() == 'A00T' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A009' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A00H' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A00N' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A00R' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A01Z' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A0B9' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A0BA' ) ) then
        return true
    endif
    return false
endfunction

function Trig_Upgrade_Skills_Conditions takes nothing returns boolean
    if ( not Trig_Upgrade_Skills_Func023C() ) then
        return false
    endif
    if ( not ( udg_Attributepoints[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] > 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Upgrade_Skills_Func012Func002Func003C takes nothing returns boolean
    if ( not ( udg_dummyspell1[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] != 'A001' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Upgrade_Skills_Func012Func002C takes nothing returns boolean
    if ( not ( udg_WeaponStaff[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] == 100 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Upgrade_Skills_Func012C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A00T' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Upgrade_Skills_Func013Func001C takes nothing returns boolean
    if ( not ( udg_WeaponSword[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] == 100 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Upgrade_Skills_Func013C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A009' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Upgrade_Skills_Func014Func003C takes nothing returns boolean
    if ( not ( udg_WeaponAxe[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] == 100 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Upgrade_Skills_Func014C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A00H' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Upgrade_Skills_Func015Func003C takes nothing returns boolean
    if ( not ( udg_WeaponHands[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] == 100 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Upgrade_Skills_Func015C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A00N' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Upgrade_Skills_Func016Func003C takes nothing returns boolean
    if ( not ( udg_WeaponBow[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] == 100 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Upgrade_Skills_Func016C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A01Z' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Upgrade_Skills_Func017Func003Func003C takes nothing returns boolean
    if ( not ( udg_dummyspell2[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] != 'A00V' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Upgrade_Skills_Func017Func003Func004C takes nothing returns boolean
    if ( not ( udg_dummyspell4[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] != 'A028' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Upgrade_Skills_Func017Func003C takes nothing returns boolean
    if ( not ( udg_WeaponMagic[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] == 100 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Upgrade_Skills_Func017C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A00R' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Upgrade_Skills_Func018Func003Func003C takes nothing returns boolean
    if ( not ( udg_dummyspell3[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] != 'A02E' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Upgrade_Skills_Func018Func003C takes nothing returns boolean
    if ( not ( udg_WeaponDagger[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] == 100 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Upgrade_Skills_Func018C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A0B9' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Upgrade_Skills_Func019Func003C takes nothing returns boolean
    if ( not ( udg_WeaponElemental[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] == 100 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Upgrade_Skills_Func019C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A0BA' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Upgrade_Skills_Func022C takes nothing returns boolean
    if ( not ( udg_Attributepoints[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Upgrade_Skills_Actions takes nothing returns nothing
    set udg_Attributepoints[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( udg_Attributepoints[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] - 1 )
    if ( Trig_Upgrade_Skills_Func012C() ) then
        if ( Trig_Upgrade_Skills_Func012Func002C() ) then
            set udg_Attributepoints[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( udg_Attributepoints[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] + 1 )
        else
            set udg_WeaponStaff[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( udg_WeaponStaff[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] + 1 )
            call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))], 2, 4, I2S(udg_WeaponStaff[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))]) )
            if ( Trig_Upgrade_Skills_Func012Func002Func003C() ) then
                set udg_dummyspell1[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = 'A001'
                call UnitAddAbilityBJ( 'A001', GetTriggerUnit() )
                call IssueImmediateOrderBJ( GetTriggerUnit(), "flamingarrows" )
            else
                call SetUnitAbilityLevelSwapped( udg_dummyspell1[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))], GetTriggerUnit(), ( 1 + ( udg_WeaponStaff[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) ) )
            endif
            call ModifyHeroStat( bj_HEROSTAT_STR, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponStaff[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
            call ModifyHeroStat( bj_HEROSTAT_AGI, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponStaff[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
            call ModifyHeroStat( bj_HEROSTAT_INT, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponStaff[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
        endif
    else
        call DoNothing(  )
    endif
    if ( Trig_Upgrade_Skills_Func013C() ) then
        if ( Trig_Upgrade_Skills_Func013Func001C() ) then
            set udg_Attributepoints[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( udg_Attributepoints[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] + 1 )
        else
            set udg_WeaponSword[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( udg_WeaponSword[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] + 1 )
            call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))], 2, 5, I2S(udg_WeaponSword[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))]) )
            call ModifyHeroStat( bj_HEROSTAT_STR, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponSword[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
            call ModifyHeroStat( bj_HEROSTAT_STR, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponSword[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
            call ModifyHeroStat( bj_HEROSTAT_AGI, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponSword[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
            call ModifyHeroStat( bj_HEROSTAT_AGI, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponSword[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
        endif
    else
        call DoNothing(  )
    endif
    if ( Trig_Upgrade_Skills_Func014C() ) then
        if ( Trig_Upgrade_Skills_Func014Func003C() ) then
            set udg_Attributepoints[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( udg_Attributepoints[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] + 1 )
        else
            set udg_WeaponAxe[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( udg_WeaponAxe[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] + 1 )
            call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))], 2, 6, I2S(udg_WeaponAxe[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))]) )
            call ModifyHeroStat( bj_HEROSTAT_STR, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponAxe[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
            call ModifyHeroStat( bj_HEROSTAT_STR, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponAxe[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
            call ModifyHeroStat( bj_HEROSTAT_STR, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponAxe[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
            call ModifyHeroStat( bj_HEROSTAT_STR, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponAxe[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
        endif
    else
        call DoNothing(  )
    endif
    if ( Trig_Upgrade_Skills_Func015C() ) then
        if ( Trig_Upgrade_Skills_Func015Func003C() ) then
            set udg_Attributepoints[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( udg_Attributepoints[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] + 1 )
        else
            set udg_WeaponHands[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( udg_WeaponHands[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] + 1 )
            call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))], 2, 7, I2S(udg_WeaponHands[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))]) )
            call ModifyHeroStat( bj_HEROSTAT_AGI, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponHands[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
            call ModifyHeroStat( bj_HEROSTAT_AGI, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponHands[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
            call ModifyHeroStat( bj_HEROSTAT_AGI, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponHands[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
            call ModifyHeroStat( bj_HEROSTAT_AGI, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponHands[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
        endif
    else
        call DoNothing(  )
    endif
    if ( Trig_Upgrade_Skills_Func016C() ) then
        if ( Trig_Upgrade_Skills_Func016Func003C() ) then
            set udg_Attributepoints[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( udg_Attributepoints[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] + 1 )
        else
            set udg_WeaponBow[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( udg_WeaponBow[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] + 1 )
            call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))], 2, 9, I2S(udg_WeaponBow[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))]) )
            call ModifyHeroStat( bj_HEROSTAT_AGI, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponBow[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
            call ModifyHeroStat( bj_HEROSTAT_AGI, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponBow[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
            call ModifyHeroStat( bj_HEROSTAT_STR, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponBow[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
            call SetPlayerTechResearchedSwap( 'R00B', ( 1 + ( udg_WeaponBow[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) ), GetOwningPlayer(GetTriggerUnit()) )
        endif
    else
        call DoNothing(  )
    endif
    if ( Trig_Upgrade_Skills_Func017C() ) then
        if ( Trig_Upgrade_Skills_Func017Func003C() ) then
            set udg_Attributepoints[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( udg_Attributepoints[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] + 1 )
        else
            set udg_WeaponMagic[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( udg_WeaponMagic[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] + 1 )
            call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))], 2, 8, I2S(udg_WeaponMagic[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))]) )
            if ( Trig_Upgrade_Skills_Func017Func003Func003C() ) then
                set udg_dummyspell2[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = 'A00V'
                call UnitAddAbilityBJ( 'A00V', GetTriggerUnit() )
            else
                call SetUnitAbilityLevelSwapped( udg_dummyspell2[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))], GetTriggerUnit(), ( 1 + ( udg_WeaponMagic[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) ) )
            endif
            if ( Trig_Upgrade_Skills_Func017Func003Func004C() ) then
                set udg_dummyspell4[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = 'A028'
                call UnitAddAbilityBJ( 'A028', GetTriggerUnit() )
                call IssueImmediateOrderBJ( GetTriggerUnit(), "manashieldon" )
            else
                call SetUnitAbilityLevelSwapped( udg_dummyspell4[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))], GetTriggerUnit(), ( 1 + ( udg_WeaponMagic[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 10 ) ) )
            endif
            call ModifyHeroStat( bj_HEROSTAT_INT, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponMagic[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
            call ModifyHeroStat( bj_HEROSTAT_INT, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponMagic[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
            call ModifyHeroStat( bj_HEROSTAT_INT, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponMagic[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
        endif
    else
        call DoNothing(  )
    endif
    if ( Trig_Upgrade_Skills_Func018C() ) then
        if ( Trig_Upgrade_Skills_Func018Func003C() ) then
            set udg_Attributepoints[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( udg_Attributepoints[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] + 1 )
        else
            set udg_WeaponDagger[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( udg_WeaponDagger[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] + 1 )
            call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))], 2, 3, I2S(udg_WeaponDagger[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))]) )
            if ( Trig_Upgrade_Skills_Func018Func003Func003C() ) then
                call UnitAddAbilityBJ( 'A02E', GetTriggerUnit() )
                set udg_dummyspell3[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = 'A02E'
            else
                call SetUnitAbilityLevelSwapped( udg_dummyspell3[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))], GetTriggerUnit(), ( 1 + ( udg_WeaponDagger[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) ) )
            endif
            call ModifyHeroStat( bj_HEROSTAT_STR, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponDagger[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
            call ModifyHeroStat( bj_HEROSTAT_STR, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponDagger[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
            call ModifyHeroStat( bj_HEROSTAT_INT, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponDagger[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
        endif
    else
        call DoNothing(  )
    endif
    if ( Trig_Upgrade_Skills_Func019C() ) then
        if ( Trig_Upgrade_Skills_Func019Func003C() ) then
            set udg_Attributepoints[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( udg_Attributepoints[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] + 1 )
        else
            set udg_WeaponElemental[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = ( udg_WeaponElemental[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] + 1 )
            call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))], 2, 10, I2S(udg_WeaponElemental[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))]) )
            call ModifyHeroStat( bj_HEROSTAT_INT, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponElemental[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
            call ModifyHeroStat( bj_HEROSTAT_INT, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponElemental[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
            call ModifyHeroStat( bj_HEROSTAT_INT, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponElemental[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
            call ModifyHeroStat( bj_HEROSTAT_INT, GetTriggerUnit(), bj_MODIFYMETHOD_ADD, ( ( udg_WeaponElemental[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] / 5 ) + 1 ) )
        endif
    else
        call DoNothing(  )
    endif
    call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))], 2, 2, I2S(udg_Attributepoints[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))]) )
    // Exit
    if ( Trig_Upgrade_Skills_Func022C() ) then
        call ForceUICancelBJ( GetOwningPlayer(GetTriggerUnit()) )
    else
        call DoNothing(  )
    endif
endfunction

//===========================================================================
function InitTrig_Upgrade_Skills takes nothing returns nothing
    set gg_trg_Upgrade_Skills = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Skills, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Skills, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Skills, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Skills, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Skills, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Skills, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Skills, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Skills, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Skills, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Skills, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Upgrade_Skills, Condition( function Trig_Upgrade_Skills_Conditions ) )
    call TriggerAddAction( gg_trg_Upgrade_Skills, function Trig_Upgrade_Skills_Actions )
endfunction

//===========================================================================
// Trigger: Hero Level Up
//===========================================================================
function Trig_Hero_Level_Up_Conditions takes nothing returns boolean
local unit u = GetLevelingUnit()
local player p = GetOwningPlayer(u)
if p != Player(10) and p != Player(11) then
set u = null
set p = null
return true
endif
set u = null
set p = null
return false
endfunction

function Trig_Hero_Level_Up_Actions takes nothing returns nothing
local unit u = GetLevelingUnit()
local player p = GetOwningPlayer(u)
set udg_Attributepoints[GetConvertedPlayerId(p)] = ( udg_Attributepoints[GetConvertedPlayerId(p)] + ( GetHeroLevel(u) - udg_HeroLevel[GetConvertedPlayerId(p)] ) )
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 2, I2S(udg_Attributepoints[GetConvertedPlayerId(p)]) )
set udg_HeroLevel[GetConvertedPlayerId(p)] = GetHeroLevel(u)
set udg_SkillLevel = ( 1 + ( GetHeroLevel(u) / 10 ) )
if udg_SkillLevel > 10 then
set udg_SkillLevel = 10
endif
call SetUnitAbilityLevelSwapped( udg_SkillBook[GetConvertedPlayerId(p)], u, udg_SkillLevel )
if GetHeroLevel(u) <= 25 then
call SetPlayerTechResearchedSwap( 'R01Q', GetHeroLevel(u), p )
endif
if GetHeroLevel(u) > 25 and GetHeroLevel(u) <= 50 then
call SetPlayerTechResearchedSwap( 'R007', GetHeroLevel(u) - 25, p )
endif
if GetHeroLevel(u) > 50 and GetHeroLevel(u) <= 75 then
call SetPlayerTechResearchedSwap( 'R00K', GetHeroLevel(u) - 50, p )
endif
if GetHeroLevel(u) > 75 and GetHeroLevel(u) <= 100 then
call SetPlayerTechResearchedSwap( 'R00L', (GetHeroLevel(u) - 75) * 2, p )
endif
if GetHeroLevel(u) > 100 and GetHeroLevel(u) <= 125 then
call SetPlayerTechResearchedSwap( 'R00J', (GetHeroLevel(u) - 100) * 2, p )
endif
if GetHeroLevel(u) > 125 and GetHeroLevel(u) <= 150 then
call SetPlayerTechResearchedSwap( 'R00M', (GetHeroLevel(u) - 125) * 3, p )
endif
set p = null
endfunction

//===========================================================================
function InitTrig_Hero_Level_Up takes nothing returns nothing
    set gg_trg_Hero_Level_Up = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Level_Up, Player(0), EVENT_PLAYER_HERO_LEVEL )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Level_Up, Player(1), EVENT_PLAYER_HERO_LEVEL )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Level_Up, Player(2), EVENT_PLAYER_HERO_LEVEL )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Level_Up, Player(3), EVENT_PLAYER_HERO_LEVEL )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Level_Up, Player(4), EVENT_PLAYER_HERO_LEVEL )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Level_Up, Player(5), EVENT_PLAYER_HERO_LEVEL )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Level_Up, Player(6), EVENT_PLAYER_HERO_LEVEL )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Level_Up, Player(7), EVENT_PLAYER_HERO_LEVEL )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Level_Up, Player(8), EVENT_PLAYER_HERO_LEVEL )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Level_Up, Player(9), EVENT_PLAYER_HERO_LEVEL )
    call TriggerAddCondition( gg_trg_Hero_Level_Up, Condition( function Trig_Hero_Level_Up_Conditions ) )
    call TriggerAddAction( gg_trg_Hero_Level_Up, function Trig_Hero_Level_Up_Actions )
endfunction

//===========================================================================
// Trigger: Set Up Camp
//===========================================================================
function Trig_Set_Up_Camp_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A0AK' then
return true
endif
return false
endfunction

function check takes nothing returns boolean
local unit u = GetFilterUnit()
local unit u2 = GetTriggerUnit()
local player p = GetOwningPlayer(u2)
if IsUnitAliveBJ(u) == true and IsUnitEnemy(u, p) == true then
set u = null
set u2 = null
set p = null
return true
endif
set u = null
set u2 = null
set p = null
return false
endfunction

function Trig_Set_Up_Camp_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local location l = GetUnitLoc(u)
local group g = GetUnitsInRangeOfLocMatching(750.00, l, Condition(function check))
local player p = GetOwningPlayer(u)
local effect e = null

if CountUnitsInGroup(g) == 0 then
call IssueImmediateOrderBJ( u, "stop" )
call AddSpecialEffectTargetUnitBJ( "overhead", u, "Abilities\\Spells\\Undead\\Sleep\\SleepTarget.mdl" )
set e = bj_lastCreatedEffect
call SetUnitVertexColorBJ( u, 50.00, 50.00, 100, 50.00 )
call PauseUnitBJ( true, u )
call SetUnitInvulnerable( u, true )
call PolledWait( ( 1.00 + ( ( 100.00 - GetUnitLifePercent(u) ) / 5.00 ) + ( ( 100 - GetUnitManaPercent(u) ) / 5.00 ) ) )
call SetUnitLifePercentBJ( u, 100 )
call SetUnitManaPercentBJ( u, 100 )
call PauseUnitBJ( false, u )
call SetUnitInvulnerable( u, false )
call SetUnitVertexColorBJ( u, 100.00, 100.00, 100, 0.00 )
else
call SetFloatingText(p,"Not safe to set up a camp!",GetLocationX(l),GetLocationY(l),50,255,0,0)
endif
call DestroyGroup(g)
set g = null
call RemoveLocation(l)
set l = null
call DestroyEffect( e )
set e = null
set p = null
set u = null
endfunction

//===========================================================================
function InitTrig_Set_Up_Camp takes nothing returns nothing
    set gg_trg_Set_Up_Camp = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Set_Up_Camp, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Set_Up_Camp, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Set_Up_Camp, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Set_Up_Camp, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Set_Up_Camp, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Set_Up_Camp, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Set_Up_Camp, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Set_Up_Camp, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Set_Up_Camp, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Set_Up_Camp, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Set_Up_Camp, Condition( function Trig_Set_Up_Camp_Conditions ) )
    call TriggerAddAction( gg_trg_Set_Up_Camp, function Trig_Set_Up_Camp_Actions )
endfunction

//===========================================================================
// Trigger: Hero Dies
//===========================================================================
function Trig_Hero_Dies_Conditions takes nothing returns boolean
local unit u = GetDyingUnit()
local player p = GetOwningPlayer(u)
if IsUnitType(u, UNIT_TYPE_HERO) == true and p != Player(10) and p != Player(11) then
set u = null
set p = null
return true
endif 
set u = null
set p = null
return false
endfunction

function DyingHero takes nothing returns nothing
local unit u = GetEnumUnit()
if IsUnitAliveBJ(u) == true and IsUnitType(u, UNIT_TYPE_STRUCTURE) == false then
call KillUnit( u )
endif
set u = null
endfunction

function Trig_Hero_Dies_Actions takes nothing returns nothing
local unit u = GetDyingUnit()
local player p = GetOwningPlayer(u)
local group g = GetUnitsOfPlayerAll(p)
local group g2 = GetUnitsOfPlayerAndTypeId(Player(PLAYER_NEUTRAL_PASSIVE), 'e015')
local unit u2 = GroupPickRandomUnit(g2)
local location l = GetUnitLoc(u2)

if udg_HeroLifes[GetConvertedPlayerId(p)] > 0 then
    set udg_HeroLifes[GetConvertedPlayerId(p)] = ( udg_HeroLifes[GetConvertedPlayerId(p)] - 1 )
    call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 1, I2S(udg_HeroLifes[GetConvertedPlayerId(p)]) )
    call PolledWait( 2.00 )
    call ForGroupBJ( g, function DyingHero )
    call ReviveHeroLoc( u, l, true )
    call PanCameraToTimedLocForPlayer( p, l, 0 )
    if udg_HeroType[GetConvertedPlayerId(p)] == 3 then
    call SetUnitUseFoodBJ( false, u )
    endif
    call SetUnitManaPercentBJ( u, 100 )
    call SetUnitInvulnerable( u, true )
    call PolledWait( 15.00 )
    call SetUnitInvulnerable( u, false )
else
    if udg_HeroRace[GetConvertedPlayerId(p)] == 1 then
        call PlaySoundBJ( gg_snd_Warning )
        call DisplayTimedTextToForce( GetPlayersAll(), 10.00, ( ( udg_Playercolor[GetConvertedPlayerId(GetOwningPlayer(GetDyingUnit()))] + GetPlayerName(GetOwningPlayer(GetDyingUnit())) ) + "'s |cffffcc00Hero has fallen!" ) )
        set udg_Heroes = ( udg_Heroes - 1 )
        call ForceRemovePlayerSimple( p, udg_AttackerGroup )
        call TriggerExecute( gg_trg_Defeat_check )
    endif
endif
call DestroyGroup(g)
call DestroyGroup(g2)
call RemoveLocation(l)
set l = null
set g = null
set g2 = null
set p = null
set u = null
set u2 = null
endfunction

//===========================================================================
function InitTrig_Hero_Dies takes nothing returns nothing
    set gg_trg_Hero_Dies = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Dies, Player(0), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Dies, Player(1), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Dies, Player(2), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Dies, Player(3), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Dies, Player(4), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Dies, Player(5), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Dies, Player(6), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Dies, Player(7), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Dies, Player(8), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Dies, Player(9), EVENT_PLAYER_UNIT_DEATH )
    call TriggerAddCondition( gg_trg_Hero_Dies, Condition( function Trig_Hero_Dies_Conditions ) )
    call TriggerAddAction( gg_trg_Hero_Dies, function Trig_Hero_Dies_Actions )
endfunction

//===========================================================================
// Trigger: Exp and Gold
//===========================================================================
function Trig_Exp_and_Gold_Conditions takes nothing returns boolean
local unit u = GetKillingUnitBJ()
if u != null then
set u = null
return true
endif
set u = null
return false
endfunction

function Trig_Exp_and_Gold_Actions takes nothing returns nothing
set udg_DyingUnit = GetDyingUnit()
set udg_KillingUnit = GetKillingUnitBJ()
call TriggerExecute( gg_trg_Exp_Gold_Rank )
endfunction

//===========================================================================
function InitTrig_Exp_and_Gold takes nothing returns nothing
    set gg_trg_Exp_and_Gold = CreateTrigger(  )
    call TriggerRegisterAnyUnitEventBJ( gg_trg_Exp_and_Gold, EVENT_PLAYER_UNIT_DEATH )
    call TriggerAddCondition( gg_trg_Exp_and_Gold, Condition( function Trig_Exp_and_Gold_Conditions ) )
    call TriggerAddAction( gg_trg_Exp_and_Gold, function Trig_Exp_and_Gold_Actions )
endfunction

//===========================================================================
// Trigger: Exp Gold Rank
//===========================================================================
function GiveExp takes nothing returns nothing
local unit u = GetEnumUnit()
local player p = GetOwningPlayer(u)
local location l = GetUnitLoc(udg_DyingUnit)
if udg_HeroType[GetConvertedPlayerId(p)] == 1 then
call AddHeroXPSwapped( ( udg_exp * 175 / 100 ), u, true )
call SetFloatingText(p,"+" + I2S(udg_exp * 175 / 100),GetLocationX(l),GetLocationY(l),50,0,0,255)
else
call AddHeroXPSwapped( udg_exp, u, true )
call SetFloatingText(p,"+" + I2S(udg_exp),GetLocationX(l),GetLocationY(l),50,0,0,255)
endif
call RemoveLocation(l)
set p = null
set u = null
set l = null
endfunction

function HeroChecking takes nothing returns boolean
local unit u = GetFilterUnit()
local player p = GetOwningPlayer(udg_KillingUnit)
if IsUnitAlly(u, p) == true and IsUnitType(u, UNIT_TYPE_HERO) == true then
set u = null
set p = null
return true
endif
set u = null
set p = null
return false
endfunction

function Trig_Exp_Gold_Rank_Actions takes nothing returns nothing
local player p = GetOwningPlayer(udg_KillingUnit)
local player p2 = GetOwningPlayer(udg_DyingUnit)
local location l = GetUnitLoc(udg_DyingUnit)
local integer i = 0
local group g = GetUnitsInRangeOfLocMatching(2500, l, Condition(function HeroChecking))

if p != Player(11) and p != Player(10) and p != Player(PLAYER_NEUTRAL_AGGRESSIVE) and IsUnitEnemy(udg_DyingUnit, p) == true and GetUnitTypeId(udg_DyingUnit) != 'e00U' then

// Rank
if IsUnitType(udg_KillingUnit, UNIT_TYPE_MECHANICAL) == false and udg_Empire[GetConvertedPlayerId(p)] == 1 then
set udg_happyness[GetConvertedPlayerId(p)] = ( udg_happyness[GetConvertedPlayerId(p)] + 5 )
call SetUnitUserData( udg_KillingUnit, ( GetUnitUserData(udg_KillingUnit) + 1 ) )
call UnitRemoveAbilityBJ( 'A053', udg_KillingUnit )
call UnitRemoveAbilityBJ( 'A056', udg_KillingUnit )
call UnitRemoveAbilityBJ( 'A05G', udg_KillingUnit )
call UnitRemoveAbilityBJ( 'A05E', udg_KillingUnit )
call UnitRemoveAbilityBJ( 'A04R', udg_KillingUnit )
call UnitRemoveAbilityBJ( 'A04S', udg_KillingUnit )
if GetUnitUserData(udg_KillingUnit) >= 5 and GetUnitUserData(udg_KillingUnit) < 10 then
call UnitAddAbilityBJ( 'A053', udg_KillingUnit )
endif
if GetUnitUserData(udg_KillingUnit) >= 10 and GetUnitUserData(udg_KillingUnit) < 25 then
call UnitAddAbilityBJ( 'A056', udg_KillingUnit )
endif
if GetUnitUserData(udg_KillingUnit) >= 25 and GetUnitUserData(udg_KillingUnit) < 50 then
call UnitAddAbilityBJ( 'A05G', udg_KillingUnit )
endif
if GetUnitUserData(udg_KillingUnit) >= 50 and GetUnitUserData(udg_KillingUnit) < 100 then
call UnitAddAbilityBJ( 'A05E', udg_KillingUnit )
endif
if GetUnitUserData(udg_KillingUnit) >= 100 and GetUnitUserData(udg_KillingUnit) < 200 then
call UnitAddAbilityBJ( 'A04R', udg_KillingUnit )
endif
if GetUnitUserData(udg_KillingUnit) >= 200 then
call UnitAddAbilityBJ( 'A04S', udg_KillingUnit )
endif
else
if IsUnitType(udg_KillingUnit, UNIT_TYPE_SAPPER) == true and IsUnitType(udg_KillingUnit, UNIT_TYPE_MECHANICAL) == false then
call SetUnitUserData( udg_KillingUnit, ( GetUnitUserData(udg_KillingUnit) + 1 ) )
call UnitRemoveAbilityBJ( 'A053', udg_KillingUnit )
call UnitRemoveAbilityBJ( 'A056', udg_KillingUnit )
call UnitRemoveAbilityBJ( 'A05G', udg_KillingUnit )
call UnitRemoveAbilityBJ( 'A05E', udg_KillingUnit )
call UnitRemoveAbilityBJ( 'A04R', udg_KillingUnit )
call UnitRemoveAbilityBJ( 'A04S', udg_KillingUnit )
if GetUnitUserData(udg_KillingUnit) >= 5 and GetUnitUserData(udg_KillingUnit) < 10 then
call UnitAddAbilityBJ( 'A053', udg_KillingUnit )
endif
if GetUnitUserData(udg_KillingUnit) >= 10 and GetUnitUserData(udg_KillingUnit) < 25 then
call UnitAddAbilityBJ( 'A056', udg_KillingUnit )
endif
if GetUnitUserData(udg_KillingUnit) >= 25 and GetUnitUserData(udg_KillingUnit) < 50 then
call UnitAddAbilityBJ( 'A05G', udg_KillingUnit )
endif
if GetUnitUserData(udg_KillingUnit) >= 50 and GetUnitUserData(udg_KillingUnit) < 100 then
call UnitAddAbilityBJ( 'A05E', udg_KillingUnit )
endif
if GetUnitUserData(udg_KillingUnit) >= 100 and GetUnitUserData(udg_KillingUnit) < 200 then
call UnitAddAbilityBJ( 'A04R', udg_KillingUnit )
endif
if GetUnitUserData(udg_KillingUnit) >= 200 then
call UnitAddAbilityBJ( 'A04S', udg_KillingUnit )
endif
endif
endif

//Set Exp

//comp unit death
if p2 == Player(11) or p2 == Player(10) or p2 == Player(PLAYER_NEUTRAL_AGGRESSIVE) then
if IsUnitType(udg_DyingUnit, UNIT_TYPE_HERO) == true then
set udg_exp = (((25 + ( ( GetUnitLevel(udg_DyingUnit) * 10 ) + ( GetUnitLevel(udg_DyingUnit) * GetUnitLevel(udg_DyingUnit) * 20 ) )) * udg_Exprate) / 100 )
else
set udg_exp = (((10 + ( ( GetUnitLevel(udg_DyingUnit) * 10 ) + ( GetUnitLevel(udg_DyingUnit) * GetUnitLevel(udg_DyingUnit) * 5 ) )) * udg_Exprate) / 100 )
if p2 == Player(PLAYER_NEUTRAL_AGGRESSIVE) then
set udg_exp = ( udg_exp + ( udg_exp / 4 ) )
endif
endif

//player unit death
else
if IsUnitType(udg_DyingUnit, UNIT_TYPE_HERO) == true then
set udg_exp = (50 + ( GetHeroLevel(udg_DyingUnit) * GetHeroLevel(udg_DyingUnit) * 3))
else
set udg_exp = GetUnitPointValue(udg_DyingUnit)
endif
endif

//item drop
if p2 == Player(11) or p2 == Player(10) or p2 == Player(PLAYER_NEUTRAL_AGGRESSIVE) then
if p2 == Player(PLAYER_NEUTRAL_AGGRESSIVE) then
set i = GetRandomInt(1,175)
else
if p2 == Player(11) or p2 == Player(10) then
set i = GetRandomInt(1,300)
endif
endif
if i <= 10 then
call CreateItemLoc( 'I005', l )
endif
if i <= 20 and i > 10 then
call CreateItemLoc( 'I002', l )
endif
if i <= 25 and i > 20 then
call CreateItemLoc( 'I006', l )
endif
if i <= 30 and i > 25 then
call CreateItemLoc( 'I007', l )
endif
if i <= 37 and i > 30 then
call CreateItemLoc( 'I004', l )
endif
if i <= 40 and i > 37 then
call CreateItemLoc( 'I000', l )
endif
endif

//Giving Exp
set udg_exp = ( udg_exp / CountUnitsInGroup(g) )
call ForGroupBJ( g, function GiveExp )    

endif
call DestroyGroup(g)
call RemoveLocation(l)
set l = null
set p = null
set p2 = null
set g = null
endfunction

//===========================================================================
function InitTrig_Exp_Gold_Rank takes nothing returns nothing
    set gg_trg_Exp_Gold_Rank = CreateTrigger(  )
    call TriggerAddAction( gg_trg_Exp_Gold_Rank, function Trig_Exp_Gold_Rank_Actions )
endfunction

//===========================================================================
// Trigger: Servant of Decay
//===========================================================================
function Trig_Servant_of_Decay_Conditions takes nothing returns boolean
local unit u = GetSummonedUnit()
if GetUnitTypeId(u) == 'u003' or GetUnitTypeId(u) == 'u004' or GetUnitTypeId(u) == 'u005' or GetUnitTypeId(u) == 'u006' or GetUnitTypeId(u) == 'u007' or GetUnitTypeId(u) == 'u008' or GetUnitTypeId(u) == 'u009' or GetUnitTypeId(u) == 'u00A' or GetUnitTypeId(u) == 'u00B' or GetUnitTypeId(u) == 'u00C' then
set u = null
return true
endif
set u = null
return false
endfunction

function Trig_Servant_of_Decay_Actions takes nothing returns nothing
local unit u = GetSummonedUnit()
local unit u2 = GetSummoningUnit()
call UnitGuardUnitAI(u,u2)
set u = null
set u2 = null
endfunction

//===========================================================================
function InitTrig_Servant_of_Decay takes nothing returns nothing
    set gg_trg_Servant_of_Decay = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Servant_of_Decay, Player(0), EVENT_PLAYER_UNIT_SUMMON )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Servant_of_Decay, Player(1), EVENT_PLAYER_UNIT_SUMMON )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Servant_of_Decay, Player(2), EVENT_PLAYER_UNIT_SUMMON )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Servant_of_Decay, Player(3), EVENT_PLAYER_UNIT_SUMMON )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Servant_of_Decay, Player(4), EVENT_PLAYER_UNIT_SUMMON )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Servant_of_Decay, Player(5), EVENT_PLAYER_UNIT_SUMMON )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Servant_of_Decay, Player(6), EVENT_PLAYER_UNIT_SUMMON )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Servant_of_Decay, Player(7), EVENT_PLAYER_UNIT_SUMMON )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Servant_of_Decay, Player(8), EVENT_PLAYER_UNIT_SUMMON )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Servant_of_Decay, Player(9), EVENT_PLAYER_UNIT_SUMMON )
    call TriggerAddCondition( gg_trg_Servant_of_Decay, Condition( function Trig_Servant_of_Decay_Conditions ) )
    call TriggerAddAction( gg_trg_Servant_of_Decay, function Trig_Servant_of_Decay_Actions )
endfunction

//===========================================================================
// Trigger: Merc Speed
//===========================================================================
function MercSpeedSet takes nothing returns nothing
local unit u = GetEnumUnit()
local player p = GetOwningPlayer(u)
local real r = GetUnitMoveSpeed(udg_Herounit[GetConvertedPlayerId(p)])
if IsUnitType(u, UNIT_TYPE_SAPPER) == true then
call SetUnitMoveSpeed( u, r )
endif
set u = null
set p = null
endfunction

function Trig_Merc_Speed_Actions takes nothing returns nothing
local integer i = 1
local group g
loop
exitwhen i > 10
if udg_HeroRace[i] == 1 then
set g = GetUnitsOfPlayerAll(ConvertedPlayer(i))
call ForGroupBJ( g, function MercSpeedSet )
endif
set i = i + 1
endloop
call DestroyGroup(g)
set g = null
endfunction

//===========================================================================
function InitTrig_Merc_Speed takes nothing returns nothing
    set gg_trg_Merc_Speed = CreateTrigger(  )
    call TriggerRegisterTimerEventPeriodic( gg_trg_Merc_Speed, 10.49 )
    call TriggerAddAction( gg_trg_Merc_Speed, function Trig_Merc_Speed_Actions )
endfunction

//===========================================================================
// Trigger: Buy Item
//===========================================================================
function Trig_Buy_Items_Conditions takes nothing returns boolean
local unit u = GetBuyingUnit()
if UnitItemInSlotBJ(u, 1) == null or UnitItemInSlotBJ(u, 2) == null or UnitItemInSlotBJ(u, 3) == null or UnitItemInSlotBJ(u, 4) == null or UnitItemInSlotBJ(u, 5) == null or UnitItemInSlotBJ(u, 6) == null then
set u = null
return true
endif
set u = null
return false
endfunction

function Trig_Buy_Item_Actions takes nothing returns nothing
local unit u = GetBuyingUnit()
local item i = GetSoldItem()
local player p = GetOwningPlayer(u)
local location l = GetUnitLoc(u)
call TriggerSleepAction( 0.00 )
if R2I(GetItemLifeBJ(i)) <= udg_TradePoints[GetConvertedPlayerId(p)]  then
call SetFloatingText(p,"-" + I2S(R2I(GetItemLifeBJ(i))),GetLocationX(l),GetLocationY(l),50,0,255,0)
set udg_TradePoints[GetConvertedPlayerId(p)] = udg_TradePoints[GetConvertedPlayerId(p)] - R2I(GetItemLifeBJ(i))
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 11, I2S(udg_TradePoints[GetConvertedPlayerId(p)]) )
else
call RemoveItem( i )
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000You can't afford this item!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif
call RemoveLocation(l)
set l = null
set p = null
set i = null
set u = null
endfunction

//===========================================================================
function InitTrig_Buy_Item takes nothing returns nothing
    set gg_trg_Buy_Item = CreateTrigger(  )
    call TriggerRegisterAnyUnitEventBJ( gg_trg_Buy_Item, EVENT_PLAYER_UNIT_SELL_ITEM )
    call TriggerAddCondition( gg_trg_Buy_Item, Condition( function Trig_Buy_Items_Conditions ))
    call TriggerAddAction( gg_trg_Buy_Item, function Trig_Buy_Item_Actions )
endfunction

//===========================================================================
// Trigger: Sell Item
//===========================================================================
function Trig_Sell_Item_Actions takes nothing returns nothing
local unit u = GetSellingUnit()
local item i = GetSoldItem()
local player p = GetOwningPlayer(u)
local location l = GetUnitLoc(u)
set udg_TradePoints[GetConvertedPlayerId(p)] = udg_TradePoints[GetConvertedPlayerId(p)] + (R2I(GetItemLifeBJ(i)) / 2)
call SetFloatingText(p,"+" + I2S(R2I(GetItemLifeBJ(i)) / 2),GetLocationX(l),GetLocationY(l),50,0,255,0)
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 11, I2S(udg_TradePoints[GetConvertedPlayerId(p)]) )
call RemoveLocation(l)
set l = null
set p = null
set i = null
set u = null
endfunction

//===========================================================================
function InitTrig_Sell_Item takes nothing returns nothing
    set gg_trg_Sell_Item = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Sell_Item, Player(0), EVENT_PLAYER_UNIT_PAWN_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Sell_Item, Player(1), EVENT_PLAYER_UNIT_PAWN_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Sell_Item, Player(2), EVENT_PLAYER_UNIT_PAWN_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Sell_Item, Player(3), EVENT_PLAYER_UNIT_PAWN_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Sell_Item, Player(4), EVENT_PLAYER_UNIT_PAWN_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Sell_Item, Player(5), EVENT_PLAYER_UNIT_PAWN_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Sell_Item, Player(6), EVENT_PLAYER_UNIT_PAWN_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Sell_Item, Player(7), EVENT_PLAYER_UNIT_PAWN_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Sell_Item, Player(8), EVENT_PLAYER_UNIT_PAWN_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Sell_Item, Player(9), EVENT_PLAYER_UNIT_PAWN_ITEM )
    call TriggerAddAction( gg_trg_Sell_Item, function Trig_Sell_Item_Actions )
endfunction

//===========================================================================
// Trigger: Hero Building Dies
//===========================================================================
function Trig_Hero_Building_Dies_Conditions takes nothing returns boolean
local unit u = GetDyingUnit()
local player p = GetOwningPlayer(u)
if IsUnitType(u, UNIT_TYPE_STRUCTURE) == true and udg_HeroRace[GetConvertedPlayerId(p)] == 1 then
set u = null
set p = null
return true
endif
set u = null
set p = null
return false
endfunction

function Trig_Hero_Building_Dies_Actions takes nothing returns nothing
local unit u = GetDyingUnit()
call PolledWait( 2.00 )
call RemoveUnit( u )
set u = null
endfunction

//===========================================================================
function InitTrig_Hero_Building_Dies takes nothing returns nothing
    set gg_trg_Hero_Building_Dies = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Building_Dies, Player(0), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Building_Dies, Player(1), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Building_Dies, Player(2), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Building_Dies, Player(3), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Building_Dies, Player(4), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Building_Dies, Player(5), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Building_Dies, Player(6), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Building_Dies, Player(7), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Building_Dies, Player(8), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hero_Building_Dies, Player(9), EVENT_PLAYER_UNIT_DEATH )
    call TriggerAddCondition( gg_trg_Hero_Building_Dies, Condition( function Trig_Hero_Building_Dies_Conditions ) )
    call TriggerAddAction( gg_trg_Hero_Building_Dies, function Trig_Hero_Building_Dies_Actions )
endfunction

//===========================================================================
// Trigger: Hideout Heal
//===========================================================================
function Trig_Hideout_Heal_Conditions takes nothing returns boolean
local unit u = GetTransportUnitBJ()
if GetUnitTypeId(u) == 'h00X'then
set u = null
return true
endif
set u = null
return false
endfunction

function Trig_Hideout_Heal_Actions takes nothing returns nothing
local unit u = GetLoadedUnitBJ()
local unit u2 = GetTransportUnitBJ()
local unit u3 = null
local player p = GetOwningPlayer(u2)
local location l = GetUnitLoc(u2)

call CreateNUnitsAtLoc( 1, 'e01C', p, l, bj_UNIT_FACING )
set u3 = GetLastCreatedUnit()
call RemoveLocation(l)

loop
exitwhen IsUnitInTransportBJ(u, u2) == false
call SetUnitLifePercentBJ( u, ( GetUnitLifePercent(u) + 12.5 ) )
call SetUnitManaPercentBJ( u, ( GetUnitManaPercent(u) + 12.5 ) )
call PolledWait(1.00)
endloop

call RemoveUnit(u3)
set l = null
set p = null
set u = null
set u2 = null
set u3 = null
endfunction

//===========================================================================
function InitTrig_Hideout_Heal takes nothing returns nothing
    set gg_trg_Hideout_Heal = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hideout_Heal, Player(0), EVENT_PLAYER_UNIT_LOADED )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hideout_Heal, Player(1), EVENT_PLAYER_UNIT_LOADED )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hideout_Heal, Player(2), EVENT_PLAYER_UNIT_LOADED )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hideout_Heal, Player(3), EVENT_PLAYER_UNIT_LOADED )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hideout_Heal, Player(4), EVENT_PLAYER_UNIT_LOADED )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hideout_Heal, Player(5), EVENT_PLAYER_UNIT_LOADED )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hideout_Heal, Player(6), EVENT_PLAYER_UNIT_LOADED )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hideout_Heal, Player(7), EVENT_PLAYER_UNIT_LOADED )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hideout_Heal, Player(8), EVENT_PLAYER_UNIT_LOADED )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hideout_Heal, Player(9), EVENT_PLAYER_UNIT_LOADED )
    call TriggerAddCondition( gg_trg_Hideout_Heal, Condition( function Trig_Hideout_Heal_Conditions ) )
    call TriggerAddAction( gg_trg_Hideout_Heal, function Trig_Hideout_Heal_Actions )
endfunction

//===========================================================================
// Trigger: Campfire
//===========================================================================
function Trig_Campfire_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A017' then
return true
endif
return false
endfunction

function Trig_Campfire_Actions takes nothing returns nothing
local unit u = GetSpellAbilityUnit()
local player p = GetOwningPlayer(u)
local integer Firestone = 0
local integer Gem = 0
local integer Herb = 0
local integer Iron = 0
local integer Rock = 0
local integer Wood = 0
local integer i = 1

loop
exitwhen i > 6
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I007' then
set Firestone = Firestone + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I000' then
set Gem = Gem + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I006' then
set Herb = Herb + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I004' then
set Iron = Iron + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I005' then
set Rock = Rock + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I002' then
set Wood = Wood + 1
endif 
set i = i + 1
endloop

if Rock >= 2 and Firestone >= 1 then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
call UnitAddItemByIdSwapped( 'I008', u )
else
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif

set p = null
set u = null
endfunction

//===========================================================================
function InitTrig_Campfire takes nothing returns nothing
    set gg_trg_Campfire = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Campfire, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Campfire, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Campfire, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Campfire, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Campfire, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Campfire, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Campfire, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Campfire, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Campfire, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Campfire, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Campfire, Condition( function Trig_Campfire_Conditions ) )
    call TriggerAddAction( gg_trg_Campfire, function Trig_Campfire_Actions )
endfunction

//===========================================================================
// Trigger: Hideout
//===========================================================================
function Trig_Hideout_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A018' then
return true
endif
return false
endfunction

function Trig_Hideout_Actions takes nothing returns nothing
local unit u = GetSpellAbilityUnit()
local player p = GetOwningPlayer(u)
local integer Firestone = 0
local integer Gem = 0
local integer Herb = 0
local integer Iron = 0
local integer Rock = 0
local integer Wood = 0
local integer i = 1

loop
exitwhen i > 6
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I007' then
set Firestone = Firestone + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I000' then
set Gem = Gem + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I006' then
set Herb = Herb + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I004' then
set Iron = Iron + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I005' then
set Rock = Rock + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I002' then
set Wood = Wood + 1
endif 
set i = i + 1
endloop

if Rock >= 2 and Wood >= 2 and Iron >= 1 then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call UnitAddItemByIdSwapped( 'I009', u )
else
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif

set p = null
set u = null
endfunction

//===========================================================================
function InitTrig_Hideout takes nothing returns nothing
    set gg_trg_Hideout = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hideout, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hideout, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hideout, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hideout, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hideout, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hideout, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hideout, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hideout, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hideout, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Hideout, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Hideout, Condition( function Trig_Hideout_Conditions ) )
    call TriggerAddAction( gg_trg_Hideout, function Trig_Hideout_Actions )
endfunction

//===========================================================================
// Trigger: Forge
//===========================================================================
function Trig_Forge_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A016' then
return true
endif
return false
endfunction

function Trig_Forge_Actions takes nothing returns nothing
local unit u = GetSpellAbilityUnit()
local player p = GetOwningPlayer(u)
local integer Firestone = 0
local integer Gem = 0
local integer Herb = 0
local integer Iron = 0
local integer Rock = 0
local integer Wood = 0
local integer i = 1

loop
exitwhen i > 6
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I007' then
set Firestone = Firestone + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I000' then
set Gem = Gem + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I006' then
set Herb = Herb + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I004' then
set Iron = Iron + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I005' then
set Rock = Rock + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I002' then
set Wood = Wood + 1
endif 
set i = i + 1
endloop

if Rock >= 1 and Wood >= 1 and Iron >= 2 then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call UnitAddItemByIdSwapped( 'I00A', u )
else
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif

set p = null
set u = null
endfunction

//===========================================================================
function InitTrig_Forge takes nothing returns nothing
    set gg_trg_Forge = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Forge, Condition( function Trig_Forge_Conditions ) )
    call TriggerAddAction( gg_trg_Forge, function Trig_Forge_Actions )
endfunction

//===========================================================================
// Trigger: Library
//===========================================================================
function Trig_Library_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A01A' then
return true
endif
return false
endfunction

function Trig_Library_Actions takes nothing returns nothing
local unit u = GetSpellAbilityUnit()
local player p = GetOwningPlayer(u)
local integer Firestone = 0
local integer Gem = 0
local integer Herb = 0
local integer Iron = 0
local integer Rock = 0
local integer Wood = 0
local integer i = 1

loop
exitwhen i > 6
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I007' then
set Firestone = Firestone + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I000' then
set Gem = Gem + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I006' then
set Herb = Herb + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I004' then
set Iron = Iron + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I005' then
set Rock = Rock + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I002' then
set Wood = Wood + 1
endif 
set i = i + 1
endloop

if Rock >= 2 and Wood >= 2 then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call UnitAddItemByIdSwapped( 'I00B', u )
else
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif

set p = null
set u = null
endfunction

//===========================================================================
function InitTrig_Library takes nothing returns nothing
    set gg_trg_Library = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Library, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Library, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Library, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Library, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Library, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Library, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Library, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Library, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Library, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Library, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Library, Condition( function Trig_Library_Conditions ) )
    call TriggerAddAction( gg_trg_Library, function Trig_Library_Actions )
endfunction

//===========================================================================
// Trigger: Spike Trap
//===========================================================================
function Trig_Spike_Trap_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A01B' then
return true
endif
return false
endfunction

function Trig_Spike_Trap_Actions takes nothing returns nothing
local unit u = GetSpellAbilityUnit()
local player p = GetOwningPlayer(u)
local integer Firestone = 0
local integer Gem = 0
local integer Herb = 0
local integer Iron = 0
local integer Rock = 0
local integer Wood = 0
local integer i = 1

loop
exitwhen i > 6
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I007' then
set Firestone = Firestone + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I000' then
set Gem = Gem + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I006' then
set Herb = Herb + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I004' then
set Iron = Iron + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I005' then
set Rock = Rock + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I002' then
set Wood = Wood + 1
endif 
set i = i + 1
endloop

if Wood >= 1 then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call UnitAddItemByIdSwapped( 'I00C', u )
else
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif

set p = null
set u = null
endfunction

//===========================================================================
function InitTrig_Spike_Trap takes nothing returns nothing
    set gg_trg_Spike_Trap = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Spike_Trap, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Spike_Trap, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Spike_Trap, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Spike_Trap, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Spike_Trap, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Spike_Trap, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Spike_Trap, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Spike_Trap, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Spike_Trap, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Spike_Trap, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Spike_Trap, Condition( function Trig_Spike_Trap_Conditions ) )
    call TriggerAddAction( gg_trg_Spike_Trap, function Trig_Spike_Trap_Actions )
endfunction

//===========================================================================
// Trigger: Storage Pit
//===========================================================================
function Trig_Storage_Pit_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A01D' then
return true
endif
return false
endfunction

function Trig_Storage_Pit_Actions takes nothing returns nothing
local unit u = GetSpellAbilityUnit()
local player p = GetOwningPlayer(u)
local integer Firestone = 0
local integer Gem = 0
local integer Herb = 0
local integer Iron = 0
local integer Rock = 0
local integer Wood = 0
local integer i = 1

loop
exitwhen i > 6
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I007' then
set Firestone = Firestone + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I000' then
set Gem = Gem + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I006' then
set Herb = Herb + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I004' then
set Iron = Iron + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I005' then
set Rock = Rock + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I002' then
set Wood = Wood + 1
endif 
set i = i + 1
endloop

if Wood >= 2 then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call UnitAddItemByIdSwapped( 'I00F', u )
else
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif

set p = null
set u = null
endfunction

//===========================================================================
function InitTrig_Storage_Pit takes nothing returns nothing
    set gg_trg_Storage_Pit = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Storage_Pit, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Storage_Pit, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Storage_Pit, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Storage_Pit, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Storage_Pit, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Storage_Pit, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Storage_Pit, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Storage_Pit, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Storage_Pit, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Storage_Pit, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Storage_Pit, Condition( function Trig_Storage_Pit_Conditions ) )
    call TriggerAddAction( gg_trg_Storage_Pit, function Trig_Storage_Pit_Actions )
endfunction

//===========================================================================
// Trigger: Land Mine
//===========================================================================
function Trig_Land_Mine_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A012' then
return true
endif
return false
endfunction

function Trig_Land_Mine_Actions takes nothing returns nothing
local unit u = GetSpellAbilityUnit()
local player p = GetOwningPlayer(u)
local integer Firestone = 0
local integer Gem = 0
local integer Herb = 0
local integer Iron = 0
local integer Rock = 0
local integer Wood = 0
local integer i = 1

loop
exitwhen i > 6
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I007' then
set Firestone = Firestone + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I000' then
set Gem = Gem + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I006' then
set Herb = Herb + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I004' then
set Iron = Iron + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I005' then
set Rock = Rock + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I002' then
set Wood = Wood + 1
endif 
set i = i + 1
endloop

if Iron >= 2 then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call UnitAddItemByIdSwapped( 'I00D', u )
else
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif

set p = null
set u = null
endfunction

//===========================================================================
function InitTrig_Land_Mine takes nothing returns nothing
    set gg_trg_Land_Mine = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Land_Mine, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Land_Mine, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Land_Mine, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Land_Mine, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Land_Mine, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Land_Mine, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Land_Mine, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Land_Mine, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Land_Mine, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Land_Mine, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Land_Mine, Condition( function Trig_Land_Mine_Conditions ) )
    call TriggerAddAction( gg_trg_Land_Mine, function Trig_Land_Mine_Actions )
endfunction

//===========================================================================
// Trigger: Temple
//===========================================================================
function Trig_Temple_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A019' then
return true
endif
return false
endfunction

function Trig_Temple_Actions takes nothing returns nothing
local unit u = GetSpellAbilityUnit()
local player p = GetOwningPlayer(u)
local integer Firestone = 0
local integer Gem = 0
local integer Herb = 0
local integer Iron = 0
local integer Rock = 0
local integer Wood = 0
local integer i = 1

loop
exitwhen i > 6
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I007' then
set Firestone = Firestone + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I000' then
set Gem = Gem + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I006' then
set Herb = Herb + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I004' then
set Iron = Iron + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I005' then
set Rock = Rock + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I002' then
set Wood = Wood + 1
endif 
set i = i + 1
endloop

if Rock >= 2 and Iron >= 2 then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call UnitAddItemByIdSwapped( 'I00E', u )
else
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif

set p = null
set u = null
endfunction

//===========================================================================
function InitTrig_Temple takes nothing returns nothing
    set gg_trg_Temple = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Temple, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Temple, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Temple, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Temple, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Temple, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Temple, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Temple, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Temple, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Temple, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Temple, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Temple, Condition( function Trig_Temple_Conditions ) )
    call TriggerAddAction( gg_trg_Temple, function Trig_Temple_Actions )
endfunction

//===========================================================================
// Trigger: Tower
//===========================================================================
function Trig_Tower_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A07R' then
return true
endif
return false
endfunction

function Trig_Tower_Actions takes nothing returns nothing
local unit u = GetSpellAbilityUnit()
local player p = GetOwningPlayer(u)
local integer Firestone = 0
local integer Gem = 0
local integer Herb = 0
local integer Iron = 0
local integer Rock = 0
local integer Wood = 0
local integer i = 1

loop
exitwhen i > 6
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I007' then
set Firestone = Firestone + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I000' then
set Gem = Gem + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I006' then
set Herb = Herb + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I004' then
set Iron = Iron + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I005' then
set Rock = Rock + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I002' then
set Wood = Wood + 1
endif 
set i = i + 1
endloop

if Rock >= 4 and Wood >= 1 then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call UnitAddItemByIdSwapped( 'I02I', u )
else
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif

set p = null
set u = null
endfunction

//===========================================================================
function InitTrig_Tower takes nothing returns nothing
    set gg_trg_Tower = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Tower, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Tower, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Tower, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Tower, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Tower, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Tower, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Tower, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Tower, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Tower, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Tower, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Tower, Condition( function Trig_Tower_Conditions ) )
    call TriggerAddAction( gg_trg_Tower, function Trig_Tower_Actions )
endfunction

//===========================================================================
// Trigger: Forge Armor
//===========================================================================
function Trig_Forge_Armor_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A01P' then
return true
endif
return false
endfunction

function Trig_Forge_Armor_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
local integer Firestone = 0
local integer Gem = 0
local integer Herb = 0
local integer Iron = 0
local integer Rock = 0
local integer Wood = 0
local integer i = 1

loop
exitwhen i > 6
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I007' then
set Firestone = Firestone + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I000' then
set Gem = Gem + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I006' then
set Herb = Herb + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I004' then
set Iron = Iron + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I005' then
set Rock = Rock + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I002' then
set Wood = Wood + 1
endif 
set i = i + 1
endloop

if Iron >= 2 and Firestone >= 1 and Gem >= 1 then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call UnitAddItemByIdSwapped( 'I00G', u )
set u = null
set p = null
return
endif

call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
set p = null
set u = null
endfunction

//===========================================================================
function InitTrig_Forge_Armor takes nothing returns nothing
    set gg_trg_Forge_Armor = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Armor, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Armor, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Armor, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Armor, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Armor, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Armor, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Armor, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Armor, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Armor, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Armor, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Forge_Armor, Condition( function Trig_Forge_Armor_Conditions ) )
    call TriggerAddAction( gg_trg_Forge_Armor, function Trig_Forge_Armor_Actions )
endfunction

//===========================================================================
// Trigger: Upgrade Armor
//===========================================================================
function Trig_Forge_Armor_Upgrade_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A01Q' then
return true
endif
return false
endfunction

function Trig_Forge_Armor_Upgrade_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
local integer Firestone = 0
local integer Gem = 0
local integer Herb = 0
local integer Iron = 0
local integer Rock = 0
local integer Wood = 0
local integer i = 1

loop
exitwhen i > 6
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I007' then
set Firestone = Firestone + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I000' then
set Gem = Gem + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I006' then
set Herb = Herb + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I004' then
set Iron = Iron + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I005' then
set Rock = Rock + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I002' then
set Wood = Wood + 1
endif 
set i = i + 1
endloop

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I00G') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I00G') )
call UnitAddItemByIdSwapped( 'I00H', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I00H') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I00H') )
call UnitAddItemByIdSwapped( 'I00I', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I00I') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I00I') )
call UnitAddItemByIdSwapped( 'I00K', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I00K') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I00K') )
call UnitAddItemByIdSwapped( 'I00L', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I00L') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I00L') )
call UnitAddItemByIdSwapped( 'I00M', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I00M') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I00M') )
call UnitAddItemByIdSwapped( 'I00N', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I00N') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I00N') )
call UnitAddItemByIdSwapped( 'I00Q', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I00Q') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I00Q') )
call UnitAddItemByIdSwapped( 'I00O', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I00O') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I00O') )
call UnitAddItemByIdSwapped( 'I00R', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I00R') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I00R') )
call UnitAddItemByIdSwapped( 'I02O', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I02O') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I02O') )
call UnitAddItemByIdSwapped( 'I00S', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I00S') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I00S') )
call UnitAddItemByIdSwapped( 'I00U', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I00U') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I00U') )
call UnitAddItemByIdSwapped( 'I00V', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I00V') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I00V') )
call UnitAddItemByIdSwapped( 'I00W', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I00W') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I00W') )
call UnitAddItemByIdSwapped( 'I00X', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
set p = null
set u = null
endfunction

//===========================================================================
function InitTrig_Upgrade_Armor takes nothing returns nothing
    set gg_trg_Upgrade_Armor = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Armor, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Armor, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Armor, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Armor, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Armor, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Armor, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Armor, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Armor, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Armor, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Armor, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Upgrade_Armor, Condition( function Trig_Forge_Armor_Upgrade_Conditions ) )
    call TriggerAddAction( gg_trg_Upgrade_Armor, function Trig_Forge_Armor_Upgrade_Actions )
endfunction

//===========================================================================
// Trigger: Forge Weapon
//===========================================================================
function Trig_Forge_Weapon_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A023' then
return true
endif
return false
endfunction

function Trig_Forge_Weapon_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
local integer Firestone = 0
local integer Gem = 0
local integer Herb = 0
local integer Iron = 0
local integer Rock = 0
local integer Wood = 0
local integer i = 1

loop
exitwhen i > 6
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I007' then
set Firestone = Firestone + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I000' then
set Gem = Gem + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I006' then
set Herb = Herb + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I004' then
set Iron = Iron + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I005' then
set Rock = Rock + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I002' then
set Wood = Wood + 1
endif 
set i = i + 1
endloop

if Iron >= 2 and Firestone >= 1 and Gem >= 1 then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call UnitAddItemByIdSwapped( 'I001', u )
set u = null
set p = null
return
endif

call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
set p = null
set u = null
endfunction

//===========================================================================
function InitTrig_Forge_Weapon takes nothing returns nothing
    set gg_trg_Forge_Weapon = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Weapon, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Weapon, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Weapon, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Weapon, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Weapon, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Weapon, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Weapon, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Weapon, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Weapon, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Weapon, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Forge_Weapon, Condition( function Trig_Forge_Weapon_Conditions ) )
    call TriggerAddAction( gg_trg_Forge_Weapon, function Trig_Forge_Weapon_Actions )
endfunction

//===========================================================================
// Trigger: Upgrade Weapon
//===========================================================================
function Trig_Forge_Weapon_Upgrade_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A05P' then
return true
endif
return false
endfunction

function Trig_Forge_Weapon_Upgrade_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
local integer Firestone = 0
local integer Gem = 0
local integer Herb = 0
local integer Iron = 0
local integer Rock = 0
local integer Wood = 0
local integer i = 1

loop
exitwhen i > 6
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I007' then
set Firestone = Firestone + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I000' then
set Gem = Gem + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I006' then
set Herb = Herb + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I004' then
set Iron = Iron + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I005' then
set Rock = Rock + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I002' then
set Wood = Wood + 1
endif 
set i = i + 1
endloop

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I001') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I001') )
call UnitAddItemByIdSwapped( 'I00Z', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I00Z') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I00Z') )
call UnitAddItemByIdSwapped( 'I010', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I010') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I010') )
call UnitAddItemByIdSwapped( 'I011', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I011') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I011') )
call UnitAddItemByIdSwapped( 'I013', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I013') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I013') )
call UnitAddItemByIdSwapped( 'I014', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I014') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I014') )
call UnitAddItemByIdSwapped( 'I015', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I015') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I015') )
call UnitAddItemByIdSwapped( 'I016', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I016') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I016') )
call UnitAddItemByIdSwapped( 'I017', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I017') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I017') )
call UnitAddItemByIdSwapped( 'I018', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I018') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I018') )
call UnitAddItemByIdSwapped( 'I019', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I019') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I019') )
call UnitAddItemByIdSwapped( 'I01A', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I01A') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01A') )
call UnitAddItemByIdSwapped( 'I01B', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I01B') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01B') )
call UnitAddItemByIdSwapped( 'I01C', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I01C') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01C') )
call UnitAddItemByIdSwapped( 'I01D', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I01D') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01D') )
call UnitAddItemByIdSwapped( 'I01E', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
set p = null
set u = null
endfunction

//===========================================================================
function InitTrig_Upgrade_Weapon takes nothing returns nothing
    set gg_trg_Upgrade_Weapon = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Weapon, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Weapon, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Weapon, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Weapon, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Weapon, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Weapon, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Weapon, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Weapon, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Weapon, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Weapon, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Upgrade_Weapon, Condition( function Trig_Forge_Weapon_Upgrade_Conditions ) )
    call TriggerAddAction( gg_trg_Upgrade_Weapon, function Trig_Forge_Weapon_Upgrade_Actions )
endfunction

//===========================================================================
// Trigger: Forge Helm
//===========================================================================
function Trig_Forge_Helm_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A05R' then
return true
endif
return false
endfunction

function Trig_Forge_Helm_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
local integer Firestone = 0
local integer Gem = 0
local integer Herb = 0
local integer Iron = 0
local integer Rock = 0
local integer Wood = 0
local integer i = 1

loop
exitwhen i > 6
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I007' then
set Firestone = Firestone + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I000' then
set Gem = Gem + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I006' then
set Herb = Herb + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I004' then
set Iron = Iron + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I005' then
set Rock = Rock + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I002' then
set Wood = Wood + 1
endif 
set i = i + 1
endloop

if Iron >= 1 and Firestone >= 1 and Gem >= 2 then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call UnitAddItemByIdSwapped( 'I00T', u )
set u = null
set p = null
return
endif

call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
set p = null
set u = null
endfunction

//===========================================================================
function InitTrig_Forge_Helm takes nothing returns nothing
    set gg_trg_Forge_Helm = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Helm, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Helm, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Helm, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Helm, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Helm, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Helm, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Helm, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Helm, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Helm, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Helm, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Forge_Helm, Condition( function Trig_Forge_Helm_Conditions ) )
    call TriggerAddAction( gg_trg_Forge_Helm, function Trig_Forge_Helm_Actions )
endfunction

//===========================================================================
// Trigger: Upgrade Helm
//===========================================================================
function Trig_Forge_Helm_Upgrade_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A05S' then
return true
endif
return false
endfunction

function Trig_Forge_Helm_Upgrade_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
local integer Firestone = 0
local integer Gem = 0
local integer Herb = 0
local integer Iron = 0
local integer Rock = 0
local integer Wood = 0
local integer i = 1

loop
exitwhen i > 6
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I007' then
set Firestone = Firestone + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I000' then
set Gem = Gem + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I006' then
set Herb = Herb + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I004' then
set Iron = Iron + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I005' then
set Rock = Rock + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I002' then
set Wood = Wood + 1
endif 
set i = i + 1
endloop

if Iron >= 2 and Firestone >= 1 and UnitHasItemOfTypeBJ(u, 'I00T') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I00T') )
call UnitAddItemByIdSwapped( 'I00J', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and UnitHasItemOfTypeBJ(u, 'I00J') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I00J') )
call UnitAddItemByIdSwapped( 'I00Y', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and UnitHasItemOfTypeBJ(u, 'I00Y') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I00Y') )
call UnitAddItemByIdSwapped( 'I012', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and UnitHasItemOfTypeBJ(u, 'I012') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I012') )
call UnitAddItemByIdSwapped( 'I01F', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and UnitHasItemOfTypeBJ(u, 'I01F') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01F') )
call UnitAddItemByIdSwapped( 'I01G', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and UnitHasItemOfTypeBJ(u, 'I01G') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01G') )
call UnitAddItemByIdSwapped( 'I01H', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and UnitHasItemOfTypeBJ(u, 'I01H') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01H') )
call UnitAddItemByIdSwapped( 'I01I', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and UnitHasItemOfTypeBJ(u, 'I01I') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01I') )
call UnitAddItemByIdSwapped( 'I01J', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and UnitHasItemOfTypeBJ(u, 'I01J') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01J') )
call UnitAddItemByIdSwapped( 'I01K', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and UnitHasItemOfTypeBJ(u, 'I01K') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01K') )
call UnitAddItemByIdSwapped( 'I01L', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif


if Iron >= 2 and Firestone >= 1 and UnitHasItemOfTypeBJ(u, 'I01L') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01L') )
call UnitAddItemByIdSwapped( 'I01M', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif


if Iron >= 2 and Firestone >= 1 and UnitHasItemOfTypeBJ(u, 'I01M') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01M') )
call UnitAddItemByIdSwapped( 'I01N', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and UnitHasItemOfTypeBJ(u, 'I01N') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01N') )
call UnitAddItemByIdSwapped( 'I01O', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and UnitHasItemOfTypeBJ(u, 'I01O') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01O') )
call UnitAddItemByIdSwapped( 'I01P', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

if Iron >= 2 and Firestone >= 1 and UnitHasItemOfTypeBJ(u, 'I01P') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01P') )
call UnitAddItemByIdSwapped( 'I02N', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
set u = null
set p = null
return
endif

call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
set p = null
set u = null
endfunction

//===========================================================================
function InitTrig_Upgrade_Helm takes nothing returns nothing
    set gg_trg_Upgrade_Helm = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Helm, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Helm, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Helm, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Helm, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Helm, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Helm, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Helm, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Helm, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Helm, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Helm, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Upgrade_Helm, Condition( function Trig_Forge_Helm_Upgrade_Conditions ) )
    call TriggerAddAction( gg_trg_Upgrade_Helm, function Trig_Forge_Helm_Upgrade_Actions )
endfunction

//===========================================================================
// Trigger: Forge Staff
//===========================================================================
function Trig_Forge_Staff_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A06S' then
return true
endif
return false
endfunction

function Trig_Forge_Staff_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
local integer Firestone = 0
local integer Gem = 0
local integer Herb = 0
local integer Iron = 0
local integer Rock = 0
local integer Wood = 0
local integer i = 1

loop
exitwhen i > 6
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I007' then
set Firestone = Firestone + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I000' then
set Gem = Gem + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I006' then
set Herb = Herb + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I004' then
set Iron = Iron + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I005' then
set Rock = Rock + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I002' then
set Wood = Wood + 1
endif 
set i = i + 1
endloop

if Wood >= 1 and Herb >= 1 and Gem >= 2 then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call UnitAddItemByIdSwapped( 'I01R', u )
set u = null
set p = null
return
endif

call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
set p = null
set u = null
endfunction

//===========================================================================
function InitTrig_Forge_Staff takes nothing returns nothing
    set gg_trg_Forge_Staff = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Staff, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Staff, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Staff, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Staff, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Staff, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Staff, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Staff, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Staff, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Staff, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Staff, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Forge_Staff, Condition( function Trig_Forge_Staff_Conditions ) )
    call TriggerAddAction( gg_trg_Forge_Staff, function Trig_Forge_Staff_Actions )
endfunction

//===========================================================================
// Trigger: Upgrade Staff
//===========================================================================
function Trig_Forge_Staff_Upgrade_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A06T' then
return true
endif
return false
endfunction

function Trig_Forge_Staff_Upgrade_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
local integer Firestone = 0
local integer Gem = 0
local integer Herb = 0
local integer Iron = 0
local integer Rock = 0
local integer Wood = 0
local integer i = 1

loop
exitwhen i > 6
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I007' then
set Firestone = Firestone + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I000' then
set Gem = Gem + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I006' then
set Herb = Herb + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I004' then
set Iron = Iron + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I005' then
set Rock = Rock + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I002' then
set Wood = Wood + 1
endif 
set i = i + 1
endloop

if Herb >= 1 and Wood >= 2 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I01R') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01R') )
call UnitAddItemByIdSwapped( 'I01S', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Herb >= 1 and Wood >= 2 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I01S') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01S') )
call UnitAddItemByIdSwapped( 'I01T', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Herb >= 1 and Wood >= 2 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I01T') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01T') )
call UnitAddItemByIdSwapped( 'I01U', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Herb >= 1 and Wood >= 2 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I01U') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01U') )
call UnitAddItemByIdSwapped( 'I01V', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Herb >= 1 and Wood >= 2 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I01V') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01V') )
call UnitAddItemByIdSwapped( 'I01W', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Herb >= 1 and Wood >= 2 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I01W') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01W') )
call UnitAddItemByIdSwapped( 'I01X', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Herb >= 1 and Wood >= 2 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I01X') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01X') )
call UnitAddItemByIdSwapped( 'I01Y', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Herb >= 1 and Wood >= 2 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I01Y') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01Y') )
call UnitAddItemByIdSwapped( 'I01Z', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Herb >= 1 and Wood >= 2 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I01Z') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01Z') )
call UnitAddItemByIdSwapped( 'I020', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Herb >= 1 and Wood >= 2 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I020') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I020') )
call UnitAddItemByIdSwapped( 'I021', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Herb >= 1 and Wood >= 2 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I021') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I021') )
call UnitAddItemByIdSwapped( 'I022', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Herb >= 1 and Wood >= 2 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I022') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I022') )
call UnitAddItemByIdSwapped( 'I023', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Herb >= 1 and Wood >= 2 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I023') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I023') )
call UnitAddItemByIdSwapped( 'I024', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Herb >= 1 and Wood >= 2 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I024') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I024') )
call UnitAddItemByIdSwapped( 'I025', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Herb >= 1 and Wood >= 2 and Gem >= 1 and UnitHasItemOfTypeBJ(u, 'I025') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I025') )
call UnitAddItemByIdSwapped( 'I026', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
set p = null
set u = null
endfunction

//===========================================================================
function InitTrig_Upgrade_Staff takes nothing returns nothing
    set gg_trg_Upgrade_Staff = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Staff, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Staff, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Staff, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Staff, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Staff, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Staff, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Staff, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Staff, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Staff, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Staff, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Upgrade_Staff, Condition( function Trig_Forge_Staff_Upgrade_Conditions ) )
    call TriggerAddAction( gg_trg_Upgrade_Staff, function Trig_Forge_Staff_Upgrade_Actions )
endfunction

//===========================================================================
// Trigger: Forge Claymore
//===========================================================================
function Trig_Forge_Claymore_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A0BU' then
return true
endif
return false
endfunction

function Trig_Forge_Claymore_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
local integer Firestone = 0
local integer Gem = 0
local integer i = 1

loop
exitwhen i > 6
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I007' then
set Firestone = Firestone + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I000' then
set Gem = Gem + 1
endif
set i = i + 1
endloop

if Gem >= 3 and Firestone >= 2 and UnitHasItemOfTypeBJ(u, 'I01E') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01E') )
call UnitAddItemByIdSwapped( 'I00P', u )
set u = null
set p = null
return
endif

call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
set p = null
set u = null
endfunction

//===========================================================================
function InitTrig_Forge_Claymore takes nothing returns nothing
    set gg_trg_Forge_Claymore = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Claymore, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Claymore, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Claymore, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Claymore, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Claymore, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Claymore, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Claymore, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Claymore, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Claymore, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Forge_Claymore, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Forge_Claymore, Condition( function Trig_Forge_Claymore_Conditions ) )
    call TriggerAddAction( gg_trg_Forge_Claymore, function Trig_Forge_Claymore_Actions )
endfunction

//===========================================================================
// Trigger: Improve Claymore
//===========================================================================
function Trig_Forge_Claymore_Upgrade_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A0BT' then
return true
endif
return false
endfunction

function Trig_Forge_Claymore_Upgrade_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
local integer Gem = 0
local integer i = 1

loop
exitwhen i > 6
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I000' then
set Gem = Gem + 1
endif
set i = i + 1
endloop

if Gem >= 5 and UnitHasItemOfTypeBJ(u, 'I00P') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I00P') )
call UnitAddItemByIdSwapped( 'I01Q', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Gem >= 5 and UnitHasItemOfTypeBJ(u, 'I01Q') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I01Q') )
call UnitAddItemByIdSwapped( 'I02Q', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Gem >= 5 and UnitHasItemOfTypeBJ(u, 'I02Q') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I02Q') )
call UnitAddItemByIdSwapped( 'I02R', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Gem >= 5 and UnitHasItemOfTypeBJ(u, 'I02R') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I02R') )
call UnitAddItemByIdSwapped( 'I02S', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

if Gem >= 5 and UnitHasItemOfTypeBJ(u, 'I02S') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I02S') )
call UnitAddItemByIdSwapped( 'I02T', u )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
set u = null
set p = null
return
endif

call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
set p = null
set u = null
endfunction

//===========================================================================
function InitTrig_Improve_Claymore takes nothing returns nothing
    set gg_trg_Improve_Claymore = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Improve_Claymore, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Improve_Claymore, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Improve_Claymore, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Improve_Claymore, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Improve_Claymore, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Improve_Claymore, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Improve_Claymore, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Improve_Claymore, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Improve_Claymore, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Improve_Claymore, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Improve_Claymore, Condition( function Trig_Forge_Claymore_Upgrade_Conditions ) )
    call TriggerAddAction( gg_trg_Improve_Claymore, function Trig_Forge_Claymore_Upgrade_Actions )
endfunction

//===========================================================================
// Trigger: Brew Potions
//===========================================================================
function Trig_Brew_Potions_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A07S' or GetSpellAbilityId() == 'A07T' or GetSpellAbilityId() == 'A07U' or GetSpellAbilityId() == 'A07V' or GetSpellAbilityId() == 'A07W' or GetSpellAbilityId() == 'A07X' or GetSpellAbilityId() == 'A07Y' or GetSpellAbilityId() == 'A07Z' or GetSpellAbilityId() == 'A080' or GetSpellAbilityId() == 'A081' or GetSpellAbilityId() == 'A082' then
return true
endif
return false
endfunction

function Trig_Brew_Potions_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
local integer Herb = 0
local integer i = 1

loop
exitwhen i > 5
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I006' then
set Herb = Herb + 1
endif
set i = i + 1
endloop

if GetSpellAbilityId() == 'A07S' then
if Herb >= 1 then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call UnitAddItemByIdSwapped( 'I027', u )
else
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif
endif

if GetSpellAbilityId() == 'A07T' then
if Herb >= 3 then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call UnitAddItemByIdSwapped( 'I02A', u )
else
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif
endif

if GetSpellAbilityId() == 'A07U' then
if Herb >= 5 then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call UnitAddItemByIdSwapped( 'I02D', u )
else
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif
endif

if GetSpellAbilityId() == 'A07V' then
if Herb >= 1 then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call UnitAddItemByIdSwapped( 'I028', u )
else
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif
endif

if GetSpellAbilityId() == 'A07W' then
if Herb >= 3 then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call UnitAddItemByIdSwapped( 'I02B', u )
else
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif
endif

if GetSpellAbilityId() == 'A07X' then
if Herb >= 5 then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call UnitAddItemByIdSwapped( 'I02E', u )
else
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif
endif

if GetSpellAbilityId() == 'A07Y' then
if Herb >= 1 then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call UnitAddItemByIdSwapped( 'I029', u )
else
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif
endif

if GetSpellAbilityId() == 'A07Z' then
if Herb >= 3 then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call UnitAddItemByIdSwapped( 'I02C', u )
else
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif
endif

if GetSpellAbilityId() == 'A080' then
if Herb >= 5 then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call UnitAddItemByIdSwapped( 'I02F', u )
else
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif
endif

if GetSpellAbilityId() == 'A081' then
if Herb >= 2 then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call UnitAddItemByIdSwapped( 'I02G', u )
else
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif
endif

if GetSpellAbilityId() == 'A082' then
if Herb >= 3 then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
call UnitAddItemByIdSwapped( 'I02H', u )
else
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif
endif

set p = null
set u = null
endfunction

//===========================================================================
function InitTrig_Brew_Potions takes nothing returns nothing
    set gg_trg_Brew_Potions = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Brew_Potions, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Brew_Potions, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Brew_Potions, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Brew_Potions, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Brew_Potions, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Brew_Potions, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Brew_Potions, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Brew_Potions, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Brew_Potions, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Brew_Potions, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Brew_Potions, Condition( function Trig_Brew_Potions_Conditions ) )
    call TriggerAddAction( gg_trg_Brew_Potions, function Trig_Brew_Potions_Actions )
endfunction

//===========================================================================
// Trigger: Sacrafice
//===========================================================================
function Trig_Sacrafice_Conditions takes nothing returns boolean
local unit u = GetTriggerUnit()
if GetSpellAbilityId() == 'A085' and GetItemTypeId(UnitItemInSlotBJ(u, 1)) != GetItemTypeId(null) then
set u = null
return true
endif
set u = null
return false
endfunction

function Trig_Sacrafice_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
local location l = GetUnitLoc(u)
local effect e = AddSpecialEffectLoc("Abilities\\Spells\\Orc\\WarStomp\\WarStompCaster.mdl",l)

if GetItemTypeId(UnitItemInSlotBJ(u, 1)) == 'I002' then
call SetUnitManaBJ( u, ( GetUnitStateSwap(UNIT_STATE_MANA, u) + 5 ) )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
endif

if GetItemTypeId(UnitItemInSlotBJ(u, 1)) == 'I005' then
call SetUnitManaBJ( u, ( GetUnitStateSwap(UNIT_STATE_MANA, u) + 5 ) )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
endif

if GetItemTypeId(UnitItemInSlotBJ(u, 1)) == 'I004' then
call SetUnitManaBJ( u, ( GetUnitStateSwap(UNIT_STATE_MANA, u) + 7 ) )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I004') )
endif

if GetItemTypeId(UnitItemInSlotBJ(u, 1)) == 'I006' then
call SetUnitManaBJ( u, ( GetUnitStateSwap(UNIT_STATE_MANA, u) + 10 ) )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I006') )
endif

if GetItemTypeId(UnitItemInSlotBJ(u, 1)) == 'I007' then
call SetUnitManaBJ( u, ( GetUnitStateSwap(UNIT_STATE_MANA, u) + 10 ) )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I007') )
endif

if GetItemTypeId(UnitItemInSlotBJ(u, 1)) == 'I000' then
call SetUnitManaBJ( u, ( GetUnitStateSwap(UNIT_STATE_MANA, u) + 15 ) )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I000') )
endif

call PolledWait(0.25)
call DestroyEffect( e )
call RemoveLocation(l)
set e = null
set l = null
set u = null
set p = null
endfunction

//===========================================================================
function InitTrig_Sacrafice takes nothing returns nothing
    set gg_trg_Sacrafice = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Sacrafice, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Sacrafice, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Sacrafice, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Sacrafice, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Sacrafice, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Sacrafice, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Sacrafice, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Sacrafice, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Sacrafice, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Sacrafice, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Sacrafice, Condition( function Trig_Sacrafice_Conditions ) )
    call TriggerAddAction( gg_trg_Sacrafice, function Trig_Sacrafice_Actions )
endfunction

//===========================================================================
// Trigger: Gifts
//===========================================================================
function Trig_Gifts_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A089' or GetSpellAbilityId() == 'A08I' or GetSpellAbilityId() == 'A08H' or GetSpellAbilityId() == 'A08J' then
return true
endif
return false
endfunction

function Trig_Gifts_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)

if GetSpellAbilityId() == 'A089' or GetSpellAbilityId() == 'A08I' or GetSpellAbilityId() == 'A08H' then

if GetUnitStateSwap(UNIT_STATE_MANA, u) >= 30.00 then

if GetSpellAbilityId() == 'A089' then
call UnitAddItemByIdSwapped( 'I02K', u )
call SetUnitManaBJ( u, ( GetUnitStateSwap(UNIT_STATE_MANA, u) - 30.00 ) )
endif
if GetSpellAbilityId() == 'A08I' then
call UnitAddItemByIdSwapped( 'I02J', u )
call SetUnitManaBJ( u, ( GetUnitStateSwap(UNIT_STATE_MANA, u) - 30.00 ) )
endif
if GetSpellAbilityId() == 'A08H' then
call UnitAddItemByIdSwapped( 'I02L', u )
call SetUnitManaBJ( u, ( GetUnitStateSwap(UNIT_STATE_MANA, u) - 30.00 ) )
endif
else
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000Not enough Power!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif
endif

if GetSpellAbilityId() == 'A08J' then
if GetUnitStateSwap(UNIT_STATE_MANA, u) >= 60.00 then
call UnitAddItemByIdSwapped( 'I02M', u )
call SetUnitManaBJ( u, ( GetUnitStateSwap(UNIT_STATE_MANA, u) - 60.00 ) )
else
call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000Not enough Power!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
endif
endif

set u = null
set p = null
endfunction

//===========================================================================
function InitTrig_Gifts takes nothing returns nothing
    set gg_trg_Gifts = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gifts, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gifts, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gifts, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gifts, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gifts, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gifts, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gifts, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gifts, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gifts, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gifts, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Gifts, Condition( function Trig_Gifts_Conditions ) )
    call TriggerAddAction( gg_trg_Gifts, function Trig_Gifts_Actions )
endfunction

//===========================================================================
// Trigger: Upgrade Tower
//===========================================================================
function Trig_Upgrade_Tower_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A08S'then
return true
endif
return false
endfunction

function Trig_Upgrade_Tower_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
local integer Rock = 0
local integer Wood = 0
local integer i = 1

loop
exitwhen i > 5
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I005' then
set Rock = Rock + 1
endif
if GetItemTypeId(UnitItemInSlotBJ(u, i)) == 'I002' then
set Wood = Wood + 1
endif 
set i = i + 1
endloop

if Rock >= 4 and Wood >= 1 and GetUnitTypeId(GetTriggerUnit()) == 'n005' then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call ReplaceUnitBJ( u, 'n006', bj_UNIT_STATE_METHOD_RELATIVE )
set u = null
set p = null
return
endif

if Rock >= 4 and Wood >= 1 and GetUnitTypeId(GetTriggerUnit()) == 'n006' then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call ReplaceUnitBJ( u, 'n00G', bj_UNIT_STATE_METHOD_RELATIVE )
set u = null
set p = null
return
endif

if Rock >= 4 and Wood >= 1 and GetUnitTypeId(GetTriggerUnit()) == 'n00G' then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call ReplaceUnitBJ( u, 'n00H', bj_UNIT_STATE_METHOD_RELATIVE )
set u = null
set p = null
return
endif

if Rock >= 4 and Wood >= 1 and GetUnitTypeId(GetTriggerUnit()) == 'n00H' then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call ReplaceUnitBJ( u, 'n00K', bj_UNIT_STATE_METHOD_RELATIVE )
set u = null
set p = null
return
endif

if Rock >= 4 and Wood >= 1 and GetUnitTypeId(GetTriggerUnit()) == 'n00K' then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call ReplaceUnitBJ( u, 'n011', bj_UNIT_STATE_METHOD_RELATIVE )
set u = null
set p = null
return
endif

if Rock >= 4 and Wood >= 1 and GetUnitTypeId(GetTriggerUnit()) == 'n011' then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call ReplaceUnitBJ( u, 'n014', bj_UNIT_STATE_METHOD_RELATIVE )
set u = null
set p = null
return
endif

if Rock >= 4 and Wood >= 1 and GetUnitTypeId(GetTriggerUnit()) == 'n014' then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call ReplaceUnitBJ( u, 'n015', bj_UNIT_STATE_METHOD_RELATIVE )
set u = null
set p = null
return
endif

if Rock >= 4 and Wood >= 1 and GetUnitTypeId(GetTriggerUnit()) == 'n015' then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call ReplaceUnitBJ( u, 'n016', bj_UNIT_STATE_METHOD_RELATIVE )
set u = null
set p = null
return
endif

if Rock >= 4 and Wood >= 1 and GetUnitTypeId(GetTriggerUnit()) == 'n016' then
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I002') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call RemoveItem( GetItemOfTypeFromUnitBJ(u, 'I005') )
call ReplaceUnitBJ( u, 'n00Q', bj_UNIT_STATE_METHOD_RELATIVE )
set u = null
set p = null
return
endif

call DisplayTimedTextToForce( GetForceOfPlayer(p), 3.00, "|cffFF0000One of the items is missing to do this combine!" )
call PlaySoundForPlayer( p, gg_snd_Warning )
set u = null
set p = null
endfunction

//===========================================================================
function InitTrig_Upgrade_Tower takes nothing returns nothing
    set gg_trg_Upgrade_Tower = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Tower, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Tower, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Tower, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Tower, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Tower, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Tower, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Tower, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Tower, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Tower, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Upgrade_Tower, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Upgrade_Tower, Condition( function Trig_Upgrade_Tower_Conditions ) )
    call TriggerAddAction( gg_trg_Upgrade_Tower, function Trig_Upgrade_Tower_Actions )
endfunction

//===========================================================================
// Trigger: Trigger Random Events
//===========================================================================
function Trig_Trigger_Random_Events_Func003C takes nothing returns boolean
    if ( not ( udg_Random <= 5 ) ) then
        return false
    endif
    if ( not ( udg_ObeliskSpawn == 0 ) ) then
        return false
    endif
    if ( not ( udg_KalendenDiff > 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Trigger_Random_Events_Func005Func001Func001C takes nothing returns boolean
    if ( not ( udg_Empire[udg_Starting] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Trigger_Random_Events_Func005C takes nothing returns boolean
    if ( not ( udg_Random > 5 ) ) then
        return false
    endif
    if ( not ( udg_Random <= 10 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Trigger_Random_Events_Func007Func006Func001C takes nothing returns boolean
    if ( not ( udg_Empire[udg_Starting] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Trigger_Random_Events_Func007C takes nothing returns boolean
    if ( not ( udg_Random > 10 ) ) then
        return false
    endif
    if ( not ( udg_Random <= 15 ) ) then
        return false
    endif
    if ( not ( udg_Plague == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Trigger_Random_Events_Func009C takes nothing returns boolean
    if ( not ( udg_Random > 15 ) ) then
        return false
    endif
    if ( not ( udg_Random <= 30 ) ) then
        return false
    endif
    if ( not ( udg_KalendenDiff > 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Trigger_Random_Events_Func011Func006Func001C takes nothing returns boolean
    if ( not ( udg_Empire[udg_Starting] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Trigger_Random_Events_Func011C takes nothing returns boolean
    if ( not ( udg_Random > 30 ) ) then
        return false
    endif
    if ( not ( udg_Random <= 35 ) ) then
        return false
    endif
    if ( not ( udg_Plague == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Trigger_Random_Events_Actions takes nothing returns nothing
    set udg_Random = GetRandomInt(1, 100)
    // Obelisk
    if ( Trig_Trigger_Random_Events_Func003C() ) then
        set udg_ObeliskSpawn = 2
    else
        call DoNothing(  )
    endif
    // Rats eat food
    if ( Trig_Trigger_Random_Events_Func005C() ) then
        set udg_Starting = 1
        loop
            exitwhen udg_Starting > 10
            if ( Trig_Trigger_Random_Events_Func005Func001Func001C() ) then
                    call PlaySoundForPlayer( ConvertedPlayer(udg_Starting), gg_snd_Warning )
                call DisplayTimedTextToForce( GetForceOfPlayer(ConvertedPlayer(udg_Starting)), 5.00, "TRIGSTR_4526" )
                set udg_food[udg_Starting] = ( udg_food[udg_Starting] - ( ( udg_food[udg_Starting] * udg_Random ) / 14 ) )
                call MultiboardSetItemValueBJ( udg_PlayerMultiboard[udg_Starting], 2, 3, I2S(udg_food[udg_Starting]) )
            else
                call DoNothing(  )
            endif
            set udg_Starting = udg_Starting + 1
        endloop
    else
        call DoNothing(  )
    endif
    // Plague
    if ( Trig_Trigger_Random_Events_Func007C() ) then
        call StartTimerBJ( udg_PlagueTimer, false, ( I2R(udg_Random) * 5.00 ) )
        call CreateTimerDialogBJ( GetLastCreatedTimerBJ(), "TRIGSTR_4572" )
        set udg_PlagueTimerWindow = GetLastCreatedTimerDialogBJ()
        call TimerDialogDisplayBJ( false, GetLastCreatedTimerDialogBJ() )
        set udg_Plague = 1
        set udg_Starting = 1
        loop
            exitwhen udg_Starting > 10
            if ( Trig_Trigger_Random_Events_Func007Func006Func001C() ) then
                    call PlaySoundForPlayer( ConvertedPlayer(udg_Starting), gg_snd_Warning )
                call DisplayTimedTextToForce( GetForceOfPlayer(ConvertedPlayer(udg_Starting)), 5.00, "TRIGSTR_4630" )
                call TimerDialogDisplayForPlayerBJ( true, GetLastCreatedTimerDialogBJ(), ConvertedPlayer(udg_Starting) )
            else
                call DoNothing(  )
            endif
            set udg_Starting = udg_Starting + 1
        endloop
    else
        call DoNothing(  )
    endif
    // Equipment
    if ( Trig_Trigger_Random_Events_Func009C() ) then
        set udg_EquipmentCamp = 1
    else
        call DoNothing(  )
    endif
    // Baby Boom
    if ( Trig_Trigger_Random_Events_Func011C() ) then
        call StartTimerBJ( udg_PlagueTimer, false, ( I2R(udg_Random) * 3.00 ) )
        call CreateTimerDialogBJ( GetLastCreatedTimerBJ(), "TRIGSTR_4631" )
        set udg_PlagueTimerWindow = GetLastCreatedTimerDialogBJ()
        call TimerDialogDisplayBJ( false, GetLastCreatedTimerDialogBJ() )
        set udg_Plague = 2
        set udg_Starting = 1
        loop
            exitwhen udg_Starting > 10
            if ( Trig_Trigger_Random_Events_Func011Func006Func001C() ) then
                    call PlaySoundForPlayer( ConvertedPlayer(udg_Starting), gg_snd_Warning )
                call DisplayTimedTextToForce( GetForceOfPlayer(ConvertedPlayer(udg_Starting)), 5.00, "TRIGSTR_4632" )
                call TimerDialogDisplayForPlayerBJ( true, GetLastCreatedTimerDialogBJ(), ConvertedPlayer(udg_Starting) )
            else
                call DoNothing(  )
            endif
            set udg_Starting = udg_Starting + 1
        endloop
    else
        call DoNothing(  )
    endif
endfunction

//===========================================================================
function InitTrig_Trigger_Random_Events takes nothing returns nothing
    set gg_trg_Trigger_Random_Events = CreateTrigger(  )
    call TriggerRegisterTimerEventPeriodic( gg_trg_Trigger_Random_Events, 56.00 )
    call TriggerAddAction( gg_trg_Trigger_Random_Events, function Trig_Trigger_Random_Events_Actions )
endfunction

//===========================================================================
// Trigger: Obilisk Timer Up
//===========================================================================
function Trig_Obilisk_Timer_Up_Func002002003 takes nothing returns boolean
    return ( GetOwningPlayer(GetFilterUnit()) == Player(PLAYER_NEUTRAL_AGGRESSIVE) )
endfunction

function Trig_Obilisk_Timer_Up_Func003002 takes nothing returns nothing
    call RemoveUnit( GetEnumUnit() )
endfunction

function Trig_Obilisk_Timer_Up_Actions takes nothing returns nothing
local location l = GetUnitLoc(udg_Obelisk)
local group g = GetUnitsInRangeOfLocMatching(750.00, l, Condition(function Trig_Obilisk_Timer_Up_Func002002003))
call ForGroupBJ( g, function Trig_Obilisk_Timer_Up_Func003002 )
call DestroyGroup( g )
set g = null
call RemoveLocation( l )
set l = null
call RemoveUnit( udg_Obelisk )
set udg_Obelisk = null
call DestroyTimerDialogBJ( udg_obilisktimerwindow )
call PauseTimerBJ( true, udg_Obilisk )
call PlaySoundBJ( gg_snd_Warning )
call DisplayTimedTextToForce( GetPlayersAll(), 5.00, "|c00ff0000Obelisk of Power complete! The Forces of Kalenden grow stronger!" )
set udg_CreepCounter = ( udg_CreepCounter + 2 )
call PolledWait(10.0)
set udg_ObeliskSpawn = 0
endfunction

//===========================================================================
function InitTrig_Obilisk_Timer_Up takes nothing returns nothing
    set gg_trg_Obilisk_Timer_Up = CreateTrigger(  )
    call TriggerRegisterTimerExpireEventBJ( gg_trg_Obilisk_Timer_Up, udg_Obilisk )
    call TriggerAddAction( gg_trg_Obilisk_Timer_Up, function Trig_Obilisk_Timer_Up_Actions )
endfunction

//===========================================================================
// Trigger: Obilisk Destroyed
//===========================================================================
function Trig_Obilisk_Destroyed_Conditions takes nothing returns boolean
local unit u = GetDyingUnit() 
if u == udg_Obelisk then
set u = null
return true
endif
set u = null
return false
endfunction

function Trig_Obilisk_Destroyed_Actions takes nothing returns nothing
local unit u = GetDyingUnit()
    call PauseTimerBJ( true, udg_Obilisk )
    call DestroyTimerDialogBJ( udg_obilisktimerwindow )
    call PlaySoundBJ( gg_snd_Warning )
    call DisplayTimedTextToForce( GetPlayersAll(), 5.00, "|c00ff0000Obilisk destroyed!" )
    call RemoveUnit( u )
    set udg_Obelisk = null
    call PolledWait(10.0)
    set udg_ObeliskSpawn = 0
set u = null
endfunction

//===========================================================================
function InitTrig_Obilisk_Destroyed takes nothing returns nothing
    set gg_trg_Obilisk_Destroyed = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Obilisk_Destroyed, Player(11), EVENT_PLAYER_UNIT_DEATH )
    call TriggerAddCondition( gg_trg_Obilisk_Destroyed, Condition( function Trig_Obilisk_Destroyed_Conditions ) )
    call TriggerAddAction( gg_trg_Obilisk_Destroyed, function Trig_Obilisk_Destroyed_Actions )
endfunction

//===========================================================================
// Trigger: Plague or Baby Boom Over
//===========================================================================
function Trig_Plague_Over_Actions takes nothing returns nothing
local integer i = 0
    call DestroyTimerDialogBJ( udg_PlagueTimerWindow )
 
   if udg_Plague == 1 then
    set i = 1
    loop
        exitwhen i > 10
        if udg_Empire[udg_Starting] == 1 then
        call PlaySoundForPlayer( ConvertedPlayer(udg_Starting), gg_snd_Warning )
        call DisplayTimedTextToForce( GetForceOfPlayer(ConvertedPlayer(udg_Starting)), 5.00, "|c00ff0000The plague has left your city." )
        endif
        set i = i + 1
    endloop
    endif

   if udg_Plague == 2 then
    set i = 1
    loop
        exitwhen i > 10
        if udg_Empire[udg_Starting] == 1 then
        call PlaySoundForPlayer( ConvertedPlayer(udg_Starting), gg_snd_Warning )
        call DisplayTimedTextToForce( GetForceOfPlayer(ConvertedPlayer(udg_Starting)), 5.00, "|c00ff0000The Baby Boom has ended." )
        endif
        set i = i + 1
    endloop
    endif

    set udg_Plague = 0
endfunction

//===========================================================================
function InitTrig_Plague_or_Baby_Boom_Over takes nothing returns nothing
    set gg_trg_Plague_or_Baby_Boom_Over = CreateTrigger(  )
    call TriggerRegisterTimerExpireEventBJ( gg_trg_Plague_or_Baby_Boom_Over, udg_PlagueTimer )
    call TriggerAddAction( gg_trg_Plague_or_Baby_Boom_Over, function Trig_Plague_Over_Actions )
endfunction
//===========================================================================
// Trigger: Initiate
//===========================================================================
function Trig_Initiate_Actions takes nothing returns nothing
    call DestroyTrigger(GetTriggeringTrigger())
    set udg_QuestNonTownTypes = 107
    set udg_QuestTownTypes = 4
endfunction

//===========================================================================
function InitTrig_Initiate takes nothing returns nothing
    set gg_trg_Initiate = CreateTrigger(  )
    call TriggerRegisterTimerEventSingle( gg_trg_Initiate, 0.02 )
    call TriggerAddAction( gg_trg_Initiate, function Trig_Initiate_Actions )
endfunction

//===========================================================================
// Trigger: Getting Quest
//===========================================================================
function Trig_Getting_Quest_Conditions takes nothing returns boolean
local unit u = GetTriggerUnit()
if GetUnitTypeId(u) == 'n00X' then
set u = null
return true
endif
set u = null
return false
endfunction

function Trig_Getting_Quest_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local location l = GetUnitLoc(u)
local player p = GetTriggerPlayer()
local location l2 = GetUnitLoc(udg_Herounit[GetConvertedPlayerId(p)])
if udg_MonsterDrop == 0 then
if GetUnitUserData(u) == 0 and DistanceBetweenPoints(l, l2) <= 250 then
   call PlaySoundForPlayer( p, gg_snd_QuestNew )
   call RemoveUnit( u )
   set udg_QuestType = GetRandomInt(101, udg_QuestNonTownTypes)
   set udg_player2 = p
   set udg_QuestGiverAmount = udg_QuestGiverAmount - 1 
   call TriggerExecute( gg_trg_Quest_Table )    
else
if GetUnitUserData(u) == 1 and DistanceBetweenPoints(l, l2) <= 250 then
   call PlaySoundForPlayer( p, gg_snd_QuestNew )
   call ReplaceUnitBJ( u, 'n00W', bj_UNIT_STATE_METHOD_RELATIVE )
   set udg_QuestType = GetRandomInt(1, udg_QuestTownTypes)
   set udg_player2 = p
   set udg_QuestGiverAmount = udg_QuestGiverAmount - 1 
   call TriggerExecute( gg_trg_Quest_Table ) 
endif
endif
endif
call RemoveLocation(l)
call RemoveLocation(l2)
set l = null
set l2 = null
set u = null
set p = null
endfunction

//===========================================================================
function InitTrig_Getting_Quest takes nothing returns nothing
    set gg_trg_Getting_Quest = CreateTrigger(  )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Getting_Quest, Player(0), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Getting_Quest, Player(1), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Getting_Quest, Player(2), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Getting_Quest, Player(3), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Getting_Quest, Player(4), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Getting_Quest, Player(5), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Getting_Quest, Player(6), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Getting_Quest, Player(7), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Getting_Quest, Player(8), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Getting_Quest, Player(9), true )
    call TriggerAddCondition( gg_trg_Getting_Quest, Condition( function Trig_Getting_Quest_Conditions ) )
    call TriggerAddAction( gg_trg_Getting_Quest, function Trig_Getting_Quest_Actions )
endfunction

//===========================================================================
// Trigger: Quest Table
//===========================================================================
function Trig_Quest_Table_Func002Func001C takes nothing returns boolean
    if ( ( udg_QuestType == 1 ) ) then
        return true
    endif
    if ( ( udg_QuestType == 101 ) ) then
        return true
    endif
    if ( ( udg_QuestType == 102 ) ) then
        return true
    endif
    if ( ( udg_QuestType == 103 ) ) then
        return true
    endif
    return false
endfunction

function Trig_Quest_Table_Func002Func006001 takes nothing returns boolean
    return ( udg_Random == 1 )
endfunction

function Trig_Quest_Table_Func002Func007001 takes nothing returns boolean
    return ( udg_Random == 2 )
endfunction

function Trig_Quest_Table_Func002Func008001 takes nothing returns boolean
    return ( udg_Random == 3 )
endfunction

function Trig_Quest_Table_Func002C takes nothing returns boolean
    if ( not Trig_Quest_Table_Func002Func001C() ) then
        return false
    endif
    return true
endfunction

function Trig_Quest_Table_Func003Func002C takes nothing returns boolean
    if ( ( udg_QuestType == 104 ) ) then
        return true
    endif
    if ( ( udg_QuestType == 2 ) ) then
        return true
    endif
    return false
endfunction

function Trig_Quest_Table_Func003Func006001 takes nothing returns boolean
    return ( udg_Random == 1 )
endfunction

function Trig_Quest_Table_Func003Func007001 takes nothing returns boolean
    return ( udg_Random == 2 )
endfunction

function Trig_Quest_Table_Func003Func008001 takes nothing returns boolean
    return ( udg_Random == 3 )
endfunction

function Trig_Quest_Table_Func003C takes nothing returns boolean
    if ( not Trig_Quest_Table_Func003Func002C() ) then
        return false
    endif
    return true
endfunction

function Trig_Quest_Table_Func006Func002C takes nothing returns boolean
    if ( not ( udg_Events[1] == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Quest_Table_Func006C takes nothing returns boolean
    if ( not ( udg_QuestType == 3 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Quest_Table_Func007Func002C takes nothing returns boolean
    if ( not ( udg_Events[2] == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Quest_Table_Func007C takes nothing returns boolean
    if ( not ( udg_QuestType == 4 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Quest_Table_Func008Func002Func006001 takes nothing returns boolean
    return ( udg_Random == 1 )
endfunction

function Trig_Quest_Table_Func008Func002Func007001 takes nothing returns boolean
    return ( udg_Random == 2 )
endfunction

function Trig_Quest_Table_Func008Func002Func008001 takes nothing returns boolean
    return ( udg_Random == 3 )
endfunction

function Trig_Quest_Table_Func008Func002C takes nothing returns boolean
    if ( not ( udg_Random == 2 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Quest_Table_Func008Func006001 takes nothing returns boolean
    return ( udg_Random == 1 )
endfunction

function Trig_Quest_Table_Func008Func007001 takes nothing returns boolean
    return ( udg_Random == 2 )
endfunction

function Trig_Quest_Table_Func008Func008001 takes nothing returns boolean
    return ( udg_Random == 3 )
endfunction

function Trig_Quest_Table_Func008C takes nothing returns boolean
    if ( not ( udg_Random == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Quest_Table_Func010Func006001 takes nothing returns boolean
    return ( udg_Random == 1 )
endfunction

function Trig_Quest_Table_Func010Func007001 takes nothing returns boolean
    return ( udg_Random == 2 )
endfunction

function Trig_Quest_Table_Func010Func008001 takes nothing returns boolean
    return ( udg_Random == 3 )
endfunction

function Trig_Quest_Table_Func010C takes nothing returns boolean
    if ( not ( udg_QuestType == 105 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Quest_Table_Func011Func006001 takes nothing returns boolean
    return ( udg_Random == 1 )
endfunction

function Trig_Quest_Table_Func011Func007001 takes nothing returns boolean
    return ( udg_Random == 2 )
endfunction

function Trig_Quest_Table_Func011Func008001 takes nothing returns boolean
    return ( udg_Random == 3 )
endfunction

function Trig_Quest_Table_Func011C takes nothing returns boolean
    if ( not ( udg_QuestType == 106 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Quest_Table_Func012Func011001 takes nothing returns boolean
    return ( udg_Random == 1 )
endfunction

function Trig_Quest_Table_Func012Func012001 takes nothing returns boolean
    return ( udg_Random == 2 )
endfunction

function Trig_Quest_Table_Func012Func013001 takes nothing returns boolean
    return ( udg_Random == 3 )
endfunction

function Trig_Quest_Table_Func012C takes nothing returns boolean
    if ( not ( udg_QuestType == 107 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Quest_Table_Actions takes nothing returns nothing
    // Both
    if ( Trig_Quest_Table_Func002C() ) then
        set udg_MonsterDifficulty = ( GetHeroLevel(udg_Herounit[GetConvertedPlayerId(udg_player2)]) - ( GetHeroLevel(udg_Herounit[GetConvertedPlayerId(udg_player2)]) / 3 ) )
        set udg_MonsterDrop = 1
        call TriggerExecute( gg_trg_Monster_Table )
        set udg_Random = GetRandomInt(1, 3)
        if ( Trig_Quest_Table_Func002Func006001() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(udg_player2), 30.00, "TRIGSTR_4633" )
        else
            call DoNothing(  )
        endif
        if ( Trig_Quest_Table_Func002Func007001() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(udg_player2), 30.00, "TRIGSTR_4634" )
        else
            call DoNothing(  )
        endif
        if ( Trig_Quest_Table_Func002Func008001() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(udg_player2), 30.00, "TRIGSTR_4635" )
        else
            call DoNothing(  )
        endif
    else
    endif
    if ( Trig_Quest_Table_Func003C() ) then
        set udg_MonsterDifficulty = ( GetHeroLevel(udg_Herounit[GetConvertedPlayerId(udg_player2)]) - ( GetHeroLevel(udg_Herounit[GetConvertedPlayerId(udg_player2)]) / 3 ) )
        set udg_MonsterDrop = 2
        call TriggerExecute( gg_trg_Monster_Table )
        set udg_Random = GetRandomInt(1, 3)
        if ( Trig_Quest_Table_Func003Func006001() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(udg_player2), 30.00, "TRIGSTR_4636" )
        else
            call DoNothing(  )
        endif
        if ( Trig_Quest_Table_Func003Func007001() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(udg_player2), 30.00, "TRIGSTR_4637" )
        else
            call DoNothing(  )
        endif
        if ( Trig_Quest_Table_Func003Func008001() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(udg_player2), 30.00, "TRIGSTR_4638" )
        else
            call DoNothing(  )
        endif
    else
    endif
    // Camp
    set udg_Random = 0
    if ( Trig_Quest_Table_Func006C() ) then
        if ( Trig_Quest_Table_Func006Func002C() ) then
            set udg_Events[1] = 1
            call TriggerExecute( gg_trg_Camp_Attack )
        else
            set udg_Random = GetRandomInt(1, 2)
        endif
    else
        call DoNothing(  )
    endif
    if ( Trig_Quest_Table_Func007C() ) then
        if ( Trig_Quest_Table_Func007Func002C() ) then
            set udg_Events[2] = 1
            call TriggerExecute( gg_trg_Supply_Wagon )
        else
            set udg_Random = GetRandomInt(1, 2)
        endif
    else
        call DoNothing(  )
    endif
    if ( Trig_Quest_Table_Func008C() ) then
        set udg_MonsterDifficulty = ( GetHeroLevel(udg_Herounit[GetConvertedPlayerId(udg_player2)]) - ( GetHeroLevel(udg_Herounit[GetConvertedPlayerId(udg_player2)]) / 3 ) )
        set udg_MonsterDrop = 1
        call TriggerExecute( gg_trg_Monster_Table )
        set udg_Random = GetRandomInt(1, 3)
        if ( Trig_Quest_Table_Func008Func006001() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(udg_player2), 30.00, "TRIGSTR_4633" )
        else
            call DoNothing(  )
        endif
        if ( Trig_Quest_Table_Func008Func007001() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(udg_player2), 30.00, "TRIGSTR_4634" )
        else
            call DoNothing(  )
        endif
        if ( Trig_Quest_Table_Func008Func008001() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(udg_player2), 30.00, "TRIGSTR_4635" )
        else
            call DoNothing(  )
        endif
    else
        if ( Trig_Quest_Table_Func008Func002C() ) then
            set udg_MonsterDifficulty = ( GetHeroLevel(udg_Herounit[GetConvertedPlayerId(udg_player2)]) - ( GetHeroLevel(udg_Herounit[GetConvertedPlayerId(udg_player2)]) / 3 ) )
            set udg_MonsterDrop = 2
            call TriggerExecute( gg_trg_Monster_Table )
            set udg_Random = GetRandomInt(1, 3)
            if ( Trig_Quest_Table_Func008Func002Func006001() ) then
                call DisplayTimedTextToForce( GetForceOfPlayer(udg_player2), 30.00, "TRIGSTR_4636" )
            else
                call DoNothing(  )
            endif
            if ( Trig_Quest_Table_Func008Func002Func007001() ) then
                call DisplayTimedTextToForce( GetForceOfPlayer(udg_player2), 30.00, "TRIGSTR_4637" )
            else
                call DoNothing(  )
            endif
            if ( Trig_Quest_Table_Func008Func002Func008001() ) then
                call DisplayTimedTextToForce( GetForceOfPlayer(udg_player2), 30.00, "TRIGSTR_4638" )
            else
                call DoNothing(  )
            endif
        else
            call DoNothing(  )
        endif
    endif
    // Non Camp
    if ( Trig_Quest_Table_Func010C() ) then
        set udg_Tempspot = GetUnitLoc(udg_Herounit[GetConvertedPlayerId(udg_player2)])
        call CreateItemLoc( 'I030', udg_Tempspot )
        call RemoveLocation(udg_Tempspot)
        set udg_Random = GetRandomInt(1, 3)
        if ( Trig_Quest_Table_Func010Func006001() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(udg_player2), 30.00, "TRIGSTR_4645" )
        else
            call DoNothing(  )
        endif
        if ( Trig_Quest_Table_Func010Func007001() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(udg_player2), 30.00, "TRIGSTR_4646" )
        else
            call DoNothing(  )
        endif
        if ( Trig_Quest_Table_Func010Func008001() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(udg_player2), 30.00, "TRIGSTR_4647" )
        else
            call DoNothing(  )
        endif
    else
    endif
    if ( Trig_Quest_Table_Func011C() ) then
        set udg_Tempspot = GetUnitLoc(udg_Herounit[GetConvertedPlayerId(udg_player2)])
        call CreateItemLoc( 'I031', udg_Tempspot )
        call RemoveLocation(udg_Tempspot)
        set udg_Random = GetRandomInt(1, 3)
        if ( Trig_Quest_Table_Func011Func006001() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(udg_player2), 30.00, "TRIGSTR_4648" )
        else
            call DoNothing(  )
        endif
        if ( Trig_Quest_Table_Func011Func007001() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(udg_player2), 30.00, "TRIGSTR_4649" )
        else
            call DoNothing(  )
        endif
        if ( Trig_Quest_Table_Func011Func008001() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(udg_player2), 30.00, "TRIGSTR_4650" )
        else
            call DoNothing(  )
        endif
    else
    endif
    if ( Trig_Quest_Table_Func012C() ) then
        set udg_MonsterDifficulty = ( GetHeroLevel(udg_Herounit[GetConvertedPlayerId(udg_player2)]) - ( GetHeroLevel(udg_Herounit[GetConvertedPlayerId(udg_player2)]) / 3 ) )
        call TriggerExecute( gg_trg_Monster_Table )
        set udg_Tempspot = GetUnitLoc(udg_Herounit[GetConvertedPlayerId(udg_player2)])
        call CreateNUnitsAtLoc( 1, udg_MonsterType, Player(PLAYER_NEUTRAL_AGGRESSIVE), udg_Tempspot, bj_UNIT_FACING )
        call SetUnitUserData( GetLastCreatedUnit(), 1 )
        call RebelLevel(3)
        call CreateNUnitsAtLoc( 3, bj_groupCountUnits, Player(PLAYER_NEUTRAL_AGGRESSIVE), udg_Tempspot, bj_UNIT_FACING )
        call RemoveLocation(udg_Tempspot)
        set udg_Random = GetRandomInt(1, 3)
        if ( Trig_Quest_Table_Func012Func011001() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(udg_player2), 30.00, "TRIGSTR_4651" )
        else
            call DoNothing(  )
        endif
        if ( Trig_Quest_Table_Func012Func012001() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(udg_player2), 30.00, "TRIGSTR_4652" )
        else
            call DoNothing(  )
        endif
        if ( Trig_Quest_Table_Func012Func013001() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(udg_player2), 30.00, "TRIGSTR_4653" )
        else
            call DoNothing(  )
        endif
    else
    endif
endfunction

//===========================================================================
function InitTrig_Quest_Table takes nothing returns nothing
    set gg_trg_Quest_Table = CreateTrigger(  )
    call TriggerAddAction( gg_trg_Quest_Table, function Trig_Quest_Table_Actions )
endfunction

//===========================================================================
// Trigger: Monster Table
//===========================================================================
function Trig_Monster_Table_Func001Func001Func001Func001Func002001 takes nothing returns boolean
    return ( udg_Random == 1 )
endfunction

function Trig_Monster_Table_Func001Func001Func001Func001Func003001 takes nothing returns boolean
    return ( udg_Random == 2 )
endfunction

function Trig_Monster_Table_Func001Func001Func001Func001Func004001 takes nothing returns boolean
    return ( udg_Random == 3 )
endfunction

function Trig_Monster_Table_Func001Func001Func001Func001Func007001 takes nothing returns boolean
    return ( udg_Random == 1 )
endfunction

function Trig_Monster_Table_Func001Func001Func001Func001Func008001 takes nothing returns boolean
    return ( udg_Random == 2 )
endfunction

function Trig_Monster_Table_Func001Func001Func001Func001Func009001 takes nothing returns boolean
    return ( udg_Random == 3 )
endfunction

function Trig_Monster_Table_Func001Func001Func001Func001C takes nothing returns boolean
    if ( not ( udg_MonsterDifficulty <= 60 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Monster_Table_Func001Func001Func001Func004001 takes nothing returns boolean
    return ( udg_Random == 1 )
endfunction

function Trig_Monster_Table_Func001Func001Func001Func005001 takes nothing returns boolean
    return ( udg_Random == 2 )
endfunction

function Trig_Monster_Table_Func001Func001Func001Func006001 takes nothing returns boolean
    return ( udg_Random == 3 )
endfunction

function Trig_Monster_Table_Func001Func001Func001C takes nothing returns boolean
    if ( not ( udg_MonsterDifficulty <= 40 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Monster_Table_Func001Func001Func004001 takes nothing returns boolean
    return ( udg_Random == 1 )
endfunction

function Trig_Monster_Table_Func001Func001Func005001 takes nothing returns boolean
    return ( udg_Random == 2 )
endfunction

function Trig_Monster_Table_Func001Func001Func006001 takes nothing returns boolean
    return ( udg_Random == 3 )
endfunction

function Trig_Monster_Table_Func001Func001C takes nothing returns boolean
    if ( not ( udg_MonsterDifficulty <= 20 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Monster_Table_Func001Func003001 takes nothing returns boolean
    return ( udg_Random == 1 )
endfunction

function Trig_Monster_Table_Func001Func004001 takes nothing returns boolean
    return ( udg_Random == 2 )
endfunction

function Trig_Monster_Table_Func001C takes nothing returns boolean
    if ( not ( udg_MonsterDifficulty <= 10 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Monster_Table_Actions takes nothing returns nothing
    if ( Trig_Monster_Table_Func001C() ) then
        set udg_Random = GetRandomInt(1, 2)
        if ( Trig_Monster_Table_Func001Func003001() ) then
            set udg_MonsterType = 'n00J'
        else
            call DoNothing(  )
        endif
        if ( Trig_Monster_Table_Func001Func004001() ) then
            set udg_MonsterType = 'n008'
        else
            call DoNothing(  )
        endif
    else
        if ( Trig_Monster_Table_Func001Func001C() ) then
            set udg_Random = GetRandomInt(1, 3)
            if ( Trig_Monster_Table_Func001Func001Func004001() ) then
                set udg_MonsterType = 'n00B'
            else
                call DoNothing(  )
            endif
            if ( Trig_Monster_Table_Func001Func001Func005001() ) then
                set udg_MonsterType = 'n009'
            else
                call DoNothing(  )
            endif
            if ( Trig_Monster_Table_Func001Func001Func006001() ) then
                set udg_MonsterType = 'n01N'
            else
                call DoNothing(  )
            endif
        else
            if ( Trig_Monster_Table_Func001Func001Func001C() ) then
                set udg_Random = GetRandomInt(1, 3)
                if ( Trig_Monster_Table_Func001Func001Func001Func004001() ) then
                    set udg_MonsterType = 'o014'
                else
                    call DoNothing(  )
                endif
                if ( Trig_Monster_Table_Func001Func001Func001Func005001() ) then
                    set udg_MonsterType = 'n009'
                else
                    call DoNothing(  )
                endif
                if ( Trig_Monster_Table_Func001Func001Func001Func006001() ) then
                    set udg_MonsterType = 'n021'
                else
                    call DoNothing(  )
                endif
            else
                if ( Trig_Monster_Table_Func001Func001Func001Func001C() ) then
                    set udg_Random = GetRandomInt(1, 3)
                    if ( Trig_Monster_Table_Func001Func001Func001Func001Func007001() ) then
                        set udg_MonsterType = 'n01E'
                    else
                        call DoNothing(  )
                    endif
                    if ( Trig_Monster_Table_Func001Func001Func001Func001Func008001() ) then
                        set udg_MonsterType = 'n01R'
                    else
                        call DoNothing(  )
                    endif
                    if ( Trig_Monster_Table_Func001Func001Func001Func001Func009001() ) then
                        set udg_MonsterType = 'o018'
                    else
                        call DoNothing(  )
                    endif
                else
                    set udg_Random = GetRandomInt(1, 3)
                    if ( Trig_Monster_Table_Func001Func001Func001Func001Func002001() ) then
                        set udg_MonsterType = 'n01F'
                    else
                        call DoNothing(  )
                    endif
                    if ( Trig_Monster_Table_Func001Func001Func001Func001Func003001() ) then
                        set udg_MonsterType = 'n01J'
                    else
                        call DoNothing(  )
                    endif
                    if ( Trig_Monster_Table_Func001Func001Func001Func001Func004001() ) then
                        set udg_MonsterType = 'o01C'
                    else
                        call DoNothing(  )
                    endif
                endif
            endif
        endif
    endif
endfunction

//===========================================================================
function InitTrig_Monster_Table takes nothing returns nothing
    set gg_trg_Monster_Table = CreateTrigger(  )
    call TriggerAddAction( gg_trg_Monster_Table, function Trig_Monster_Table_Actions )
endfunction

//===========================================================================
// Trigger: Set Quests
//===========================================================================
function Trig_Set_Quests_Actions takes nothing returns nothing
local integer i = GetRandomInt(0, 2)
local group g = GetUnitsOfPlayerAndTypeId(Player(PLAYER_NEUTRAL_PASSIVE), 'n00W')
local unit u = GroupPickRandomUnit(g)
if i == 1 and udg_QuestGiverAmount < 20 and GetUnitUserData(u) == 1 then
call ReplaceUnitBJ( u, 'n00X', bj_UNIT_STATE_METHOD_RELATIVE )
set u = GetLastReplacedUnitBJ()
call SetUnitUserData( u, 1)
set udg_QuestGiverAmount = udg_QuestGiverAmount + 1 
else
if udg_QuestSpawn == 0 and udg_QuestGiverAmount < 20 and GetUnitUserData(u) == 0 then
set udg_QuestSpawn = 1
set udg_QuestGiverAmount = udg_QuestGiverAmount + 1 
endif
endif
set u = null
call DestroyGroup(g)
set g = null
endfunction

//===========================================================================
function InitTrig_Set_Quests takes nothing returns nothing
    set gg_trg_Set_Quests = CreateTrigger(  )
    call TriggerRegisterTimerEventPeriodic( gg_trg_Set_Quests, 90.00 )
    call TriggerAddAction( gg_trg_Set_Quests, function Trig_Set_Quests_Actions )
endfunction

//===========================================================================
// Trigger: Returning Quest Items To Towns
//===========================================================================
function Trig_Returning_Quest_Items_To_Towns_Conditions takes nothing returns boolean
local unit u = GetTriggerUnit()
local player p = GetTriggerPlayer()
local unit u2 = udg_Herounit[GetConvertedPlayerId(p)]
local location l = GetUnitLoc(u2)
local location l2 = GetUnitLoc(u)
if GetUnitTypeId(u) == 'n00L' and DistanceBetweenPoints(l, l2) <= 250.00 then
set u = null
set p = null
set u2 = null
call RemoveLocation(l)
call RemoveLocation(l2)
set l = null
set l2 = null
return true
endif
set u = null
set p = null
set u2 = null
call RemoveLocation(l)
call RemoveLocation(l2)
set l = null
set l2 = null
return false
endfunction

function Quest_Reward_Check2 takes nothing returns boolean
local player p = GetTriggerPlayer()
if  IsUnitType(GetFilterUnit(), UNIT_TYPE_HERO) == true and IsUnitAlly(GetFilterUnit(), p) == true then
set p = null
return true
endif
set p = null
return false
endfunction

function Trig_Returning_Quest_Items_To_Towns_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local player p = GetTriggerPlayer() 
local location l = GetUnitLoc(u)  
local group g = GetUnitsInRangeOfLocMatching(1500.00, l, Condition(function Quest_Reward_Check2))

if UnitHasItemOfTypeBJ(udg_Herounit[GetConvertedPlayerId(p)], 'I042') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(udg_Herounit[GetConvertedPlayerId(p)], 'I042') )
call PlaySoundForPlayer( p, gg_snd_QuestCompleted )
call ForGroupBJ( g, function QuestReward ) 
else
if UnitHasItemOfTypeBJ(udg_Herounit[GetConvertedPlayerId(p)], 'I046') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(udg_Herounit[GetConvertedPlayerId(p)], 'I046') )
call PlaySoundForPlayer( p, gg_snd_QuestCompleted )
call ForGroupBJ( g, function QuestReward ) 
else
if UnitHasItemOfTypeBJ(udg_Herounit[GetConvertedPlayerId(p)], 'I03J') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(udg_Herounit[GetConvertedPlayerId(p)], 'I03J') )
call PlaySoundForPlayer( p, gg_snd_QuestCompleted )
call ForGroupBJ( g, function QuestReward ) 
else
if UnitHasItemOfTypeBJ(udg_Herounit[GetConvertedPlayerId(p)], 'I030') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(udg_Herounit[GetConvertedPlayerId(p)], 'I030') )
call PlaySoundForPlayer( p, gg_snd_QuestCompleted )
call ForGroupBJ( g, function QuestReward ) 
else
if UnitHasItemOfTypeBJ(udg_Herounit[GetConvertedPlayerId(p)], 'I031') == true then
call RemoveItem( GetItemOfTypeFromUnitBJ(udg_Herounit[GetConvertedPlayerId(p)], 'I031') )
call PlaySoundForPlayer( p, gg_snd_QuestCompleted )
call ForGroupBJ( g, function QuestReward ) 
endif
endif
endif
endif
endif

call RemoveLocation(l)
call DestroyGroup(g)
set u = null
set p = null
set g = null
set l = null
endfunction

//===========================================================================
function InitTrig_Returning_Quest_Items_To_Towns takes nothing returns nothing
    set gg_trg_Returning_Quest_Items_To_Towns = CreateTrigger(  )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Returning_Quest_Items_To_Towns, Player(0), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Returning_Quest_Items_To_Towns, Player(1), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Returning_Quest_Items_To_Towns, Player(2), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Returning_Quest_Items_To_Towns, Player(3), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Returning_Quest_Items_To_Towns, Player(4), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Returning_Quest_Items_To_Towns, Player(5), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Returning_Quest_Items_To_Towns, Player(6), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Returning_Quest_Items_To_Towns, Player(7), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Returning_Quest_Items_To_Towns, Player(8), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Returning_Quest_Items_To_Towns, Player(9), true )
    call TriggerAddCondition( gg_trg_Returning_Quest_Items_To_Towns, Condition( function Trig_Returning_Quest_Items_To_Towns_Conditions ) )
    call TriggerAddAction( gg_trg_Returning_Quest_Items_To_Towns, function Trig_Returning_Quest_Items_To_Towns_Actions )
endfunction

//===========================================================================
// Trigger: Quest Reward Monster Slaying
//===========================================================================
function Trig_Quest_Reward_Monster_Slaying_Conditions takes nothing returns boolean
local unit u = GetDyingUnit()
local player p = GetOwningPlayer(u)
if p == Player(PLAYER_NEUTRAL_AGGRESSIVE) and GetUnitUserData(u) > 0 and GetUnitTypeId(u) != 'e00U' then
set u = null
set p = null
return true
endif
set u = null
set p = null
return false
endfunction

function Quest_Reward_Check takes nothing returns boolean
local unit u = GetKillingUnitBJ()
local unit u2 = GetFilterUnit()
local player p = GetOwningPlayer(u)
if  IsUnitType(u2, UNIT_TYPE_HERO) == true and IsUnitAlly(u2, p) == true then
set u = null
set u2 = null
set p = null
return true
endif
set u = null
set u2 = null
set p = null
return false
endfunction

function Trig_Quest_Reward_Monster_Slaying_Actions takes nothing returns nothing
local unit u = GetDyingUnit()
local location l = GetUnitLoc(u)
local group g = GetUnitsInRangeOfLocMatching(1500.00, l, Condition(function Quest_Reward_Check))
local item it = null

if GetUnitUserData(u) == 1 then
call ForGroupBJ( g, function QuestReward )
endif
if GetUnitUserData(u) == 2 then
call CreateItemLoc( 'I042', l )
set it = GetLastCreatedItem()
call SetItemInvulnerableBJ( it, true )
endif
if GetUnitUserData(u) == 3 then
call CreateItemLoc( 'I046', l )
set it = GetLastCreatedItem()
call SetItemInvulnerableBJ( it, true )
endif
if GetUnitUserData(u) == 4  then
call CreateItemLoc( 'I03J', l )
set it = GetLastCreatedItem()
call SetItemInvulnerableBJ( it, true )
endif
if GetUnitUserData(u) == 5  then
call CreateItemLoc( 'I030', l )
set it = GetLastCreatedItem()
call SetItemInvulnerableBJ( it, true )
endif
if GetUnitUserData(u) == 6  then
call CreateItemLoc( 'I031', l )
set it = GetLastCreatedItem()
call SetItemInvulnerableBJ( it, true )
endif

call DestroyGroup(g)
call RemoveLocation(l)
set g = null
set l = null
set u = null
set it = null
endfunction

//===========================================================================
function InitTrig_Quest_Reward_Monster_Slaying takes nothing returns nothing
    set gg_trg_Quest_Reward_Monster_Slaying = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Quest_Reward_Monster_Slaying, Player(PLAYER_NEUTRAL_AGGRESSIVE), EVENT_PLAYER_UNIT_DEATH )
    call TriggerAddCondition( gg_trg_Quest_Reward_Monster_Slaying, Condition( function Trig_Quest_Reward_Monster_Slaying_Conditions ) )
    call TriggerAddAction( gg_trg_Quest_Reward_Monster_Slaying, function Trig_Quest_Reward_Monster_Slaying_Actions )
endfunction

//===========================================================================
// Trigger: Camp Attack
//===========================================================================
function Quest_Reward_Check_Camp takes nothing returns boolean
if IsUnitType(GetFilterUnit(), UNIT_TYPE_HERO) == true then
return true
endif
return false
endfunction

function removeunitcampattack takes nothing returns nothing
local unit u = GetEnumUnit() 
call RemoveUnit(u)
set u = null
endfunction

function Trig_Camp_Attack_Actions takes nothing returns nothing
local integer i
local integer i2 = GetRandomInt(1,5)
local rect r
local rect r2
local unit u
local location l
local location l2
local location l3
local effect array e
local timer t = CreateTimer()
local timerdialog w
local group g = CreateGroup()
local group g2 = null
call StartTimerBJ( t, false, 90.00 )
call CreateTimerDialogBJ( t, "Arrival:" )
set w = GetLastCreatedTimerDialogBJ()

if i2 > 3 then 
set r = gg_rct_camp_top
set r2 = gg_rct_camp_top1
else
set r = gg_rct_camp_bottom
set r2 = gg_rct_camp_bottom1
endif

set l = GetRectCenter(r)
set l2 = GetRectCenter(r2)
call PlaySoundBJ( gg_snd_Warning )
call DisplayTimedTextToForce( GetPlayersAll(), 30.00, "Kalenden's forces are coming protect the children!" )
call PingMinimapLocForForceEx( GetPlayersAll(), l, 90.00, bj_MINIMAPPINGSTYLE_SIMPLE, 0.00, 0.00, 100 )

call CreateNUnitsAtLoc( 1, 'n00Z', Player(bj_PLAYER_NEUTRAL_VICTIM), l2, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call GroupAddUnitSimple( u, g ) 
call CreateNUnitsAtLoc( 1, 'n00Z', Player(bj_PLAYER_NEUTRAL_VICTIM), l2, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call GroupAddUnitSimple( u, g ) 
call CreateNUnitsAtLoc( 1, 'n00Z', Player(bj_PLAYER_NEUTRAL_VICTIM), l2, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call GroupAddUnitSimple( u, g ) 

call PolledWait(90.00)
call PlaySoundBJ( gg_snd_Fight )
call DisplayTimedTextToForce( GetPlayersAll(), 30.00, "My lord Kalenden's forces are assaulting the camp save us!" )
call StartTimerBJ( t, false, 90.00 )
call TimerDialogSetTitleBJ( w, "Survival:")

call AddSpecialEffectLocBJ( l, "Doodads\\Cinematic\\TownBurningFireEmitter\\TownBurningFireEmitter.mdl" )
set e[0] = GetLastCreatedEffectBJ()
set i = 1
loop
exitwhen i > 6
set l3 = PolarProjectionBJ(l, 100, I2R(i*60))
call AddSpecialEffectLocBJ( l3, "Doodads\\Cinematic\\TownBurningFireEmitter\\TownBurningFireEmitter.mdl" )
set e[i] = GetLastCreatedEffectBJ()
call RemoveLocation(l3)
set i = i + 1
endloop

loop
exitwhen (TimerGetRemaining(t)<=0) or CountUnitsInGroup(g) == 0
call Level(0,i2)
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, Player(11), l, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call GroupAddUnitSimple( u, udg_QuestArmy )
call IssuePointOrderLoc( u, "attack", l2)
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, Player(11), l, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call GroupAddUnitSimple( u, udg_QuestArmy ) 
call IssuePointOrderLoc( u, "attack", l2)
call Level(3,i2)
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, Player(11), l, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call GroupAddUnitSimple( u, udg_QuestArmy )  
call IssuePointOrderLoc( u, "attack", l2)
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, Player(11), l, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call GroupAddUnitSimple( u, udg_QuestArmy )  
call IssuePointOrderLoc( u, "attack", l2)
call Level(6,i2)
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, Player(11), l, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call GroupAddUnitSimple( u, udg_QuestArmy ) 
call IssuePointOrderLoc( u, "attack", l2)
call PolledWait(7.50)
endloop

if CountUnitsInGroup(g) == 0 then
call PlaySoundBJ( gg_snd_Warning )
call DisplayTimedTextToForce( GetPlayersAll(), 30.00, "Kalenden's forces have killed the children! Everything is lost...." )
else
call PlaySoundBJ( gg_snd_Warning )
call DisplayTimedTextToForce( GetPlayersAll(), 30.00, "The Children have been saved! Thank god!")
set g2 = GetUnitsInRangeOfLocMatching(2500.00, l, Condition(function Quest_Reward_Check_Camp))
call ForGroupBJ( g2, function QuestReward2 ) 
call DestroyGroup(g2)
set g2 = null
endif
call ForGroupBJ( g, function removeunitcampattack )

call DestroyGroup(g)
set g = null
call RemoveLocation(l)
call RemoveLocation(l2)
call RemoveLocation(l3)
set r = null
set r2 = null
set l = null
set l2 = null
set l3 = null
set u = null
set t = null
call DestroyTimerDialogBJ( w )
set w = null
call DestroyEffectBJ(e[0])
call DestroyEffectBJ(e[1])
call DestroyEffectBJ(e[2])
call DestroyEffectBJ(e[3])
call DestroyEffectBJ(e[4])
call DestroyEffectBJ(e[5])
call DestroyEffectBJ(e[6])
set e[0] = null
set e[1] = null
set e[2] = null
set e[3] = null
set e[4] = null
set e[5] = null
set e[6] = null
set udg_Events[1] = 0
endfunction
//===========================================================================
function InitTrig_Camp_Attack takes nothing returns nothing
    set gg_trg_Camp_Attack = CreateTrigger(  )
    call TriggerAddAction( gg_trg_Camp_Attack, function Trig_Camp_Attack_Actions )
endfunction

//===========================================================================
// Trigger: Supply Wagon
//===========================================================================
function Quest_Reward_Check_Cargo takes nothing returns boolean
if IsUnitType(GetFilterUnit(), UNIT_TYPE_HERO) == true then
return true
endif
return false
endfunction

function Trig_Supply_Wagon_Actions takes nothing returns nothing
local rect r = gg_rct_camp_top
local rect r2 = gg_rct_camp_bottom
local location l = GetRectCenter(r)
local location l2 = GetRectCenter(r2)
local location l3
local location l4
local unit u
local integer i = GetRandomInt(1,5)
local timer t = CreateTimer()
local timerdialog w
local group g

call StartTimerBJ( t, false, 90.00 )
call CreateTimerDialogBJ( t, "Cargo:" )
set w = GetLastCreatedTimerDialogBJ()
call PlaySoundBJ( gg_snd_Warning )
call DisplayTimedTextToForce( GetPlayersAll(), 30.00, "The Camp is sending a Cargo Wagon to the other camp to aid them, could you ensure its save travel for us?" )

if i > 3 then
call PingMinimapLocForForceEx( GetPlayersAll(), l, 90.00, bj_MINIMAPPINGSTYLE_SIMPLE, 0.00, 0.00, 100 )
set l3 = l2
else
call PingMinimapLocForForceEx( GetPlayersAll(), l2, 90.00, bj_MINIMAPPINGSTYLE_SIMPLE, 0.00, 0.00, 100 )
set l3 = l
endif

call PolledWait(90.00)

set t = null
call DestroyTimerDialogBJ( w )
set w = null

if i > 3 then
call CreateNUnitsAtLoc( 1, 'e00V', Player(PLAYER_NEUTRAL_PASSIVE), l, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call IssuePointOrderLoc( u, "move", l3)
else
call CreateNUnitsAtLoc( 1, 'e00V', Player(PLAYER_NEUTRAL_PASSIVE), l2, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call IssuePointOrderLoc( u, "move", l3)
endif

loop
call IssuePointOrderLoc( u, "move", l3)
set l4 = GetUnitLoc(u)
exitwhen IsUnitDeadBJ(u) == true or DistanceBetweenPoints(l4, l3) <= 100
call RemoveLocation(l4)
call PolledWait(2.00)
endloop

if IsUnitDeadBJ(u) == true then
call PlaySoundBJ( gg_snd_Warning )
call DisplayTimedTextToForce( GetPlayersAll(), 30.00, "Kalenden's forces have killed Cargo Wagon and used the resources to improve themselves!" )
set udg_CreepCounter = ( udg_CreepCounter + 1 )
else
call RemoveUnit(u)
call PlaySoundBJ( gg_snd_Warning )
call DisplayTimedTextToForce( GetPlayersAll(), 30.00, "Thank you for protecting our Cargo Wagon!")
set g = GetUnitsInRangeOfLocMatching(1500.00, l3, Condition(function Quest_Reward_Check_Cargo))
call ForGroupBJ( g, function QuestReward2 ) 
endif

call DestroyGroup(g)
set g = null
call RemoveLocation(l)
call RemoveLocation(l2)
call RemoveLocation(l3)
call RemoveLocation(l4)
set r = null
set r2 = null
set l = null
set l2 = null
set l3 = null
set l4 = null
set u = null
set udg_Events[2] = 0
endfunction

//===========================================================================
function InitTrig_Supply_Wagon takes nothing returns nothing
    set gg_trg_Supply_Wagon = CreateTrigger(  )
    call TriggerAddAction( gg_trg_Supply_Wagon, function Trig_Supply_Wagon_Actions )
endfunction

//===========================================================================
// Trigger: zooms
//===========================================================================
function Trig_zooms_Func002C takes nothing returns boolean
    if ( not ( udg_Camera <= 15 ) ) then
        return false
    endif
    if ( not ( udg_Camera >= 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_zooms_Actions takes nothing returns nothing
    set udg_Camera = S2I(SubStringBJ(GetEventPlayerChatString(), 6, 10))
    if ( Trig_zooms_Func002C() ) then
        call SetCameraFieldForPlayer( GetTriggerPlayer(), CAMERA_FIELD_TARGET_DISTANCE, ( ( I2R(udg_Camera) * 200.00 ) + 600.00 ), 0 )
    else
        call DoNothing(  )
    endif
endfunction

//===========================================================================
function InitTrig_zooms takes nothing returns nothing
    set gg_trg_zooms = CreateTrigger(  )
    call TriggerRegisterPlayerChatEvent( gg_trg_zooms, Player(0), "-zoom", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_zooms, Player(1), "-zoom", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_zooms, Player(2), "-zoom", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_zooms, Player(3), "-zoom", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_zooms, Player(4), "-zoom", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_zooms, Player(5), "-zoom", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_zooms, Player(6), "-zoom", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_zooms, Player(7), "-zoom", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_zooms, Player(8), "-zoom", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_zooms, Player(9), "-zoom", false )
    call TriggerAddAction( gg_trg_zooms, function Trig_zooms_Actions )
endfunction

//===========================================================================
// Trigger: rotate
//===========================================================================
function Trig_rotate_Actions takes nothing returns nothing
    set udg_Camera = S2I(SubStringBJ(GetEventPlayerChatString(), 8, 11))
    call SetCameraFieldForPlayer( GetTriggerPlayer(), CAMERA_FIELD_ROTATION, I2R(udg_Camera), 0 )
endfunction

//===========================================================================
function InitTrig_rotate takes nothing returns nothing
    set gg_trg_rotate = CreateTrigger(  )
    call TriggerRegisterPlayerChatEvent( gg_trg_rotate, Player(0), "-rotate", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_rotate, Player(1), "-rotate", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_rotate, Player(2), "-rotate", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_rotate, Player(3), "-rotate", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_rotate, Player(4), "-rotate", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_rotate, Player(5), "-rotate", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_rotate, Player(6), "-rotate", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_rotate, Player(7), "-rotate", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_rotate, Player(8), "-rotate", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_rotate, Player(9), "-rotate", false )
    call TriggerAddAction( gg_trg_rotate, function Trig_rotate_Actions )
endfunction

//===========================================================================
// Trigger: angle
//===========================================================================
function Trig_angle_Func002C takes nothing returns boolean
    if ( not ( udg_Camera <= 14 ) ) then
        return false
    endif
    if ( not ( udg_Camera >= 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_angle_Actions takes nothing returns nothing
    set udg_Camera = S2I(SubStringBJ(GetEventPlayerChatString(), 7, 10))
    if ( Trig_angle_Func002C() ) then
        call SetCameraFieldForPlayer( GetTriggerPlayer(), CAMERA_FIELD_ANGLE_OF_ATTACK, ( 354.00 - ( I2R(udg_Camera) * 6.00 ) ), 0 )
    else
        call DoNothing(  )
    endif
endfunction

//===========================================================================
function InitTrig_angle takes nothing returns nothing
    set gg_trg_angle = CreateTrigger(  )
    call TriggerRegisterPlayerChatEvent( gg_trg_angle, Player(0), "-angle", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_angle, Player(1), "-angle", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_angle, Player(2), "-angle", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_angle, Player(3), "-angle", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_angle, Player(4), "-angle", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_angle, Player(5), "-angle", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_angle, Player(6), "-angle", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_angle, Player(7), "-angle", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_angle, Player(8), "-angle", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_angle, Player(9), "-angle", false )
    call TriggerAddAction( gg_trg_angle, function Trig_angle_Actions )
endfunction

//===========================================================================
// Trigger: reset
//===========================================================================
function Trig_reset_Actions takes nothing returns nothing
    call ResetToGameCameraForPlayer( GetTriggerPlayer(), 0 )
endfunction

//===========================================================================
function InitTrig_reset takes nothing returns nothing
    set gg_trg_reset = CreateTrigger(  )
    call TriggerRegisterPlayerChatEvent( gg_trg_reset, Player(0), "-cam reset", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_reset, Player(1), "-cam reset", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_reset, Player(2), "-cam reset", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_reset, Player(3), "-cam reset", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_reset, Player(4), "-cam reset", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_reset, Player(5), "-cam reset", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_reset, Player(6), "-cam reset", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_reset, Player(7), "-cam reset", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_reset, Player(8), "-cam reset", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_reset, Player(9), "-cam reset", true )
    call TriggerAddAction( gg_trg_reset, function Trig_reset_Actions )
endfunction

//===========================================================================
// Trigger: Rename
//===========================================================================
function Trig_Rename_Actions takes nothing returns nothing
    call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 15.00, "TRIGSTR_2590" )
    call PlaySoundBJ( gg_snd_Message )
endfunction

//===========================================================================
function InitTrig_Rename takes nothing returns nothing
    set gg_trg_Rename = CreateTrigger(  )
    call TriggerRegisterPlayerChatEvent( gg_trg_Rename, Player(0), "-rename", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Rename, Player(1), "-rename", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Rename, Player(2), "-rename", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Rename, Player(3), "-rename", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Rename, Player(4), "-rename", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Rename, Player(5), "-rename", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Rename, Player(6), "-rename", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Rename, Player(7), "-rename", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Rename, Player(8), "-rename", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Rename, Player(9), "-rename", false )
    call TriggerAddAction( gg_trg_Rename, function Trig_Rename_Actions )
endfunction

//===========================================================================
// Trigger: Hero Ally Click
//===========================================================================
function Trig_Hero_Ally_Click_Func001Func004C takes nothing returns boolean
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[11] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[12] ) ) then
        return true
    endif
    return false
endfunction

function Trig_Hero_Ally_Click_Func001C takes nothing returns boolean
    if ( not Trig_Hero_Ally_Click_Func001Func004C() ) then
        return false
    endif
    return true
endfunction

function Trig_Hero_Ally_Click_Func002Func004C takes nothing returns boolean
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[21] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[22] ) ) then
        return true
    endif
    return false
endfunction

function Trig_Hero_Ally_Click_Func002C takes nothing returns boolean
    if ( not Trig_Hero_Ally_Click_Func002Func004C() ) then
        return false
    endif
    return true
endfunction

function Trig_Hero_Ally_Click_Func003Func004C takes nothing returns boolean
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[31] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[32] ) ) then
        return true
    endif
    return false
endfunction

function Trig_Hero_Ally_Click_Func003C takes nothing returns boolean
    if ( not Trig_Hero_Ally_Click_Func003Func004C() ) then
        return false
    endif
    return true
endfunction

function Trig_Hero_Ally_Click_Func004Func004C takes nothing returns boolean
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[41] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[42] ) ) then
        return true
    endif
    return false
endfunction

function Trig_Hero_Ally_Click_Func004C takes nothing returns boolean
    if ( not Trig_Hero_Ally_Click_Func004Func004C() ) then
        return false
    endif
    return true
endfunction

function Trig_Hero_Ally_Click_Func005Func004C takes nothing returns boolean
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[51] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[52] ) ) then
        return true
    endif
    return false
endfunction

function Trig_Hero_Ally_Click_Func005C takes nothing returns boolean
    if ( not Trig_Hero_Ally_Click_Func005Func004C() ) then
        return false
    endif
    return true
endfunction

function Trig_Hero_Ally_Click_Func006Func004C takes nothing returns boolean
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[61] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[62] ) ) then
        return true
    endif
    return false
endfunction

function Trig_Hero_Ally_Click_Func006C takes nothing returns boolean
    if ( not Trig_Hero_Ally_Click_Func006Func004C() ) then
        return false
    endif
    return true
endfunction

function Trig_Hero_Ally_Click_Func007Func004C takes nothing returns boolean
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[71] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[72] ) ) then
        return true
    endif
    return false
endfunction

function Trig_Hero_Ally_Click_Func007C takes nothing returns boolean
    if ( not Trig_Hero_Ally_Click_Func007Func004C() ) then
        return false
    endif
    return true
endfunction

function Trig_Hero_Ally_Click_Func008Func004C takes nothing returns boolean
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[81] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[82] ) ) then
        return true
    endif
    return false
endfunction

function Trig_Hero_Ally_Click_Func008C takes nothing returns boolean
    if ( not Trig_Hero_Ally_Click_Func008Func004C() ) then
        return false
    endif
    return true
endfunction

function Trig_Hero_Ally_Click_Func009Func004C takes nothing returns boolean
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[91] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[92] ) ) then
        return true
    endif
    return false
endfunction

function Trig_Hero_Ally_Click_Func009C takes nothing returns boolean
    if ( not Trig_Hero_Ally_Click_Func009Func004C() ) then
        return false
    endif
    return true
endfunction

function Trig_Hero_Ally_Click_Func010Func004C takes nothing returns boolean
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[101] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[102] ) ) then
        return true
    endif
    return false
endfunction

function Trig_Hero_Ally_Click_Func010C takes nothing returns boolean
    if ( not Trig_Hero_Ally_Click_Func010Func004C() ) then
        return false
    endif
    return true
endfunction

function Trig_Hero_Ally_Click_Func011Func004C takes nothing returns boolean
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[11] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[21] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[31] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[41] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[51] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[61] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[71] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[81] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[91] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[101] ) ) then
        return true
    endif
    return false
endfunction

function Trig_Hero_Ally_Click_Func011C takes nothing returns boolean
    if ( not Trig_Hero_Ally_Click_Func011Func004C() ) then
        return false
    endif
    return true
endfunction

function Trig_Hero_Ally_Click_Func012Func004C takes nothing returns boolean
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[12] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[22] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[32] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[42] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[52] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[62] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[72] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[82] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[92] ) ) then
        return true
    endif
    if ( ( GetClickedButtonBJ() == udg_HeroAllyButtons[102] ) ) then
        return true
    endif
    return false
endfunction

function Trig_Hero_Ally_Click_Func012C takes nothing returns boolean
    if ( not Trig_Hero_Ally_Click_Func012Func004C() ) then
        return false
    endif
    return true
endfunction

function Trig_Hero_Ally_Click_Actions takes nothing returns nothing
    if ( Trig_Hero_Ally_Click_Func001C() ) then
        set udg_playerremind = udg_asking[1]
        set udg_otherplayer = Player(0)
    else
        call DoNothing(  )
    endif
    if ( Trig_Hero_Ally_Click_Func002C() ) then
        set udg_playerremind = udg_asking[2]
        set udg_otherplayer = Player(1)
    else
        call DoNothing(  )
    endif
    if ( Trig_Hero_Ally_Click_Func003C() ) then
        set udg_playerremind = udg_asking[3]
        set udg_otherplayer = Player(2)
    else
        call DoNothing(  )
    endif
    if ( Trig_Hero_Ally_Click_Func004C() ) then
        set udg_playerremind = udg_asking[4]
        set udg_otherplayer = Player(3)
    else
        call DoNothing(  )
    endif
    if ( Trig_Hero_Ally_Click_Func005C() ) then
        set udg_playerremind = udg_asking[5]
        set udg_otherplayer = Player(4)
    else
        call DoNothing(  )
    endif
    if ( Trig_Hero_Ally_Click_Func006C() ) then
        set udg_playerremind = udg_asking[6]
        set udg_otherplayer = Player(5)
    else
        call DoNothing(  )
    endif
    if ( Trig_Hero_Ally_Click_Func007C() ) then
        set udg_playerremind = udg_asking[7]
        set udg_otherplayer = Player(6)
    else
        call DoNothing(  )
    endif
    if ( Trig_Hero_Ally_Click_Func008C() ) then
        set udg_playerremind = udg_asking[8]
        set udg_otherplayer = Player(7)
    else
        call DoNothing(  )
    endif
    if ( Trig_Hero_Ally_Click_Func009C() ) then
        set udg_playerremind = udg_asking[9]
        set udg_otherplayer = Player(8)
    else
        call DoNothing(  )
    endif
    if ( Trig_Hero_Ally_Click_Func010C() ) then
        set udg_playerremind = udg_asking[10]
        set udg_otherplayer = Player(9)
    else
        call DoNothing(  )
    endif
    if ( Trig_Hero_Ally_Click_Func011C() ) then
            call PlaySoundForPlayer( udg_playerremind, gg_snd_Warning )
            call PlaySoundForPlayer( udg_otherplayer, gg_snd_Warning )
        call DisplayTimedTextToForce( GetForceOfPlayer(udg_playerremind), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(udg_otherplayer)] + GetPlayerName(udg_otherplayer) ) + " |cffffcc00has agreed to ally with you!" ) )
        call DisplayTimedTextToForce( GetForceOfPlayer(udg_otherplayer), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(udg_playerremind)] + GetPlayerName(udg_playerremind) ) + " |cffffcc00has become your ally!" ) )
        call SetPlayerAllianceStateBJ( udg_otherplayer, udg_playerremind, bj_ALLIANCE_ALLIED_VISION )
        call SetPlayerAllianceStateBJ( udg_playerremind, udg_otherplayer, bj_ALLIANCE_ALLIED_VISION )
    else
        call DoNothing(  )
    endif
    if ( Trig_Hero_Ally_Click_Func012C() ) then
            call PlaySoundForPlayer( udg_playerremind, gg_snd_Warning )
            call PlaySoundForPlayer( udg_otherplayer, gg_snd_Warning )
        call DisplayTimedTextToForce( GetForceOfPlayer(udg_playerremind), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(udg_otherplayer)] + GetPlayerName(udg_otherplayer) ) + " |cffffcc00doesn't want to ally with you!" ) )
        call DisplayTimedTextToForce( GetForceOfPlayer(udg_otherplayer), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(udg_playerremind)] + GetPlayerName(udg_playerremind) ) + " |cffffcc00has refused the ally request!" ) )
    else
        call DoNothing(  )
    endif
    set udg_Playerbussy[GetConvertedPlayerId(udg_otherplayer)] = 0
endfunction

//===========================================================================
function InitTrig_Hero_Ally_Click takes nothing returns nothing
    set gg_trg_Hero_Ally_Click = CreateTrigger(  )
    call TriggerRegisterDialogEventBJ( gg_trg_Hero_Ally_Click, udg_HeroAlly1 )
    call TriggerRegisterDialogEventBJ( gg_trg_Hero_Ally_Click, udg_HeroAlly2 )
    call TriggerRegisterDialogEventBJ( gg_trg_Hero_Ally_Click, udg_HeroAlly3 )
    call TriggerRegisterDialogEventBJ( gg_trg_Hero_Ally_Click, udg_HeroAlly4 )
    call TriggerRegisterDialogEventBJ( gg_trg_Hero_Ally_Click, udg_HeroAlly5 )
    call TriggerRegisterDialogEventBJ( gg_trg_Hero_Ally_Click, udg_HeroAlly6 )
    call TriggerRegisterDialogEventBJ( gg_trg_Hero_Ally_Click, udg_HeroAlly7 )
    call TriggerRegisterDialogEventBJ( gg_trg_Hero_Ally_Click, udg_HeroAlly8 )
    call TriggerRegisterDialogEventBJ( gg_trg_Hero_Ally_Click, udg_HeroAlly9 )
    call TriggerRegisterDialogEventBJ( gg_trg_Hero_Ally_Click, udg_HeroAlly10 )
    call TriggerAddAction( gg_trg_Hero_Ally_Click, function Trig_Hero_Ally_Click_Actions )
endfunction

//===========================================================================
// Trigger: Difficulty
//===========================================================================
function Trig_Difficulty_Func002C takes nothing returns boolean
    if ( not ( udg_TimerDiff == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Difficulty_Func003C takes nothing returns boolean
    if ( not ( udg_TimerDiff == 3 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Difficulty_Func004C takes nothing returns boolean
    if ( not ( udg_TimerDiff == 6 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Difficulty_Func005C takes nothing returns boolean
    if ( not ( udg_TimerDiff == 10 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Difficulty_Func006C takes nothing returns boolean
    if ( not ( udg_TimerDiff == 16 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Difficulty_Func007C takes nothing returns boolean
    if ( not ( udg_TimerDiff == 25 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Difficulty_Func008C takes nothing returns boolean
    if ( not ( udg_TimerDiff == 35 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Difficulty_Func009C takes nothing returns boolean
    if ( not ( udg_TimerDiff == 50 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Difficulty_Actions takes nothing returns nothing
        call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Message )
    if ( Trig_Difficulty_Func002C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4654" )
    else
    endif
    if ( Trig_Difficulty_Func003C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4655" )
    else
    endif
    if ( Trig_Difficulty_Func004C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4656" )
    else
    endif
    if ( Trig_Difficulty_Func005C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4657" )
    else
    endif
    if ( Trig_Difficulty_Func006C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4658" )
    else
    endif
    if ( Trig_Difficulty_Func007C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4659" )
    else
    endif
    if ( Trig_Difficulty_Func008C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4660" )
    else
    endif
    if ( Trig_Difficulty_Func009C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4661" )
    else
    endif
endfunction

//===========================================================================
function InitTrig_Difficulty takes nothing returns nothing
    set gg_trg_Difficulty = CreateTrigger(  )
    call DisableTrigger( gg_trg_Difficulty )
    call TriggerRegisterPlayerChatEvent( gg_trg_Difficulty, Player(0), "-difficulty", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Difficulty, Player(1), "-difficulty", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Difficulty, Player(2), "-difficulty", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Difficulty, Player(3), "-difficulty", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Difficulty, Player(4), "-difficulty", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Difficulty, Player(5), "-difficulty", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Difficulty, Player(6), "-difficulty", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Difficulty, Player(7), "-difficulty", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Difficulty, Player(8), "-difficulty", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Difficulty, Player(9), "-difficulty", false )
    call TriggerAddAction( gg_trg_Difficulty, function Trig_Difficulty_Actions )
endfunction

//===========================================================================
// Trigger: War
//===========================================================================
function Trig_War_Func001C takes nothing returns boolean
    if ( ( GetEventPlayerChatString() == "-war red" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-war blue" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-war teal" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-war purple" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-war yellow" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-war orange" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-war green" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-war pink" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-war gray" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-war grey" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-war light blue" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-war lightblue" ) ) then
        return true
    endif
    return false
endfunction

function Trig_War_Conditions takes nothing returns boolean
    if ( not Trig_War_Func001C() ) then
        return false
    endif
    return true
endfunction

function Trig_War_Func002001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-war red" )
endfunction

function Trig_War_Func003001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-war blue" )
endfunction

function Trig_War_Func004001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-war teal" )
endfunction

function Trig_War_Func005001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-war purple" )
endfunction

function Trig_War_Func006001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-war yellow" )
endfunction

function Trig_War_Func007001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-war orange" )
endfunction

function Trig_War_Func008001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-war green" )
endfunction

function Trig_War_Func009001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-war pink" )
endfunction

function Trig_War_Func010001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-war gray" )
endfunction

function Trig_War_Func011001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-war grey" )
endfunction

function Trig_War_Func012001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-war lightblue" )
endfunction

function Trig_War_Func013001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-war light blue" )
endfunction

function Trig_War_Func014C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == udg_Asked ) ) then
        return false
    endif
    return true
endfunction

function Trig_War_Func015C takes nothing returns boolean
    if ( not ( GetPlayerSlotState(udg_Asked) != PLAYER_SLOT_STATE_PLAYING ) ) then
        return false
    endif
    return true
endfunction

function Trig_War_Func020C takes nothing returns boolean
    if ( not ( IsPlayerEnemy(GetTriggerPlayer(), udg_Asked) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_War_Actions takes nothing returns nothing
    if ( Trig_War_Func002001() ) then
        set udg_Asked = Player(0)
    else
        call DoNothing(  )
    endif
    if ( Trig_War_Func003001() ) then
        set udg_Asked = Player(1)
    else
        call DoNothing(  )
    endif
    if ( Trig_War_Func004001() ) then
        set udg_Asked = Player(2)
    else
        call DoNothing(  )
    endif
    if ( Trig_War_Func005001() ) then
        set udg_Asked = Player(3)
    else
        call DoNothing(  )
    endif
    if ( Trig_War_Func006001() ) then
        set udg_Asked = Player(4)
    else
        call DoNothing(  )
    endif
    if ( Trig_War_Func007001() ) then
        set udg_Asked = Player(5)
    else
        call DoNothing(  )
    endif
    if ( Trig_War_Func008001() ) then
        set udg_Asked = Player(6)
    else
        call DoNothing(  )
    endif
    if ( Trig_War_Func009001() ) then
        set udg_Asked = Player(7)
    else
        call DoNothing(  )
    endif
    if ( Trig_War_Func010001() ) then
        set udg_Asked = Player(8)
    else
        call DoNothing(  )
    endif
    if ( Trig_War_Func011001() ) then
        set udg_Asked = Player(8)
    else
        call DoNothing(  )
    endif
    if ( Trig_War_Func012001() ) then
        set udg_Asked = Player(9)
    else
        call DoNothing(  )
    endif
    if ( Trig_War_Func013001() ) then
        set udg_Asked = Player(9)
    else
        call DoNothing(  )
    endif
    if ( Trig_War_Func014C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4662" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_War_Func015C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4663" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_War_Func020C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4664" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    call DisplayTimedTextToForce( GetForceOfPlayer(udg_Asked), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(GetTriggerPlayer())] + GetPlayerName(GetTriggerPlayer()) ) + "  |cffffcc00has decleared war on you!" ) )
    call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(udg_Asked)] + GetPlayerName(udg_Asked) ) + "  |cffffcc00has become your enemy!" ) )
        call PlaySoundForPlayer( udg_Asked, gg_snd_Warning )
        call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
    call SetPlayerAllianceStateBJ( GetTriggerPlayer(), udg_Asked, bj_ALLIANCE_UNALLIED )
    call SetPlayerAllianceStateBJ( udg_Asked, GetTriggerPlayer(), bj_ALLIANCE_UNALLIED )
endfunction

//===========================================================================
function InitTrig_War takes nothing returns nothing
    set gg_trg_War = CreateTrigger(  )
    call DisableTrigger( gg_trg_War )
    call TriggerRegisterPlayerChatEvent( gg_trg_War, Player(0), "-war", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_War, Player(1), "-war", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_War, Player(2), "-war", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_War, Player(3), "-war", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_War, Player(4), "-war", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_War, Player(5), "-war", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_War, Player(6), "-war", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_War, Player(7), "-war", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_War, Player(8), "-war", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_War, Player(9), "-war", false )
    call TriggerAddCondition( gg_trg_War, Condition( function Trig_War_Conditions ) )
    call TriggerAddAction( gg_trg_War, function Trig_War_Actions )
endfunction

//===========================================================================
// Trigger: War All
//===========================================================================
function Trig_War_All_Func002Func001C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() != ConvertedPlayer(udg_Starting) ) ) then
        return false
    endif
    if ( not ( GetPlayerSlotState(ConvertedPlayer(udg_Starting)) == PLAYER_SLOT_STATE_PLAYING ) ) then
        return false
    endif
    if ( not ( IsPlayerEnemy(ConvertedPlayer(udg_Starting), GetTriggerPlayer()) == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_War_All_Actions takes nothing returns nothing
    set udg_Asker = GetTriggerPlayer()
    set udg_Starting = 1
    loop
        exitwhen udg_Starting > 10
        if ( Trig_War_All_Func002Func001C() ) then
            set udg_Asked = ConvertedPlayer(udg_Starting)
            call DisplayTimedTextToForce( GetForceOfPlayer(udg_Asked), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(GetTriggerPlayer())] + GetPlayerName(GetTriggerPlayer()) ) + "  |cffffcc00has decleared war on you!" ) )
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(udg_Asked)] + GetPlayerName(udg_Asked) ) + "  |cffffcc00has become your enemy!" ) )
                call PlaySoundForPlayer( udg_Asked, gg_snd_Warning )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            call SetPlayerAllianceStateBJ( GetTriggerPlayer(), udg_Asked, bj_ALLIANCE_UNALLIED )
            call SetPlayerAllianceStateBJ( udg_Asked, GetTriggerPlayer(), bj_ALLIANCE_UNALLIED )
        else
        endif
        set udg_Starting = udg_Starting + 1
    endloop
endfunction

//===========================================================================
function InitTrig_War_All takes nothing returns nothing
    set gg_trg_War_All = CreateTrigger(  )
    call DisableTrigger( gg_trg_War_All )
    call TriggerRegisterPlayerChatEvent( gg_trg_War_All, Player(0), "-war all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_War_All, Player(1), "-war all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_War_All, Player(2), "-war all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_War_All, Player(3), "-war all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_War_All, Player(4), "-war all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_War_All, Player(5), "-war all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_War_All, Player(6), "-war all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_War_All, Player(7), "-war all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_War_All, Player(8), "-war all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_War_All, Player(9), "-war all", true )
    call TriggerAddAction( gg_trg_War_All, function Trig_War_All_Actions )
endfunction

//===========================================================================
// Trigger: Truce
//===========================================================================
function Trig_Truce_Func001C takes nothing returns boolean
    if ( ( GetEventPlayerChatString() == "-truce red" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-truce blue" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-truce teal" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-truce purple" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-truce yellow" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-truce orange" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-truce green" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-truce pink" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-truce gray" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-truce grey" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-truce light blue" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-truce lightblue" ) ) then
        return true
    endif
    return false
endfunction

function Trig_Truce_Conditions takes nothing returns boolean
    if ( not Trig_Truce_Func001C() ) then
        return false
    endif
    return true
endfunction

function Trig_Truce_Func002001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-truce red" )
endfunction

function Trig_Truce_Func003001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-truce blue" )
endfunction

function Trig_Truce_Func004001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-truce teal" )
endfunction

function Trig_Truce_Func005001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-truce purple" )
endfunction

function Trig_Truce_Func006001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-truce yellow" )
endfunction

function Trig_Truce_Func007001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-truce orange" )
endfunction

function Trig_Truce_Func008001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-truce green" )
endfunction

function Trig_Truce_Func009001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-truce pink" )
endfunction

function Trig_Truce_Func010001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-truce gray" )
endfunction

function Trig_Truce_Func011001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-truce grey" )
endfunction

function Trig_Truce_Func012001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-truce lightblue" )
endfunction

function Trig_Truce_Func013001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-truce light blue" )
endfunction

function Trig_Truce_Func014C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == udg_Asked ) ) then
        return false
    endif
    return true
endfunction

function Trig_Truce_Func015C takes nothing returns boolean
    if ( not ( GetPlayerSlotState(udg_Asked) != PLAYER_SLOT_STATE_PLAYING ) ) then
        return false
    endif
    return true
endfunction

function Trig_Truce_Func030Func001Func001C takes nothing returns boolean
    if ( not ( IsPlayerEnemy(udg_Asked, GetTriggerPlayer()) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_Truce_Func030Func001C takes nothing returns boolean
    if ( not ( GetPlayerAlliance(udg_Asked, GetTriggerPlayer(), ALLIANCE_PASSIVE) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_Truce_Func030C takes nothing returns boolean
    if ( not ( GetPlayerAlliance(udg_Asked, GetTriggerPlayer(), ALLIANCE_SHARED_VISION) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_Truce_Actions takes nothing returns nothing
    if ( Trig_Truce_Func002001() ) then
        set udg_Asked = Player(0)
    else
        call DoNothing(  )
    endif
    if ( Trig_Truce_Func003001() ) then
        set udg_Asked = Player(1)
    else
        call DoNothing(  )
    endif
    if ( Trig_Truce_Func004001() ) then
        set udg_Asked = Player(2)
    else
        call DoNothing(  )
    endif
    if ( Trig_Truce_Func005001() ) then
        set udg_Asked = Player(3)
    else
        call DoNothing(  )
    endif
    if ( Trig_Truce_Func006001() ) then
        set udg_Asked = Player(4)
    else
        call DoNothing(  )
    endif
    if ( Trig_Truce_Func007001() ) then
        set udg_Asked = Player(5)
    else
        call DoNothing(  )
    endif
    if ( Trig_Truce_Func008001() ) then
        set udg_Asked = Player(6)
    else
        call DoNothing(  )
    endif
    if ( Trig_Truce_Func009001() ) then
        set udg_Asked = Player(7)
    else
        call DoNothing(  )
    endif
    if ( Trig_Truce_Func010001() ) then
        set udg_Asked = Player(8)
    else
        call DoNothing(  )
    endif
    if ( Trig_Truce_Func011001() ) then
        set udg_Asked = Player(8)
    else
        call DoNothing(  )
    endif
    if ( Trig_Truce_Func012001() ) then
        set udg_Asked = Player(9)
    else
        call DoNothing(  )
    endif
    if ( Trig_Truce_Func013001() ) then
        set udg_Asked = Player(9)
    else
        call DoNothing(  )
    endif
    if ( Trig_Truce_Func014C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4665" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_Truce_Func015C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4663" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    call DisplayTimedTextToForce( GetForceOfPlayer(udg_Asked), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(GetTriggerPlayer())] + GetPlayerName(GetTriggerPlayer()) ) + "  |cffffcc00has made a truce pact with you!" ) )
    call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(udg_Asked)] + GetPlayerName(udg_Asked) ) + "  |cffffcc00will not be attacked by your units anymore!" ) )
        call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        call PlaySoundForPlayer( udg_Asked, gg_snd_Warning )
    if ( Trig_Truce_Func030C() ) then
        call SetPlayerAllianceStateBJ( GetTriggerPlayer(), udg_Asked, bj_ALLIANCE_ALLIED )
        call SetPlayerAllianceStateBJ( udg_Asked, GetTriggerPlayer(), bj_ALLIANCE_ALLIED )
    else
        if ( Trig_Truce_Func030Func001C() ) then
            call SetPlayerAllianceStateBJ( GetTriggerPlayer(), udg_Asked, bj_ALLIANCE_ALLIED )
            call SetPlayerAllianceStateBJ( udg_Asked, GetTriggerPlayer(), bj_ALLIANCE_ALLIED )
        else
            if ( Trig_Truce_Func030Func001Func001C() ) then
                call SetPlayerAllianceStateBJ( GetTriggerPlayer(), udg_Asked, bj_ALLIANCE_ALLIED )
            else
            endif
        endif
    endif
endfunction

//===========================================================================
function InitTrig_Truce takes nothing returns nothing
    set gg_trg_Truce = CreateTrigger(  )
    call DisableTrigger( gg_trg_Truce )
    call TriggerRegisterPlayerChatEvent( gg_trg_Truce, Player(0), "-truce", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Truce, Player(1), "-truce", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Truce, Player(2), "-truce", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Truce, Player(3), "-truce", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Truce, Player(4), "-truce", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Truce, Player(5), "-truce", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Truce, Player(6), "-truce", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Truce, Player(7), "-truce", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Truce, Player(8), "-truce", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Truce, Player(9), "-truce", false )
    call TriggerAddCondition( gg_trg_Truce, Condition( function Trig_Truce_Conditions ) )
    call TriggerAddAction( gg_trg_Truce, function Trig_Truce_Actions )
endfunction

//===========================================================================
// Trigger: Truce All
//===========================================================================
function Trig_Truce_All_Func002Func001C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() != ConvertedPlayer(udg_Starting) ) ) then
        return false
    endif
    if ( not ( GetPlayerSlotState(ConvertedPlayer(udg_Starting)) == PLAYER_SLOT_STATE_PLAYING ) ) then
        return false
    endif
    return true
endfunction

function Trig_Truce_All_Actions takes nothing returns nothing
    set udg_Asker = GetTriggerPlayer()
    set udg_Starting = 1
    loop
        exitwhen udg_Starting > 10
        if ( Trig_Truce_All_Func002Func001C() ) then
            set udg_Asked = ConvertedPlayer(udg_Starting)
            call DisplayTimedTextToForce( GetForceOfPlayer(udg_Asked), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(GetTriggerPlayer())] + GetPlayerName(GetTriggerPlayer()) ) + "  |cffffcc00has made a truce pact with you!" ) )
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(udg_Asked)] + GetPlayerName(udg_Asked) ) + "  |cffffcc00will not be attacked by your units anymore!" ) )
                call PlaySoundForPlayer( udg_Asked, gg_snd_Warning )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            call SetPlayerAllianceStateBJ( GetTriggerPlayer(), udg_Asked, bj_ALLIANCE_ALLIED )
        else
        endif
        set udg_Starting = udg_Starting + 1
    endloop
endfunction

//===========================================================================
function InitTrig_Truce_All takes nothing returns nothing
    set gg_trg_Truce_All = CreateTrigger(  )
    call DisableTrigger( gg_trg_Truce_All )
    call TriggerRegisterPlayerChatEvent( gg_trg_Truce_All, Player(0), "-truce all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Truce_All, Player(1), "-truce all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Truce_All, Player(2), "-truce all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Truce_All, Player(3), "-truce all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Truce_All, Player(4), "-truce all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Truce_All, Player(5), "-truce all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Truce_All, Player(6), "-truce all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Truce_All, Player(7), "-truce all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Truce_All, Player(8), "-truce all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Truce_All, Player(9), "-truce all", true )
    call TriggerAddAction( gg_trg_Truce_All, function Trig_Truce_All_Actions )
endfunction

//===========================================================================
// Trigger: Share
//===========================================================================
function Trig_Share_Func001C takes nothing returns boolean
    if ( ( GetEventPlayerChatString() == "-share red" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-share blue" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-share teal" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-share purple" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-share yellow" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-share orange" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-share green" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-share pink" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-share gray" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-share grey" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-share light blue" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-share lightblue" ) ) then
        return true
    endif
    return false
endfunction

function Trig_Share_Conditions takes nothing returns boolean
    if ( not Trig_Share_Func001C() ) then
        return false
    endif
    return true
endfunction

function Trig_Share_Func002001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-share red" )
endfunction

function Trig_Share_Func003001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-share blue" )
endfunction

function Trig_Share_Func004001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-share teal" )
endfunction

function Trig_Share_Func005001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-share purple" )
endfunction

function Trig_Share_Func006001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-share yellow" )
endfunction

function Trig_Share_Func007001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-share orange" )
endfunction

function Trig_Share_Func008001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-share green" )
endfunction

function Trig_Share_Func009001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-share pink" )
endfunction

function Trig_Share_Func010001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-share gray" )
endfunction

function Trig_Share_Func011001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-share grey" )
endfunction

function Trig_Share_Func012001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-share lightblue" )
endfunction

function Trig_Share_Func013001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-share light blue" )
endfunction

function Trig_Share_Func014C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == udg_Asked ) ) then
        return false
    endif
    return true
endfunction

function Trig_Share_Func015C takes nothing returns boolean
    if ( not ( GetPlayerSlotState(udg_Asked) != PLAYER_SLOT_STATE_PLAYING ) ) then
        return false
    endif
    return true
endfunction

function Trig_Share_Func026C takes nothing returns boolean
    if ( not ( IsPlayerEnemy(udg_Asked, GetTriggerPlayer()) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_Share_Actions takes nothing returns nothing
    if ( Trig_Share_Func002001() ) then
        set udg_Asked = Player(0)
    else
        call DoNothing(  )
    endif
    if ( Trig_Share_Func003001() ) then
        set udg_Asked = Player(1)
    else
        call DoNothing(  )
    endif
    if ( Trig_Share_Func004001() ) then
        set udg_Asked = Player(2)
    else
        call DoNothing(  )
    endif
    if ( Trig_Share_Func005001() ) then
        set udg_Asked = Player(3)
    else
        call DoNothing(  )
    endif
    if ( Trig_Share_Func006001() ) then
        set udg_Asked = Player(4)
    else
        call DoNothing(  )
    endif
    if ( Trig_Share_Func007001() ) then
        set udg_Asked = Player(5)
    else
        call DoNothing(  )
    endif
    if ( Trig_Share_Func008001() ) then
        set udg_Asked = Player(6)
    else
        call DoNothing(  )
    endif
    if ( Trig_Share_Func009001() ) then
        set udg_Asked = Player(7)
    else
        call DoNothing(  )
    endif
    if ( Trig_Share_Func010001() ) then
        set udg_Asked = Player(8)
    else
        call DoNothing(  )
    endif
    if ( Trig_Share_Func011001() ) then
        set udg_Asked = Player(8)
    else
        call DoNothing(  )
    endif
    if ( Trig_Share_Func012001() ) then
        set udg_Asked = Player(9)
    else
        call DoNothing(  )
    endif
    if ( Trig_Share_Func013001() ) then
        set udg_Asked = Player(9)
    else
        call DoNothing(  )
    endif
    if ( Trig_Share_Func014C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4668" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_Share_Func015C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4663" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_Share_Func026C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4670" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    call DisplayTimedTextToForce( GetForceOfPlayer(udg_Asked), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(GetTriggerPlayer())] + GetPlayerName(GetTriggerPlayer()) ) + "  |cffffcc00has shared his units with you!" ) )
    call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(udg_Asked)] + GetPlayerName(udg_Asked) ) + "  |cffffcc00has now total control over your units!" ) )
        call PlaySoundForPlayer( udg_Asked, gg_snd_Warning )
        call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
    call SetPlayerAllianceStateBJ( GetTriggerPlayer(), udg_Asked, bj_ALLIANCE_ALLIED_ADVUNITS )
endfunction

//===========================================================================
function InitTrig_Share takes nothing returns nothing
    set gg_trg_Share = CreateTrigger(  )
    call DisableTrigger( gg_trg_Share )
    call TriggerRegisterPlayerChatEvent( gg_trg_Share, Player(0), "-share", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Share, Player(1), "-share", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Share, Player(2), "-share", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Share, Player(3), "-share", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Share, Player(4), "-share", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Share, Player(5), "-share", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Share, Player(6), "-share", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Share, Player(7), "-share", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Share, Player(8), "-share", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Share, Player(9), "-share", false )
    call TriggerAddCondition( gg_trg_Share, Condition( function Trig_Share_Conditions ) )
    call TriggerAddAction( gg_trg_Share, function Trig_Share_Actions )
endfunction

//===========================================================================
// Trigger: Unshare
//===========================================================================
function Trig_Unshare_Func001C takes nothing returns boolean
    if ( ( GetEventPlayerChatString() == "-unshare red" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-unshare blue" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-unshare teal" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-unshare purple" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-unshare yellow" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-unshare orange" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-unshare green" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-unshare pink" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-unshare gray" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-unshare grey" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-unshare light blue" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-unshare lightblue" ) ) then
        return true
    endif
    return false
endfunction

function Trig_Unshare_Conditions takes nothing returns boolean
    if ( not Trig_Unshare_Func001C() ) then
        return false
    endif
    return true
endfunction

function Trig_Unshare_Func002001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-unshare red" )
endfunction

function Trig_Unshare_Func003001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-unshare blue" )
endfunction

function Trig_Unshare_Func004001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-unshare teal" )
endfunction

function Trig_Unshare_Func005001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-unshare purple" )
endfunction

function Trig_Unshare_Func006001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-unshare yellow" )
endfunction

function Trig_Unshare_Func007001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-unshare orange" )
endfunction

function Trig_Unshare_Func008001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-unshare green" )
endfunction

function Trig_Unshare_Func009001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-unshare pink" )
endfunction

function Trig_Unshare_Func010001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-unshare gray" )
endfunction

function Trig_Unshare_Func011001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-unshare grey" )
endfunction

function Trig_Unshare_Func012001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-unshare lightblue" )
endfunction

function Trig_Unshare_Func013001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-unshare light blue" )
endfunction

function Trig_Unshare_Func014C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == udg_Asked ) ) then
        return false
    endif
    return true
endfunction

function Trig_Unshare_Func015C takes nothing returns boolean
    if ( not ( GetPlayerSlotState(udg_Asked) != PLAYER_SLOT_STATE_PLAYING ) ) then
        return false
    endif
    return true
endfunction

function Trig_Unshare_Func026C takes nothing returns boolean
    if ( not ( GetPlayerAlliance(GetTriggerPlayer(), udg_Asked, ALLIANCE_SHARED_CONTROL) == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_Unshare_Actions takes nothing returns nothing
    if ( Trig_Unshare_Func002001() ) then
        set udg_Asked = Player(0)
    else
        call DoNothing(  )
    endif
    if ( Trig_Unshare_Func003001() ) then
        set udg_Asked = Player(1)
    else
        call DoNothing(  )
    endif
    if ( Trig_Unshare_Func004001() ) then
        set udg_Asked = Player(2)
    else
        call DoNothing(  )
    endif
    if ( Trig_Unshare_Func005001() ) then
        set udg_Asked = Player(3)
    else
        call DoNothing(  )
    endif
    if ( Trig_Unshare_Func006001() ) then
        set udg_Asked = Player(4)
    else
        call DoNothing(  )
    endif
    if ( Trig_Unshare_Func007001() ) then
        set udg_Asked = Player(5)
    else
        call DoNothing(  )
    endif
    if ( Trig_Unshare_Func008001() ) then
        set udg_Asked = Player(6)
    else
        call DoNothing(  )
    endif
    if ( Trig_Unshare_Func009001() ) then
        set udg_Asked = Player(7)
    else
        call DoNothing(  )
    endif
    if ( Trig_Unshare_Func010001() ) then
        set udg_Asked = Player(8)
    else
        call DoNothing(  )
    endif
    if ( Trig_Unshare_Func011001() ) then
        set udg_Asked = Player(8)
    else
        call DoNothing(  )
    endif
    if ( Trig_Unshare_Func012001() ) then
        set udg_Asked = Player(9)
    else
        call DoNothing(  )
    endif
    if ( Trig_Unshare_Func013001() ) then
        set udg_Asked = Player(9)
    else
        call DoNothing(  )
    endif
    if ( Trig_Unshare_Func014C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_2020" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_Unshare_Func015C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_2022" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_Unshare_Func026C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_2141" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    call DisplayTimedTextToForce( GetForceOfPlayer(udg_Asked), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(GetTriggerPlayer())] + GetPlayerName(GetTriggerPlayer()) ) + "  |cffffcc00has taken away the shared unit control!" ) )
    call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(udg_Asked)] + GetPlayerName(udg_Asked) ) + "  |cffffcc00has no longer control over your units!" ) )
        call PlaySoundForPlayer( udg_Asked, gg_snd_Warning )
        call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
    call SetPlayerAllianceStateBJ( GetTriggerPlayer(), udg_Asked, bj_ALLIANCE_ALLIED_VISION )
endfunction

//===========================================================================
function InitTrig_Unshare takes nothing returns nothing
    set gg_trg_Unshare = CreateTrigger(  )
    call TriggerRegisterPlayerChatEvent( gg_trg_Unshare, Player(0), "-unshare", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Unshare, Player(1), "-unshare", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Unshare, Player(2), "-unshare", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Unshare, Player(3), "-unshare", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Unshare, Player(4), "-unshare", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Unshare, Player(5), "-unshare", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Unshare, Player(6), "-unshare", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Unshare, Player(7), "-unshare", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Unshare, Player(8), "-unshare", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Unshare, Player(9), "-unshare", false )
    call TriggerAddCondition( gg_trg_Unshare, Condition( function Trig_Unshare_Conditions ) )
    call TriggerAddAction( gg_trg_Unshare, function Trig_Unshare_Actions )
endfunction

//===========================================================================
// Trigger: Ally
//===========================================================================
function Trig_Ally_Func002C takes nothing returns boolean
    if ( ( GetEventPlayerChatString() == "-ally red" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-ally blue" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-ally teal" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-ally purple" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-ally yellow" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-ally orange" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-ally green" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-ally pink" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-ally gray" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-ally grey" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-ally light blue" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-ally lightblue" ) ) then
        return true
    endif
    return false
endfunction

function Trig_Ally_Conditions takes nothing returns boolean
    if ( not Trig_Ally_Func002C() ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Func013001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-ally red" )
endfunction

function Trig_Ally_Func014001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-ally blue" )
endfunction

function Trig_Ally_Func015001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-ally teal" )
endfunction

function Trig_Ally_Func016001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-ally purple" )
endfunction

function Trig_Ally_Func017001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-ally yellow" )
endfunction

function Trig_Ally_Func018001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-ally orange" )
endfunction

function Trig_Ally_Func019001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-ally green" )
endfunction

function Trig_Ally_Func020001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-ally pink" )
endfunction

function Trig_Ally_Func021001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-ally gray" )
endfunction

function Trig_Ally_Func022001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-ally grey" )
endfunction

function Trig_Ally_Func023001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-ally lightblue" )
endfunction

function Trig_Ally_Func024001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-ally light blue" )
endfunction

function Trig_Ally_Func025C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == udg_Asked ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Func026C takes nothing returns boolean
    if ( not ( udg_Playerbussy[GetConvertedPlayerId(udg_Asked)] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Func027C takes nothing returns boolean
    if ( not ( GetPlayerSlotState(udg_Asked) != PLAYER_SLOT_STATE_PLAYING ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Func028C takes nothing returns boolean
    if ( not ( GetPlayerAlliance(GetTriggerPlayer(), udg_Asked, ALLIANCE_SHARED_VISION) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Func029Func001C takes nothing returns boolean
    if ( not ( udg_Ignore1[GetConvertedPlayerId(GetTriggerPlayer())] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Func029C takes nothing returns boolean
    if ( not ( udg_Asked == Player(0) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Func030Func001C takes nothing returns boolean
    if ( not ( udg_Ignore2[GetConvertedPlayerId(GetTriggerPlayer())] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Func030C takes nothing returns boolean
    if ( not ( udg_Asked == Player(1) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Func031Func001C takes nothing returns boolean
    if ( not ( udg_Ignore3[GetConvertedPlayerId(GetTriggerPlayer())] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Func031C takes nothing returns boolean
    if ( not ( udg_Asked == Player(2) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Func032Func001C takes nothing returns boolean
    if ( not ( udg_Ignore4[GetConvertedPlayerId(GetTriggerPlayer())] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Func032C takes nothing returns boolean
    if ( not ( udg_Asked == Player(3) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Func033Func001C takes nothing returns boolean
    if ( not ( udg_Ignore5[GetConvertedPlayerId(GetTriggerPlayer())] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Func033C takes nothing returns boolean
    if ( not ( udg_Asked == Player(4) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Func034Func001C takes nothing returns boolean
    if ( not ( udg_Ignore6[GetConvertedPlayerId(GetTriggerPlayer())] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Func034C takes nothing returns boolean
    if ( not ( udg_Asked == Player(5) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Func035Func001C takes nothing returns boolean
    if ( not ( udg_Ignore7[GetConvertedPlayerId(GetTriggerPlayer())] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Func035C takes nothing returns boolean
    if ( not ( udg_Asked == Player(6) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Func036Func001C takes nothing returns boolean
    if ( not ( udg_Ignore8[GetConvertedPlayerId(GetTriggerPlayer())] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Func036C takes nothing returns boolean
    if ( not ( udg_Asked == Player(7) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Func037Func001C takes nothing returns boolean
    if ( not ( udg_Ignore9[GetConvertedPlayerId(GetTriggerPlayer())] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Func037C takes nothing returns boolean
    if ( not ( udg_Asked == Player(8) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Func038Func001C takes nothing returns boolean
    if ( not ( udg_Ignore10[GetConvertedPlayerId(GetTriggerPlayer())] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Func038C takes nothing returns boolean
    if ( not ( udg_Asked == Player(9) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_Actions takes nothing returns nothing
    set udg_Asker = GetTriggerPlayer()
    if ( Trig_Ally_Func013001() ) then
        set udg_Asked = Player(0)
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func014001() ) then
        set udg_Asked = Player(1)
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func015001() ) then
        set udg_Asked = Player(2)
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func016001() ) then
        set udg_Asked = Player(3)
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func017001() ) then
        set udg_Asked = Player(4)
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func018001() ) then
        set udg_Asked = Player(5)
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func019001() ) then
        set udg_Asked = Player(6)
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func020001() ) then
        set udg_Asked = Player(7)
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func021001() ) then
        set udg_Asked = Player(8)
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func022001() ) then
        set udg_Asked = Player(8)
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func023001() ) then
        set udg_Asked = Player(9)
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func024001() ) then
        set udg_Asked = Player(9)
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func025C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4671" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func026C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(udg_Asked)] + GetPlayerName(udg_Asked) ) + "  |cffffcc00is currently considering another ally proposal." ) )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func027C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4663" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func028C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4673" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func029C() ) then
        if ( Trig_Ally_Func029Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4674" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            call DoNothing(  )
        endif
        call DialogClearBJ( udg_HeroAlly1 )
        call DialogSetMessageBJ( udg_HeroAlly1, ( GetPlayerName(udg_Asker) + " wants to ally you!" ) )
        call DialogAddButtonBJ( udg_HeroAlly1, "TRIGSTR_4675" )
        set udg_HeroAllyButtons[12] = GetLastCreatedButtonBJ()
        call DialogAddButtonBJ( udg_HeroAlly1, "TRIGSTR_4676" )
        set udg_HeroAllyButtons[11] = GetLastCreatedButtonBJ()
        call DialogDisplayBJ( true, udg_HeroAlly1, udg_Asked )
        set udg_asking[1] = udg_Asker
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func030C() ) then
        if ( Trig_Ally_Func030Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4674" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            call DoNothing(  )
        endif
        call DialogClearBJ( udg_HeroAlly2 )
        call DialogSetMessageBJ( udg_HeroAlly2, ( GetPlayerName(udg_Asker) + " wants to ally you!" ) )
        call DialogAddButtonBJ( udg_HeroAlly2, "TRIGSTR_4675" )
        set udg_HeroAllyButtons[22] = GetLastCreatedButtonBJ()
        call DialogAddButtonBJ( udg_HeroAlly2, "TRIGSTR_4676" )
        set udg_HeroAllyButtons[21] = GetLastCreatedButtonBJ()
        call DialogDisplayBJ( true, udg_HeroAlly2, udg_Asked )
        set udg_asking[2] = udg_Asker
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func031C() ) then
        if ( Trig_Ally_Func031Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4674" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            call DoNothing(  )
        endif
        call DialogClearBJ( udg_HeroAlly3 )
        call DialogSetMessageBJ( udg_HeroAlly3, ( GetPlayerName(udg_Asker) + " wants to ally you!" ) )
        call DialogAddButtonBJ( udg_HeroAlly3, "TRIGSTR_4675" )
        set udg_HeroAllyButtons[32] = GetLastCreatedButtonBJ()
        call DialogAddButtonBJ( udg_HeroAlly3, "TRIGSTR_4676" )
        set udg_HeroAllyButtons[31] = GetLastCreatedButtonBJ()
        call DialogDisplayBJ( true, udg_HeroAlly3, udg_Asked )
        set udg_asking[3] = udg_Asker
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func032C() ) then
        if ( Trig_Ally_Func032Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4674" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            call DoNothing(  )
        endif
        call DialogClearBJ( udg_HeroAlly4 )
        call DialogSetMessageBJ( udg_HeroAlly4, ( GetPlayerName(udg_Asker) + " wants to ally you!" ) )
        call DialogAddButtonBJ( udg_HeroAlly4, "TRIGSTR_4675" )
        set udg_HeroAllyButtons[42] = GetLastCreatedButtonBJ()
        call DialogAddButtonBJ( udg_HeroAlly4, "TRIGSTR_4676" )
        set udg_HeroAllyButtons[41] = GetLastCreatedButtonBJ()
        call DialogDisplayBJ( true, udg_HeroAlly4, udg_Asked )
        set udg_asking[4] = udg_Asker
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func033C() ) then
        if ( Trig_Ally_Func033Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4674" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            call DoNothing(  )
        endif
        call DialogClearBJ( udg_HeroAlly5 )
        call DialogSetMessageBJ( udg_HeroAlly5, ( GetPlayerName(udg_Asker) + " wants to ally you!" ) )
        call DialogAddButtonBJ( udg_HeroAlly5, "TRIGSTR_4675" )
        set udg_HeroAllyButtons[52] = GetLastCreatedButtonBJ()
        call DialogAddButtonBJ( udg_HeroAlly5, "TRIGSTR_4676" )
        set udg_HeroAllyButtons[51] = GetLastCreatedButtonBJ()
        call DialogDisplayBJ( true, udg_HeroAlly5, udg_Asked )
        set udg_asking[5] = udg_Asker
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func034C() ) then
        if ( Trig_Ally_Func034Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4674" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            call DoNothing(  )
        endif
        call DialogClearBJ( udg_HeroAlly6 )
        call DialogSetMessageBJ( udg_HeroAlly6, ( GetPlayerName(udg_Asker) + " wants to ally you!" ) )
        call DialogAddButtonBJ( udg_HeroAlly6, "TRIGSTR_4675" )
        set udg_HeroAllyButtons[62] = GetLastCreatedButtonBJ()
        call DialogAddButtonBJ( udg_HeroAlly6, "TRIGSTR_4676" )
        set udg_HeroAllyButtons[61] = GetLastCreatedButtonBJ()
        call DialogDisplayBJ( true, udg_HeroAlly6, udg_Asked )
        set udg_asking[6] = udg_Asker
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func035C() ) then
        if ( Trig_Ally_Func035Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4674" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            call DoNothing(  )
        endif
        call DialogClearBJ( udg_HeroAlly7 )
        call DialogSetMessageBJ( udg_HeroAlly7, ( GetPlayerName(udg_Asker) + " wants to ally you!" ) )
        call DialogAddButtonBJ( udg_HeroAlly7, "TRIGSTR_4675" )
        set udg_HeroAllyButtons[72] = GetLastCreatedButtonBJ()
        call DialogAddButtonBJ( udg_HeroAlly7, "TRIGSTR_4676" )
        set udg_HeroAllyButtons[71] = GetLastCreatedButtonBJ()
        call DialogDisplayBJ( true, udg_HeroAlly7, udg_Asked )
        set udg_asking[7] = udg_Asker
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func036C() ) then
        if ( Trig_Ally_Func036Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4674" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            call DoNothing(  )
        endif
        call DialogClearBJ( udg_HeroAlly8 )
        call DialogSetMessageBJ( udg_HeroAlly8, ( GetPlayerName(udg_Asker) + " wants to ally you!" ) )
        call DialogAddButtonBJ( udg_HeroAlly8, "TRIGSTR_4675" )
        set udg_HeroAllyButtons[82] = GetLastCreatedButtonBJ()
        call DialogAddButtonBJ( udg_HeroAlly8, "TRIGSTR_4676" )
        set udg_HeroAllyButtons[81] = GetLastCreatedButtonBJ()
        call DialogDisplayBJ( true, udg_HeroAlly8, udg_Asked )
        set udg_asking[8] = udg_Asker
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func037C() ) then
        if ( Trig_Ally_Func037Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4674" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            call DoNothing(  )
        endif
        call DialogClearBJ( udg_HeroAlly9 )
        call DialogSetMessageBJ( udg_HeroAlly9, ( GetPlayerName(udg_Asker) + " wants to ally you!" ) )
        call DialogAddButtonBJ( udg_HeroAlly9, "TRIGSTR_4675" )
        set udg_HeroAllyButtons[92] = GetLastCreatedButtonBJ()
        call DialogAddButtonBJ( udg_HeroAlly9, "TRIGSTR_4676" )
        set udg_HeroAllyButtons[91] = GetLastCreatedButtonBJ()
        call DialogDisplayBJ( true, udg_HeroAlly9, udg_Asked )
        set udg_asking[9] = udg_Asker
    else
        call DoNothing(  )
    endif
    if ( Trig_Ally_Func038C() ) then
        if ( Trig_Ally_Func038Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4674" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            call DoNothing(  )
        endif
        call DialogClearBJ( udg_HeroAlly10 )
        call DialogSetMessageBJ( udg_HeroAlly10, ( GetPlayerName(udg_Asker) + " wants to ally you!" ) )
        call DialogAddButtonBJ( udg_HeroAlly10, "TRIGSTR_4675" )
        set udg_HeroAllyButtons[102] = GetLastCreatedButtonBJ()
        call DialogAddButtonBJ( udg_HeroAlly10, "TRIGSTR_4676" )
        set udg_HeroAllyButtons[101] = GetLastCreatedButtonBJ()
        call DialogDisplayBJ( true, udg_HeroAlly10, udg_Asked )
        set udg_asking[10] = udg_Asker
    else
        call DoNothing(  )
    endif
    set udg_Playerbussy[GetConvertedPlayerId(udg_Asked)] = 1
endfunction

//===========================================================================
function InitTrig_Ally takes nothing returns nothing
    set gg_trg_Ally = CreateTrigger(  )
    call DisableTrigger( gg_trg_Ally )
    call TriggerRegisterPlayerChatEvent( gg_trg_Ally, Player(0), "-ally ", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Ally, Player(1), "-ally ", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Ally, Player(2), "-ally ", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Ally, Player(3), "-ally ", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Ally, Player(4), "-ally ", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Ally, Player(5), "-ally ", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Ally, Player(6), "-ally ", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Ally, Player(7), "-ally ", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Ally, Player(8), "-ally ", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Ally, Player(9), "-ally ", false )
    call TriggerAddCondition( gg_trg_Ally, Condition( function Trig_Ally_Conditions ) )
    call TriggerAddAction( gg_trg_Ally, function Trig_Ally_Actions )
endfunction

//===========================================================================
// Trigger: Ally All
//===========================================================================
function Trig_Ally_All_Func002Func001Func002Func001C takes nothing returns boolean
    if ( not ( udg_Ignore1[GetConvertedPlayerId(GetTriggerPlayer())] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_All_Func002Func001Func002C takes nothing returns boolean
    if ( not ( udg_Asked == Player(0) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_All_Func002Func001Func003Func001C takes nothing returns boolean
    if ( not ( udg_Ignore2[GetConvertedPlayerId(GetTriggerPlayer())] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_All_Func002Func001Func003C takes nothing returns boolean
    if ( not ( udg_Asked == Player(1) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_All_Func002Func001Func004Func001C takes nothing returns boolean
    if ( not ( udg_Ignore3[GetConvertedPlayerId(GetTriggerPlayer())] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_All_Func002Func001Func004C takes nothing returns boolean
    if ( not ( udg_Asked == Player(2) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_All_Func002Func001Func005Func001C takes nothing returns boolean
    if ( not ( udg_Ignore4[GetConvertedPlayerId(GetTriggerPlayer())] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_All_Func002Func001Func005C takes nothing returns boolean
    if ( not ( udg_Asked == Player(3) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_All_Func002Func001Func006Func001C takes nothing returns boolean
    if ( not ( udg_Ignore5[GetConvertedPlayerId(GetTriggerPlayer())] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_All_Func002Func001Func006C takes nothing returns boolean
    if ( not ( udg_Asked == Player(4) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_All_Func002Func001Func007Func001C takes nothing returns boolean
    if ( not ( udg_Ignore6[GetConvertedPlayerId(GetTriggerPlayer())] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_All_Func002Func001Func007C takes nothing returns boolean
    if ( not ( udg_Asked == Player(5) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_All_Func002Func001Func008Func001C takes nothing returns boolean
    if ( not ( udg_Ignore7[GetConvertedPlayerId(GetTriggerPlayer())] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_All_Func002Func001Func008C takes nothing returns boolean
    if ( not ( udg_Asked == Player(6) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_All_Func002Func001Func009Func001C takes nothing returns boolean
    if ( not ( udg_Ignore8[GetConvertedPlayerId(GetTriggerPlayer())] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_All_Func002Func001Func009C takes nothing returns boolean
    if ( not ( udg_Asked == Player(7) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_All_Func002Func001Func010Func001C takes nothing returns boolean
    if ( not ( udg_Ignore9[GetConvertedPlayerId(GetTriggerPlayer())] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_All_Func002Func001Func010C takes nothing returns boolean
    if ( not ( udg_Asked == Player(8) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_All_Func002Func001Func011Func001C takes nothing returns boolean
    if ( not ( udg_Ignore10[GetConvertedPlayerId(GetTriggerPlayer())] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_All_Func002Func001Func011C takes nothing returns boolean
    if ( not ( udg_Asked == Player(9) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_All_Func002Func001C takes nothing returns boolean
    if ( not ( GetPlayerSlotState(ConvertedPlayer(udg_Starting)) == PLAYER_SLOT_STATE_PLAYING ) ) then
        return false
    endif
    if ( not ( GetTriggerPlayer() != ConvertedPlayer(udg_Starting) ) ) then
        return false
    endif
    if ( not ( GetPlayerAlliance(GetTriggerPlayer(), ConvertedPlayer(udg_Starting), ALLIANCE_SHARED_VISION) == false ) ) then
        return false
    endif
    if ( not ( udg_Playerbussy[udg_Starting] == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ally_All_Actions takes nothing returns nothing
    set udg_Asker = GetTriggerPlayer()
    set udg_Starting = 1
    loop
        exitwhen udg_Starting > 10
        if ( Trig_Ally_All_Func002Func001C() ) then
            set udg_Asked = ConvertedPlayer(udg_Starting)
            if ( Trig_Ally_All_Func002Func001Func002C() ) then
                if ( Trig_Ally_All_Func002Func001Func002Func001C() ) then
                    call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4674" )
                        call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
                    return
                else
                    call DoNothing(  )
                endif
                call DialogClearBJ( udg_HeroAlly1 )
                call DialogSetMessageBJ( udg_HeroAlly1, ( GetPlayerName(udg_Asker) + " wants to ally you!" ) )
                call DialogAddButtonBJ( udg_HeroAlly1, "TRIGSTR_4675" )
                set udg_HeroAllyButtons[12] = GetLastCreatedButtonBJ()
                call DialogAddButtonBJ( udg_HeroAlly1, "TRIGSTR_4676" )
                set udg_HeroAllyButtons[11] = GetLastCreatedButtonBJ()
                call DialogDisplayBJ( true, udg_HeroAlly1, udg_Asked )
                set udg_asking[1] = udg_Asker
            else
                call DoNothing(  )
            endif
            if ( Trig_Ally_All_Func002Func001Func003C() ) then
                if ( Trig_Ally_All_Func002Func001Func003Func001C() ) then
                    call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4674" )
                        call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
                    return
                else
                    call DoNothing(  )
                endif
                call DialogClearBJ( udg_HeroAlly2 )
                call DialogSetMessageBJ( udg_HeroAlly2, ( GetPlayerName(udg_Asker) + " wants to ally you!" ) )
                call DialogAddButtonBJ( udg_HeroAlly2, "TRIGSTR_4675" )
                set udg_HeroAllyButtons[22] = GetLastCreatedButtonBJ()
                call DialogAddButtonBJ( udg_HeroAlly2, "TRIGSTR_4676" )
                set udg_HeroAllyButtons[21] = GetLastCreatedButtonBJ()
                call DialogDisplayBJ( true, udg_HeroAlly2, udg_Asked )
                set udg_asking[2] = udg_Asker
            else
                call DoNothing(  )
            endif
            if ( Trig_Ally_All_Func002Func001Func004C() ) then
                if ( Trig_Ally_All_Func002Func001Func004Func001C() ) then
                    call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4674" )
                        call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
                    return
                else
                    call DoNothing(  )
                endif
                call DialogClearBJ( udg_HeroAlly3 )
                call DialogSetMessageBJ( udg_HeroAlly3, ( GetPlayerName(udg_Asker) + " wants to ally you!" ) )
                call DialogAddButtonBJ( udg_HeroAlly3, "TRIGSTR_4675" )
                set udg_HeroAllyButtons[32] = GetLastCreatedButtonBJ()
                call DialogAddButtonBJ( udg_HeroAlly3, "TRIGSTR_4676" )
                set udg_HeroAllyButtons[31] = GetLastCreatedButtonBJ()
                call DialogDisplayBJ( true, udg_HeroAlly3, udg_Asked )
                set udg_asking[3] = udg_Asker
            else
                call DoNothing(  )
            endif
            if ( Trig_Ally_All_Func002Func001Func005C() ) then
                if ( Trig_Ally_All_Func002Func001Func005Func001C() ) then
                    call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4674" )
                        call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
                    return
                else
                    call DoNothing(  )
                endif
                call DialogClearBJ( udg_HeroAlly4 )
                call DialogSetMessageBJ( udg_HeroAlly4, ( GetPlayerName(udg_Asker) + " wants to ally you!" ) )
                call DialogAddButtonBJ( udg_HeroAlly4, "TRIGSTR_4675" )
                set udg_HeroAllyButtons[42] = GetLastCreatedButtonBJ()
                call DialogAddButtonBJ( udg_HeroAlly4, "TRIGSTR_4676" )
                set udg_HeroAllyButtons[41] = GetLastCreatedButtonBJ()
                call DialogDisplayBJ( true, udg_HeroAlly4, udg_Asked )
                set udg_asking[4] = udg_Asker
            else
                call DoNothing(  )
            endif
            if ( Trig_Ally_All_Func002Func001Func006C() ) then
                if ( Trig_Ally_All_Func002Func001Func006Func001C() ) then
                    call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4674" )
                        call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
                    return
                else
                    call DoNothing(  )
                endif
                call DialogClearBJ( udg_HeroAlly5 )
                call DialogSetMessageBJ( udg_HeroAlly5, ( GetPlayerName(udg_Asker) + " wants to ally you!" ) )
                call DialogAddButtonBJ( udg_HeroAlly5, "TRIGSTR_4675" )
                set udg_HeroAllyButtons[52] = GetLastCreatedButtonBJ()
                call DialogAddButtonBJ( udg_HeroAlly5, "TRIGSTR_4676" )
                set udg_HeroAllyButtons[51] = GetLastCreatedButtonBJ()
                call DialogDisplayBJ( true, udg_HeroAlly5, udg_Asked )
                set udg_asking[5] = udg_Asker
            else
                call DoNothing(  )
            endif
            if ( Trig_Ally_All_Func002Func001Func007C() ) then
                if ( Trig_Ally_All_Func002Func001Func007Func001C() ) then
                    call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4674" )
                        call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
                    return
                else
                    call DoNothing(  )
                endif
                call DialogClearBJ( udg_HeroAlly6 )
                call DialogSetMessageBJ( udg_HeroAlly6, ( GetPlayerName(udg_Asker) + " wants to ally you!" ) )
                call DialogAddButtonBJ( udg_HeroAlly6, "TRIGSTR_4675" )
                set udg_HeroAllyButtons[62] = GetLastCreatedButtonBJ()
                call DialogAddButtonBJ( udg_HeroAlly6, "TRIGSTR_4676" )
                set udg_HeroAllyButtons[61] = GetLastCreatedButtonBJ()
                call DialogDisplayBJ( true, udg_HeroAlly6, udg_Asked )
                set udg_asking[6] = udg_Asker
            else
                call DoNothing(  )
            endif
            if ( Trig_Ally_All_Func002Func001Func008C() ) then
                if ( Trig_Ally_All_Func002Func001Func008Func001C() ) then
                    call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4674" )
                        call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
                    return
                else
                    call DoNothing(  )
                endif
                call DialogClearBJ( udg_HeroAlly7 )
                call DialogSetMessageBJ( udg_HeroAlly7, ( GetPlayerName(udg_Asker) + " wants to ally you!" ) )
                call DialogAddButtonBJ( udg_HeroAlly7, "TRIGSTR_4675" )
                set udg_HeroAllyButtons[72] = GetLastCreatedButtonBJ()
                call DialogAddButtonBJ( udg_HeroAlly7, "TRIGSTR_4676" )
                set udg_HeroAllyButtons[71] = GetLastCreatedButtonBJ()
                call DialogDisplayBJ( true, udg_HeroAlly7, udg_Asked )
                set udg_asking[7] = udg_Asker
            else
                call DoNothing(  )
            endif
            if ( Trig_Ally_All_Func002Func001Func009C() ) then
                if ( Trig_Ally_All_Func002Func001Func009Func001C() ) then
                    call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4674" )
                        call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
                    return
                else
                    call DoNothing(  )
                endif
                call DialogClearBJ( udg_HeroAlly8 )
                call DialogSetMessageBJ( udg_HeroAlly8, ( GetPlayerName(udg_Asker) + " wants to ally you!" ) )
                call DialogAddButtonBJ( udg_HeroAlly8, "TRIGSTR_4675" )
                set udg_HeroAllyButtons[82] = GetLastCreatedButtonBJ()
                call DialogAddButtonBJ( udg_HeroAlly8, "TRIGSTR_4676" )
                set udg_HeroAllyButtons[81] = GetLastCreatedButtonBJ()
                call DialogDisplayBJ( true, udg_HeroAlly8, udg_Asked )
                set udg_asking[8] = udg_Asker
            else
                call DoNothing(  )
            endif
            if ( Trig_Ally_All_Func002Func001Func010C() ) then
                if ( Trig_Ally_All_Func002Func001Func010Func001C() ) then
                    call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4674" )
                        call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
                    return
                else
                    call DoNothing(  )
                endif
                call DialogClearBJ( udg_HeroAlly9 )
                call DialogSetMessageBJ( udg_HeroAlly9, ( GetPlayerName(udg_Asker) + " wants to ally you!" ) )
                call DialogAddButtonBJ( udg_HeroAlly9, "TRIGSTR_4675" )
                set udg_HeroAllyButtons[92] = GetLastCreatedButtonBJ()
                call DialogAddButtonBJ( udg_HeroAlly9, "TRIGSTR_4676" )
                set udg_HeroAllyButtons[91] = GetLastCreatedButtonBJ()
                call DialogDisplayBJ( true, udg_HeroAlly9, udg_Asked )
                set udg_asking[9] = udg_Asker
            else
                call DoNothing(  )
            endif
            if ( Trig_Ally_All_Func002Func001Func011C() ) then
                if ( Trig_Ally_All_Func002Func001Func011Func001C() ) then
                    call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4674" )
                        call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
                    return
                else
                    call DoNothing(  )
                endif
                call DialogClearBJ( udg_HeroAlly10 )
                call DialogSetMessageBJ( udg_HeroAlly10, ( GetPlayerName(udg_Asker) + " wants to ally you!" ) )
                call DialogAddButtonBJ( udg_HeroAlly10, "TRIGSTR_4675" )
                set udg_HeroAllyButtons[102] = GetLastCreatedButtonBJ()
                call DialogAddButtonBJ( udg_HeroAlly10, "TRIGSTR_4676" )
                set udg_HeroAllyButtons[101] = GetLastCreatedButtonBJ()
                call DialogDisplayBJ( true, udg_HeroAlly10, udg_Asked )
                set udg_asking[10] = udg_Asker
            else
                call DoNothing(  )
            endif
            set udg_Playerbussy[udg_Starting] = 1
        else
            call DoNothing(  )
        endif
        set udg_Starting = udg_Starting + 1
    endloop
endfunction

//===========================================================================
function InitTrig_Ally_All takes nothing returns nothing
    set gg_trg_Ally_All = CreateTrigger(  )
    call DisableTrigger( gg_trg_Ally_All )
    call TriggerRegisterPlayerChatEvent( gg_trg_Ally_All, Player(0), "-ally all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Ally_All, Player(1), "-ally all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Ally_All, Player(2), "-ally all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Ally_All, Player(3), "-ally all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Ally_All, Player(4), "-ally all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Ally_All, Player(5), "-ally all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Ally_All, Player(6), "-ally all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Ally_All, Player(7), "-ally all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Ally_All, Player(8), "-ally all", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Ally_All, Player(9), "-ally all", true )
    call TriggerAddAction( gg_trg_Ally_All, function Trig_Ally_All_Actions )
endfunction

//===========================================================================
// Trigger: ignore
//===========================================================================
function Trig_ignore_Func030C takes nothing returns boolean
    if ( ( GetEventPlayerChatString() == "-ignore red" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-ignore blue" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-ignore teal" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-ignore purple" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-ignore yellow" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-ignore orange" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-ignore green" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-ignore pink" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-ignore gray" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-ignore grey" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-ignore light blue" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-ignore lightblue" ) ) then
        return true
    endif
    return false
endfunction

function Trig_ignore_Conditions takes nothing returns boolean
    if ( not Trig_ignore_Func030C() ) then
        return false
    endif
    return true
endfunction

function Trig_ignore_Func001001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-ignore red" )
endfunction

function Trig_ignore_Func002001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-ignore blue" )
endfunction

function Trig_ignore_Func003001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-ignore teal" )
endfunction

function Trig_ignore_Func004001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-ignore purple" )
endfunction

function Trig_ignore_Func005001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-ignore yellow" )
endfunction

function Trig_ignore_Func006001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-ignore orange" )
endfunction

function Trig_ignore_Func007001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-ignore green" )
endfunction

function Trig_ignore_Func008001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-ignore pink" )
endfunction

function Trig_ignore_Func009001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-ignore gray" )
endfunction

function Trig_ignore_Func010001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-ignore grey" )
endfunction

function Trig_ignore_Func011001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-ignore lightblue" )
endfunction

function Trig_ignore_Func012001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-ignore light blue" )
endfunction

function Trig_ignore_Func013C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == udg_Asked ) ) then
        return false
    endif
    return true
endfunction

function Trig_ignore_Func014C takes nothing returns boolean
    if ( not ( GetPlayerSlotState(udg_Asked) != PLAYER_SLOT_STATE_PLAYING ) ) then
        return false
    endif
    return true
endfunction

function Trig_ignore_Func015C takes nothing returns boolean
    if ( not ( IsPlayerAlly(udg_Asked, GetTriggerPlayer()) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_ignore_Func016Func001C takes nothing returns boolean
    if ( not ( udg_Ignore1[GetConvertedPlayerId(udg_Asked)] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_ignore_Func016C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == Player(0) ) ) then
        return false
    endif
    return true
endfunction

function Trig_ignore_Func017Func001C takes nothing returns boolean
    if ( not ( udg_Ignore2[GetConvertedPlayerId(udg_Asked)] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_ignore_Func017C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == Player(1) ) ) then
        return false
    endif
    return true
endfunction

function Trig_ignore_Func018Func001C takes nothing returns boolean
    if ( not ( udg_Ignore3[GetConvertedPlayerId(udg_Asked)] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_ignore_Func018C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == Player(2) ) ) then
        return false
    endif
    return true
endfunction

function Trig_ignore_Func019Func001C takes nothing returns boolean
    if ( not ( udg_Ignore4[GetConvertedPlayerId(udg_Asked)] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_ignore_Func019C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == Player(3) ) ) then
        return false
    endif
    return true
endfunction

function Trig_ignore_Func020Func001C takes nothing returns boolean
    if ( not ( udg_Ignore5[GetConvertedPlayerId(udg_Asked)] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_ignore_Func020C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == Player(4) ) ) then
        return false
    endif
    return true
endfunction

function Trig_ignore_Func021Func001C takes nothing returns boolean
    if ( not ( udg_Ignore6[GetConvertedPlayerId(udg_Asked)] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_ignore_Func021C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == Player(5) ) ) then
        return false
    endif
    return true
endfunction

function Trig_ignore_Func022Func001C takes nothing returns boolean
    if ( not ( udg_Ignore7[GetConvertedPlayerId(udg_Asked)] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_ignore_Func022C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == Player(6) ) ) then
        return false
    endif
    return true
endfunction

function Trig_ignore_Func023Func001C takes nothing returns boolean
    if ( not ( udg_Ignore8[GetConvertedPlayerId(udg_Asked)] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_ignore_Func023C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == Player(7) ) ) then
        return false
    endif
    return true
endfunction

function Trig_ignore_Func024Func001C takes nothing returns boolean
    if ( not ( udg_Ignore9[GetConvertedPlayerId(udg_Asked)] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_ignore_Func024C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == Player(8) ) ) then
        return false
    endif
    return true
endfunction

function Trig_ignore_Func025Func001C takes nothing returns boolean
    if ( not ( udg_Ignore10[GetConvertedPlayerId(udg_Asked)] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_ignore_Func025C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == Player(9) ) ) then
        return false
    endif
    return true
endfunction

function Trig_ignore_Actions takes nothing returns nothing
    if ( Trig_ignore_Func001001() ) then
        set udg_Asked = Player(0)
    else
        call DoNothing(  )
    endif
    if ( Trig_ignore_Func002001() ) then
        set udg_Asked = Player(1)
    else
        call DoNothing(  )
    endif
    if ( Trig_ignore_Func003001() ) then
        set udg_Asked = Player(2)
    else
        call DoNothing(  )
    endif
    if ( Trig_ignore_Func004001() ) then
        set udg_Asked = Player(3)
    else
        call DoNothing(  )
    endif
    if ( Trig_ignore_Func005001() ) then
        set udg_Asked = Player(4)
    else
        call DoNothing(  )
    endif
    if ( Trig_ignore_Func006001() ) then
        set udg_Asked = Player(5)
    else
        call DoNothing(  )
    endif
    if ( Trig_ignore_Func007001() ) then
        set udg_Asked = Player(6)
    else
        call DoNothing(  )
    endif
    if ( Trig_ignore_Func008001() ) then
        set udg_Asked = Player(7)
    else
        call DoNothing(  )
    endif
    if ( Trig_ignore_Func009001() ) then
        set udg_Asked = Player(8)
    else
        call DoNothing(  )
    endif
    if ( Trig_ignore_Func010001() ) then
        set udg_Asked = Player(8)
    else
        call DoNothing(  )
    endif
    if ( Trig_ignore_Func011001() ) then
        set udg_Asked = Player(9)
    else
        call DoNothing(  )
    endif
    if ( Trig_ignore_Func012001() ) then
        set udg_Asked = Player(9)
    else
        call DoNothing(  )
    endif
    if ( Trig_ignore_Func013C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4754" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_ignore_Func014C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4663" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_ignore_Func015C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4673" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_ignore_Func016C() ) then
        if ( Trig_ignore_Func016Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4758" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            set udg_Ignore1[GetConvertedPlayerId(udg_Asked)] = 1
        endif
    else
    endif
    if ( Trig_ignore_Func017C() ) then
        if ( Trig_ignore_Func017Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4758" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            set udg_Ignore2[GetConvertedPlayerId(udg_Asked)] = 1
        endif
    else
    endif
    if ( Trig_ignore_Func018C() ) then
        if ( Trig_ignore_Func018Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4758" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            set udg_Ignore3[GetConvertedPlayerId(udg_Asked)] = 1
        endif
    else
    endif
    if ( Trig_ignore_Func019C() ) then
        if ( Trig_ignore_Func019Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4758" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            set udg_Ignore4[GetConvertedPlayerId(udg_Asked)] = 1
        endif
    else
    endif
    if ( Trig_ignore_Func020C() ) then
        if ( Trig_ignore_Func020Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4758" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            set udg_Ignore5[GetConvertedPlayerId(udg_Asked)] = 1
        endif
    else
    endif
    if ( Trig_ignore_Func021C() ) then
        if ( Trig_ignore_Func021Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4758" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            set udg_Ignore6[GetConvertedPlayerId(udg_Asked)] = 1
        endif
    else
    endif
    if ( Trig_ignore_Func022C() ) then
        if ( Trig_ignore_Func022Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4758" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            set udg_Ignore7[GetConvertedPlayerId(udg_Asked)] = 1
        endif
    else
    endif
    if ( Trig_ignore_Func023C() ) then
        if ( Trig_ignore_Func023Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4758" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            set udg_Ignore8[GetConvertedPlayerId(udg_Asked)] = 1
        endif
    else
    endif
    if ( Trig_ignore_Func024C() ) then
        if ( Trig_ignore_Func024Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4758" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            set udg_Ignore9[GetConvertedPlayerId(udg_Asked)] = 1
        endif
    else
    endif
    if ( Trig_ignore_Func025C() ) then
        if ( Trig_ignore_Func025Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4758" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            set udg_Ignore10[GetConvertedPlayerId(udg_Asked)] = 1
        endif
    else
    endif
    call DisplayTimedTextToForce( GetForceOfPlayer(udg_Asked), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(GetTriggerPlayer())] + GetPlayerName(GetTriggerPlayer()) ) + "  |cffffcc00has put you on his ignore list!" ) )
    call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(udg_Asked)] + GetPlayerName(udg_Asked) ) + "  |cffffcc00has been put on your ignore list!" ) )
        call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        call PlaySoundForPlayer( udg_Asked, gg_snd_Warning )
endfunction

//===========================================================================
function InitTrig_ignore takes nothing returns nothing
    set gg_trg_ignore = CreateTrigger(  )
    call DisableTrigger( gg_trg_ignore )
    call TriggerRegisterPlayerChatEvent( gg_trg_ignore, Player(0), "-ignore", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_ignore, Player(1), "-ignore", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_ignore, Player(2), "-ignore", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_ignore, Player(3), "-ignore", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_ignore, Player(4), "-ignore", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_ignore, Player(5), "-ignore", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_ignore, Player(6), "-ignore", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_ignore, Player(7), "-ignore", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_ignore, Player(8), "-ignore", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_ignore, Player(9), "-ignore", false )
    call TriggerAddCondition( gg_trg_ignore, Condition( function Trig_ignore_Conditions ) )
    call TriggerAddAction( gg_trg_ignore, function Trig_ignore_Actions )
endfunction

//===========================================================================
// Trigger: unignore
//===========================================================================
function Trig_unignore_Func030C takes nothing returns boolean
    if ( ( GetEventPlayerChatString() == "-unignore red" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-unignore blue" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-unignore teal" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-unignore purple" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-unignore yellow" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-unignore orange" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-unignore green" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-unignore pink" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-unignore gray" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-unignore grey" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-unignore light blue" ) ) then
        return true
    endif
    if ( ( GetEventPlayerChatString() == "-unignore lightblue" ) ) then
        return true
    endif
    return false
endfunction

function Trig_unignore_Conditions takes nothing returns boolean
    if ( not Trig_unignore_Func030C() ) then
        return false
    endif
    return true
endfunction

function Trig_unignore_Func001001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-unignore red" )
endfunction

function Trig_unignore_Func002001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-unignore blue" )
endfunction

function Trig_unignore_Func003001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-unignore teal" )
endfunction

function Trig_unignore_Func004001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-unignore purple" )
endfunction

function Trig_unignore_Func005001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-unignore yellow" )
endfunction

function Trig_unignore_Func006001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-unignore orange" )
endfunction

function Trig_unignore_Func007001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-unignore green" )
endfunction

function Trig_unignore_Func008001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-unignore pink" )
endfunction

function Trig_unignore_Func009001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-unignore gray" )
endfunction

function Trig_unignore_Func010001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-unignore grey" )
endfunction

function Trig_unignore_Func011001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-unignore lightblue" )
endfunction

function Trig_unignore_Func012001 takes nothing returns boolean
    return ( GetEventPlayerChatString() == "-unignore light blue" )
endfunction

function Trig_unignore_Func013C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == udg_Asked ) ) then
        return false
    endif
    return true
endfunction

function Trig_unignore_Func014C takes nothing returns boolean
    if ( not ( GetPlayerSlotState(udg_Asked) != PLAYER_SLOT_STATE_PLAYING ) ) then
        return false
    endif
    return true
endfunction

function Trig_unignore_Func015C takes nothing returns boolean
    if ( not ( IsPlayerAlly(udg_Asked, GetTriggerPlayer()) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_unignore_Func016Func001C takes nothing returns boolean
    if ( not ( udg_Ignore1[GetConvertedPlayerId(udg_Asked)] == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_unignore_Func016C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == Player(0) ) ) then
        return false
    endif
    return true
endfunction

function Trig_unignore_Func017Func001C takes nothing returns boolean
    if ( not ( udg_Ignore2[GetConvertedPlayerId(udg_Asked)] == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_unignore_Func017C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == Player(1) ) ) then
        return false
    endif
    return true
endfunction

function Trig_unignore_Func018Func001C takes nothing returns boolean
    if ( not ( udg_Ignore3[GetConvertedPlayerId(udg_Asked)] == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_unignore_Func018C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == Player(2) ) ) then
        return false
    endif
    return true
endfunction

function Trig_unignore_Func019Func001C takes nothing returns boolean
    if ( not ( udg_Ignore4[GetConvertedPlayerId(udg_Asked)] == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_unignore_Func019C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == Player(3) ) ) then
        return false
    endif
    return true
endfunction

function Trig_unignore_Func020Func001C takes nothing returns boolean
    if ( not ( udg_Ignore5[GetConvertedPlayerId(udg_Asked)] == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_unignore_Func020C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == Player(4) ) ) then
        return false
    endif
    return true
endfunction

function Trig_unignore_Func021Func001C takes nothing returns boolean
    if ( not ( udg_Ignore6[GetConvertedPlayerId(udg_Asked)] == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_unignore_Func021C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == Player(5) ) ) then
        return false
    endif
    return true
endfunction

function Trig_unignore_Func022Func001C takes nothing returns boolean
    if ( not ( udg_Ignore7[GetConvertedPlayerId(udg_Asked)] == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_unignore_Func022C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == Player(6) ) ) then
        return false
    endif
    return true
endfunction

function Trig_unignore_Func023Func001C takes nothing returns boolean
    if ( not ( udg_Ignore8[GetConvertedPlayerId(udg_Asked)] == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_unignore_Func023C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == Player(7) ) ) then
        return false
    endif
    return true
endfunction

function Trig_unignore_Func024Func001C takes nothing returns boolean
    if ( not ( udg_Ignore9[GetConvertedPlayerId(udg_Asked)] == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_unignore_Func024C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == Player(8) ) ) then
        return false
    endif
    return true
endfunction

function Trig_unignore_Func025Func001C takes nothing returns boolean
    if ( not ( udg_Ignore10[GetConvertedPlayerId(udg_Asked)] == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_unignore_Func025C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == Player(9) ) ) then
        return false
    endif
    return true
endfunction

function Trig_unignore_Actions takes nothing returns nothing
    if ( Trig_unignore_Func001001() ) then
        set udg_Asked = Player(0)
    else
        call DoNothing(  )
    endif
    if ( Trig_unignore_Func002001() ) then
        set udg_Asked = Player(1)
    else
        call DoNothing(  )
    endif
    if ( Trig_unignore_Func003001() ) then
        set udg_Asked = Player(2)
    else
        call DoNothing(  )
    endif
    if ( Trig_unignore_Func004001() ) then
        set udg_Asked = Player(3)
    else
        call DoNothing(  )
    endif
    if ( Trig_unignore_Func005001() ) then
        set udg_Asked = Player(4)
    else
        call DoNothing(  )
    endif
    if ( Trig_unignore_Func006001() ) then
        set udg_Asked = Player(5)
    else
        call DoNothing(  )
    endif
    if ( Trig_unignore_Func007001() ) then
        set udg_Asked = Player(6)
    else
        call DoNothing(  )
    endif
    if ( Trig_unignore_Func008001() ) then
        set udg_Asked = Player(7)
    else
        call DoNothing(  )
    endif
    if ( Trig_unignore_Func009001() ) then
        set udg_Asked = Player(8)
    else
        call DoNothing(  )
    endif
    if ( Trig_unignore_Func010001() ) then
        set udg_Asked = Player(8)
    else
        call DoNothing(  )
    endif
    if ( Trig_unignore_Func011001() ) then
        set udg_Asked = Player(9)
    else
        call DoNothing(  )
    endif
    if ( Trig_unignore_Func012001() ) then
        set udg_Asked = Player(9)
    else
        call DoNothing(  )
    endif
    if ( Trig_unignore_Func013C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4777" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_unignore_Func014C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4663" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_unignore_Func015C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4673" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_unignore_Func016C() ) then
        if ( Trig_unignore_Func016Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4784" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            set udg_Ignore1[GetConvertedPlayerId(udg_Asked)] = 0
        endif
    else
    endif
    if ( Trig_unignore_Func017C() ) then
        if ( Trig_unignore_Func017Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4784" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            set udg_Ignore2[GetConvertedPlayerId(udg_Asked)] = 0
        endif
    else
    endif
    if ( Trig_unignore_Func018C() ) then
        if ( Trig_unignore_Func018Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4784" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            set udg_Ignore3[GetConvertedPlayerId(udg_Asked)] = 0
        endif
    else
    endif
    if ( Trig_unignore_Func019C() ) then
        if ( Trig_unignore_Func019Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4784" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            set udg_Ignore4[GetConvertedPlayerId(udg_Asked)] = 0
        endif
    else
    endif
    if ( Trig_unignore_Func020C() ) then
        if ( Trig_unignore_Func020Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4784" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            set udg_Ignore5[GetConvertedPlayerId(udg_Asked)] = 0
        endif
    else
    endif
    if ( Trig_unignore_Func021C() ) then
        if ( Trig_unignore_Func021Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4784" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            set udg_Ignore6[GetConvertedPlayerId(udg_Asked)] = 0
        endif
    else
    endif
    if ( Trig_unignore_Func022C() ) then
        if ( Trig_unignore_Func022Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4784" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            set udg_Ignore7[GetConvertedPlayerId(udg_Asked)] = 0
        endif
    else
    endif
    if ( Trig_unignore_Func023C() ) then
        if ( Trig_unignore_Func023Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4784" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            set udg_Ignore8[GetConvertedPlayerId(udg_Asked)] = 0
        endif
    else
    endif
    if ( Trig_unignore_Func024C() ) then
        if ( Trig_unignore_Func024Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4784" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            set udg_Ignore9[GetConvertedPlayerId(udg_Asked)] = 0
        endif
    else
    endif
    if ( Trig_unignore_Func025C() ) then
        if ( Trig_unignore_Func025Func001C() ) then
            call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4784" )
                call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
            return
        else
            set udg_Ignore10[GetConvertedPlayerId(udg_Asked)] = 0
        endif
    else
    endif
    call DisplayTimedTextToForce( GetForceOfPlayer(udg_Asked), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(GetTriggerPlayer())] + GetPlayerName(GetTriggerPlayer()) ) + "  |cffffcc00has removed you from his ignore list!" ) )
    call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(udg_Asked)] + GetPlayerName(udg_Asked) ) + "  |cffffcc00has been removed from your ignore list!" ) )
        call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        call PlaySoundForPlayer( udg_Asked, gg_snd_Warning )
endfunction

//===========================================================================
function InitTrig_unignore takes nothing returns nothing
    set gg_trg_unignore = CreateTrigger(  )
    call DisableTrigger( gg_trg_unignore )
    call TriggerRegisterPlayerChatEvent( gg_trg_unignore, Player(0), "-unignore", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_unignore, Player(1), "-unignore", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_unignore, Player(2), "-unignore", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_unignore, Player(3), "-unignore", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_unignore, Player(4), "-unignore", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_unignore, Player(5), "-unignore", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_unignore, Player(6), "-unignore", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_unignore, Player(7), "-unignore", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_unignore, Player(8), "-unignore", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_unignore, Player(9), "-unignore", false )
    call TriggerAddCondition( gg_trg_unignore, Condition( function Trig_unignore_Conditions ) )
    call TriggerAddAction( gg_trg_unignore, function Trig_unignore_Actions )
endfunction

//===========================================================================
// Trigger: Give Tradepoints
//===========================================================================
function Trig_Give_Tradepoints_Func028C takes nothing returns boolean
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 11) == "-givetp red" ) ) then
        return true
    endif
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 12) == "-givetp blue" ) ) then
        return true
    endif
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 12) == "-givetp teal" ) ) then
        return true
    endif
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 14) == "-givetp purple" ) ) then
        return true
    endif
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 14) == "-givetp yellow" ) ) then
        return true
    endif
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 14) == "-givetp orange" ) ) then
        return true
    endif
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 13) == "-givetp green" ) ) then
        return true
    endif
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 12) == "-givetp pink" ) ) then
        return true
    endif
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 12) == "-givetp grey" ) ) then
        return true
    endif
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 12) == "-givetp gray" ) ) then
        return true
    endif
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 17) == "-givetp lightblue" ) ) then
        return true
    endif
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 18) == "-givetp light blue" ) ) then
        return true
    endif
    return false
endfunction

function Trig_Give_Tradepoints_Conditions takes nothing returns boolean
    if ( not Trig_Give_Tradepoints_Func028C() ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Tradepoints_Func002C takes nothing returns boolean
    if ( not ( SubStringBJ(GetEventPlayerChatString(), 1, 11) == "-givetp red" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Tradepoints_Func003C takes nothing returns boolean
    if ( not ( SubStringBJ(GetEventPlayerChatString(), 1, 12) == "-givetp blue" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Tradepoints_Func004C takes nothing returns boolean
    if ( not ( SubStringBJ(GetEventPlayerChatString(), 1, 12) == "-givetp teal" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Tradepoints_Func005C takes nothing returns boolean
    if ( not ( SubStringBJ(GetEventPlayerChatString(), 1, 14) == "-givetp purple" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Tradepoints_Func006C takes nothing returns boolean
    if ( not ( SubStringBJ(GetEventPlayerChatString(), 1, 14) == "-givetp yellow" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Tradepoints_Func007C takes nothing returns boolean
    if ( not ( SubStringBJ(GetEventPlayerChatString(), 1, 14) == "-givetp orange" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Tradepoints_Func008C takes nothing returns boolean
    if ( not ( SubStringBJ(GetEventPlayerChatString(), 1, 13) == "-givetp green" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Tradepoints_Func009C takes nothing returns boolean
    if ( not ( SubStringBJ(GetEventPlayerChatString(), 1, 12) == "-givetp pink" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Tradepoints_Func010Func001C takes nothing returns boolean
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 12) == "-givetp gray" ) ) then
        return true
    endif
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 12) == "-givetp grey" ) ) then
        return true
    endif
    return false
endfunction

function Trig_Give_Tradepoints_Func010C takes nothing returns boolean
    if ( not Trig_Give_Tradepoints_Func010Func001C() ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Tradepoints_Func011C takes nothing returns boolean
    if ( not ( SubStringBJ(GetEventPlayerChatString(), 1, 18) == "-givetp light blue" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Tradepoints_Func012C takes nothing returns boolean
    if ( not ( SubStringBJ(GetEventPlayerChatString(), 1, 17) == "-givetp lightblue" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Tradepoints_Func014C takes nothing returns boolean
    if ( not ( GetPlayerSlotState(udg_Asked) != PLAYER_SLOT_STATE_PLAYING ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Tradepoints_Func015C takes nothing returns boolean
    if ( not ( udg_HeroRace[GetConvertedPlayerId(udg_Asked)] == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Tradepoints_Func016C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == udg_Asked ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Tradepoints_Func017C takes nothing returns boolean
    if ( not ( udg_TradePoints[GetConvertedPlayerId(GetTriggerPlayer())] < S2I(SubStringBJ(GetEventPlayerChatString(), ( udg_ReminderInt + 1 ), ( udg_ReminderInt + 10 ))) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Tradepoints_Func018C takes nothing returns boolean
    if ( not ( 0 > S2I(SubStringBJ(GetEventPlayerChatString(), ( udg_ReminderInt + 1 ), ( udg_ReminderInt + 10 ))) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Tradepoints_Actions takes nothing returns nothing
    // set values
    if ( Trig_Give_Tradepoints_Func002C() ) then
        set udg_Asked = Player(0)
        set udg_ReminderInt = 11
    else
    endif
    if ( Trig_Give_Tradepoints_Func003C() ) then
        set udg_Asked = Player(1)
        set udg_ReminderInt = 12
    else
    endif
    if ( Trig_Give_Tradepoints_Func004C() ) then
        set udg_Asked = Player(2)
        set udg_ReminderInt = 12
    else
    endif
    if ( Trig_Give_Tradepoints_Func005C() ) then
        set udg_Asked = Player(3)
        set udg_ReminderInt = 14
    else
    endif
    if ( Trig_Give_Tradepoints_Func006C() ) then
        set udg_Asked = Player(4)
        set udg_ReminderInt = 14
    else
    endif
    if ( Trig_Give_Tradepoints_Func007C() ) then
        set udg_Asked = Player(5)
        set udg_ReminderInt = 14
    else
    endif
    if ( Trig_Give_Tradepoints_Func008C() ) then
        set udg_Asked = Player(6)
        set udg_ReminderInt = 13
    else
    endif
    if ( Trig_Give_Tradepoints_Func009C() ) then
        set udg_Asked = Player(7)
        set udg_ReminderInt = 12
    else
    endif
    if ( Trig_Give_Tradepoints_Func010C() ) then
        set udg_Asked = Player(8)
        set udg_ReminderInt = 12
    else
    endif
    if ( Trig_Give_Tradepoints_Func011C() ) then
        set udg_Asked = Player(9)
        set udg_ReminderInt = 18
    else
    endif
    if ( Trig_Give_Tradepoints_Func012C() ) then
        set udg_Asked = Player(9)
        set udg_ReminderInt = 17
    else
    endif
    // Check if possible
    if ( Trig_Give_Tradepoints_Func014C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4663" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_Give_Tradepoints_Func015C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4803" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_Give_Tradepoints_Func016C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4805" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_Give_Tradepoints_Func017C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4806" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_Give_Tradepoints_Func018C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_1734" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    // Give them
    set udg_TradePoints[GetConvertedPlayerId(GetTriggerPlayer())] = ( udg_TradePoints[GetConvertedPlayerId(GetTriggerPlayer())] - S2I(SubStringBJ(GetEventPlayerChatString(), ( udg_ReminderInt + 1 ), ( udg_ReminderInt + 10 ))) )
    set udg_TradePoints[GetConvertedPlayerId(udg_Asked)] = ( udg_TradePoints[GetConvertedPlayerId(udg_Asked)] + S2I(SubStringBJ(GetEventPlayerChatString(), ( udg_ReminderInt + 1 ), ( udg_ReminderInt + 10 ))) )
    call DisplayTimedTextToForce( GetForceOfPlayer(udg_Asked), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(GetTriggerPlayer())] + GetPlayerName(GetTriggerPlayer()) ) + ( "  |cffffcc00has given you" + ( SubStringBJ(GetEventPlayerChatString(), ( udg_ReminderInt + 1 ), ( udg_ReminderInt + 10 )) + " Trade Points!" ) ) ) )
    call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(udg_Asked)] + GetPlayerName(udg_Asked) ) + ( "  |cffffcc00has recieved your " + ( SubStringBJ(GetEventPlayerChatString(), ( udg_ReminderInt + 1 ), ( udg_ReminderInt + 10 )) + " Trade Points!" ) ) ) )
        call PlaySoundForPlayer( udg_Asked, gg_snd_Warning )
        call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
    call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(GetTriggerPlayer())], 2, 11, I2S(udg_TradePoints[GetConvertedPlayerId(GetTriggerPlayer())]) )
    call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(udg_Asked)], 2, 11, I2S(udg_TradePoints[GetConvertedPlayerId(udg_Asked)]) )
endfunction

//===========================================================================
function InitTrig_Give_Tradepoints takes nothing returns nothing
    set gg_trg_Give_Tradepoints = CreateTrigger(  )
    call TriggerRegisterPlayerChatEvent( gg_trg_Give_Tradepoints, Player(0), "-givetp", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Give_Tradepoints, Player(1), "-givetp", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Give_Tradepoints, Player(2), "-givetp", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Give_Tradepoints, Player(3), "-givetp", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Give_Tradepoints, Player(4), "-givetp", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Give_Tradepoints, Player(5), "-givetp", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Give_Tradepoints, Player(6), "-givetp", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Give_Tradepoints, Player(7), "-givetp", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Give_Tradepoints, Player(8), "-givetp", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Give_Tradepoints, Player(9), "-givetp", false )
    call TriggerAddCondition( gg_trg_Give_Tradepoints, Condition( function Trig_Give_Tradepoints_Conditions ) )
    call TriggerAddAction( gg_trg_Give_Tradepoints, function Trig_Give_Tradepoints_Actions )
endfunction

//===========================================================================
// Trigger: Give Food
//===========================================================================
function Trig_Give_Food_Func028C takes nothing returns boolean
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 11) == "-givefd red" ) ) then
        return true
    endif
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 12) == "-givefd blue" ) ) then
        return true
    endif
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 12) == "-givefd teal" ) ) then
        return true
    endif
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 14) == "-givefd purple" ) ) then
        return true
    endif
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 14) == "-givefd yellow" ) ) then
        return true
    endif
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 14) == "-givefd orange" ) ) then
        return true
    endif
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 13) == "-givefd green" ) ) then
        return true
    endif
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 12) == "-givefd pink" ) ) then
        return true
    endif
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 12) == "-givefd grey" ) ) then
        return true
    endif
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 12) == "-givefd gray" ) ) then
        return true
    endif
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 17) == "-givefd lightblue" ) ) then
        return true
    endif
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 18) == "-givefd light blue" ) ) then
        return true
    endif
    return false
endfunction

function Trig_Give_Food_Conditions takes nothing returns boolean
    if ( not Trig_Give_Food_Func028C() ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Food_Func002C takes nothing returns boolean
    if ( not ( SubStringBJ(GetEventPlayerChatString(), 1, 11) == "-givefd red" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Food_Func003C takes nothing returns boolean
    if ( not ( SubStringBJ(GetEventPlayerChatString(), 1, 12) == "-givefd blue" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Food_Func004C takes nothing returns boolean
    if ( not ( SubStringBJ(GetEventPlayerChatString(), 1, 12) == "-givefd teal" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Food_Func005C takes nothing returns boolean
    if ( not ( SubStringBJ(GetEventPlayerChatString(), 1, 14) == "-givefd purple" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Food_Func006C takes nothing returns boolean
    if ( not ( SubStringBJ(GetEventPlayerChatString(), 1, 14) == "-givefd yellow" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Food_Func007C takes nothing returns boolean
    if ( not ( SubStringBJ(GetEventPlayerChatString(), 1, 14) == "-givefd orange" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Food_Func008C takes nothing returns boolean
    if ( not ( SubStringBJ(GetEventPlayerChatString(), 1, 13) == "-givefd green" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Food_Func009C takes nothing returns boolean
    if ( not ( SubStringBJ(GetEventPlayerChatString(), 1, 12) == "-givefd pink" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Food_Func010Func001C takes nothing returns boolean
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 12) == "-givefd gray" ) ) then
        return true
    endif
    if ( ( SubStringBJ(GetEventPlayerChatString(), 1, 12) == "-givefd grey" ) ) then
        return true
    endif
    return false
endfunction

function Trig_Give_Food_Func010C takes nothing returns boolean
    if ( not Trig_Give_Food_Func010Func001C() ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Food_Func011C takes nothing returns boolean
    if ( not ( SubStringBJ(GetEventPlayerChatString(), 1, 18) == "-givefd light blue" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Food_Func012C takes nothing returns boolean
    if ( not ( SubStringBJ(GetEventPlayerChatString(), 1, 17) == "-givefd lightblue" ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Food_Func014C takes nothing returns boolean
    if ( not ( GetPlayerSlotState(udg_Asked) != PLAYER_SLOT_STATE_PLAYING ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Food_Func015C takes nothing returns boolean
    if ( not ( udg_Empire[GetConvertedPlayerId(udg_Asked)] == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Food_Func016C takes nothing returns boolean
    if ( not ( GetTriggerPlayer() == udg_Asked ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Food_Func017C takes nothing returns boolean
    if ( not ( udg_food[GetConvertedPlayerId(GetTriggerPlayer())] < S2I(SubStringBJ(GetEventPlayerChatString(), ( udg_ReminderInt + 1 ), ( udg_ReminderInt + 10 ))) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Food_Func018C takes nothing returns boolean
    if ( not ( 0 > S2I(SubStringBJ(GetEventPlayerChatString(), ( udg_ReminderInt + 1 ), ( udg_ReminderInt + 10 ))) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Give_Food_Actions takes nothing returns nothing
    // set values
    if ( Trig_Give_Food_Func002C() ) then
        set udg_Asked = Player(0)
        set udg_ReminderInt = 11
    else
    endif
    if ( Trig_Give_Food_Func003C() ) then
        set udg_Asked = Player(1)
        set udg_ReminderInt = 12
    else
    endif
    if ( Trig_Give_Food_Func004C() ) then
        set udg_Asked = Player(2)
        set udg_ReminderInt = 12
    else
    endif
    if ( Trig_Give_Food_Func005C() ) then
        set udg_Asked = Player(3)
        set udg_ReminderInt = 14
    else
    endif
    if ( Trig_Give_Food_Func006C() ) then
        set udg_Asked = Player(4)
        set udg_ReminderInt = 14
    else
    endif
    if ( Trig_Give_Food_Func007C() ) then
        set udg_Asked = Player(5)
        set udg_ReminderInt = 14
    else
    endif
    if ( Trig_Give_Food_Func008C() ) then
        set udg_Asked = Player(6)
        set udg_ReminderInt = 13
    else
    endif
    if ( Trig_Give_Food_Func009C() ) then
        set udg_Asked = Player(7)
        set udg_ReminderInt = 12
    else
    endif
    if ( Trig_Give_Food_Func010C() ) then
        set udg_Asked = Player(8)
        set udg_ReminderInt = 12
    else
    endif
    if ( Trig_Give_Food_Func011C() ) then
        set udg_Asked = Player(9)
        set udg_ReminderInt = 18
    else
    endif
    if ( Trig_Give_Food_Func012C() ) then
        set udg_Asked = Player(9)
        set udg_ReminderInt = 17
    else
    endif
    // Check if possible
    if ( Trig_Give_Food_Func014C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4663" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_Give_Food_Func015C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4809" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_Give_Food_Func016C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4810" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_Give_Food_Func017C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_4812" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    if ( Trig_Give_Food_Func018C() ) then
        call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, "TRIGSTR_2225" )
            call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
        return
    else
        call DoNothing(  )
    endif
    // Give them
    set udg_food[GetConvertedPlayerId(GetTriggerPlayer())] = ( udg_food[GetConvertedPlayerId(GetTriggerPlayer())] - S2I(SubStringBJ(GetEventPlayerChatString(), ( udg_ReminderInt + 1 ), ( udg_ReminderInt + 10 ))) )
    set udg_food[GetConvertedPlayerId(udg_Asked)] = ( udg_food[GetConvertedPlayerId(udg_Asked)] + S2I(SubStringBJ(GetEventPlayerChatString(), ( udg_ReminderInt + 1 ), ( udg_ReminderInt + 10 ))) )
    call DisplayTimedTextToForce( GetForceOfPlayer(udg_Asked), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(GetTriggerPlayer())] + GetPlayerName(GetTriggerPlayer()) ) + ( "  |cffffcc00has given you" + ( SubStringBJ(GetEventPlayerChatString(), ( udg_ReminderInt + 1 ), ( udg_ReminderInt + 10 )) + " Food!" ) ) ) )
    call DisplayTimedTextToForce( GetForceOfPlayer(GetTriggerPlayer()), 5.00, ( ( udg_Playercolor[GetConvertedPlayerId(udg_Asked)] + GetPlayerName(udg_Asked) ) + ( "  |cffffcc00has recieved your " + ( SubStringBJ(GetEventPlayerChatString(), ( udg_ReminderInt + 1 ), ( udg_ReminderInt + 10 )) + " Food!" ) ) ) )
        call PlaySoundForPlayer( udg_Asked, gg_snd_Warning )
        call PlaySoundForPlayer( GetTriggerPlayer(), gg_snd_Warning )
    call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(GetTriggerPlayer())], 2, 3, I2S(udg_food[GetConvertedPlayerId(GetTriggerPlayer())]) )
    call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(udg_Asked)], 2, 3, I2S(udg_food[GetConvertedPlayerId(udg_Asked)]) )
endfunction

//===========================================================================
function InitTrig_Give_Food takes nothing returns nothing
    set gg_trg_Give_Food = CreateTrigger(  )
    call TriggerRegisterPlayerChatEvent( gg_trg_Give_Food, Player(0), "-givefd", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Give_Food, Player(1), "-givefd", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Give_Food, Player(2), "-givefd", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Give_Food, Player(3), "-givefd", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Give_Food, Player(4), "-givefd", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Give_Food, Player(5), "-givefd", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Give_Food, Player(6), "-givefd", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Give_Food, Player(7), "-givefd", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Give_Food, Player(8), "-givefd", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Give_Food, Player(9), "-givefd", false )
    call TriggerAddCondition( gg_trg_Give_Food, Condition( function Trig_Give_Food_Conditions ) )
    call TriggerAddAction( gg_trg_Give_Food, function Trig_Give_Food_Actions )
endfunction

//===========================================================================
// Trigger: Unit is hit by Tower
//===========================================================================
function Trig_Unit_is_hit_by_Tower_Conditions takes nothing returns boolean
local unit u = GetAttacker()
if IsUnitType(u, UNIT_TYPE_UNDEAD) == true then
set u = null
return true
endif
set u = null
return false
endfunction

function Trig_Unit_is_hit_by_Tower_Actions takes nothing returns nothing
local unit u = GetAttacker()
local unit u2 = GetAttackedUnitBJ()
if IsUnitType(u2, UNIT_TYPE_HERO) == true then
call UnitDamageTargetBJ( u, u2, ((GetUnitStateSwap(UNIT_STATE_MAX_LIFE, u2) / 30.00) + (GetUnitStateSwap(UNIT_STATE_MAX_MANA, u2) / 10.00)), ATTACK_TYPE_PIERCE, DAMAGE_TYPE_ENHANCED )
else
call UnitDamageTargetBJ( u, u2, ((GetUnitStateSwap(UNIT_STATE_MAX_LIFE, u2) / 15.00) + (GetUnitStateSwap(UNIT_STATE_MAX_MANA, u2) / 10.00)), ATTACK_TYPE_PIERCE, DAMAGE_TYPE_ENHANCED )
endif
set u = null
set u2 = null
endfunction

//===========================================================================
function InitTrig_Unit_is_hit_by_Tower takes nothing returns nothing
    set gg_trg_Unit_is_hit_by_Tower = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_is_hit_by_Tower, Player(0), EVENT_PLAYER_UNIT_ATTACKED )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_is_hit_by_Tower, Player(1), EVENT_PLAYER_UNIT_ATTACKED )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_is_hit_by_Tower, Player(2), EVENT_PLAYER_UNIT_ATTACKED )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_is_hit_by_Tower, Player(3), EVENT_PLAYER_UNIT_ATTACKED )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_is_hit_by_Tower, Player(4), EVENT_PLAYER_UNIT_ATTACKED )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_is_hit_by_Tower, Player(5), EVENT_PLAYER_UNIT_ATTACKED )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_is_hit_by_Tower, Player(6), EVENT_PLAYER_UNIT_ATTACKED )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_is_hit_by_Tower, Player(7), EVENT_PLAYER_UNIT_ATTACKED )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_is_hit_by_Tower, Player(8), EVENT_PLAYER_UNIT_ATTACKED )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Unit_is_hit_by_Tower, Player(9), EVENT_PLAYER_UNIT_ATTACKED )
    call TriggerAddCondition( gg_trg_Unit_is_hit_by_Tower, Condition( function Trig_Unit_is_hit_by_Tower_Conditions ) )
    call TriggerAddAction( gg_trg_Unit_is_hit_by_Tower, function Trig_Unit_is_hit_by_Tower_Actions )
endfunction

//===========================================================================
// Trigger: Tradepoint Flow
//===========================================================================
function Trig_Tradepoint_Flow_Actions takes nothing returns nothing
local integer i = 1
local unit u = null
local location l = null
local player p = null

loop
exitwhen i > 10

if udg_HeroRace[i] == 1 then
set p = ConvertedPlayer(i)
set u = udg_Herounit[i]
set l = GetUnitLoc(u)

if GetUnitAbilityLevelSwapped('A09L', u) == 1 then
set udg_TradePoints[i] = udg_TradePoints[i] + 5
call SetFloatingText(p,"+5",GetLocationX(l),GetLocationY(l),50,0,255,0)
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[i], 2, 11, I2S(udg_TradePoints[i]) )
endif
if GetUnitAbilityLevelSwapped('A09M', u) == 1 then
set udg_TradePoints[i] = udg_TradePoints[i] + 10
call SetFloatingText(p,"+10",GetLocationX(l),GetLocationY(l),50,0,255,0)
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[i], 2, 11, I2S(udg_TradePoints[i]) )
endif
if GetUnitAbilityLevelSwapped('A09N', u) == 1 then
set udg_TradePoints[i] = udg_TradePoints[i] + 15
call SetFloatingText(p,"+15",GetLocationX(l),GetLocationY(l),50,0,255,0)
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[i], 2, 11, I2S(udg_TradePoints[i]) )
endif
if GetUnitAbilityLevelSwapped('A09O', u) == 1 then
set udg_TradePoints[i] = udg_TradePoints[i] + 20
call SetFloatingText(p,"+20",GetLocationX(l),GetLocationY(l),50,0,255,0)
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[i], 2, 11, I2S(udg_TradePoints[i]) )
endif
if GetUnitAbilityLevelSwapped('A0AX', u) == 1 then
set udg_TradePoints[i] = udg_TradePoints[i] + 25
call SetFloatingText(p,"+25",GetLocationX(l),GetLocationY(l),50,0,255,0)
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[i], 2, 11, I2S(udg_TradePoints[i]) )
endif
call RemoveLocation(l)
endif

set i = i + 1
endloop

set l = null
set u = null
set p = null
endfunction

//===========================================================================
function InitTrig_Tradepoint_Flow takes nothing returns nothing
    set gg_trg_Tradepoint_Flow = CreateTrigger(  )
    call TriggerRegisterTimerEventPeriodic( gg_trg_Tradepoint_Flow, 60.00 )
    call TriggerAddAction( gg_trg_Tradepoint_Flow, function Trig_Tradepoint_Flow_Actions )
endfunction

//===========================================================================
// Trigger: Taunt
//===========================================================================
function Trig_Taunt_Conditions takes nothing returns boolean
local unit u = GetAttacker()
if GetUnitTypeId(u) == 'u00K' then
set u = null
return true
endif
set u = null
return false
endfunction

function Trig_Taunt_Actions takes nothing returns nothing
local unit u = GetAttacker()
call IssueImmediateOrderBJ( u, "taunt" )
set u = null
endfunction

//===========================================================================
function InitTrig_Taunt takes nothing returns nothing
    set gg_trg_Taunt = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Taunt, Player(10), EVENT_PLAYER_UNIT_ATTACKED )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Taunt, Player(11), EVENT_PLAYER_UNIT_ATTACKED )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Taunt, Player(PLAYER_NEUTRAL_AGGRESSIVE), EVENT_PLAYER_UNIT_ATTACKED )    
    call TriggerAddCondition( gg_trg_Taunt, Condition( function Trig_Taunt_Conditions ) )
    call TriggerAddAction( gg_trg_Taunt, function Trig_Taunt_Actions )
endfunction

//===========================================================================
// Trigger: Roar
//===========================================================================
function Trig_Roar_Conditions takes nothing returns boolean
local unit u = GetAttacker()
if GetUnitTypeId(u) == 'u00P' then
set u = null
return true
endif
set u = null
return false
endfunction

function Trig_Roar_Actions takes nothing returns nothing
local unit u = GetAttacker()
call IssueImmediateOrderBJ( u, "roar" )
set u = null
endfunction

//===========================================================================
function InitTrig_Roar takes nothing returns nothing
    set gg_trg_Roar = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Roar, Player(10), EVENT_PLAYER_UNIT_ATTACKED )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Roar, Player(11), EVENT_PLAYER_UNIT_ATTACKED )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Roar, Player(PLAYER_NEUTRAL_AGGRESSIVE), EVENT_PLAYER_UNIT_ATTACKED ) 
    call TriggerAddCondition( gg_trg_Roar, Condition( function Trig_Roar_Conditions ) )
    call TriggerAddAction( gg_trg_Roar, function Trig_Roar_Actions )
endfunction

//===========================================================================
// Trigger: Use Potions
//===========================================================================
function Trig_Use_Potions_Conditions takes nothing returns boolean
local item m = GetManipulatedItem()
if GetItemTypeId(m) == 'I027' or GetItemTypeId(m) == 'I02A' or GetItemTypeId(m) == 'I02D' or GetItemTypeId(m) == 'I028' or GetItemTypeId(m) == 'I02B' or GetItemTypeId(m) == 'I02E' or GetItemTypeId(m) == 'I02H' then
set m = null
return true
endif
set m = null
return false
endfunction

function Trig_Use_Potions_Actions takes nothing returns nothing
local item m = GetManipulatedItem()
local unit u = GetManipulatingUnit()
local player p = GetOwningPlayer(u)

if GetItemTypeId(m) == 'I02H' then
set udg_HeroLifes[GetConvertedPlayerId(p)] = ( udg_HeroLifes[GetConvertedPlayerId(p)] + 1 )
call MultiboardSetItemValueBJ( udg_PlayerMultiboard[GetConvertedPlayerId(p)], 2, 1, I2S(udg_HeroLifes[GetConvertedPlayerId(p)]) )
endif

if GetItemTypeId(m) == 'I027' or GetItemTypeId(m) == 'I02A' or GetItemTypeId(m) == 'I02D'  then
call SetUnitLifePercentBJ( u, ( GetUnitLifePercent(u) + 50.00 ) )
endif

if GetItemTypeId(m) == 'I028' or GetItemTypeId(m) == 'I02B' or GetItemTypeId(m) == 'I02E' then
call SetUnitManaPercentBJ( u, ( GetUnitManaPercent(u) + 50.00 ) )
endif

set m = null
set u = null
set p = null
endfunction

//===========================================================================
function InitTrig_Use_Potions takes nothing returns nothing
    set gg_trg_Use_Potions = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Use_Potions, Player(0), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Use_Potions, Player(1), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Use_Potions, Player(2), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Use_Potions, Player(3), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Use_Potions, Player(4), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Use_Potions, Player(5), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Use_Potions, Player(6), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Use_Potions, Player(7), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Use_Potions, Player(8), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Use_Potions, Player(9), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerAddCondition( gg_trg_Use_Potions, Condition( function Trig_Use_Potions_Conditions ) )
    call TriggerAddAction( gg_trg_Use_Potions, function Trig_Use_Potions_Actions )
endfunction

//===========================================================================
// Trigger: Call to Arms
//===========================================================================
function Call_to_Arms_Conditions takes nothing returns boolean
local item it = GetManipulatedItem()
if GetItemTypeId(it) == 'I03F' then
set it = null
return true
endif
set it = null
return false
endfunction

function Call_To_Arms_Check takes nothing returns boolean
local unit u = GetFilterUnit()
if IsUnitType(u, UNIT_TYPE_SAPPER) == true then
set u = null
return true
endif
set u = null
return false
endfunction

function CalltoArms takes nothing returns nothing
local unit u = GetEnumUnit()
local unit u2 = GetManipulatingUnit()
local location l = GetUnitLoc(u2)
call SetUnitPositionLoc( u, l)
call RemoveLocation(l)
set u = null
set u2 = null
set l = null
endfunction

function Call_to_Arms_Actions takes nothing returns nothing
local unit u = GetManipulatingUnit()
local player p = GetOwningPlayer(u)
local group g = GetUnitsOfPlayerMatching(p, Condition(function Call_To_Arms_Check))
call ForGroupBJ( g, function CalltoArms )
call DestroyGroup(g)
set g = null
set u = null
set p = null
endfunction

//===========================================================================
function InitTrig_Call_to_Arms takes nothing returns nothing
    set gg_trg_Call_to_Arms = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Call_to_Arms, Player(0), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Call_to_Arms, Player(1), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Call_to_Arms, Player(2), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Call_to_Arms, Player(3), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Call_to_Arms, Player(4), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Call_to_Arms, Player(5), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Call_to_Arms, Player(6), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Call_to_Arms, Player(7), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Call_to_Arms, Player(8), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Call_to_Arms, Player(9), EVENT_PLAYER_UNIT_USE_ITEM )
    call TriggerAddCondition( gg_trg_Call_to_Arms, Condition( function Call_to_Arms_Conditions ) )
    call TriggerAddAction( gg_trg_Call_to_Arms, function Call_to_Arms_Actions )
endfunction

//===========================================================================
// Trigger: Merc Heal
//===========================================================================
function Trig_Merc_Heal_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A04Q' then
return true
endif
return false
endfunction

function Trig_Merc_Heal_Actions takes nothing returns nothing
local unit u = GetSpellTargetUnit()
call SetUnitLifePercentBJ( u, ( GetUnitLifePercent(u) + 5.00 ) )
set u = null
endfunction

//===========================================================================
function InitTrig_Merc_Heal takes nothing returns nothing
    set gg_trg_Merc_Heal = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Merc_Heal, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Merc_Heal, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Merc_Heal, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Merc_Heal, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Merc_Heal, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Merc_Heal, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Merc_Heal, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Merc_Heal, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Merc_Heal, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Merc_Heal, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Merc_Heal, Condition( function Trig_Merc_Heal_Conditions ) )
    call TriggerAddAction( gg_trg_Merc_Heal, function Trig_Merc_Heal_Actions )
endfunction

//===========================================================================
// Trigger: Fireball
//===========================================================================
function Trig_Fireball_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A03U' then
return true
endif
return false
endfunction

function Trig_Fireball_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
call UnitDamageTargetBJ( u, u2, ( (I2R(GetHeroLevel(u) * GetHeroLevel(u) * GetHeroLevel(u))/300.0) + (I2R(GetHeroLevel(u)) * 25) ), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_FIRE )
set u = null
set u2 = null
endfunction

//===========================================================================
function InitTrig_Fireball takes nothing returns nothing
    set gg_trg_Fireball = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Fireball, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Fireball, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Fireball, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Fireball, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Fireball, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Fireball, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Fireball, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Fireball, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Fireball, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Fireball, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Fireball, Condition( function Trig_Fireball_Conditions ) )
    call TriggerAddAction( gg_trg_Fireball, function Trig_Fireball_Actions )
endfunction

//===========================================================================
// Trigger: Gold Strike
//===========================================================================
function Trig_Gold_Strike_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A0B0' then
return true
endif
return false
endfunction

function Trig_Gold_Strike_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
call UnitDamageTargetBJ( u, u2, ( (I2R(GetHeroLevel(u) * GetHeroLevel(u) * GetHeroLevel(u))/500.0) + (I2R(GetHeroLevel(u)) * 25) ), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_FIRE )
set u = null
set u2 = null
endfunction

//===========================================================================
function InitTrig_Gold_Strike takes nothing returns nothing
    set gg_trg_Gold_Strike = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gold_Strike, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gold_Strike, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gold_Strike, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gold_Strike, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gold_Strike, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gold_Strike, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gold_Strike, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gold_Strike, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gold_Strike, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gold_Strike, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Gold_Strike, Condition( function Trig_Gold_Strike_Conditions ) )
    call TriggerAddAction( gg_trg_Gold_Strike, function Trig_Gold_Strike_Actions )
endfunction

//===========================================================================
// Trigger: Energy Shield
//===========================================================================
function Trig_Energy_Shield_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A03P' then
return true
endif
return false
endfunction

function Trig_Energy_Shield_Actions takes nothing returns nothing
 local unit caster=GetTriggerUnit()
 local unit array elec
 local timer t=CreateTimer()
 local real grad=0
 local integer s=GetSpellAbilityId()
 local integer n=3
 local location l = null
 local location l2 = null
 local integer a = 0
 
    call TimerStart( t, 180.00, false, null)
    set a=0
    loop
        exitwhen a>=n
        set elec[a]=CreateUnit( Player(15), 'e00Z', 0 ,0 ,0)
        call SetUnitOwner( elec[a], GetOwningPlayer(caster), true)
        call SetUnitPosition( elec[a], GetUnitX(caster), GetUnitY(caster) )
        set a=a+1
    endloop
    loop
        exitwhen (TimerGetRemaining(t)<=0) or (IsUnitDeadBJ(caster)) or n <= 0
        call PolledWait(0.25)
        set a=0
        loop
            exitwhen a>=n          
            if GetUnitManaPercent( caster ) < 50 and GetWidgetLife(caster) > 0 then
            call SetUnitManaPercentBJ( caster, GetUnitManaPercent( caster )+25.0 )
            call DestroyEffect( AddSpellEffectTargetById( s, EFFECT_TYPE_TARGET, caster, "origin" ) )
            call RemoveUnit( elec[a] ) 
            set elec[a]=elec[n-1]
            set elec[n-1]=null
            set n=n-1
            endif
            set l = Location(GetUnitX(caster)+150*CosBJ(grad+a*360/n), GetUnitY(caster)+150*SinBJ(grad+a*360/n))
            set l2 = GetUnitLoc(elec[a])
            if DistanceBetweenPoints(l, l2) <= 1000.00 then
            call IssuePointOrderLoc(elec[a], "move", l)
            else
            call SetUnitPositionLoc( elec[a],l )
            endif
            call RemoveLocation(l)
            call RemoveLocation(l2)
            set a=a+1
        endloop
        set grad = ModuloReal(grad+30,360)
    endloop
 if IsUnitDeadBJ(caster) == true or caster == null or TimerGetRemaining(t)<=0 then
 set a=0
 loop
 exitwhen a>=n   
 call RemoveUnit( elec[a] ) 
 set elec[a]=null
 set a=a+1
 endloop
 endif
 call DestroyTimer(t)
 call RemoveLocation(l)
 call RemoveLocation(l2)
 set t=null
 set l = null
 set l2 = null
 set caster = null
endfunction

//===========================================================================
function InitTrig_Energy_Shield takes nothing returns nothing
    set gg_trg_Energy_Shield = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Energy_Shield, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Energy_Shield, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Energy_Shield, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Energy_Shield, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Energy_Shield, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Energy_Shield, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Energy_Shield, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Energy_Shield, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Energy_Shield, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Energy_Shield, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Energy_Shield, Condition( function Trig_Energy_Shield_Conditions ) )
    call TriggerAddAction( gg_trg_Energy_Shield, function Trig_Energy_Shield_Actions )
endfunction//===========================================================================
// Trigger: Shield of divinity
//===========================================================================
function Trig_DivinityShield_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A08P' then
return true
endif
return false
endfunction

function Trig_DivinityShield_Actions takes nothing returns nothing
 local unit caster=GetTriggerUnit()
 local unit array elec
 local timer t=CreateTimer()
 local real grad=0
 local integer s=GetSpellAbilityId()
 local integer n=3
 local location l = null
 local location l2 = null
 local integer a = 0

    call TimerStart( t, 180.00, false, null)
    set a=0
    loop
        exitwhen a>=n
        set elec[a]=CreateUnit( Player(15), 'e01J', 0 ,0 ,0)
        call SetUnitOwner( elec[a], GetOwningPlayer(caster), true)
        call SetUnitPosition( elec[a], GetUnitX(caster), GetUnitY(caster) )
        set a=a+1
    endloop
    loop
        exitwhen (TimerGetRemaining(t)<=0) or (IsUnitDeadBJ(caster)) or n <= 0
        call PolledWait(0.25)
        set a=0
        loop
            exitwhen a>=n          
            if GetUnitLifePercent( caster ) < 50 or GetUnitManaPercent( caster ) < 50 and GetWidgetLife(caster) > 0 then
            if GetUnitLifePercent( caster ) < 50 then
            call SetUnitLifePercentBJ( caster, GetUnitLifePercent( caster )+25.0 )
            else
            call SetUnitManaPercentBJ( caster, GetUnitManaPercent( caster )+25.0 )
            endif
            call DestroyEffect( AddSpellEffectTargetById( s, EFFECT_TYPE_TARGET, caster, "origin" ) )
            call RemoveUnit( elec[a] ) 
            set elec[a]=elec[n-1]
            set elec[n-1]=null
            set n=n-1
            endif
            set l = Location(GetUnitX(caster)+150*CosBJ(grad+a*360/n), GetUnitY(caster)+150*SinBJ(grad+a*360/n))
            set l2 = GetUnitLoc(elec[a])
            if DistanceBetweenPoints(l, l2) <= 1000.00 then
            call IssuePointOrderLoc(elec[a], "move", l)
            else
            call SetUnitPositionLoc( elec[a],l )
            endif
            call RemoveLocation(l)
            call RemoveLocation(l2)
            set a=a+1
        endloop
        set grad = ModuloReal(grad+30,360)
    endloop
 if IsUnitDeadBJ(caster) == true or caster == null or TimerGetRemaining(t)<=0 then
 set a=0
 loop
 exitwhen a>=n   
 call RemoveUnit( elec[a] )
 set elec[a]=null 
 set a=a+1
 endloop
 endif
 call DestroyTimer(t)
 call RemoveLocation(l)
 call RemoveLocation(l2)
 set t=null
 set l = null
 set l2 = null
 set caster = null
endfunction

//===========================================================================
function InitTrig_Shield_of_divinity takes nothing returns nothing
    set gg_trg_Shield_of_divinity = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Shield_of_divinity, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Shield_of_divinity, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Shield_of_divinity, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Shield_of_divinity, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Shield_of_divinity, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Shield_of_divinity, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Shield_of_divinity, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Shield_of_divinity, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Shield_of_divinity, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Shield_of_divinity, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Shield_of_divinity, Condition( function Trig_DivinityShield_Conditions ) )
    call TriggerAddAction( gg_trg_Shield_of_divinity, function Trig_DivinityShield_Actions )
endfunction//===========================================================================
// Trigger: Nova
//===========================================================================
function Trig_Nova_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A0AL' then
return true
endif
return false
endfunction

function novacheck takes nothing returns boolean
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
if IsUnitAlly(GetFilterUnit(), p) == false and IsUnitType(GetFilterUnit(), UNIT_TYPE_STRUCTURE) == false and IsUnitAliveBJ(GetFilterUnit()) == true then
set u = null
set p = null
return true
endif
set u = null
set p = null
return false 
endfunction

function novakill takes nothing returns nothing
local unit u = GetTriggerUnit()
local unit u2 = GetEnumUnit()
local real d = (I2R(GetHeroLevel(u) * GetHeroLevel(u) * GetHeroLevel(u))/1250.0) + (I2R(GetHeroLevel(u)) * 10)
call UnitDamageTargetBJ( u, u2, d, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_NORMAL )
set u = null
set u2 = null
endfunction

function Trig_Nova_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local location l = GetUnitLoc(u)
local location l2 = null
local integer i = 0
local integer i2 = 0
local effect e = null
local group g
loop
exitwhen i > 11 or IsUnitAliveBJ(u) == false
set i2 = 0
loop
exitwhen i2 > 35
set l2 = PolarProjectionBJ(l, I2R(25 * i), I2R(i2 * 10))
call AddSpecialEffectLocBJ( l2, "Abilities\\Spells\\Other\\AcidBomb\\BottleImpact.mdl" )
set e = GetLastCreatedEffectBJ()
call DestroyEffectBJ( e)
set g = GetUnitsInRangeOfLocMatching(75.00, l2, Condition(function novacheck))
call ForGroupBJ( g, function novakill )
call DestroyGroup(g)
call RemoveLocation(l2)
set i2 = i2 + 1
endloop
call TriggerSleepAction( 0.00 )
set i = i + 1
endloop
set u = null
call RemoveLocation(l)
set l2 = null
set l = null
set e = null
set g = null
endfunction

//===========================================================================
function InitTrig_Nova takes nothing returns nothing
    set gg_trg_Nova = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nova, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nova, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nova, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nova, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nova, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nova, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nova, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nova, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nova, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nova, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Nova, Condition( function Trig_Nova_Conditions ) )
    call TriggerAddAction( gg_trg_Nova, function Trig_Nova_Actions )
endfunction

//===========================================================================
// Trigger: Mend
//===========================================================================
function Trig_Mend_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A0BJ' then
return true
endif
return false
endfunction

function Trig_Mend_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
call SetUnitLifePercentBJ( u, ( GetUnitLifePercent(u) + 75 ) )
set u = null
endfunction

//===========================================================================
function InitTrig_Mend takes nothing returns nothing
    set gg_trg_Mend = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Mend, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Mend, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Mend, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Mend, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Mend, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Mend, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Mend, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Mend, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Mend, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Mend, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Mend, Condition( function Trig_Mend_Conditions ) )
    call TriggerAddAction( gg_trg_Mend, function Trig_Mend_Actions )
endfunction

//===========================================================================
// Trigger: Battle Rage
//===========================================================================
function Trig_Battle_Rage_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A0BI' then
return true
endif
return false
endfunction

function BattleRageCheck takes nothing returns boolean
local unit u = GetTriggerUnit()
local unit u2 = GetFilterUnit()
local player p = GetOwningPlayer(u)
if IsUnitAlly(u2, p) == false and IsUnitType(u2, UNIT_TYPE_STRUCTURE) == false and IsUnitAliveBJ(u2) == true then
set u = null
set u2 = null
set p = null
return true
endif
set u = null
set u2 = null
set p = null
return false 
endfunction

function BattleRage takes nothing returns nothing
local unit u = GetTriggerUnit()
local unit u2 = GetEnumUnit()
local real d = (I2R(GetHeroLevel(u) * GetHeroLevel(u) * GetHeroLevel(u))/500.0) + (I2R(GetHeroLevel(u)) * 25)
call UnitDamageTargetBJ( u, u2, d, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_NORMAL )
set u = null
set u2 = null
endfunction

function Trig_Battle_Rage_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local location l = GetUnitLoc(u)
local group g = GetUnitsInRangeOfLocMatching(500.00, l, Condition(function BattleRageCheck))
call ForGroupBJ(g,function BattleRage)
call RemoveLocation(l)
call DestroyGroup(g)
set u = null
set l = null
set g = null
endfunction

//===========================================================================
function InitTrig_Battle_Rage takes nothing returns nothing
    set gg_trg_Battle_Rage = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Battle_Rage, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Battle_Rage, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Battle_Rage, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Battle_Rage, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Battle_Rage, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Battle_Rage, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Battle_Rage, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Battle_Rage, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Battle_Rage, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Battle_Rage, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Battle_Rage, Condition( function Trig_Battle_Rage_Conditions ) )
    call TriggerAddAction( gg_trg_Battle_Rage, function Trig_Battle_Rage_Actions )
endfunction

//===========================================================================
// Trigger: Nova wiz
//===========================================================================
function Trig_Nova_Wiz_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A09S' then
return true
endif
return false
endfunction

function novacheck2 takes nothing returns boolean
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
if IsUnitAlly(GetFilterUnit(), p) == false and IsUnitType(GetFilterUnit(), UNIT_TYPE_STRUCTURE) == false and IsUnitAliveBJ(GetFilterUnit()) == true then
set u = null
set p = null
return true
endif
set u = null
set p = null
return false 
endfunction

function novakill2 takes nothing returns nothing
local unit u = GetTriggerUnit()
local unit u2 = GetEnumUnit()
local real d = (I2R(GetHeroLevel(u) * GetHeroLevel(u) * GetHeroLevel(u))/1000.0) + (I2R(GetHeroLevel(u)) * 10)
call UnitDamageTargetBJ( u, u2, d, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_NORMAL )
set u = null
set u2 = null
endfunction

function Trig_Nova_Wiz_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local location l = GetUnitLoc(u)
local location l2 = null
local integer i = 0
local integer i2 = 0
local effect e = null
local group g
loop
exitwhen i > 15 or IsUnitAliveBJ(u) == false
set i2 = 0
loop
exitwhen i2 > 35
set l2 = PolarProjectionBJ(l, I2R(25 * i), I2R(i2 * 10))
call AddSpecialEffectLocBJ( l2, "Abilities\\Weapons\\RedDragonBreath\\RedDragonMissile.mdl" )
set e = GetLastCreatedEffectBJ()
call DestroyEffectBJ( e)
set g = GetUnitsInRangeOfLocMatching(75.00, l2, Condition(function novacheck2))
call ForGroupBJ( g, function novakill2 )
call DestroyGroup(g)
call RemoveLocation(l2)
set i2 = i2 + 1
endloop
call TriggerSleepAction( 0.00 )
set i = i + 1
endloop
set u = null
call RemoveLocation(l)
set l2 = null
set l = null
set e = null
set g = null
endfunction

//===========================================================================
function InitTrig_Nova_wiz takes nothing returns nothing
    set gg_trg_Nova_wiz = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nova_wiz, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nova_wiz, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nova_wiz, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nova_wiz, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nova_wiz, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nova_wiz, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nova_wiz, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nova_wiz, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nova_wiz, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Nova_wiz, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Nova_wiz, Condition( function Trig_Nova_Wiz_Conditions ) )
    call TriggerAddAction( gg_trg_Nova_wiz, function Trig_Nova_Wiz_Actions )
endfunction

//===========================================================================
// Trigger: Dark Pact
//===========================================================================
function Trig_Dark_Pact_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A00W' then
return true
endif
return false
endfunction

function darkpact takes nothing returns boolean
local unit u = GetTriggerUnit()
local player p = GetOwningPlayer(u)
if IsUnitType(GetFilterUnit(), UNIT_TYPE_GROUND) == true and IsUnitEnemy(GetFilterUnit(), p) == true and IsUnitAliveBJ(GetFilterUnit()) == true then
set u = null
set p = null
return true
endif
set u = null
set p = null
return false
endfunction

function darkpactkill takes nothing returns nothing
local unit u = GetTriggerUnit()
local unit u2 = GetEnumUnit()
local location l = GetUnitLoc(u2)
local effect e = AddSpecialEffectLocBJ( l, "Abilities\\Spells\\Demon\\DemonBoltImpact\\DemonBoltImpact.mdl" )
local real d = (GetUnitStateSwap(UNIT_STATE_MAX_LIFE, u2) / 2 )
if IsUnitType(u2, UNIT_TYPE_STRUCTURE) == true then
call UnitDamageTargetBJ( u, u2, (d / 4), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_NORMAL )
else
call UnitDamageTargetBJ( u, u2, d, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_NORMAL )
endif
set u = null
set u2 = null
set e = null
call RemoveLocation(l)
set l = null
endfunction

function Trig_Dark_Pact_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local location l = GetUnitLoc(u)
local location l2 = null
local effect array e
local integer i = 1
local group g
loop
exitwhen i > 6
set l2 = PolarProjectionBJ(l,200.0,I2R(i*60))
call AddSpecialEffectLocBJ( l2, "Abilities\\Spells\\Orc\\EarthQuake\\EarthQuakeTarget.mdl" )
set e[i] = GetLastCreatedEffectBJ()
set i = i + 1
endloop
set i = 1
loop
exitwhen i > 8
set g = GetUnitsInRangeOfLocMatching(500.00, l, Condition(function darkpact))
call ForGroupBJ( g, function darkpactkill )
call DestroyGroup(g)
call PolledWait(0.50)
set i = i + 1
endloop

call RemoveLocation(l)
set l = null
set l2 = null
set u = null
set g = null
call DestroyEffectBJ(e[1])
call DestroyEffectBJ(e[2])
call DestroyEffectBJ(e[3])
call DestroyEffectBJ(e[4])
call DestroyEffectBJ(e[5])
call DestroyEffectBJ(e[6])
set e[1] = null
set e[2] = null
set e[3] = null
set e[4] = null
set e[5] = null
set e[6] = null
endfunction

//===========================================================================
function InitTrig_Dark_Pact takes nothing returns nothing
    set gg_trg_Dark_Pact = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Dark_Pact, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Dark_Pact, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Dark_Pact, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Dark_Pact, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Dark_Pact, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Dark_Pact, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Dark_Pact, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Dark_Pact, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Dark_Pact, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Dark_Pact, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Dark_Pact, Condition( function Trig_Dark_Pact_Conditions ) )
    call TriggerAddAction( gg_trg_Dark_Pact, function Trig_Dark_Pact_Actions )
endfunction

//===========================================================================
// Trigger: Death Coil
//===========================================================================
function Trig_Death_Coil_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A044' then
return true
endif
return false
endfunction

function Trig_Death_Coil_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
call UnitDamageTargetBJ( u, u2, I2R(GetHeroStatBJ(bj_HEROSTAT_STR, u, false)), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_DEATH )
set u = null
set u2 = null
endfunction

//===========================================================================
function InitTrig_Death_Coil takes nothing returns nothing
    set gg_trg_Death_Coil = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Death_Coil, Player(11), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Death_Coil, Player(PLAYER_NEUTRAL_AGGRESSIVE), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Death_Coil, Condition( function Trig_Death_Coil_Conditions ) )
    call TriggerAddAction( gg_trg_Death_Coil, function Trig_Death_Coil_Actions )
endfunction

//===========================================================================
// Trigger: Finger of Pain
//===========================================================================
function Trig_Finger_of_Pain_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A0AM' then
return true
endif
return false
endfunction

function Trig_Finger_of_Pain_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
call UnitDamageTargetBJ( u, u2, I2R(GetHeroStatBJ(bj_HEROSTAT_STR, u, false)), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_DEATH )
set u = null
set u2 = null
endfunction

//===========================================================================
function InitTrig_Finger_of_Pain takes nothing returns nothing
    set gg_trg_Finger_of_Pain = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Death_Coil, Player(11), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Finger_of_Pain, Condition( function Trig_Finger_of_Pain_Conditions ) )
    call TriggerAddAction( gg_trg_Finger_of_Pain, function Trig_Finger_of_Pain_Actions )
endfunction

//===========================================================================
// Trigger: Destruction Bolt and Frost Bolt
//
// 
//===========================================================================
function Trig_Destruction_Bolt_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A04W' or GetSpellAbilityId() == 'A08X' then
return true
endif
return false
endfunction

function Trig_Destruction_Bolt_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
call UnitDamageTargetBJ( u, u2, I2R(GetUnitLevel(u) * GetUnitLevel(u) * 2), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_DEATH )
set u = null
set u2 = null
endfunction

//===========================================================================
function InitTrig_Destruction_Bolt_and_Frost_Bolt takes nothing returns nothing
    set gg_trg_Destruction_Bolt_and_Frost_Bolt = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Death_Coil, Player(10), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Death_Coil, Player(11), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Death_Coil, Player(PLAYER_NEUTRAL_AGGRESSIVE), EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition( gg_trg_Destruction_Bolt_and_Frost_Bolt, Condition( function Trig_Destruction_Bolt_Conditions ) )
    call TriggerAddAction( gg_trg_Destruction_Bolt_and_Frost_Bolt, function Trig_Destruction_Bolt_Actions )
endfunction

//===========================================================================
// Trigger: Finger of Death
//===========================================================================
function Trig_Finger_of_Death_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A08Z' then
return true
endif
return false
endfunction

function Trig_Finger_of_Death_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
call UnitDamageTargetBJ( u, u2, I2R(GetUnitLevel(u) * GetUnitLevel(u) * 5), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_DEATH )
set u = null
set u2 = null
endfunction

//===========================================================================
function InitTrig_Finger_of_Death takes nothing returns nothing
    set gg_trg_Finger_of_Death = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Death_Coil, Player(11), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Death_Coil, Player(PLAYER_NEUTRAL_AGGRESSIVE), EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition( gg_trg_Finger_of_Death, Condition( function Trig_Finger_of_Death_Conditions ) )
    call TriggerAddAction( gg_trg_Finger_of_Death, function Trig_Finger_of_Death_Actions )
endfunction

//===========================================================================
// Trigger: Ray of Light
//===========================================================================
function Trig_Ray_of_Light_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A0BB' then
return true
endif
return false
endfunction

function RayofLightCheck takes nothing returns boolean
local unit u = GetFilterUnit()
if IsUnitType(u, UNIT_TYPE_STRUCTURE) == false and IsUnitAliveBJ(u) == true then
set u = null
return true
endif
set u = null
return false
endfunction

function RayofLightEffect takes nothing returns nothing
local unit u = GetEnumUnit()
local unit u2 = GetTriggerUnit()
local player p = GetOwningPlayer(u2)
if IsUnitAlly(u, p) == true then
call SetUnitLifeBJ( u, ( GetUnitStateSwap(UNIT_STATE_LIFE, u) + (I2R(GetHeroLevel(u2) * GetHeroLevel(u2) * GetHeroLevel(u2)) / 250.0) + (I2R(GetHeroLevel(u2)) * 50)) )
else
call UnitDamageTargetBJ( u2, u,(I2R(GetHeroLevel(u2) * GetHeroLevel(u2) * GetHeroLevel(u2))/500.0) + (I2R(GetHeroLevel(u2)) * 25), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_NORMAL )
endif
set u = null
set u2 = null
set p = null
endfunction

function Trig_Ray_of_Light_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local location l = GetUnitLoc(u)
local location l2 = null
local integer i = 0
local group g
local effect array e
local lightning array li
call AddSpecialEffectLocBJ( l, "Abilities\\Spells\\Orc\\Disenchant\\DisenchantSpecialArt.mdl" )
set e[1] = GetLastCreatedEffectBJ()
call AddSpecialEffectLocBJ( l, "Abilities\\Spells\\Human\\Resurrect\\ResurrectCaster.mdl" )
set e[2] = GetLastCreatedEffectBJ()
call PolledWait(1.25)
call DestroyEffectBJ( e[1] ) 
call DestroyEffectBJ( e[2] ) 
call AddSpecialEffectLocBJ( l, "Abilities\\Spells\\Human\\ReviveHuman\\ReviveHuman.mdl" )
set e[3] = GetLastCreatedEffectBJ()
loop
exitwhen i == 39
set l2 = PolarProjectionBJ(l, 500, I2R(i * 9))
call AddLightningLoc( "FORK", l2, l )  
set li[i] = GetLastCreatedLightningBJ()
call SetLightningColorBJ( li[i], 100.00, 100.00, 0.00, 100.00 )
call RemoveLocation(l2)
set i = i + 1
endloop
set g = GetUnitsInRangeOfLocMatching(500.00, l, Condition(function RayofLightCheck))
call ForGroupBJ(g,function RayofLightEffect)
call PolledWait(1.50)
set i = 0
loop
exitwhen i == 39
call DestroyLightningBJ( li[i] )
set li[i] = null
set i = i + 1
endloop
call DestroyEffectBJ( e[3] ) 
call DestroyGroup(g)
call RemoveLocation(l)
set e[1] = null
set e[2] = null
set e[3] = null
set g = null
set l2 = null
set l = null
set u = null
endfunction

//===========================================================================
function InitTrig_Ray_of_Light takes nothing returns nothing
    set gg_trg_Ray_of_Light = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Ray_of_Light, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Ray_of_Light, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Ray_of_Light, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Ray_of_Light, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Ray_of_Light, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Ray_of_Light, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Ray_of_Light, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Ray_of_Light, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Ray_of_Light, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Ray_of_Light, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Ray_of_Light, Condition( function Trig_Ray_of_Light_Conditions ) )
    call TriggerAddAction( gg_trg_Ray_of_Light, function Trig_Ray_of_Light_Actions )
endfunction

//===========================================================================
// Trigger: Soul Drain
//===========================================================================
function Trig_Soul_Drain_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A0BC' or GetSpellAbilityId() == 'A0BD' or GetSpellAbilityId() == 'A0BE' or GetSpellAbilityId() == 'A0BF' or GetSpellAbilityId() == 'A0BG' then
return true
endif
return false
endfunction

function Trig_Soul_Drain_Actions takes nothing returns nothing
local unit u = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
if GetSpellAbilityId() == 'A0BC' then
call UnitDamageTargetBJ( u, u2, (GetUnitStateSwap(UNIT_STATE_MAX_LIFE, u2) / 10 ), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_DEATH )
call UnitDamageTargetBJ( u, u2, (GetUnitStateSwap(UNIT_STATE_MAX_MANA, u2) / 10 ), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_DEATH )
call SetUnitLifePercentBJ( u, ( GetUnitLifePercent(u) + 10 ) )
call SetUnitManaPercentBJ( u, ( GetUnitManaPercent(u) + 10 ) )
endif
if GetSpellAbilityId() == 'A0BD' then
call UnitDamageTargetBJ( u, u2, (GetUnitStateSwap(UNIT_STATE_MAX_LIFE, u2) / 5 ), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_DEATH )
call UnitDamageTargetBJ( u, u2, (GetUnitStateSwap(UNIT_STATE_MAX_MANA, u2) / 5 ), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_DEATH )
call SetUnitLifePercentBJ( u, ( GetUnitLifePercent(u) + 20 ) )
call SetUnitManaPercentBJ( u, ( GetUnitManaPercent(u) + 20 ) )
endif
if GetSpellAbilityId() == 'A0BE' then
call UnitDamageTargetBJ( u, u2, (GetUnitStateSwap(UNIT_STATE_MAX_LIFE, u2) / 10 * 3 ), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_DEATH )
call UnitDamageTargetBJ( u, u2, (GetUnitStateSwap(UNIT_STATE_MAX_MANA, u2) / 10 * 3 ), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_DEATH )
call SetUnitLifePercentBJ( u, ( GetUnitLifePercent(u) + 30 ) )
call SetUnitManaPercentBJ( u, ( GetUnitManaPercent(u) + 30 ) )
endif
if GetSpellAbilityId() == 'A0BF' then
call UnitDamageTargetBJ( u, u2, (GetUnitStateSwap(UNIT_STATE_MAX_LIFE, u2) / 10 * 4 ), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_DEATH )
call UnitDamageTargetBJ( u, u2, (GetUnitStateSwap(UNIT_STATE_MAX_MANA, u2) / 10 * 4 ), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_DEATH )
call SetUnitLifePercentBJ( u, ( GetUnitLifePercent(u) + 40 ) )
call SetUnitManaPercentBJ( u, ( GetUnitManaPercent(u) + 40 ) )
endif
if GetSpellAbilityId() == 'A0BG' then
call UnitDamageTargetBJ( u, u2, (GetUnitStateSwap(UNIT_STATE_MAX_LIFE, u2) / 2 ), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_DEATH )
call UnitDamageTargetBJ( u, u2, (GetUnitStateSwap(UNIT_STATE_MAX_MANA, u2) / 2 ), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_DEATH )
call SetUnitLifePercentBJ( u, ( GetUnitLifePercent(u) + 50 ) )
call SetUnitManaPercentBJ( u, ( GetUnitManaPercent(u) + 50 ) )
endif
set u = null
set u2 = null
endfunction

//===========================================================================
function InitTrig_Soul_Drain takes nothing returns nothing
    set gg_trg_Soul_Drain = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Soul_Drain, Player(0), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Soul_Drain, Player(1), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Soul_Drain, Player(2), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Soul_Drain, Player(3), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Soul_Drain, Player(4), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Soul_Drain, Player(5), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Soul_Drain, Player(6), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Soul_Drain, Player(7), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Soul_Drain, Player(8), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Soul_Drain, Player(9), EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Soul_Drain, Condition( function Trig_Soul_Drain_Conditions ) )
    call TriggerAddAction( gg_trg_Soul_Drain, function Trig_Soul_Drain_Actions )
endfunction

//===========================================================================
// Trigger: Gold Factory
//===========================================================================
function Trig_Gold_Factory_Conditions takes nothing returns boolean
if GetSpellAbilityId() == 'A0BN' then
return true
endif
return false
endfunction

function Trig_Gold_Factory_Actions takes nothing returns nothing
local unit u2 = GetTriggerUnit()
local player p = GetOwningPlayer(u2)
local location l = null
local location l2 = GetSpellTargetLoc()
local unit array u
local integer i = 0
call CreateNUnitsAtLoc( 1, 'h02Q', p, l2, 270.0 )
set u[0] = GetLastCreatedUnit()
set l = GetUnitLoc(u[0])
loop
exitwhen i > 19
set i = i + 1
call CreateNUnitsAtLoc( 1, 'n017', p, l, 270.0 )
set u[i] = GetLastCreatedUnit()
call PolledWait(1.00)
endloop
set i = -1
loop 
exitwhen i > 19
set i = i + 1
call KillUnit(u[i])
set u[i] = null
endloop
call RemoveLocation(l)
call RemoveLocation(l2)
set u2 = null
set p = null
set l = null
set l2 = null
endfunction

//===========================================================================
function InitTrig_Gold_Factory takes nothing returns nothing
    set gg_trg_Gold_Factory = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gold_Factory, Player(0), EVENT_PLAYER_UNIT_SPELL_CAST )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gold_Factory, Player(1), EVENT_PLAYER_UNIT_SPELL_CAST )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gold_Factory, Player(2), EVENT_PLAYER_UNIT_SPELL_CAST )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gold_Factory, Player(3), EVENT_PLAYER_UNIT_SPELL_CAST )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gold_Factory, Player(4), EVENT_PLAYER_UNIT_SPELL_CAST )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gold_Factory, Player(5), EVENT_PLAYER_UNIT_SPELL_CAST )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gold_Factory, Player(6), EVENT_PLAYER_UNIT_SPELL_CAST )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gold_Factory, Player(7), EVENT_PLAYER_UNIT_SPELL_CAST )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gold_Factory, Player(8), EVENT_PLAYER_UNIT_SPELL_CAST )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Gold_Factory, Player(9), EVENT_PLAYER_UNIT_SPELL_CAST )
    call TriggerAddCondition( gg_trg_Gold_Factory, Condition( function Trig_Gold_Factory_Conditions ) )
    call TriggerAddAction( gg_trg_Gold_Factory, function Trig_Gold_Factory_Actions )
endfunction

//===========================================================================
// Trigger: Green Brown Grey Dies
//===========================================================================
function Trig_Green_Brown_Grey_Dies_Actions takes nothing returns nothing
local unit u = GetDyingUnit()
local integer i = 5 

if GetUnitTypeId(u) == 'n012' then
call GroupRemoveUnitSimple( u, udg_EquipmentCamps )
endif
if IsUnitInGroup(u, udg_KalendenArmy) == true then
call GroupRemoveUnitSimple( u, udg_KalendenArmy )
endif
if IsUnitInGroup(u, udg_CompArmy) == true then
call GroupRemoveUnitSimple( u, udg_CompArmy )
endif
if IsUnitInGroup(u, udg_KalendenLargeArmy) == true then
call GroupRemoveUnitSimple( u, udg_KalendenLargeArmy )
endif
if IsUnitInGroup(u, udg_QuestArmy) == true then
call GroupRemoveUnitSimple( u, udg_QuestArmy )
endif
if IsUnitInGroup(u, udg_RebellionArmy) == true then
call GroupRemoveUnitSimple( u, udg_RebellionArmy )
endif

loop
exitwhen i == 25
if IsUnitInGroup(u, udg_Group[i]) == true then
call GroupRemoveUnitSimple( u, udg_Group[i] )
set i = i + 1
endif
endloop

call PolledWait( 3.00 )
call RemoveUnit( u )
set u = null
endfunction

//===========================================================================
function InitTrig_Green_Brown_Grey_Dies takes nothing returns nothing
    set gg_trg_Green_Brown_Grey_Dies = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Green_Brown_Grey_Dies, Player(10), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Green_Brown_Grey_Dies, Player(11), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Green_Brown_Grey_Dies, Player(PLAYER_NEUTRAL_AGGRESSIVE), EVENT_PLAYER_UNIT_DEATH )
    call TriggerAddAction( gg_trg_Green_Brown_Grey_Dies, function Trig_Green_Brown_Grey_Dies_Actions )
endfunction

//===========================================================================
// Trigger: Spawning
//===========================================================================
function BuildingCheck takes nothing returns boolean
local unit u = GetFilterUnit()
if IsUnitType(u, UNIT_TYPE_STRUCTURE) == true then 
set u = null
return true
endif
set u = null
return false
endfunction

function Spawning takes nothing returns nothing
local unit spawner = GetEnumUnit()
local location l = GetUnitLoc(spawner)
local location l2
local integer i
local group g 
local unit u

set udg_Random = udg_Random - 1

if GetUnitUserData(spawner) > 0 then
call SetUnitUserData( spawner, ( GetUnitUserData(spawner) - 1 ) )
else
if UnitHasBuffBJ(spawner, 'B01B') == false then

//Quest Monster Spawn
if udg_Random > -20 and udg_Random < 20 and GetUnitUserData(spawner) == 0 and udg_MonsterDrop > 0 and UnitHasBuffBJ(spawner, 'B016') == false then
call CreateNUnitsAtLoc( 1, udg_MonsterType, Player(PLAYER_NEUTRAL_AGGRESSIVE), l, 270.0 )
set u = GetLastCreatedUnit()
call SetUnitUserData( u, udg_MonsterDrop )
call PingMinimapLocForForceEx( GetForceOfPlayer(udg_player2), l, 20.00, bj_MINIMAPPINGSTYLE_SIMPLE, 100, 100, 0.00 ) 
call RebelLevel(0)
call CreateNUnitsAtLoc( 3, bj_groupCountUnits, Player(PLAYER_NEUTRAL_AGGRESSIVE), l, 270.0 )
set udg_MonsterDrop = 0
call SetUnitUserData( spawner, 48 )
endif

//Quest Spawn
if udg_Random > -10 and udg_Random < 10 and GetUnitUserData(spawner) == 0 and udg_QuestSpawn == 1 and UnitHasBuffBJ(spawner, 'B016') == false then
call SetUnitUserData( spawner, 2 )
call CreateNUnitsAtLoc( 1, 'n00X', Player(PLAYER_NEUTRAL_PASSIVE), l, 270.0 )
set u = GetLastCreatedUnit()
call UnitAddAbilityBJ( 'Awan', u )
set udg_QuestSpawn = 0
endif

//Obelisk Spawn
if udg_Random > -5 and udg_Random < 5 and GetUnitUserData(spawner) == 0 and udg_ObeliskSpawn == 2 and UnitHasBuffBJ(spawner, 'B016') == false then
call PlaySoundBJ( gg_snd_Warning )
set udg_ObeliskSpawn = 1
call PingMinimapLocForForceEx( GetPlayersAll(), l, 20.00, bj_MINIMAPPINGSTYLE_SIMPLE, 100.00, 0.00, 0.00 )
call DisplayTimedTextToForce( GetPlayersAll(), 19.00, "|c00ff0000Forces of Kalenden have started the construction of a Power Obelisk it must be destroyed!" )
call CreateNUnitsAtLoc( 1, 'u001', Player(11), l, 270.0 )
set udg_Obelisk = GetLastCreatedUnit()
call Level(3,bj_cineModeSavedSeed)
set i = 0
loop
exitwhen i == 9
set l2 = PolarProjectionBJ(l, 300, I2R(i * 36))
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, Player(PLAYER_NEUTRAL_AGGRESSIVE), l2, 270.0 )
call RemoveLocation(l2)
set i = i + 1
endloop
set l2 = null
call StartTimerBJ( udg_Obilisk, false, 600.00 )
call CreateTimerDialogBJ( GetLastCreatedTimerBJ(), "Obelisk" )
call PauseTimerBJ( false, udg_Obilisk )
set udg_obilisktimerwindow = GetLastCreatedTimerDialogBJ()
call TimerDialogDisplayBJ( true, udg_obilisktimerwindow )
call SetUnitUserData( spawner, 10 )
endif

//Equipment Camp
if udg_Random > -5 and udg_Random < 5 and GetUnitUserData(spawner) == 0 and udg_EquipmentCamp == 1 and UnitHasBuffBJ(spawner, 'B016') == false then
set g = GetUnitsOfPlayerAndTypeId(Player(10), 'n012')
if CountUnitsInGroup(g) > 2 then
set udg_EquipmentCamp = 0
else
call PlaySoundBJ( gg_snd_Warning )
set udg_EquipmentCamp = 0
call PingMinimapLocForForceEx( GetPlayersAll(), l, 20.00, bj_MINIMAPPINGSTYLE_SIMPLE, 50.00, 50.00, 50.00 )
call CreateNUnitsAtLoc( 1, 'n012', Player(10), l, 270.0 )
set u = GetLastCreatedUnit()
call GroupAddUnitSimple( u, udg_EquipmentCamps )
call DisplayTimedTextToForce( GetPlayersAll(), 19.00, "|c00ff0000The Rebellions have built a new Equipment Camp!" )
call SetUnitUserData( spawner, 10 )
endif
endif

// Creep Spawn
if GetUnitUserData(spawner) == 0 and UnitHasBuffBJ(spawner, 'B016') == true then
call Level(R2I(GetUnitFacing(spawner) - 1),bj_cineModeSavedSeed)

if bj_cineModeSavedSeed == 4 or bj_cineModeSavedSeed == 5 then
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, Player(PLAYER_NEUTRAL_AGGRESSIVE), l, 270.0 )
set u = GetLastCreatedUnit()
call UnitApplyTimedLifeBJ( 120.00, 'BTLF', u )
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, Player(PLAYER_NEUTRAL_AGGRESSIVE), l, 270.0 )
set u = GetLastCreatedUnit()
call UnitApplyTimedLifeBJ( 120.00, 'BTLF', u )
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, Player(PLAYER_NEUTRAL_AGGRESSIVE), l, 270.0 )
set u = GetLastCreatedUnit()
call UnitApplyTimedLifeBJ( 120.00, 'BTLF', u )
endif
if bj_cineModeSavedSeed == 2 or bj_cineModeSavedSeed == 3 then
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, Player(PLAYER_NEUTRAL_AGGRESSIVE), l, 270.0 )
set u = GetLastCreatedUnit()
call UnitApplyTimedLifeBJ( 120.00, 'BTLF', u )
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, Player(PLAYER_NEUTRAL_AGGRESSIVE), l, 270.0 )
set u = GetLastCreatedUnit()
call UnitApplyTimedLifeBJ( 120.00, 'BTLF', u )
endif
if bj_cineModeSavedSeed == 1 then
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, Player(PLAYER_NEUTRAL_AGGRESSIVE), l, 270.0 )
set u = GetLastCreatedUnit()
call UnitApplyTimedLifeBJ( 120.00, 'BTLF', u )
endif
call SetUnitUserData( spawner, 14 )
endif
endif

endif
call DestroyGroup(g)
call RemoveLocation(l)
call RemoveLocation(l2)
set g = null
set l = null
set l2 = null
set spawner = null
set u = null
endfunction


function Trig_Spawning_Actions takes nothing returns nothing
set udg_Random = GetRandomInt(1,CountUnitsInGroup(udg_Spawners))
if udg_Random < CountUnitsInGroup(udg_Spawners) / 5 then 
set bj_cineModeSavedSeed = 1
endif
if udg_Random >= CountUnitsInGroup(udg_Spawners) / 5 and udg_Random < (CountUnitsInGroup(udg_Spawners) / 5) * 2 then 
set bj_cineModeSavedSeed = 2
endif
if udg_Random >= (CountUnitsInGroup(udg_Spawners) / 5) * 2  and udg_Random < (CountUnitsInGroup(udg_Spawners) / 5) * 3 then 
set bj_cineModeSavedSeed = 3
endif
if udg_Random >= (CountUnitsInGroup(udg_Spawners) / 5) * 3 and udg_Random < (CountUnitsInGroup(udg_Spawners) / 5) * 4 then 
set bj_cineModeSavedSeed = 4
endif
if udg_Random >= (CountUnitsInGroup(udg_Spawners) / 5) * 4 then 
set bj_cineModeSavedSeed = 5
endif
call ForGroupBJ( udg_Spawners, function Spawning )
endfunction

//===========================================================================
function InitTrig_Spawning takes nothing returns nothing
    set gg_trg_Spawning = CreateTrigger(  )
    call TriggerRegisterTimerEventPeriodic( gg_trg_Spawning, 6.00 )
    call TriggerAddAction( gg_trg_Spawning, function Trig_Spawning_Actions )
endfunction

//===========================================================================
// Trigger: other victem
//===========================================================================
function Trig_other_victem_Actions takes nothing returns nothing
local integer i = 1
local group g
local player p

    loop
        exitwhen i == 25
        set p = ForcePickRandomPlayer(udg_AttackerGroup)
        set g = GetUnitsOfPlayerAll(p)
        set udg_HuntedUnit[i] = FirstOfGroup(g)
        call DestroyGroup(g)
        set i = i + 1
    endloop

set g = null
set p = null
endfunction

//===========================================================================
function InitTrig_other_victem takes nothing returns nothing
    set gg_trg_other_victem = CreateTrigger(  )
    call TriggerRegisterTimerEventPeriodic( gg_trg_other_victem, 90.00 )
    call TriggerAddAction( gg_trg_other_victem, function Trig_other_victem_Actions )
endfunction

//===========================================================================
// Trigger: Order Creeps
//===========================================================================
function Order_Attack_1 takes nothing returns nothing
local location l = GetUnitLoc(udg_HuntedUnit[4])
local unit u = GetEnumUnit()
call IssuePointOrderLoc( u, "attack", l )
call RemoveLocation(l)
set u = null
set l = null
endfunction

function Order_Attack_2 takes nothing returns nothing
local location l = GetUnitLoc(udg_HuntedUnit[5])
local unit u = GetEnumUnit()
call IssuePointOrderLoc( u, "attack", l )
call RemoveLocation(l)
set u = null
set l = null
endfunction

function Trig_Order_Creeps_Actions takes nothing returns nothing
local location l1 = GetUnitLoc(udg_HuntedUnit[1])
local location l2 = GetUnitLoc(udg_HuntedUnit[2])
local location l3 = GetUnitLoc(udg_HuntedUnit[3])

call GroupPointOrderLoc( udg_KalendenLargeArmy, "attack", l1 )
call GroupPointOrderLoc( udg_KalendenArmy, "attack", l2 )
call GroupPointOrderLoc( udg_CompArmy, "attack", l3 )
call ForGroupBJ( udg_QuestArmy, function Order_Attack_1 )
call ForGroupBJ( udg_RebellionArmy, function Order_Attack_2 )

call RemoveLocation(l1)
call RemoveLocation(l2)
call RemoveLocation(l3)
set l1 = null
set l2 = null
set l3 = null
endfunction

//===========================================================================
function InitTrig_Order_Creeps takes nothing returns nothing
    set gg_trg_Order_Creeps = CreateTrigger(  )
    call TriggerRegisterTimerEventPeriodic( gg_trg_Order_Creeps, 11.99 )
    call TriggerAddAction( gg_trg_Order_Creeps, function Trig_Order_Creeps_Actions )
endfunction

//===========================================================================
// Trigger: Attacker Spawn
//===========================================================================
function Trig_Attacker_Spawn_Conditions takes nothing returns boolean
if udg_Damageunits == 1 and udg_KalendenDiff > 0 then
return true
endif
return false
endfunction

function Trig_Attacker_Spawn_Actions takes nothing returns nothing
local location l = GetRectCenter(gg_rct_Spawn)
local player p = Player(11)
local integer i = 0
local integer i2 = 0
local unit u = null
local integer i3 = GetRandomInt(1,5)

call StartTimerBJ( udg_SpawnUp, false, ( 100.00 - ( I2R(CountPlayersInForceBJ(udg_AttackerGroup)) * 9.00 ) ) )


//Comp Heroes
if CountUnitsInGroup(udg_CompArmy) == 0 then

call Level(0,i3)
set i2 = ( udg_KalendenDiff / 10 )
set i = 1
loop
exitwhen i > i2
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, p, l, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call RemoveGuardPosition( u )
call GroupAddUnitSimple( u, udg_CompArmy )
set i = i + 1
endloop

call Level(3,i3)
set i2 = ( udg_KalendenDiff / 20 )
set i = 1
loop
exitwhen i > i2
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, p, l, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call RemoveGuardPosition( u )
call GroupAddUnitSimple( u, udg_CompArmy )
set i = i + 1
endloop

call Level(6,i3)
set i2 = ( udg_KalendenDiff / 30 )
set i = 1
loop
exitwhen i > i2
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, p, l, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call RemoveGuardPosition( u )
call GroupAddUnitSimple( u, udg_CompArmy )
set i = i + 1
endloop

call CreateNUnitsAtLoc( 1, 'U002', p, l, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call SetHeroLevelBJ( u, udg_CreepCounter, false )
call SetUnitScalePercent( u, ( 50.00 + ( 2.5 * I2R(udg_CreepCounter) ) ), ( 50.00 + ( 2.5 * I2R(udg_CreepCounter) ) ), ( 50.00 + ( 2.5 * I2R(udg_CreepCounter) ) ) )
call ModifyHeroStat( bj_HEROSTAT_STR, u, bj_MODIFYMETHOD_SET, ( ( GetHeroLevel(u)  * ( ( GetHeroLevel(u) / 3 ) + 1 ) ) * (GetHeroLevel(u) * 2) ) )
call ModifyHeroStat( bj_HEROSTAT_INT, u, bj_MODIFYMETHOD_SET, ( ( ( GetHeroLevel(u) / 2 ) * ( ( GetHeroLevel(u) / 4 ) + 1 ) ) * (GetHeroLevel(u) / 2) ) )
call ModifyHeroStat( bj_HEROSTAT_AGI, u, bj_MODIFYMETHOD_SET, ( GetHeroLevel(u) * GetHeroLevel(u) * 2 ))
call GroupAddUnitSimple( u, udg_CompArmy )
endif

//Kalenden Army
if CountUnitsInGroup(udg_KalendenArmy) == 0 then

call Level(0,i3)
set i2 = ( udg_KalendenDiff / 10 )
set i = 1
loop
exitwhen i > i2
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, p, l, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call RemoveGuardPosition( u )
call GroupAddUnitSimple( u, udg_KalendenArmy )
set i = i + 1
endloop

call Level(3,i3)
set i2 = ( udg_KalendenDiff / 20 )
set i = 1
loop
exitwhen i > i2
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, p, l, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call RemoveGuardPosition( u )
call GroupAddUnitSimple( u, udg_KalendenArmy )
set i = i + 1
endloop

call Level(6,i3)
set i2 = ( udg_KalendenDiff / 30 )
set i = 1
loop
exitwhen i > i2
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, p, l, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call RemoveGuardPosition( u )
call GroupAddUnitSimple( u, udg_KalendenArmy )
set i = i + 1
endloop

call CreateNUnitsAtLoc( 1, 'U00D', p, l, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call SetHeroLevelBJ( u, udg_CreepCounter, false )
call SetUnitScalePercent( u, ( 50.00 + ( 2.5 * I2R(udg_CreepCounter) ) ), ( 50.00 + ( 2.5 * I2R(udg_CreepCounter) ) ), ( 50.00 + ( 2.5 * I2R(udg_CreepCounter) ) ) )
call ModifyHeroStat( bj_HEROSTAT_STR, u, bj_MODIFYMETHOD_SET, ( ( GetHeroLevel(u) * ( ( GetHeroLevel(u) / 3 ) + 1 ) ) * ( GetHeroLevel(u) * 2 ) ) )
call ModifyHeroStat( bj_HEROSTAT_INT, u, bj_MODIFYMETHOD_SET, ( ( ( GetHeroLevel(u) / 2 ) * ( ( GetHeroLevel(u) / 4 ) + 1 ) ) * ( GetHeroLevel(u) / 2 ) ) )
call ModifyHeroStat( bj_HEROSTAT_AGI, u, bj_MODIFYMETHOD_SET, ( GetHeroLevel(u) * GetHeroLevel(u) * 2 ))
call GroupAddUnitSimple( u, udg_KalendenArmy )
endif

call RemoveLocation(l)
set l = null
set u = null
set p = null
endfunction

//===========================================================================
function InitTrig_Attacker_Spawn takes nothing returns nothing
    set gg_trg_Attacker_Spawn = CreateTrigger(  )
    call TriggerRegisterTimerExpireEventBJ( gg_trg_Attacker_Spawn, udg_SpawnUp )
    call TriggerAddCondition( gg_trg_Attacker_Spawn, Condition( function Trig_Attacker_Spawn_Conditions ) )
    call TriggerAddAction( gg_trg_Attacker_Spawn, function Trig_Attacker_Spawn_Actions )
endfunction

//===========================================================================
// Trigger: Kalendens Army
//===========================================================================
function Trig_Kalendens_Army_Conditions takes nothing returns boolean
if udg_Damageunits == 1 and udg_KalendenDiff > 0 then
return true
endif
return false
endfunction

function Trig_Kalendens_Army_Actions takes nothing returns nothing
local location l = GetRectCenter(gg_rct_Spawn)
local player p = Player(11)
local integer i = GetRandomInt(1,5)
local unit u = null

if CountUnitsInGroup(udg_KalendenLargeArmy) == 0 then
//units
call Level(3,i)
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, p, l, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call RemoveGuardPosition( u )
call GroupAddUnitSimple( u, udg_KalendenLargeArmy )
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, p, l, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call RemoveGuardPosition( u )
call GroupAddUnitSimple( u, udg_KalendenLargeArmy )
call Level(6,i)
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, p, l, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call RemoveGuardPosition( u )
call GroupAddUnitSimple( u, udg_KalendenLargeArmy )
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, p, l, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call RemoveGuardPosition( u )
call GroupAddUnitSimple( u, udg_KalendenLargeArmy )

call RebelLevel(0)
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, p, l, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call RemoveGuardPosition( u )
call GroupAddUnitSimple( u, udg_KalendenLargeArmy )
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, p, l, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call RemoveGuardPosition( u )
call GroupAddUnitSimple( u, udg_KalendenLargeArmy )

//heroes
call CreateNUnitsAtLoc( 1, 'U00R', p, l, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call SetHeroLevelBJ( u, udg_CreepCounter, false )
call SetUnitScalePercent( u, ( 75.00 + ( 2.5 * I2R(udg_CreepCounter) ) ), ( 75.00 + ( 2.5 * I2R(udg_CreepCounter) ) ), ( 75.00 + ( 2.5 * I2R(udg_CreepCounter) ) ) )
call ModifyHeroStat( bj_HEROSTAT_STR, u, bj_MODIFYMETHOD_SET, ( ( GetHeroLevel(u)  * ( ( GetHeroLevel(u) / 2 ) + 1 ) ) * (GetHeroLevel(u) * 2) ) )
call ModifyHeroStat( bj_HEROSTAT_INT, u, bj_MODIFYMETHOD_SET, ( ( ( GetHeroLevel(u) / 2 ) * ( ( GetHeroLevel(u) / 4 ) + 1 ) ) * (GetHeroLevel(u) / 2) ) )
call ModifyHeroStat( bj_HEROSTAT_AGI, u, bj_MODIFYMETHOD_SET, ( GetHeroLevel(u) * GetHeroLevel(u) * 2 ))
call GroupAddUnitSimple( u, udg_KalendenLargeArmy )

call CreateNUnitsAtLoc( 1, 'U00Q', p, l, bj_UNIT_FACING )
set u = GetLastCreatedUnit()
call SetHeroLevelBJ( u, udg_CreepCounter, false )
call SetUnitScalePercent( u, ( 75.00 + ( 2.5 * I2R(udg_CreepCounter) ) ), ( 75.00 + ( 2.5 * I2R(udg_CreepCounter) ) ), ( 75.00 + ( 2.5 * I2R(udg_CreepCounter) ) ) )
call ModifyHeroStat( bj_HEROSTAT_STR, u, bj_MODIFYMETHOD_SET, ( ( GetHeroLevel(u)  * ( ( GetHeroLevel(u) / 2 ) + 1 ) ) * (GetHeroLevel(u) * 2) ) )
call ModifyHeroStat( bj_HEROSTAT_INT, u, bj_MODIFYMETHOD_SET, ( ( ( GetHeroLevel(u) / 2 ) * ( ( GetHeroLevel(u) / 4 ) + 1 ) ) * (GetHeroLevel(u) / 2) ) )
call ModifyHeroStat( bj_HEROSTAT_AGI, u, bj_MODIFYMETHOD_SET, ( GetHeroLevel(u) * GetHeroLevel(u) * 2 ))
call GroupAddUnitSimple( u, udg_KalendenLargeArmy )

endif

call RemoveLocation(l)
set l = null
set u = null
set p = null
endfunction

//===========================================================================
function InitTrig_Kalendens_Army takes nothing returns nothing
    set gg_trg_Kalendens_Army = CreateTrigger(  )
    call TriggerRegisterTimerEventPeriodic( gg_trg_Kalendens_Army, 300.00 )
    call TriggerAddCondition( gg_trg_Kalendens_Army, Condition( function Trig_Kalendens_Army_Conditions ) )
    call TriggerAddAction( gg_trg_Kalendens_Army, function Trig_Kalendens_Army_Actions )
endfunction

//===========================================================================
// Trigger: Comp Up
//===========================================================================
function Trig_Comp_Up_Actions takes nothing returns nothing
    set udg_CreepCounter = ( udg_CreepCounter + 1 )
endfunction

//===========================================================================
function InitTrig_Comp_Up takes nothing returns nothing
    set gg_trg_Comp_Up = CreateTrigger(  )
    call TriggerRegisterTimerExpireEventBJ( gg_trg_Comp_Up, udg_CompUp )
    call TriggerAddAction( gg_trg_Comp_Up, function Trig_Comp_Up_Actions )
endfunction

//===========================================================================
// Trigger: Castle Creep Respawn
//===========================================================================
function Trig_Castle_Creep_Respawn_Conditions takes nothing returns boolean
local unit u = GetDyingUnit()
if GetUnitUserData(u) > 100 then
return true
set u = null
endif
set u = null
return false
endfunction

function Trig_Castle_Creep_Respawn_Actions takes nothing returns nothing
local unit u = GetDyingUnit()
local unit u2 = null
local player p = GetOwningPlayer(u)
local integer i = GetUnitTypeId(u)
local integer i2 = GetUnitUserData(u)

call PolledWait( 600.00 )

call CreateNUnitsAtLoc( 1, i, p, udg_CastleCreepsSpots[i2], bj_UNIT_FACING )
set u2 = GetLastCreatedUnit()
call SetUnitUserData( u2, i2 )
set u = null
set u2 = null
set p = null
endfunction

//===========================================================================
function InitTrig_Castle_Creep_Respawn takes nothing returns nothing
    set gg_trg_Castle_Creep_Respawn = CreateTrigger(  )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Castle_Creep_Respawn, Player(10), EVENT_PLAYER_UNIT_DEATH )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Castle_Creep_Respawn, Player(11), EVENT_PLAYER_UNIT_DEATH )
    call TriggerAddCondition( gg_trg_Castle_Creep_Respawn, Condition( function Trig_Castle_Creep_Respawn_Conditions ) )
    call TriggerAddAction( gg_trg_Castle_Creep_Respawn, function Trig_Castle_Creep_Respawn_Actions )
endfunction

//===========================================================================
// Trigger: Equipment Camp Grow
//===========================================================================
function Equipment_War takes nothing returns boolean
local unit u = GetFilterUnit()
local player p = GetOwningPlayer(u)
if IsUnitType(u, UNIT_TYPE_GROUND) == true and GetUnitUserData(u) == 0 and p == Player(10) then
set u = null
set p = null
return true
endif
set u = null
set p = null
return false
endfunction

function Equipment_Grow takes nothing returns boolean
local unit u = GetFilterUnit()
local player p = GetOwningPlayer(u)
if IsUnitType(u, UNIT_TYPE_GROUND) == true and p == Player(10) and GetUnitUserData(u) == 2 then
set u = null
set p = null
return true
endif
set u = null
set p = null
return false
endfunction

function Barrack_Check takes nothing returns boolean
local unit u = GetFilterUnit()
if GetUnitTypeId(u) == 'o01E' then
set u = null
return true
endif
set u = null
return false
endfunction

function BarrackSpawn takes nothing returns nothing
local unit u = GetEnumUnit()
local player p = Player(10)
local location l = GetUnitLoc(u)
call RebelLevel(0)
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, p, l, bj_UNIT_FACING )
call RemoveLocation( l )
set l = null 
set u = null 
set p = null
endfunction

function Build_Equipment_Expansion takes nothing returns nothing
local unit u = GetEnumUnit()
local location l = PolarProjectionBJ(bj_enumDestructableCenter, ((bj_meleeNearestMineDist * 60) + 450), bj_meleeNearestMineDist * 45)

if bj_meleeNearestMineDist == 1 or bj_meleeNearestMineDist == 2 then 
call IssueBuildOrderByIdLocBJ( u, 'o00S', l )
endif
if bj_meleeNearestMineDist == 3 or bj_meleeNearestMineDist == 4 then 
call IssueBuildOrderByIdLocBJ( u, 'o01E', l )
endif
if bj_meleeNearestMineDist == 5 or bj_meleeNearestMineDist == 6 then 
call IssueBuildOrderByIdLocBJ( u, 'o01D', l )
endif
if bj_meleeNearestMineDist == 7 or bj_meleeNearestMineDist == 8 then 
call IssueBuildOrderByIdLocBJ( u, 'o00R', l )
endif

set bj_meleeNearestMineDist = bj_meleeNearestMineDist + 2
if bj_meleeNearestMineDist > 8 then 
set bj_meleeNearestMineDist = 1
endif

set u = null
call RemoveLocation(l)
set l = null
endfunction


function Equipment_Worker takes nothing returns boolean
    return ( GetUnitTypeId(GetFilterUnit()) == 'o01H' )
endfunction

function Trig_Equipment_Camp_Grow_Func001A takes nothing returns nothing
local unit u = GetEnumUnit()
local unit u2 = null
local player p = GetOwningPlayer(u)
local location l = GetUnitLoc(u)
local group g = GetUnitsInRangeOfLocMatching(1400, l, Condition(function Equipment_Worker))
local group g2 = GetUnitsInRangeOfLocMatching(1250, l, Condition(function Equipment_Grow))
local group g3 = GetUnitsInRangeOfLocMatching(1250, l, Condition(function Barrack_Check))
local group g4 = null
local integer i = 5

if CountUnitsInGroup(g) < 4 and GetUnitStateSwap(UNIT_STATE_MANA, u) == GetUnitStateSwap(UNIT_STATE_MAX_MANA, u) then
call CreateNUnitsAtLoc( 1, 'o01H', p, l, 270.0 )
set u2 = GetLastCreatedUnit()
call GroupAddUnitSimple( u2, g )
call SetUnitUserData( u2, 3 )
call SetUnitManaBJ( u, 0 )
endif

if CountUnitsInGroup(g) > 0 then
set bj_enumDestructableCenter = l
call ForGroupBJ( g, function Build_Equipment_Expansion )
endif

if udg_CreepGroupCounter < 5 then
call RebelLevel(0)
call CreateNUnitsAtLoc( 4, bj_groupCountUnits, p, l, bj_UNIT_FACING )
call CreateNUnitsAtLoc( 1, 'U00E', p, l, bj_UNIT_FACING )
set u2 = GetLastCreatedUnit()
call SetHeroLevelBJ( u2, udg_CreepCounter, false )
call SetUnitScalePercent( u2, ( 50.00 + ( 2.5 * I2R(udg_CreepCounter) ) ), ( 50.00 + ( 2.5 * I2R(udg_CreepCounter) ) ), ( 50.00 + ( 2.5 * I2R(udg_CreepCounter) ) ) )
call ModifyHeroStat( bj_HEROSTAT_STR, u2, bj_MODIFYMETHOD_SET, ( ( GetHeroLevel(u2) * ( ( GetHeroLevel(u2) / 3 ) + 1 ) ) * ( GetHeroLevel(u2) * 2 ) ) )
call ModifyHeroStat( bj_HEROSTAT_INT, u2, bj_MODIFYMETHOD_SET, ( ( ( GetHeroLevel(u2) / 2 ) * ( ( GetHeroLevel(u2) / 4 ) + 1 ) ) * ( GetHeroLevel(u2) / 2 ) ) )
call ModifyHeroStat( bj_HEROSTAT_AGI, u2, bj_MODIFYMETHOD_SET, ( GetHeroLevel(u) * GetHeroLevel(u) * 2 ))
call ForGroupBJ( g3, function BarrackSpawn )
loop
exitwhen CountUnitsInGroup(udg_Group[i]) == 0
set i = i + 1
endloop
set udg_Group[i] = GetUnitsInRangeOfLocMatching(1250, l, Condition(function Equipment_War))
endif

if CountUnitsInGroup(g2) < 5 then
call RebelLevel(0)
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, p, l, bj_UNIT_FACING )
set u2 = GetLastCreatedUnit()
call SetUnitUserData(u2, 2)
call CreateNUnitsAtLoc( 1, bj_groupCountUnits, p, l, bj_UNIT_FACING )
set u2 = GetLastCreatedUnit()
call SetUnitUserData(u2, 2)
endif

call RemoveLocation(l)
call DestroyGroup(g)
call DestroyGroup(g2)
call DestroyGroup(g3)
call DestroyGroup(g4)
set l = null
set g = null
set g2 = null
set g3 = null
set g4 = null
set u = null
set u2 = null
set p = null
endfunction

function Trig_Equipment_Camp_Grow_Actions takes nothing returns nothing
set bj_meleeNearestMineDist = GetRandomReal(1.0,8.0)
call ForGroupBJ( udg_EquipmentCamps, function Trig_Equipment_Camp_Grow_Func001A )
endfunction

//===========================================================================
function InitTrig_Equipment_Camp_Grow takes nothing returns nothing
    set gg_trg_Equipment_Camp_Grow = CreateTrigger(  )
    call TriggerRegisterTimerEventPeriodic( gg_trg_Equipment_Camp_Grow, 89.00 )
    call TriggerAddAction( gg_trg_Equipment_Camp_Grow, function Trig_Equipment_Camp_Grow_Actions )
endfunction

//===========================================================================
// Trigger: Equipment Camp Attack
//===========================================================================
function Camp_Attack_Now takes nothing returns nothing
local location l = GetUnitLoc(udg_HuntedUnit[bj_cineModeSavedSeed])
local unit u = GetEnumUnit()
call IssuePointOrderLoc( u, "attack", l )
call RemoveLocation(l)
set u = null
set l = null
endfunction

function Trig_Equipment_Camp_Attack_Actions takes nothing returns nothing
local integer i = 5

set udg_CreepGroupCounter = 0
loop
exitwhen i == 25
set bj_cineModeSavedSeed = i
if CountUnitsInGroup(udg_Group[i]) > 0 then
call ForGroupBJ( udg_Group[i], function Camp_Attack_Now )
set udg_CreepGroupCounter = udg_CreepGroupCounter + 1
endif
set i = i + 1
endloop
endfunction

//===========================================================================
function InitTrig_Equipment_Camp_Attack takes nothing returns nothing
    set gg_trg_Equipment_Camp_Attack = CreateTrigger(  )
    call TriggerRegisterTimerEventPeriodic( gg_trg_Equipment_Camp_Attack, 20.00 )
    call TriggerAddAction( gg_trg_Equipment_Camp_Attack, function Trig_Equipment_Camp_Attack_Actions )
endfunction

//===========================================================================
// Trigger: Kick Blue
//===========================================================================
function Trig_Kick_Blue_Actions takes nothing returns nothing
    call CustomDefeatBJ( Player(1), "TRIGSTR_2599" )
endfunction

//===========================================================================
function InitTrig_Kick_Blue takes nothing returns nothing
    set gg_trg_Kick_Blue = CreateTrigger(  )
    call TriggerRegisterPlayerChatEvent( gg_trg_Kick_Blue, Player(0), "-kick blue", true )
    call TriggerAddAction( gg_trg_Kick_Blue, function Trig_Kick_Blue_Actions )
endfunction

//===========================================================================
// Trigger: Kick Teal
//===========================================================================
function Trig_Kick_Teal_Actions takes nothing returns nothing
    call CustomDefeatBJ( Player(2), "TRIGSTR_2691" )
endfunction

//===========================================================================
function InitTrig_Kick_Teal takes nothing returns nothing
    set gg_trg_Kick_Teal = CreateTrigger(  )
    call TriggerRegisterPlayerChatEvent( gg_trg_Kick_Teal, Player(0), "-kick teal", true )
    call TriggerAddAction( gg_trg_Kick_Teal, function Trig_Kick_Teal_Actions )
endfunction

//===========================================================================
// Trigger: Kick Purple
//===========================================================================
function Trig_Kick_Purple_Actions takes nothing returns nothing
    call CustomDefeatBJ( Player(3), "TRIGSTR_2841" )
endfunction

//===========================================================================
function InitTrig_Kick_Purple takes nothing returns nothing
    set gg_trg_Kick_Purple = CreateTrigger(  )
    call TriggerRegisterPlayerChatEvent( gg_trg_Kick_Purple, Player(0), "-kick purple", true )
    call TriggerAddAction( gg_trg_Kick_Purple, function Trig_Kick_Purple_Actions )
endfunction

//===========================================================================
// Trigger: Kick Yellow
//===========================================================================
function Trig_Kick_Yellow_Actions takes nothing returns nothing
    call CustomDefeatBJ( Player(4), "TRIGSTR_3023" )
endfunction

//===========================================================================
function InitTrig_Kick_Yellow takes nothing returns nothing
    set gg_trg_Kick_Yellow = CreateTrigger(  )
    call TriggerRegisterPlayerChatEvent( gg_trg_Kick_Yellow, Player(0), "-kick yellow", true )
    call TriggerAddAction( gg_trg_Kick_Yellow, function Trig_Kick_Yellow_Actions )
endfunction

//===========================================================================
// Trigger: Kick Orange
//===========================================================================
function Trig_Kick_Orange_Actions takes nothing returns nothing
    call CustomDefeatBJ( Player(5), "TRIGSTR_3025" )
endfunction

//===========================================================================
function InitTrig_Kick_Orange takes nothing returns nothing
    set gg_trg_Kick_Orange = CreateTrigger(  )
    call TriggerRegisterPlayerChatEvent( gg_trg_Kick_Orange, Player(0), "-kick orange", true )
    call TriggerAddAction( gg_trg_Kick_Orange, function Trig_Kick_Orange_Actions )
endfunction

//===========================================================================
// Trigger: Kick Green
//===========================================================================
function Trig_Kick_Green_Actions takes nothing returns nothing
    call CustomDefeatBJ( Player(6), "TRIGSTR_3026" )
endfunction

//===========================================================================
function InitTrig_Kick_Green takes nothing returns nothing
    set gg_trg_Kick_Green = CreateTrigger(  )
    call TriggerRegisterPlayerChatEvent( gg_trg_Kick_Green, Player(0), "-kick green", true )
    call TriggerAddAction( gg_trg_Kick_Green, function Trig_Kick_Green_Actions )
endfunction

//===========================================================================
// Trigger: Kick Pink
//===========================================================================
function Trig_Kick_Pink_Actions takes nothing returns nothing
    call CustomDefeatBJ( Player(7), "TRIGSTR_3027" )
endfunction

//===========================================================================
function InitTrig_Kick_Pink takes nothing returns nothing
    set gg_trg_Kick_Pink = CreateTrigger(  )
    call TriggerRegisterPlayerChatEvent( gg_trg_Kick_Pink, Player(0), "-kick pink", true )
    call TriggerAddAction( gg_trg_Kick_Pink, function Trig_Kick_Pink_Actions )
endfunction

//===========================================================================
// Trigger: Kick Gray
//===========================================================================
function Trig_Kick_Gray_Actions takes nothing returns nothing
    call CustomDefeatBJ( Player(8), "TRIGSTR_3037" )
endfunction

//===========================================================================
function InitTrig_Kick_Gray takes nothing returns nothing
    set gg_trg_Kick_Gray = CreateTrigger(  )
    call TriggerRegisterPlayerChatEvent( gg_trg_Kick_Gray, Player(0), "-kick gray", true )
    call TriggerAddAction( gg_trg_Kick_Gray, function Trig_Kick_Gray_Actions )
endfunction

//===========================================================================
// Trigger: Kick LB
//===========================================================================
function Trig_Kick_LB_Actions takes nothing returns nothing
    call CustomDefeatBJ( Player(9), "TRIGSTR_3039" )
endfunction

//===========================================================================
function InitTrig_Kick_LB takes nothing returns nothing
    set gg_trg_Kick_LB = CreateTrigger(  )
    call TriggerRegisterPlayerChatEvent( gg_trg_Kick_LB, Player(0), "-kick light blue", true )
    call TriggerAddAction( gg_trg_Kick_LB, function Trig_Kick_LB_Actions )
endfunction

//===========================================================================
// Trigger: Continue After Win
//===========================================================================
function Trig_Continue_After_Win_Actions takes nothing returns nothing
    call DisableTrigger( gg_trg_Victory_Kalenden_Death )
endfunction

//===========================================================================
function InitTrig_Continue_After_Win takes nothing returns nothing
    set gg_trg_Continue_After_Win = CreateTrigger(  )
    call TriggerRegisterPlayerChatEvent( gg_trg_Continue_After_Win, Player(0), "-continue after win", true )
    call TriggerAddAction( gg_trg_Continue_After_Win, function Trig_Continue_After_Win_Actions )
endfunction

//===========================================================================
// Trigger: Turn off song
//===========================================================================
function Trig_Turn_off_song_Actions takes nothing returns nothing
    call StopMusicBJ( true )
endfunction

//===========================================================================
function InitTrig_Turn_off_song takes nothing returns nothing
    set gg_trg_Turn_off_song = CreateTrigger(  )
    call TriggerRegisterPlayerChatEvent( gg_trg_Turn_off_song, Player(0), "-song off", true )
    call TriggerAddAction( gg_trg_Turn_off_song, function Trig_Turn_off_song_Actions )
endfunction

//===========================================================================
// Trigger: EXAMPLE
//===========================================================================
function Trig_EXAMPLE_Actions takes nothing returns nothing
    call PlayMusicBJ( GetLastPlayedMusic() )
endfunction

//===========================================================================
function InitTrig_EXAMPLE takes nothing returns nothing
    set gg_trg_EXAMPLE = CreateTrigger(  )
    call TriggerRegisterPlayerChatEvent( gg_trg_EXAMPLE, Player(0), "-(song name)", true )
    call TriggerAddAction( gg_trg_EXAMPLE, function Trig_EXAMPLE_Actions )
endfunction

//===========================================================================
// Trigger: Storm Earth and Fire
//===========================================================================
function Trig_Storm_Earth_and_Fire_Actions takes nothing returns nothing
    call PlayMusicBJ( gg_snd_Storm_Earth_and_Fire )
endfunction

//===========================================================================
function InitTrig_Storm_Earth_and_Fire takes nothing returns nothing
    set gg_trg_Storm_Earth_and_Fire = CreateTrigger(  )
    call TriggerRegisterPlayerChatEvent( gg_trg_Storm_Earth_and_Fire, Player(0), "-storm earth and fire", true )
    call TriggerAddAction( gg_trg_Storm_Earth_and_Fire, function Trig_Storm_Earth_and_Fire_Actions )
endfunction

//===========================================================================
// Trigger: Tragic Confrontation
//===========================================================================
function Trig_Tragic_Confrontation_Actions takes nothing returns nothing
    call PlayMusicBJ( gg_snd_Tragic_Confrontation )
endfunction

//===========================================================================
function InitTrig_Tragic_Confrontation takes nothing returns nothing
    set gg_trg_Tragic_Confrontation = CreateTrigger(  )
    call TriggerRegisterPlayerChatEvent( gg_trg_Tragic_Confrontation, Player(0), "-tragic confrontation", true )
    call TriggerAddAction( gg_trg_Tragic_Confrontation, function Trig_Tragic_Confrontation_Actions )
endfunction

//===========================================================================
// Trigger: Pursuit
//===========================================================================
function Trig_Pursuit_Actions takes nothing returns nothing
    call PlayMusicBJ( gg_snd_Pursuit )
endfunction

//===========================================================================
function InitTrig_Pursuit takes nothing returns nothing
    set gg_trg_Pursuit = CreateTrigger(  )
    call TriggerRegisterPlayerChatEvent( gg_trg_Pursuit, Player(0), "-pursuit", true )
    call TriggerAddAction( gg_trg_Pursuit, function Trig_Pursuit_Actions )
endfunction

//===========================================================================
function InitCustomTriggers takes nothing returns nothing
    call InitTrig_Autoblink(  )
    call InitTrig_Refresh_Multiboard(  )
    call InitTrig_Multiboard_Show(  )
    call InitTrig_Set_Up_Castle_Creeps(  )
    call InitTrig_Set_Up_Rebellions(  )
    call InitTrig_Set_Up_Creep(  )
    call InitTrig_Starting_Game(  )
    call InitTrig_Vote_Over(  )
    call InitTrig_Button_Clicked(  )
    call InitTrig_Button_Clicked_Race(  )
    call InitTrig_Button_Clicked_Class(  )
    call InitTrig_Button_Clicked_Profile(  )
    call InitTrig_Button_Clicked_Mode(  )
    call InitTrig_Victory_Kalenden_Death(  )
    call InitTrig_Grace_Periode_End(  )
    call InitTrig_Multiboard_Hero(  )
    call InitTrig_Multiboard_Empire(  )
    call InitTrig_Defeat_check(  )
    call InitTrig_Unpack(  )
    call InitTrig_Not_allowed(  )
    call InitTrig_House_Grow(  )
    call InitTrig_Hire_or_Fire_Hero(  )
    call InitTrig_Hire_Hero_Button(  )
    call InitTrig_Increase_and_Decrease_Payment(  )
    call InitTrig_Player_Leaves(  )
    call InitTrig_Set_working_people(  )
    call InitTrig_Tax(  )
    call InitTrig_Rations(  )
    call InitTrig_Destroy_Building(  )
    call InitTrig_Demolish_Plant(  )
    call InitTrig_Retire(  )
    call InitTrig_Open_and_Close_gates(  )
    call InitTrig_Unit_Trained(  )
    call InitTrig_Building_Finished(  )
    call InitTrig_Begins_an_Upgrade(  )
    call InitTrig_Unit_or_Building_Dies(  )
    call InitTrig_New_Building(  )
    call InitTrig_New_Building_Grace(  )
    call InitTrig_Nuclear_Missle_Launch(  )
    call InitTrig_Black_Hole(  )
    call InitTrig_Age_Up(  )
    call InitTrig_Fire_Dies(  )
    call InitTrig_Grow_Trees(  )
    call InitTrig_Destroy_Road(  )
    call InitTrig_No_Hiring(  )
    call InitTrig_Science_Lab(  )
    call InitTrig_Start_Research(  )
    call InitTrig_Research_Done(  )
    call InitTrig_Researches_Back(  )
    call InitTrig_Abort_Research(  )
    call InitTrig_Go_to_Tech(  )
    call InitTrig_Hero_Gets_Item(  )
    call InitTrig_Hero_Loses_Item(  )
    call InitTrig_Show_Spots(  )
    call InitTrig_Show_Quest_Monsters(  )
    call InitTrig_Upgrade_Skills(  )
    call InitTrig_Hero_Level_Up(  )
    call InitTrig_Set_Up_Camp(  )
    call InitTrig_Hero_Dies(  )
    call InitTrig_Exp_and_Gold(  )
    call InitTrig_Exp_Gold_Rank(  )
    call InitTrig_Servant_of_Decay(  )
    call InitTrig_Merc_Speed(  )
    call InitTrig_Buy_Item(  )
    call InitTrig_Sell_Item(  )
    call InitTrig_Hero_Building_Dies(  )
    call InitTrig_Hideout_Heal(  )
    call InitTrig_Campfire(  )
    call InitTrig_Hideout(  )
    call InitTrig_Forge(  )
    call InitTrig_Library(  )
    call InitTrig_Spike_Trap(  )
    call InitTrig_Storage_Pit(  )
    call InitTrig_Land_Mine(  )
    call InitTrig_Temple(  )
    call InitTrig_Tower(  )
    call InitTrig_Forge_Armor(  )
    call InitTrig_Upgrade_Armor(  )
    call InitTrig_Forge_Weapon(  )
    call InitTrig_Upgrade_Weapon(  )
    call InitTrig_Forge_Helm(  )
    call InitTrig_Upgrade_Helm(  )
    call InitTrig_Forge_Staff(  )
    call InitTrig_Upgrade_Staff(  )
    call InitTrig_Forge_Claymore(  )
    call InitTrig_Improve_Claymore(  )
    call InitTrig_Brew_Potions(  )
    call InitTrig_Sacrafice(  )
    call InitTrig_Gifts(  )
    call InitTrig_Upgrade_Tower(  )
    call InitTrig_Trigger_Random_Events(  )
    call InitTrig_Obilisk_Timer_Up(  )
    call InitTrig_Obilisk_Destroyed(  )
    call InitTrig_Plague_or_Baby_Boom_Over(  )
    call InitTrig_Initiate(  )
    call InitTrig_Getting_Quest(  )
    call InitTrig_Quest_Table(  )
    call InitTrig_Monster_Table(  )
    call InitTrig_Set_Quests(  )
    call InitTrig_Returning_Quest_Items_To_Towns(  )
    call InitTrig_Quest_Reward_Monster_Slaying(  )
    call InitTrig_Camp_Attack(  )
    call InitTrig_Supply_Wagon(  )
    call InitTrig_zooms(  )
    call InitTrig_rotate(  )
    call InitTrig_angle(  )
    call InitTrig_reset(  )
    call InitTrig_Rename(  )
    call InitTrig_Hero_Ally_Click(  )
    call InitTrig_Difficulty(  )
    call InitTrig_War(  )
    call InitTrig_War_All(  )
    call InitTrig_Truce(  )
    call InitTrig_Truce_All(  )
    call InitTrig_Share(  )
    call InitTrig_Unshare(  )
    call InitTrig_Ally(  )
    call InitTrig_Ally_All(  )
    call InitTrig_ignore(  )
    call InitTrig_unignore(  )
    call InitTrig_Give_Tradepoints(  )
    call InitTrig_Give_Food(  )
    call InitTrig_Unit_is_hit_by_Tower(  )
    call InitTrig_Tradepoint_Flow(  )
    call InitTrig_Taunt(  )
    call InitTrig_Roar(  )
    call InitTrig_Use_Potions(  )
    call InitTrig_Call_to_Arms(  )
    call InitTrig_Merc_Heal(  )
    call InitTrig_Fireball(  )
    call InitTrig_Gold_Strike(  )
    call InitTrig_Energy_Shield(  )
    call InitTrig_Shield_of_divinity(  )
    call InitTrig_Nova(  )
    call InitTrig_Mend(  )
    call InitTrig_Battle_Rage(  )
    call InitTrig_Nova_wiz(  )
    call InitTrig_Dark_Pact(  )
    call InitTrig_Death_Coil(  )
    call InitTrig_Finger_of_Pain(  )
    call InitTrig_Destruction_Bolt_and_Frost_Bolt(  )
    call InitTrig_Finger_of_Death(  )
    call InitTrig_Ray_of_Light(  )
    call InitTrig_Soul_Drain(  )
    call InitTrig_Gold_Factory(  )
    call InitTrig_Green_Brown_Grey_Dies(  )
    call InitTrig_Spawning(  )
    call InitTrig_other_victem(  )
    call InitTrig_Order_Creeps(  )
    call InitTrig_Attacker_Spawn(  )
    call InitTrig_Kalendens_Army(  )
    call InitTrig_Comp_Up(  )
    call InitTrig_Castle_Creep_Respawn(  )
    call InitTrig_Equipment_Camp_Grow(  )
    call InitTrig_Equipment_Camp_Attack(  )
    call InitTrig_Kick_Blue(  )
    call InitTrig_Kick_Teal(  )
    call InitTrig_Kick_Purple(  )
    call InitTrig_Kick_Yellow(  )
    call InitTrig_Kick_Orange(  )
    call InitTrig_Kick_Green(  )
    call InitTrig_Kick_Pink(  )
    call InitTrig_Kick_Gray(  )
    call InitTrig_Kick_LB(  )
    call InitTrig_Continue_After_Win(  )
    call InitTrig_Turn_off_song(  )
    call InitTrig_EXAMPLE(  )
    call InitTrig_Storm_Earth_and_Fire(  )
    call InitTrig_Tragic_Confrontation(  )
    call InitTrig_Pursuit(  )
endfunction

//***************************************************************************
//*
//*  Players
//*
//***************************************************************************

function InitCustomPlayerSlots takes nothing returns nothing

    // Player 0
    call SetPlayerStartLocation( Player(0), 0 )
    call SetPlayerColor( Player(0), ConvertPlayerColor(0) )
    call SetPlayerRacePreference( Player(0), RACE_PREF_HUMAN )
    call SetPlayerRaceSelectable( Player(0), false )
    call SetPlayerController( Player(0), MAP_CONTROL_USER )

    // Player 1
    call SetPlayerStartLocation( Player(1), 1 )
    call SetPlayerColor( Player(1), ConvertPlayerColor(1) )
    call SetPlayerRacePreference( Player(1), RACE_PREF_HUMAN )
    call SetPlayerRaceSelectable( Player(1), false )
    call SetPlayerController( Player(1), MAP_CONTROL_USER )

    // Player 2
    call SetPlayerStartLocation( Player(2), 2 )
    call SetPlayerColor( Player(2), ConvertPlayerColor(2) )
    call SetPlayerRacePreference( Player(2), RACE_PREF_HUMAN )
    call SetPlayerRaceSelectable( Player(2), false )
    call SetPlayerController( Player(2), MAP_CONTROL_USER )

    // Player 3
    call SetPlayerStartLocation( Player(3), 3 )
    call SetPlayerColor( Player(3), ConvertPlayerColor(3) )
    call SetPlayerRacePreference( Player(3), RACE_PREF_HUMAN )
    call SetPlayerRaceSelectable( Player(3), false )
    call SetPlayerController( Player(3), MAP_CONTROL_USER )

    // Player 4
    call SetPlayerStartLocation( Player(4), 4 )
    call SetPlayerColor( Player(4), ConvertPlayerColor(4) )
    call SetPlayerRacePreference( Player(4), RACE_PREF_HUMAN )
    call SetPlayerRaceSelectable( Player(4), false )
    call SetPlayerController( Player(4), MAP_CONTROL_USER )

    // Player 5
    call SetPlayerStartLocation( Player(5), 5 )
    call SetPlayerColor( Player(5), ConvertPlayerColor(5) )
    call SetPlayerRacePreference( Player(5), RACE_PREF_HUMAN )
    call SetPlayerRaceSelectable( Player(5), false )
    call SetPlayerController( Player(5), MAP_CONTROL_USER )

    // Player 6
    call SetPlayerStartLocation( Player(6), 6 )
    call SetPlayerColor( Player(6), ConvertPlayerColor(6) )
    call SetPlayerRacePreference( Player(6), RACE_PREF_HUMAN )
    call SetPlayerRaceSelectable( Player(6), false )
    call SetPlayerController( Player(6), MAP_CONTROL_USER )

    // Player 7
    call SetPlayerStartLocation( Player(7), 7 )
    call SetPlayerColor( Player(7), ConvertPlayerColor(7) )
    call SetPlayerRacePreference( Player(7), RACE_PREF_HUMAN )
    call SetPlayerRaceSelectable( Player(7), false )
    call SetPlayerController( Player(7), MAP_CONTROL_USER )

    // Player 8
    call SetPlayerStartLocation( Player(8), 8 )
    call SetPlayerColor( Player(8), ConvertPlayerColor(8) )
    call SetPlayerRacePreference( Player(8), RACE_PREF_HUMAN )
    call SetPlayerRaceSelectable( Player(8), false )
    call SetPlayerController( Player(8), MAP_CONTROL_USER )

    // Player 9
    call SetPlayerStartLocation( Player(9), 9 )
    call SetPlayerColor( Player(9), ConvertPlayerColor(9) )
    call SetPlayerRacePreference( Player(9), RACE_PREF_HUMAN )
    call SetPlayerRaceSelectable( Player(9), false )
    call SetPlayerController( Player(9), MAP_CONTROL_USER )

    // Player 10
    call SetPlayerStartLocation( Player(10), 10 )
    call ForcePlayerStartLocation( Player(10), 10 )
    call SetPlayerColor( Player(10), ConvertPlayerColor(10) )
    call SetPlayerRacePreference( Player(10), RACE_PREF_ORC )
    call SetPlayerRaceSelectable( Player(10), false )
    call SetPlayerController( Player(10), MAP_CONTROL_COMPUTER )

    // Player 11
    call SetPlayerStartLocation( Player(11), 11 )
    call ForcePlayerStartLocation( Player(11), 11 )
    call SetPlayerColor( Player(11), ConvertPlayerColor(11) )
    call SetPlayerRacePreference( Player(11), RACE_PREF_ORC )
    call SetPlayerRaceSelectable( Player(11), false )
    call SetPlayerController( Player(11), MAP_CONTROL_COMPUTER )

endfunction

function InitCustomTeams takes nothing returns nothing
    // Force: TRIGSTR_580
    call SetPlayerTeam( Player(0), 0 )
    call SetPlayerTeam( Player(1), 0 )
    call SetPlayerTeam( Player(2), 0 )
    call SetPlayerTeam( Player(3), 0 )
    call SetPlayerTeam( Player(4), 0 )
    call SetPlayerTeam( Player(5), 0 )
    call SetPlayerTeam( Player(6), 0 )
    call SetPlayerTeam( Player(7), 0 )
    call SetPlayerTeam( Player(8), 0 )
    call SetPlayerTeam( Player(9), 0 )

    // Force: TRIGSTR_331
    call SetPlayerTeam( Player(10), 1 )
    call SetPlayerState( Player(10), PLAYER_STATE_ALLIED_VICTORY, 1 )
    call SetPlayerTeam( Player(11), 1 )
    call SetPlayerState( Player(11), PLAYER_STATE_ALLIED_VICTORY, 1 )

    //   Allied
    call SetPlayerAllianceStateAllyBJ( Player(10), Player(11), true )
    call SetPlayerAllianceStateAllyBJ( Player(11), Player(10), true )

endfunction

function InitAllyPriorities takes nothing returns nothing

    call SetStartLocPrioCount( 0, 9 )
    call SetStartLocPrio( 0, 0, 1, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 0, 1, 2, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 0, 2, 3, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 0, 3, 4, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 0, 4, 5, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 0, 5, 6, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 0, 6, 7, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 0, 7, 8, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 0, 8, 9, MAP_LOC_PRIO_HIGH )

    call SetStartLocPrioCount( 1, 9 )
    call SetStartLocPrio( 1, 0, 0, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 1, 1, 2, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 1, 2, 3, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 1, 3, 4, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 1, 4, 5, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 1, 5, 6, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 1, 6, 7, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 1, 7, 8, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 1, 8, 9, MAP_LOC_PRIO_HIGH )

    call SetStartLocPrioCount( 2, 9 )
    call SetStartLocPrio( 2, 0, 0, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 2, 1, 1, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 2, 2, 3, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 2, 3, 4, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 2, 4, 5, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 2, 5, 6, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 2, 6, 7, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 2, 7, 8, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 2, 8, 9, MAP_LOC_PRIO_HIGH )

    call SetStartLocPrioCount( 3, 9 )
    call SetStartLocPrio( 3, 0, 0, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 3, 1, 1, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 3, 2, 2, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 3, 3, 4, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 3, 4, 5, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 3, 5, 6, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 3, 6, 7, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 3, 7, 8, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 3, 8, 9, MAP_LOC_PRIO_HIGH )

    call SetStartLocPrioCount( 4, 9 )
    call SetStartLocPrio( 4, 0, 0, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 4, 1, 1, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 4, 2, 2, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 4, 3, 3, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 4, 4, 5, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 4, 5, 6, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 4, 6, 7, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 4, 7, 8, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 4, 8, 9, MAP_LOC_PRIO_HIGH )

    call SetStartLocPrioCount( 5, 9 )
    call SetStartLocPrio( 5, 0, 0, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 5, 1, 1, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 5, 2, 2, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 5, 3, 3, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 5, 4, 4, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 5, 5, 6, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 5, 6, 7, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 5, 7, 8, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 5, 8, 9, MAP_LOC_PRIO_HIGH )

    call SetStartLocPrioCount( 6, 9 )
    call SetStartLocPrio( 6, 0, 0, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 6, 1, 1, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 6, 2, 2, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 6, 3, 3, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 6, 4, 4, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 6, 5, 5, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 6, 6, 7, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 6, 7, 8, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 6, 8, 9, MAP_LOC_PRIO_HIGH )

    call SetStartLocPrioCount( 7, 9 )
    call SetStartLocPrio( 7, 0, 0, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 7, 1, 1, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 7, 2, 2, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 7, 3, 3, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 7, 4, 4, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 7, 5, 5, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 7, 6, 6, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 7, 7, 8, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 7, 8, 9, MAP_LOC_PRIO_HIGH )

    call SetStartLocPrioCount( 8, 9 )
    call SetStartLocPrio( 8, 0, 0, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 8, 1, 1, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 8, 2, 2, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 8, 3, 3, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 8, 4, 4, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 8, 5, 5, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 8, 6, 6, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 8, 7, 7, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 8, 8, 9, MAP_LOC_PRIO_HIGH )

    call SetStartLocPrioCount( 9, 9 )
    call SetStartLocPrio( 9, 0, 0, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 9, 1, 1, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 9, 2, 2, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 9, 3, 3, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 9, 4, 4, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 9, 5, 5, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 9, 6, 6, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 9, 7, 7, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 9, 8, 8, MAP_LOC_PRIO_HIGH )
endfunction

//***************************************************************************
//*
//*  Main Initialization
//*
//***************************************************************************

//===========================================================================
function main takes nothing returns nothing
    call SetCameraBounds( -7936.0 + GetCameraMargin(CAMERA_MARGIN_LEFT), -7936.0 + GetCameraMargin(CAMERA_MARGIN_BOTTOM), 16128.0 - GetCameraMargin(CAMERA_MARGIN_RIGHT), 16128.0 - GetCameraMargin(CAMERA_MARGIN_TOP), -7936.0 + GetCameraMargin(CAMERA_MARGIN_LEFT), 16128.0 - GetCameraMargin(CAMERA_MARGIN_TOP), 16128.0 - GetCameraMargin(CAMERA_MARGIN_RIGHT), -7936.0 + GetCameraMargin(CAMERA_MARGIN_BOTTOM) )
    call SetDayNightModels( "Environment\\DNC\\DNCLordaeron\\DNCLordaeronTerrain\\DNCLordaeronTerrain.mdl", "Environment\\DNC\\DNCLordaeron\\DNCLordaeronUnit\\DNCLordaeronUnit.mdl" )
    call SetWaterBaseColor( 150, 150, 200, 255 )
    call NewSoundEnvironment( "lake" )
    call SetAmbientDaySound( "LordaeronSummerDay" )
    call SetAmbientNightSound( "LordaeronSummerNight" )
    call SetMapMusic( "Music", true, 0 )
    call InitSounds(  )
    call CreateRegions(  )
    call CreateAllItems(  )
    call CreateAllUnits(  )
    call InitBlizzard(  )
    call InitGlobals(  )
    call InitCustomTriggers(  )

endfunction

//***************************************************************************
//*
//*  Map Configuration
//*
//***************************************************************************

function config takes nothing returns nothing
    call SetMapName( "TRIGSTR_001" )
    call SetMapDescription( "TRIGSTR_3811" )
    call SetPlayers( 12 )
    call SetTeams( 12 )
    call SetGamePlacement( MAP_PLACEMENT_TEAMS_TOGETHER )

    call DefineStartLocation( 0, 4736.0, 6080.0 )
    call DefineStartLocation( 1, 4736.0, 6080.0 )
    call DefineStartLocation( 2, 4736.0, 6080.0 )
    call DefineStartLocation( 3, 4736.0, 6080.0 )
    call DefineStartLocation( 4, 4736.0, 6080.0 )
    call DefineStartLocation( 5, 4736.0, 6080.0 )
    call DefineStartLocation( 6, 4736.0, 6080.0 )
    call DefineStartLocation( 7, 4736.0, 6080.0 )
    call DefineStartLocation( 8, 4736.0, 6080.0 )
    call DefineStartLocation( 9, 4736.0, 6080.0 )
    call DefineStartLocation( 10, 4736.0, 6080.0 )
    call DefineStartLocation( 11, 4736.0, 6080.0 )

    // Player setup
    call InitCustomPlayerSlots(  )
    call InitCustomTeams(  )
    call InitAllyPriorities(  )
endfunction

